!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FSBL=t():e.FSBL=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=46)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},r=Math.max;var o=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=r(o.length-t,0),u=Array(a);++s<a;)u[s]=o[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=o[s];return l[t]=n(u),i(e,this,l)}},s=n(7);function a(e,t){return o(e,t,s.a)}},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.LoggerConstructor=void 0;const i=n(3),r=n(36),o={Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0,Verbose:!0,LocalOnly:!1},s={Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0},a=n(52);t.LoggerConstructor=function(e){const r=this;let u;r.RouterClient=e&&e.RouterClient;let l=!1,c=!1;const d=r;let f,h,p=0,g=0;this.startupTime=0;let m=[];if("undefined"==typeof window)return;let y=i.System.Window.getCurrent().name;window.top!==window&&(y+=".Frame"),this.onLogStateChangeCallback=[];const w="finsemble.logger.client."+y;let b={console:s,dev:o,system:o,perf:o};function v(e,t,n){this.category=e,!u&&i.System.isBrowserView()&&(u=i.System.getViewId()),this.logClientName=u?`${y}: view-${u}`:y,this.logType=t,this.logData=n,this.logTimestamp=window.performance.timing.navigationStart+window.performance.now()+p}function C(e,t){e&&e.dev&&(b=e,r.onLogStateChangeCallback.forEach(t=>{t(e)})),function(e){d.system.debug("Logger updateQueueBasedOnState",e,p,"QUEUE LENGTH",m.length,b);const t=[];for(let n=0,{length:i}=m;n<i;n++)if(b[m[n].category][m[n].logType]&&!b[m[n].category].LocalOnly)e&&(m[n].logTimestamp=m[n].logTimestamp+p),t.push(m[n]);else if(b[m[n].category][m[n].logType]&&b[m[n].category].LocalOnly){const e=m[n];console.log(e.category,e.logType,e.logTimestamp-window.performance.timing.navigationStart,e.logData,"(Previously queued!)")}m=t}(t)}function S(){const{stack:e}=function(){try{throw Error("")}catch(e){return e}}(),t=(n="\n",i=4,e.split(n,i).join(n).length);var n,i;return"Log Stack: \n"+e.substring(t).substr(1)}this.onStateChanged=e=>{-1===this.onLogStateChangeCallback.indexOf(e)&&this.onLogStateChangeCallback.push(e)},this.setClientName=function(e){y=e},this.getClientName=function(){return y},this.clearMessageList=function(){m=[]},this.callStack=function(){return S()},this.setting=function(){return b};const _=console.error,T=console.warn,A=console.info,E=console.log,L=console.debug;function O(e,t){try{e.apply(console,function e(t){return t.reduce((t,n)=>t.concat(Array.isArray(n)?e(n):n),[])}(t))}catch(e){(t=[]).push(S())}}let I=()=>{m.length>0&&(r.RouterClient.transmit("logger.service.logMessages",m),d.clearMessageList())};function M(e,n,i){let r,o=!1,s=!0;"forceObjectsToLogger"===i[0]&&(o=!0,s=!1,i.splice(0,1)),i=i.map(e=>{if(s){if(function(e){const t=[],n=[e];let i=0,r=0;for(;n.length&&r<1e3;){r++;const e=n.pop();if("boolean"==typeof e)i+=4;else if("string"==typeof e)i+=2*e.length;else if("number"==typeof e)i+=8;else if("object"==typeof e&&-1===t.indexOf(e)){t.push(e);for(const t in e)n.push(e[t])}}return i}(e)>5e4)return O(A,["Message too large to send to the logger.",i]),"Log argument greater than 50KB. Check local Console to see output of the object."}return e});try{for(let e=0;e<i.length;e++)i[e]instanceof Error&&(i[e]=i[e].toString());r=new v(e,n,JSON.stringify(i))}catch(t){i.splice(0,i.length),i.push(S()),r=new v(e,n,"*** Logging Error: "+JSON.stringify(i))}if(o||!function(e){return!0===e.logData.includes("Finsemble.heartbeat")}(r))!function(e){if(m.length<2e4)m.push(e);else{console.error("Logging Queue Overflowed! Dumping queue here then continuing.",m.length);let e,n=0;for(;e=m.shift();)console.log("Message "+n++,e);t.Logger.system.error("Logging Queue Overflowed! Dumping queue in client then continuing.")}}(r);else if(++g<=5){O(A,[`"Filtered Logger Message (${g} of first 5 shown)`,r])}c&&I()}function D(){!u&&i.System.isBrowserView()&&(u=i.System.getViewId()),d.system.debug("logger.service.registering",y),r.RouterClient.query("logger.service.register",{clientName:y,clientChannel:w,uuid:i.System.Window.getCurrent().uuid,windowName:i.System.Window.getCurrent().name,viewId:u},(e,t)=>{if(e)setTimeout(D,750);else{for(const e of m)e.viewId=u;c=!0,d.system.debug("logger.service.registered"),f=t.data,"routerService"!==y?(p=h,C(f,!0)):C(f,!1),M("system","Debug",["Logger Registered"]),I()}}),r.RouterClient.addListener(w,(e,t)=>{d.system.debug("logger.client.setLogState",t.data),f=t.data,C(f,!1)})}I=a(I,"routerService"===y?100:250,{leading:!1}),this.error=function(){const e=Array.prototype.slice.call(arguments);e.push(S()),b.dev.Error&&!b.dev.LocalOnly&&M("dev","Error",e),e.unshift(`dev error (${window.performance.now()}):`),O(_,e)},this.warn=function(){if(b.dev.Warn){const e=Array.prototype.slice.call(arguments);e.push(S()),b.dev.Warn&&!b.dev.LocalOnly&&M("dev","Warn",e),b.dev.Warn&&b.dev.LocalOnly&&(e.unshift(`dev warn (${window.performance.now()}):`),O(T,e))}},this.info=function(){if(b.dev.Info){const e=Array.prototype.slice.call(arguments);0,b.dev.Info&&!b.dev.LocalOnly&&M("dev","Info",e),b.dev.Info&&b.dev.LocalOnly&&(e.unshift(`dev info (${window.performance.now()}):`),O(A,e))}},this.log=function(){if(b.dev.Log){const e=Array.prototype.slice.call(arguments);0,b.dev.Log&&!b.dev.LocalOnly&&M("dev","Log",e),b.dev.Log&&b.dev.LocalOnly&&(e.unshift(`dev log (${window.performance.now()}):`),O(E,e))}},this.debug=function(){if(b.dev.Debug){const e=Array.prototype.slice.call(arguments);0,b.dev.Debug&&!b.dev.LocalOnly&&M("dev","Debug",e),b.dev.Debug&&b.dev.LocalOnly&&(e.unshift(`dev debug (${window.performance.now()}):`),O(L,e))}},this.verbose=function(){if(b.dev.Verbose){const e=Array.prototype.slice.call(arguments);0,b.dev.Verbose&&!b.dev.LocalOnly&&M("dev","Verbose",e),b.dev.Verbose&&b.dev.LocalOnly&&(e.unshift(`dev verbose (${window.performance.now()}):`),O(L,e))}},this.system={},this.system.error=function(){const e=Array.prototype.slice.call(arguments);e.push(S()),b.system.Error&&!b.system.LocalOnly&&M("system","Error",e),e.unshift(`system error (${window.performance.now()}):`),O(_,e)},this.system.warn=function(){if(b.system.Warn){const e=Array.prototype.slice.call(arguments);e.push(S()),b.system.Warn&&!b.system.LocalOnly&&M("system","Warn",e),b.system.Warn&&b.system.LocalOnly&&(e.unshift(`system warn (${window.performance.now()}):`),O(T,e))}},this.system.info=function(){if(b.system.Info){const e=Array.prototype.slice.call(arguments);0,b.system.Info&&!b.system.LocalOnly&&M("system","Info",e),b.system.Info&&b.system.LocalOnly&&(e.unshift(`system info (${window.performance.now()}):`),O(A,e))}},this.system.log=function(){if(b.system.Log){const e=Array.prototype.slice.call(arguments);0,b.system.Log&&!b.system.LocalOnly&&M("system","Log",e),b.system.Log&&b.system.LocalOnly&&(e.unshift(`system log (${window.performance.now()}):`),O(E,e))}},this.system.debug=function(){if(b.system.Debug){const e=Array.prototype.slice.call(arguments);0,b.system.Debug&&!b.system.LocalOnly&&M("system","Debug",e),b.system.Debug&&b.system.LocalOnly&&(e.unshift(`system debug (${window.performance.now()}):`),O(L,e))}},this.system.verbose=function(){if(b.system.Verbose){var e=Array.prototype.slice.call(arguments);0,b.system.Verbose&&!b.system.LocalOnly&&M("system","Verbose",e),b.system.Verbose&&b.system.LocalOnly&&((e=Array.prototype.slice.call(arguments)).unshift(`system log (${window.performance.now()}):`),O(L,e))}},this.perf={},this.perf.error=function(){const e=Array.prototype.slice.call(arguments);e.push(S()),b.perf.Error&&!b.perf.LocalOnly&&M("perf","Error",e),e.unshift(`perf error (${window.performance.now()}):`),O(_,e)},this.perf.warn=function(){if(b.perf.Warn){const e=Array.prototype.slice.call(arguments);e.push(S()),b.perf.Warn&&!b.perf.LocalOnly&&M("perf","Warn",e),b.perf.Warn&&b.perf.LocalOnly&&(e.unshift(`perf warn (${window.performance.now()}):`),O(T,e))}},this.perf.info=function(){if(b.perf.Info){const e=Array.prototype.slice.call(arguments);0,b.perf.Info&&!b.perf.LocalOnly&&M("perf","Info",e),b.perf.Info&&b.perf.LocalOnly&&(e.unshift(`perf info (${window.performance.now()}):`),O(A,e))}},this.perf.log=function(){if(b.perf.Log){const e=Array.prototype.slice.call(arguments);0,b.perf.Log&&!b.perf.LocalOnly&&M("perf","Log",e),b.perf.Log&&b.perf.LocalOnly&&(e.unshift(`perf log (${window.performance.now()}):`),O(E,e))}},this.perf.debug=function(){if(b.perf.Debug){const e=Array.prototype.slice.call(arguments);0,b.perf.Debug&&!b.perf.LocalOnly&&M("perf","Debug",e),b.perf.Debug&&b.perf.LocalOnly&&(e.unshift(`perf debug (${window.performance.now()}):`),O(L,e))}},this.perf.verbose=function(){if(b.perf.Verbose){const e=Array.prototype.slice.call(arguments);0,b.perf.Verbose&&!b.perf.LocalOnly&&M("perf","Verbose",e),b.perf.Verbose&&b.perf.LocalOnly&&(e.unshift(`perf verbose (${window.performance.now()}):`),O(L,e))}},this.unregisterClient=function(e=null,t=Function.prototype){d.system.debug("logger.service.unregister",y,e,u),I();const n=e||{clientName:y,viewId:u};r.RouterClient.query("logger.service.unregister",n,t)},this.isLogMessage=function(e){return"logger.service.logMessages"===e},this.status="offline",this.setRouterClient=e=>{this.RouterClient=e},this.start=function(){let e;function t(){r.status="online",d.system.debug("Logger onReady",y),r.RouterClient.calibrateTimeWithRouterService(e=>{h=e,l||(r.startupTime=performance.now()-r.startupTime,D(),l=!0)})}this.startupTime=performance.now(),r.RouterClient||(console.log("No instance of the RouterClient found for this instance of the Logger. Dynamically requiring it."),r.RouterClient=n(8).default);const o=()=>{e=r.RouterClient.subscribe("Finsemble.Service.State.loggerService",(n,i)=>{"ready"===i.data.state&&(t(),r.RouterClient.unsubscribe(e))})};"routerService"===window.name?r.RouterClient.query("logger.service.register",{},e=>{e?setTimeout(o,750):o()}):r.RouterClient.onReady(o),i.System.isBrowserView()&&window.addEventListener("beforeunload",()=>{r.unregisterClient()})}},t.Logger="undefined"!=typeof window?new t.LoggerConstructor:new r.LocalLogger,t.default=t.Logger},function(e,t,n){"use strict";(function(e,i){n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l}));var r,o=n(0),s="function"==typeof e&&e,a="object"==typeof i&&"function"==typeof i.nextTick;function u(e){setTimeout(e,0)}function l(e){return Object(o.a)((function(t,n){e((function(){t.apply(null,n)}))}))}r=s?e:a?i.nextTick:u,t.a=l(r)}).call(this,n(31).setImmediate,n(19))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.System=void 0;const n="undefined"!=typeof window?window:e;class i{constructor(e,t,n){return new fin.desktop.Window(e,t)}static get getCurrent(){return fin.desktop.Window.getCurrent}static get wrap(){return fin.desktop.Window.wrap}}class r{constructor(e,t,n){return new fin.desktop.Application(e,t)}static get getCurrent(){return fin.desktop.Application.getCurrent}static get wrap(){return fin.desktop.Application.wrap}}class o{constructor(e){new fin.desktop.Notification(e)}}class s{constructor(){return new fin.desktop.System.Clipboard}static get writeText(){return fin.desktop.System.Clipboard.writeText}static get writeHTML(){return fin.desktop.System.Clipboard.writeHTML}static get writeRTF(){return fin.desktop.System.Clipboard.writeRTF}static get readText(){return fin.desktop.System.Clipboard.readText}static get readHTML(){return fin.desktop.System.Clipboard.readHTML}static get readRTF(){return fin.desktop.System.Clipboard.readRTF}}t.System=class{static get Application(){return r}static get Window(){return i}static get Notification(){return o}static get Clipboard(){return s}static async getMousePosition(e=Function.prototype){return new Promise((t,n)=>{fin.desktop.System.getMousePosition(n=>{(n.left||0===n.left)&&(n.x=n.left),(n.top||0===n.top)&&(n.y=n.top),e(null,n),t(n)},t=>{e(t,null),n(t)})})}static getMonitorInfo(e=Function.prototype){return new Promise(t=>{fin.desktop.System.getMonitorInfo(n=>{t(n),e(n)})})}static get container(){return fin.container?fin.container:"Electron"}static get isBrowserView(){return e2o.isBrowserView}static get getViewId(){return e2o.getViewId}static get hasBrowserView(){return e2o.hasBrowserView}static get fin(){return e2o||fin||{}}static get ready(){return fin.desktop.main}static getHostSpecs(e=Function.prototype){return new Promise(t=>{fin.desktop.System.getHostSpecs(n=>{t(n),e(n)})})}static get InterApplicationBus(){return fin.desktop.InterApplicationBus}static get launchExternalProcess(){return fin.desktop.System.launchExternalProcess}static get terminateExternalProcess(){return fin.desktop.System.terminateExternalProcess}static get getAllApplications(){return fin.desktop.System.getAllApplications}static get exit(){return fin.desktop.System.exit}static get clearCache(){return fin.desktop.System.clearCache}static get showDeveloperTools(){return fin.desktop.System.showDeveloperTools}static get getRuntimeInfo(){return fin.desktop.System.getRuntimeInfo||chrome.desktop.getDetails}static get addEventListener(){return fin.desktop.System.addEventListener}static get addSelectClientCertificateListener(){return fin.desktop.System.addSelectClientCertificateListener}static get addCertificateErrorListener(){return fin.desktop.System.addCertificateErrorListener}static get getVersion(){return fin.desktop.System.getVersion}static get getUpdateAvailable(){return fin.desktop.System.getUpdateAvailable}static get openUrlWithBrowser(){return fin.desktop.System.openUrlWithBrowser}static get getAllWindows(){return fin.desktop.System.getAllWindows}static get getProcessList(){return fin.desktop.System.getProcessList}static get getProtocolString(){return fin.desktop.System.getProtocolString}static get hideSplashScreen(){return fin.desktop.System.hideSplashScreen}static FinsembleReady(e){return n.FSBL&&n.FSBL.addEventListener?n.FSBL.addEventListener("onready",e):window.addEventListener("FSBLready",e)}static startupApplicationHandshake(){fin.desktop.System.startupApplicationHandshake&&fin.desktop.System.startupApplicationHandshake()}static closeApplication(e,t=Function.prototype){return new Promise(n=>{let i,r=!1;const o=()=>{r||(console.log("Attempting to terminate",e.uuid),e.terminate(()=>{t(),n()},()=>{r||(r=!0,clearInterval(i),console.log("force closing ",e.uuid),e.terminate())}))};i=setInterval(o,2e3),console.log("closing ",e.uuid),e.close(!1,()=>{console.log("app.close: successfully closed",e.uuid),r=!0,clearInterval(i),t(),n()},o)})}static isElectron(){return"Electron"===fin.container}}}).call(this,n(19))},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._BaseClient=void 0;
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const r=i(n(8)),o=i(n(6)),s=i(n(1)),a=n(3),u=i(n(41)),l=n(32);class c extends u.default{constructor(e){super({name:e.name,sourceType:e.name.replace("Client","")}),this.status="offline",this.startupTime=0,this.initialized=!1,this.startupDependencies={services:[],clients:[]},this.finsembleWindow=null,this.windowName="",this.clientReadyQueue=[],this.processClientReadyQueue=()=>{for(const e of this.clientReadyQueue)e();this.clientReadyQueue=[]},this.onReady=e=>{this.clientReadyQueue.push(e),"online"===this.status&&this.processClientReadyQueue()},this.setClientOnline=()=>{this.status="online";const e=`STARTUP:CLIENT ONLINE:${this.finWindow.name}:${this.name}`;this.startupTime=window.performance.now()-this.startupTime;const t=()=>{this.logger.system.debug(e),this.processClientReadyQueue(),l.FSBLDependencyManagerSingleton.setClientOnline(this.name)};this._onReady?this._onReady(t):t()},this.initialize=(e=Function.prototype)=>{this.initialized||(this.initialized=!0,this.startupTime=performance.now(),this.routerClient.onReady(()=>{this.finWindow=a.System.Window.getCurrent(),this.windowName=this.finWindow.name,this.logger.system.debug("Baseclient Init Router Ready",this.name),l.FSBLDependencyManagerSingleton.startup.waitFor(this.startupDependencies,()=>{e(),this.setClientOnline()})}))},this.onClose=e=>{this.cleanup(),e&&e()},this.name=e.name,this._onReady=e.onReady,this.startupDependencies=e.startupDependencies||{services:[],clients:[]},this.logger=s.default,this.routerClient=r.default}addEventListener(e,t){super.addEventListener(e,t)}}t._BaseClient=c;t.default=function(e){o.default.args(e,"object=");const t=this;let n,i="offline";this.startupTime=0,e&&(e.onReady&&({onReady:n}=e),this.name=e.name),this.initialized=!1,this.startupDependencies=e.startupDependencies||{services:[],clients:[]},this.routerClient=r.default,this.finWindow=null,this.finsembleWindow=null,this.windowName="",this.requiredServices=[],this.requiredClients=[],this.clientReadyQueue=[],this.processClientReadyQueue=function(){for(let e=0;e<this.clientReadyQueue.length;e++){const t=this.clientReadyQueue[e];"function"==typeof t&&t()}this.clientReadyQueue=[]},this.onReady=function(e){this.clientReadyQueue.push(e),"online"===i&&this.processClientReadyQueue()},this.setClientOnline=function(){i="online";const e=`STARTUP:CLIENT ONLINE:${t.finWindow.name}:${t.name}`;t.startupTime=performance.now()-t.startupTime,n?n(()=>{s.default.system.debug(e),t.processClientReadyQueue(),l.FSBLDependencyManagerSingleton.setClientOnline(t.name)}):(s.default.system.debug(e),t.processClientReadyQueue(),l.FSBLDependencyManagerSingleton.setClientOnline(t.name))},this.initialize=function(e=Function.prototype){t.initialized||(t.initialized=!0,t.setClientOnline=t.setClientOnline.bind(t),t.startupTime=performance.now(),t.routerClient.onReady(()=>{t.finWindow=a.System.Window.getCurrent(),t.windowName=t.finWindow.name,s.default.system.debug("Baseclient Init Router Ready",t.name),l.FSBLDependencyManagerSingleton.startup.waitFor({clients:t.startupDependencies.clients||[]},()=>{e(),t.setClientOnline()})}))},this.onClose=function(){}}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(63));
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var o=new function(){function e(e,t,n){const i=function(){try{throw Error("")}catch(e){return e}}(),r=i.stack.split("\n")[5],o=r.indexOf("at "),s=r.slice(o+2,r.length),a=i.stack.split("\n")[6],u=a.indexOf("at "),l=a.slice(u+2,a.length);console.warn(`parameter validation failed: parameter ${e} is of type '${typeof t}' but should be of type '${n}' in${s} called by${l}`)}this.args=function(){let t=!0;if(r.default.validationEnabled()){const n=arguments.length;if((n+1)%2!=0)for(let i=0;i<n;i+=2){let n=!1;const r=arguments[i];let o=arguments[i+1];if("="===o.slice(-1)&&(o=o.slice(0,-1),n=!0),typeof r!==o&&!(n&&void 0===r||void 0!==r&&"any"===o)){e(i/2+1,r,o),t=!1;break}}else console.warn("validate.args requires even number of parameters: "+JSON.stringify(arguments))}return t},this.args2=function(){let t=!0;if(r.default.validationEnabled()){const n=arguments.length;if((n+1)%3!=0)for(let i=0;i<n;i+=3){let n=!1;const r=arguments[i],o=arguments[i+1];let s=arguments[i+2];if("="===s.slice(-1)&&(s=s.slice(0,-1),n=!0),typeof o!==s&&!(n&&void 0===o||void 0!==o&&"any"===s)){e(r,o,s),t=!1;break}}else console.warn("validate.args requires even number of parameters: "+JSON.stringify(arguments))}return t}};t.default=o,e.exports=t.default},function(e,t,n){"use strict";t.a=function(e){return e}},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0});const i=n(49),r=n(1),o=new(0,i.RouterClientConstructor)({clientName:"RouterClient"});r.Logger.setRouterClient(o),t.default=o},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.clone=l,t.getContainerVersion=function(e=Function.prototype){return new Promise(t=>{o.System.getVersion(n=>{const i=n.split(".").map(Number),r={major:i[0],chromium:i[1],minor:i[2],patch:i[3]};e(r),t({versionObject:r})})})},t.castToPromise=function(e){return function(){return new Promise((t,n)=>{const i=e.apply(null,Array.from(arguments));try{return i.then(t,n)}catch(e){e instanceof TypeError?t(i):n(e)}})}},t.isPercentage=function(e){if("string"!=typeof e)return!1;return-1!==e.indexOf("%")},t.crossDomain=function(e){const t=document.createElement("a");t.href=e;const n=window.location.hostname===t.hostname,i=window.location.protocol===t.protocol,r=void 0!==window.location.port?window.location.port:80,o=void 0!==t.port?t.port:80,s=r===o,u=!(n&&s&&i);return a.default.system.debug(`Launcher crossDomain=${u} (${n}:${i}:${s})`),u},t.getMonitorFromWindow=f,t.getFinWindow=h,t.getWindowDescriptor=p,t.findMonitor=g,t.getWhichMonitor=m,t.getMonitor=y,t.getMonitorFromCommand=function(e,t,n){return new Promise(i=>{y(t,t=>{u.getAllMonitors(r=>{m({commandMonitor:e,monitors:r,launchingMonitorPosition:t.position},e=>{n&&n(e),i(e)})})})})},t.windowOnMonitor=function(e,t){if(e.left>=t.left&&e.left<t.right||e.right<=t.right&&e.right>t.left)return!0;return!1},t.getMonitorByDescriptor=function(e,t){return new Promise(n=>{f(e,e=>{t&&t(e),n(e)})})},t.getMyWindowIdentifier=function(e){const t=o.System.Window.getCurrent();return new Promise(n=>{t.getOptions(i=>{let r=null;const{customData:o}=i;o&&o.component&&(r=o.component.type);const s={windowName:t.name,uuid:t.uuid,componentType:r};e&&e(s),n(s)})})},t.camelCase=function(){let e="";for(let t=0;t<arguments.length;t++)e=`${e} ${arguments[t]}`;return e.replace(/\s(.)/g,e=>e.toUpperCase()).replace(/\s/g,"").replace(/^(.)/,e=>e.toLowerCase())},t.guuid=function(){return(0,r.default)()},t.injectJS=function(e,t){const n=document.createElement("script");n.onload=t,n.type="text/javascript",n.async=!0,n.src=e;const i=document.getElementsByTagName("head")[0],r=i.getElementsByTagName("script")[0];i.insertBefore(n,r)},t.openSharedData=function(e,t){const n=FSBL.Clients.LauncherClient,i=FSBL.Clients.LinkerClient;e.multipleOpenerHandler||(e.multipleOpenerHandler=function(e){let t,n=0;for(const i of Object.keys(e))e[i].length>n&&(t=i,n=e[i].length);return[t]});const r=[],o={};n.getComponentsThatCanReceiveDataTypes({dataTypes:Object.keys(e.data)},(s,u)=>{for(const e of Object.keys(u))if(u[e].componentTypes.length)for(const t of u[e].componentTypes)o[t]?o[t].push(e):o[t]=[e];else{const t="No Components Available to Handle the type: "+e;r.push(t),a.default.system.error(t)}let l=Object.keys(o);if(l.length){l.length>1&&(l=e.multipleOpenerHandler(o));const s=Object.keys(i.channels);if(s.length){if(i.getLinkedComponents({componentTypes:l,windowIdentifier:i.windowIdentifier()}).length||e.publishOnly)i.publish({dataType:"Finsemble.DragAndDropClient",data:e.data}),t&&t(r.length?r:null,"Data published");else{for(const t of l)n.spawn(t,{data:{sharedData:e.data,linker:{channels:s}},addToWorkspace:!0});t&&t(r.length?r:null,"Linked Window(s) spawned with data")}}else if(!e.publishOnly){for(const t of l)n.spawn(t,{data:{sharedData:e.data},addToWorkspace:!0});t&&t(r.length?r:null,"New Window(s) spawned with data")}}else t&&t(r.length?r:null,null)})},t.getNewBoundsWhenMovedToMonitor=function(e,t,n="availableRect"){const i=e[n]||e.availableRect||e.monitorRect,r=l(t);t.top<i.top?r.top=i.top:t.top>i.bottom-t.height&&(r.top=i.bottom-t.height);t.left<i.left?r.left=i.left:t.left>i.right-t.width&&(r.left=i.right-t.width);r.bottom=r.top+r.height,r.right=r.left+r.width,r.right>i.right&&(r.right=i.right);r.top<i.top&&(r.top=i.top);r.left<i.left&&(r.left=i.left);r.bottom>i.bottom&&(r.bottom=i.bottom);r.height=r.bottom-r.top,r.width=r.right-r.left;const o=Math.sqrt((t.left-r.left)**2+(t.top-r.top)**2);return{newBounds:r,distanceMoved:o,monitor:e}},t.isOnAMonitor=function(e){return this.Monitors.allMonitors.some(t=>{const{monitorRect:n}=t;return e.left>=n.left&&e.left<=n.right&&e.right>=n.left&&e.right<=n.right&&e.top>=n.top&&e.top<=n.bottom&&e.bottom>=n.top&&e.bottom<=n.bottom})},t.adjustBoundsToBeOnMonitor=function(e,t="availableRect"){if(this.isOnAMonitor(e))return a.default.system.info("Launcher.adjustWindowDescriptorBoundsToBeOnMonitor: on monitor."),e;const n=this.Monitors.allMonitors.map(n=>{let i=n.rawMonitor?n.rawMonitor:n;return this.getNewBoundsWhenMovedToMonitor(i,e,t)}).sort((e,t)=>e.distanceMoved-t.distanceMoved)[0];return a.default.system.info("Launcher.adjustWindowDescriptorBoundsToBeOnMonitor: not on monitor.  bounds",e,"monitor name",n.monitor.name,"newBounds",n.newBounds),n.newBounds},t.isWindows=async function(e=Function.prototype){const t=(await o.System.getHostSpecs()).name.toUpperCase().includes("WINDOWS");return e(t),t},t.getWindowType=function(e){if(e.windowType&&!["assimilation","assimilated","native","application","NativeWindow","FinsembleNativeWindow","CompoundWindow","WebWindow","WebApplication","StackedWindow"].includes(e.windowType))return a.default.system.error(`Invalid windowType: ${e.windowType}, defaulting to windowType: WebWindow`),"WebWindow";let t=e.windowType||"WebWindow";switch(e.windowType){case"assimilation":case"assimilated":t="NativeWindow";break;case"native":t="FinsembleNativeWindow";break;case"application":t="WebApplication";break;case"Web":t="WebWindow";break;case"StackedWindow":t="StackedWindow"}e.native&&(t="NativeWindow");e.compound&&(t="CompoundWindow");return t},t.getMonitorFromXY=t.getAllMonitors=t.Monitors=void 0;var r=i(n(33)),o=n(3),s=i(n(51)),a=i(n(1));
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const u=new s.default(Function.prototype,Function.prototype,{System:o.System});function l(e,t){if(null===e||"object"!=typeof e)return e;if(e.constructor==Date||e.constructor==RegExp||e.constructor==Function||e.constructor==String||e.constructor==Number||e.constructor==Boolean)return new e.constructor(e);t=t||new e.constructor;for(const n in e)t[n]=void 0===t[n]?l(e[n],null):t[n];return t}t.Monitors=u;var{getAllMonitors:c}=u;t.getAllMonitors=c;var d=u.getMonitorFromScaledXY;function f(e,t){const n=Number.isFinite(e.x)?e.x:e.defaultLeft,i=Number.isFinite(e.y)?e.y:e.defaultTop,r=n+e.defaultWidth,o=i+e.defaultHeight;return new Promise((e,s)=>{u.getMonitorFromScaledXY(n,i,c=>{if(!c)return a.default.system.debug("getMonitorFromWindow - top-left is off screen, trying bottom right"),void u.getMonitorFromScaledXY(r,o,r=>{if(!r)return a.default.system.debug("getMonitorFromWindow - bottom-right is off screen, getting primary"),void u.getAllMonitors(n=>{n[0]?(t&&t(n[0]),e(n[0])):(s(new Error("Cannot find monitor for window.")),t&&t(null))});r=l(r);const{monitorRect:o}=r;(o.left<n||o.right<i)&&(r.straddling=!0),t&&t(r),e(r)});c=l(c);const{monitorRect:d}=c;(d.right>r||d.bottom>o)&&(c.straddling=!0),t&&t(c),e(c)})})}function h(e,t){return new Promise((n,i)=>{const r=o.System.Window.getCurrent();r.getOptions(s=>{if(e&&e.windowName){e.uuid||(e.uuid=s.uuid);const r=o.System.Window.wrap(e.uuid,e.windowName);r.getInfo(()=>{t&&t(r),n(r)},()=>{t&&t(null),i(`Window ${e.windowName} not found. UUID: ${e.uuid}`),console.debug(`util.getFinWindow: Window ${e.windowName} not found`)})}else if(e&&e.componentType)if(void 0!==window.LauncherService){const r=window.LauncherService.componentFinder(e);r?(n(r),t&&t(r)):(i(`util.getFinWindow: Component ${e.componentType} not found.`),t&&t(null))}else i("getFinWindow by componentType is currently only operable within LaunchService"),t&&t(null);else t&&t(r),n(r)})})}function p(e,t){return new Promise((n,i)=>{h(e).then(e=>{e.getOptions(e=>{t&&t(e),n(e)})}).catch(e=>{console.warn(e),t&&t(null),i(e)})})}function g(e,t,n){for(let i=0;i<e.length;i++){const r=e[i];if(r[t]===n)return r}return null}function m(e,t){let n;arguments.length>2&&(e={commandMonitor:arguments[0],monitors:arguments[1],launchingMonitorPosition:arguments[2]},t=null);let{commandMonitor:i,monitors:r,launchingMonitorPosition:o}=e;const s=i&&""!==i||0===i;if("primary"===i)n=g(r,"whichMonitor","primary");else if("next"===i){let e=o+1;e>=r.length&&(e=0),n=r[e]}else if("previous"===i){let e=o-1;e<0&&(e=r.length-1),n=r[e]}else if("mine"===i){var a=!0;activeWindows.getWindow(e.windowIdentifier.windowName)._getBounds((e,i)=>{e?(n=r[0],t(n)):u.getMonitorFromScaledXY(i.left,i.top,e=>{t(e)})})}else s?(i>=r.length&&(i=r.length-1),n=r.filter(e=>e.position===i)[0]):o&&(n=r[o]);if(n||(n=r[0]),!a){if(!t)return n;t(n)}}function y(e,t){return new Promise((n,i)=>{p(e,e=>{e?f(e,e=>{t&&t(e),n(e)}):i("util.getMonitor: Can't locate windowDescriptor.")})})}t.getMonitorFromXY=d},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigUtilInstance=void 0;var r=i(n(9)),o=i(n(1)),s=n(3);
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const a=new function(){const e=this;this.resolveConfigVariables=function(e,t){let n=0,i=0,r=!0;function s(e){const t=e.split(/[/\\:?=&\s]/);for(let n=0;n<t.length;n++)if("$"===t[n][0]){const i=t[n].substring(1);let s=a(i);if(void 0!==s){const a=e.replace(t[n],s);o.default.system.verbose("forceObjectsToLogger","ConfigUtil.resolveConfigVariables:resolveString configString",t[n],i,s,"old value=",e,"value=",a),r=!0,e=a}}return e}function a(t){let n=e[t];return void 0===n&&(e.custom?(n=e.custom[t],void 0===n&&o.default.system.warn("ConfigUtil.resolveString",`Missing [${t}] variable from finsemble.custom configuration object`)):o.default.system.error("ConfigUtil.resolveString",'Missing "custom" node from finsemble configuration - unable to get variable resoution for variable: '+t)),n}function u(e,t,n){e=e||{},o.default.system.verbose("forceObjectsToLogger","ConfigUtil.resolveConfigVariables:resolveObject","pass",t,"recursionLevel",n,"configObject:",e),Object.keys(e).forEach(i=>{const r=e[i];"string"==typeof r&&r.indexOf("$")>-1?e[i]=s(r):r instanceof Array?function e(t,n,i){o.default.system.verbose("forceObjectsToLogger","resolveArray","pass",n,"recursionLevel",i,"configArray:",t);for(let r=0;r<t.length;r++){const o=t[r];"string"==typeof o&&o.indexOf("$")>-1?t[r]=s(o):o instanceof Array?e(o,n,i+1):"object"==typeof o&&u(o,n,i+1)}}(r,t,n+1):"object"==typeof r&&u(r,t,n+1)})}for(;r&&i++<100;)r=!1,u(t,++n,1);i>=100&&o.default.system.error("forceObjectsToLogger","resolveConfigVariables exceeded maximum passes so continuing -- probably a recursive macro definitions.  Look in this config for unresolved macro variables",e)},this.getExpandedRawManifest=function(t,n){o.default.system.debug("ConfigUtil.getExpandedRawManifest starting"),s.System.ready(()=>{const i=s.System.Application.getCurrent();!function t(i,r,a){o.default.system.debug("forceObjectsToLogger","ConfigUtil.getExpandedRawManifest:getRawManifest",r,a),r.getManifest(t=>{o.default.system.debug("forceObjectsToLogger","ConfigUtil.getExpandedRawManifest:getExpandedRawManifest: manifest retrieved. Pre-variable resolution",t),e.resolveConfigVariables(t.finsemble,t.finsemble),o.default.system.debug("forceObjectsToLogger","ConfigUtil.getExpandedRawManifest:getExpandedRawManifest:Complete. post-variable resolution",t),i(t)},e=>{e&&(o.default.system.error("ConfigUtil.getExpandedRawManifest:application.getManifest:err",e),n&&n()),r.getParentUuid(e=>{const n=s.System.Application.wrap(e);o.default.system.debug("forceObjectsToLogger","uuid",e,"parentApplication",n),a<10?t(i,n,++a):i("could not find manifest in parent applications")})})}(t,i,1)})},this.readConfigFile=function(e,t){o.default.system.debug("fetching "+e),fetch(e,{credentials:"include",cache:"no-cache"}).then(e=>e.json()).catch(n=>{t(`Failure importing ${e}: ${n}`,null)}).then(e=>{t(null,e)})},this.getInitialManifest=function(t){s.System.ready(()=>{s.System.Application.getCurrent().getManifest(n=>{n.finsemble=n.finsemble||{},e.resolveConfigVariables(n.finsemble,n.finsemble),n.finsemble.applicationRoot||o.default.system.error("FATAL ERROR: applicationRoot was not defined in manifest file.");const i=n.finsemble.moduleRoot+"/configs/core/config.json";e.readConfigFile(i,(r,s)=>{r?o.default.system.error(`ConfigUtil.getInitialManifest:getCoreConfig:failed importing into finsemble config. $moduleRoot=${n.finsemble.moduleRoot}; Full Path=${i}`,r):(Object.keys(s).forEach(e=>{if("importConfig"===e){n.finsemble.importConfig=n.finsemble.importConfig||[];for(let e=0;e<s.importConfig.length;e++)n.finsemble.importConfig.unshift(s.importConfig[e])}else if("importThirdPartyConfig"===e){n.finsemble.importThirdPartyConfig=n.finsemble.importThirdPartyConfig||[];for(let e=0;e<s.importThirdPartyConfig.length;e++)n.finsemble.importThirdPartyConfig.unshift(s.importThirdPartyConfig[e])}else n.finsemble[e]=s[e]}),e.resolveConfigVariables(n.finsemble,n.finsemble),o.default.system.debug("forceObjectsToLogger","ConfigUtil.getInitialManifest:getCoreConfig:Initial Manifest after variables Resolved",n)),t(n)})})})},this.promptAndSaveJSONToLocalFile=function(e,t){o.default.system.debug("saveJSONToLocalFile",e,t);const n=JSON.stringify(t,null,"\t"),i="data:application/json;charset=utf-8,"+encodeURIComponent(n),r=e+".json",s=document.createElement("a");s.setAttribute("href",i),s.setAttribute("download",r),s.click()},this.configFormatForExport=function(e,t){o.default.system.debug("configFormatForExport starting",e,t);let n=r.default.clone(t);if("raw"===e);else if("all"===e)delete n.importConfig,delete n.comment;else if("application"===e)delete n.importConfig,delete n.comment,delete n.system,delete n.services;else if("workspace"===e)n={workspace:n};else if("workspaceTemplate"===e){const e={};e[n.name]=n,n={workspaceTemplates:e}}else"services"===e?n=n.services:"components"===e&&(n=n.components);return n},this.getDefault=function(e,t,n){let i=n;if(e){try{const n=t.split(".");let r=e;for(let e=1;e<n.length;e++)r=r[n[e]];i=r}catch(e){i=n}void 0===i&&(i=n)}return i},this.getFile=async function(e,t=Function.prototype){o.default.system.debug("fetching import "+e);let n=null;return await fetch(e,{credentials:"include",cache:"no-cache"}).then(e=>e.json()).catch(n=>{t(`failure importing ${e}: ${n}`,null)}).then(e=>{t(null,e),n=e}),n}};t.ConfigUtilInstance=a},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkDeprecatedConfigs=t.isEqualIgnoringArrayOrder=t.sleep=t.checkIfBoundsAreEqual=t.removeKeys=t.toRecord=t.isStackedWindow=t.wrapWithTimeout=t.timeoutPromise=t.getRandomWindowName=t.getUniqueName=t.getProp=t.composeRL=t.instrumentPromise=t.promisify=t.identity=t.isNumber=t.chunkArray=t.Timeout=t.mockLogger=t.capitalizeFirst=t.clone=t.isServiceInWindow=t.iAmAServiceWindow=t.guuid=void 0;const r=n(37),o=i(n(38)),s=i(n(61)),a=i(n(26)),u=i(n(62)),l=n(11),c=i(n(1)),d=window;function f(e,t){if(Array.isArray(e))return e.slice();try{return JSON.parse(JSON.stringify(e))}catch(e){return t("clone error",e),e}}t.guuid=function(){return r.v1()},t.iAmAServiceWindow=function(){return!(!d.finsembleServices||!d.finsembleServices.length)},t.isServiceInWindow=function(e){return d.finsembleServices&&d.finsembleServices.find(t=>t.name===e)},t.clone=f,t.capitalizeFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};t.mockLogger=new class{constructor({debug:e}={debug:!0}){e?(this.system=console,this.system.debug=console.log):this.system={warn:Function.prototype,debug:Function.prototype,log:Function.prototype,info:Function.prototype,error:console.error}}isLogMessage(){return!0}start(){}};function h(e="RouterClient"){return`${e}-${Math.floor(100*Math.random())}-${Math.floor(1e4*Math.random())}`}function p(e,t){return new Promise((n,i)=>{const r=setTimeout(()=>{clearTimeout(r),i(t)},e)})}function g(e,t,n){return`${e}.${t}.${n}`}function m(e,t,n){const i=""+g(e.baseString,e.newPath,e.newValue);c.default.system.warn(`${g(e.baseString,t,n)} has been deprecated in favor of ${i}`)}t.Timeout=class{constructor(e,t){this.fired=!1,this.id=setTimeout(()=>{e(),this.fired=!0},t),this.clear=this.clear.bind(this),this.didFire=this.didFire.bind(this)}clear(){this.fired||clearTimeout(this.id)}didFire(){return this.fired}},t.chunkArray=function(e,t){if(e<=0)throw new Error("Can't chunk array by number less than 0");return t.reduce((n,i,r)=>{if(r%e==0){const i=[];for(let n=r;n<r+e;n++)n<t.length&&i.push(t[n]);n.push(i)}return n},[])},t.isNumber=function(e){return!(!e||Number.isNaN(Number(e)))&&Number(e)},t.identity=function(e){return e},t.promisify=function(e,t){return function(){const n=Array.prototype.slice.call(arguments);return new Promise((i,r)=>{n.push((e,t)=>e?r(e):i(t)),e.apply(t,n)})}},t.instrumentPromise=async(e,t,n)=>{const i=t+" end";return e(t+" start"),n.then(()=>e(i))},t.composeRL=(...e)=>e.reduce((e,t)=>(...n)=>e(t(...n))),t.getProp=function e(t,n,i){const r=Array.isArray(n)?n:n.split(".").filter(e=>e.length);return r.length?e(t[r.shift()],r,i):void 0===t?i:t},t.getUniqueName=h,t.getRandomWindowName=function(e,t){return`${h(e)}-${t}`},t.timeoutPromise=p,t.wrapWithTimeout=function(e,t,n){return Promise.race([e,p(t,n)])},t.isStackedWindow=function(e){return e&&"StackedWindow"===(o.default(e,"windowIdentifier.windowType")||e.windowType)},t.toRecord=function(e,t){const n="string"==typeof e?t=>t[e]:e;return t.reduce((e,t)=>(e[n(t)]=t,e),{})},t.removeKeys=function(e,t){if(!e)return e;const n=Object.keys(e).filter(e=>!t.includes(e));return s.default(e,n)},t.checkIfBoundsAreEqual=function(e,t){if(!e||!t)return!1;const n=["left","right","top","bottom","width","height"],i=s.default(e,n),r=s.default(t,n);return!!a.default(i,r)},t.sleep=function(e,t=!1){return new Promise((n,i)=>{t?setTimeout(()=>{try{i("timeout expired")}catch(e){}},e):setTimeout(n,e)})},t.isEqualIgnoringArrayOrder=function(e,t){const n=f(e,Function.prototype),i=f(t,Function.prototype);return u.default(n,i,(e,t)=>{if(Array.isArray(e)&&Array.isArray(t))return u.default(e.sort(),t.sort())})},t.checkDeprecatedConfigs=function(e,t,n){const{baseString:i,oldPath:r,newPath:o,oldValue:s,newValue:a}=t;let u=l.ConfigUtilInstance.getDefault(e,g(i,o,a),null);return null===u&&(u=l.ConfigUtilInstance.getDefault(e,g(i,o,s),null),u?m(t,o,s):(u=l.ConfigUtilInstance.getDefault(e,g(i,r,a),null),u?m(t,r,a):(u=l.ConfigUtilInstance.getDefault(e,g(i,r,s),null),u?m(t,r,s):u=n))),u}},function(e,t,n){"use strict";n.r(t),n.d(t,"applyEach",(function(){return se})),n.d(t,"applyEachSeries",(function(){return ce})),n.d(t,"apply",(function(){return de})),n.d(t,"asyncify",(function(){return fe})),n.d(t,"auto",(function(){return ve})),n.d(t,"autoInject",(function(){return Je})),n.d(t,"cargo",(function(){return it})),n.d(t,"compose",(function(){return at})),n.d(t,"concat",(function(){return lt})),n.d(t,"concatSeries",(function(){return dt})),n.d(t,"constant",(function(){return ft})),n.d(t,"detect",(function(){return mt})),n.d(t,"detectLimit",(function(){return yt})),n.d(t,"detectSeries",(function(){return wt})),n.d(t,"dir",(function(){return vt})),n.d(t,"doDuring",(function(){return Ct})),n.d(t,"doUntil",(function(){return _t})),n.d(t,"doWhilst",(function(){return St})),n.d(t,"during",(function(){return Tt})),n.d(t,"each",(function(){return Et})),n.d(t,"eachLimit",(function(){return Lt})),n.d(t,"eachOf",(function(){return ne})),n.d(t,"eachOfLimit",(function(){return J})),n.d(t,"eachOfSeries",(function(){return rt})),n.d(t,"eachSeries",(function(){return Ot})),n.d(t,"ensureAsync",(function(){return It})),n.d(t,"every",(function(){return Dt})),n.d(t,"everyLimit",(function(){return kt})),n.d(t,"everySeries",(function(){return Wt})),n.d(t,"filter",(function(){return Ft})),n.d(t,"filterLimit",(function(){return xt})),n.d(t,"filterSeries",(function(){return Bt})),n.d(t,"forever",(function(){return Ut})),n.d(t,"log",(function(){return zt})),n.d(t,"map",(function(){return oe})),n.d(t,"mapLimit",(function(){return ue})),n.d(t,"mapSeries",(function(){return le})),n.d(t,"mapValues",(function(){return Vt})),n.d(t,"mapValuesLimit",(function(){return Ht})),n.d(t,"mapValuesSeries",(function(){return qt})),n.d(t,"memoize",(function(){return Gt})),n.d(t,"nextTick",(function(){return Yt.a})),n.d(t,"parallel",(function(){return Kt})),n.d(t,"parallelLimit",(function(){return Zt})),n.d(t,"priorityQueue",(function(){return en})),n.d(t,"queue",(function(){return Xt})),n.d(t,"race",(function(){return tn})),n.d(t,"reduce",(function(){return ot})),n.d(t,"reduceRight",(function(){return rn})),n.d(t,"reflect",(function(){return on})),n.d(t,"reflectAll",(function(){return un})),n.d(t,"reject",(function(){return an})),n.d(t,"rejectLimit",(function(){return ln})),n.d(t,"rejectSeries",(function(){return cn})),n.d(t,"retry",(function(){return fn})),n.d(t,"retryable",(function(){return hn})),n.d(t,"seq",(function(){return st})),n.d(t,"series",(function(){return pn})),n.d(t,"setImmediate",(function(){return Jt})),n.d(t,"some",(function(){return gn})),n.d(t,"someLimit",(function(){return mn})),n.d(t,"someSeries",(function(){return yn})),n.d(t,"sortBy",(function(){return wn})),n.d(t,"timeout",(function(){return bn})),n.d(t,"times",(function(){return Tn})),n.d(t,"timesLimit",(function(){return _n})),n.d(t,"timesSeries",(function(){return An})),n.d(t,"transform",(function(){return En})),n.d(t,"unmemoize",(function(){return Ln})),n.d(t,"until",(function(){return In})),n.d(t,"waterfall",(function(){return Mn})),n.d(t,"whilst",(function(){return On})),n.d(t,"all",(function(){return Dt})),n.d(t,"allLimit",(function(){return kt})),n.d(t,"allSeries",(function(){return Wt})),n.d(t,"any",(function(){return gn})),n.d(t,"anyLimit",(function(){return mn})),n.d(t,"anySeries",(function(){return yn})),n.d(t,"find",(function(){return mt})),n.d(t,"findLimit",(function(){return yt})),n.d(t,"findSeries",(function(){return wt})),n.d(t,"forEach",(function(){return Et})),n.d(t,"forEachSeries",(function(){return Ot})),n.d(t,"forEachLimit",(function(){return Lt})),n.d(t,"forEachOf",(function(){return ne})),n.d(t,"forEachOfSeries",(function(){return rt})),n.d(t,"forEachOfLimit",(function(){return J})),n.d(t,"inject",(function(){return ot})),n.d(t,"foldl",(function(){return ot})),n.d(t,"foldr",(function(){return rn})),n.d(t,"select",(function(){return Ft})),n.d(t,"selectLimit",(function(){return xt})),n.d(t,"selectSeries",(function(){return Bt})),n.d(t,"wrapSync",(function(){return fe}));var i=n(0),r=function(e){return Object(i.a)((function(t){var n=t.pop();e.call(this,t,n)}))};function o(e){return Object(i.a)((function(t,n){var i=r((function(n,i){var r=this;return e(t,(function(e,t){e.apply(r,n.concat(t))}),i)}));return n.length?i.apply(this,n):i}))}var s=n(23).a.Symbol,a=Object.prototype,u=a.hasOwnProperty,l=a.toString,c=s?s.toStringTag:void 0;var d=function(e){var t=u.call(e,c),n=e[c];try{e[c]=void 0;var i=!0}catch(e){}var r=l.call(e);return i&&(t?e[c]=n:delete e[c]),r},f=Object.prototype.toString;var h=function(e){return f.call(e)},p=s?s.toStringTag:void 0;var g=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":p&&p in Object(e)?d(e):h(e)};var m=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var y=function(e){if(!m(e))return!1;var t=g(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var w=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var b=function(e){return null!=e&&w(e.length)&&!y(e)},v={};var C=function(){};function S(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var _="function"==typeof Symbol&&Symbol.iterator;var T=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i};var A=function(e){return null!=e&&"object"==typeof e};var E=function(e){return A(e)&&"[object Arguments]"==g(e)},L=Object.prototype,O=L.hasOwnProperty,I=L.propertyIsEnumerable,M=E(function(){return arguments}())?E:function(e){return A(e)&&O.call(e,"callee")&&!I.call(e,"callee")},D=Array.isArray,k=n(44),W=/^(?:0|[1-9]\d*)$/;var j=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&W.test(e))&&e>-1&&e%1==0&&e<t},N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N["[object Arguments]"]=N["[object Array]"]=N["[object ArrayBuffer]"]=N["[object Boolean]"]=N["[object DataView]"]=N["[object Date]"]=N["[object Error]"]=N["[object Function]"]=N["[object Map]"]=N["[object Number]"]=N["[object Object]"]=N["[object RegExp]"]=N["[object Set]"]=N["[object String]"]=N["[object WeakMap]"]=!1;var R=function(e){return A(e)&&w(e.length)&&!!N[g(e)]};var P=function(e){return function(t){return e(t)}},F=n(29),x=F.a&&F.a.isTypedArray,B=x?P(x):R,U=Object.prototype.hasOwnProperty;var z=function(e,t){var n=D(e),i=!n&&M(e),r=!n&&!i&&Object(k.a)(e),o=!n&&!i&&!r&&B(e),s=n||i||r||o,a=s?T(e.length,String):[],u=a.length;for(var l in e)!t&&!U.call(e,l)||s&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||j(l,u))||a.push(l);return a},H=Object.prototype;var V=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||H)};var q=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),$=Object.prototype.hasOwnProperty;var G=function(e){if(!V(e))return q(e);var t=[];for(var n in Object(e))$.call(e,n)&&"constructor"!=n&&t.push(n);return t};var Y=function(e){return b(e)?z(e):G(e)};function Q(e){if(b(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,n,i,r,o=function(e){return _&&e[_]&&e[_]()}(e);return o?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(o):(n=Y(t=e),i=-1,r=n.length,function(){var e=n[++i];return i<r?{value:t[e],key:e}:null})}function K(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function Z(e){return function(t,n,i){if(i=S(i||C),e<=0||!t)return i(null);var r=Q(t),o=!1,s=0;function a(e,t){if(s-=1,e)o=!0,i(e);else{if(t===v||o&&s<=0)return o=!0,i(null);u()}}function u(){for(;s<e&&!o;){var t=r();if(null===t)return o=!0,void(s<=0&&i(null));s+=1,n(t.value,t.key,K(a))}}u()}}function J(e,t,n,i){Z(t)(e,n,i)}function X(e,t){return function(n,i,r){return e(n,t,i,r)}}function ee(e,t,n){n=S(n||C);var i=0,r=0,o=e.length;function s(e,t){e?n(e):++r!==o&&t!==v||n(null)}for(0===o&&n(null);i<o;i++)t(e[i],i,K(s))}var te=X(J,1/0),ne=function(e,t,n){(b(e)?ee:te)(e,t,n)};function ie(e){return function(t,n,i){return e(ne,t,n,i)}}function re(e,t,n,i){i=i||C;var r=[],o=0;e(t=t||[],(function(e,t,i){var s=o++;n(e,(function(e,t){r[s]=t,i(e)}))}),(function(e){i(e,r)}))}var oe=ie(re),se=o(oe);function ae(e){return function(t,n,i,r){return e(Z(n),t,i,r)}}var ue=ae(re),le=X(ue,1),ce=o(le),de=Object(i.a)((function(e,t){return Object(i.a)((function(n){return e.apply(null,t.concat(n))}))}));function fe(e){return r((function(t,n){var i;try{i=e.apply(this,t)}catch(e){return n(e)}m(i)&&"function"==typeof i.then?i.then((function(e){n(null,e)}),(function(e){n(e.message?e:new Error(e))})):n(null,i)}))}var he=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e};var pe=function(e){return function(t,n,i){for(var r=-1,o=Object(t),s=i(t),a=s.length;a--;){var u=s[e?a:++r];if(!1===n(o[u],u,o))break}return t}}();var ge=function(e,t){return e&&pe(e,t,Y)};var me=function(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1};var ye=function(e){return e!=e};var we=function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1};var be=function(e,t,n){return t==t?we(e,t,n):me(e,ye,n)},ve=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=S(n||C);var r=Y(e).length;if(!r)return n(null);t||(t=r);var o={},s=0,a=!1,u=Object.create(null),l=[],c=[],d={};function f(e,t){l.push((function(){!function(e,t){if(a)return;var r=K(Object(i.a)((function(t,i){if(s--,i.length<=1&&(i=i[0]),t){var r={};ge(o,(function(e,t){r[t]=e})),r[e]=i,a=!0,u=Object.create(null),n(t,r)}else o[e]=i,l=u[e]||[],he(l,(function(e){e()})),h();var l})));s++;var l=t[t.length-1];t.length>1?l(o,r):l(r)}(e,t)}))}function h(){if(0===l.length&&0===s)return n(null,o);for(;l.length&&s<t;){l.shift()()}}function p(t){var n=[];return ge(e,(function(e,i){D(e)&&be(e,t,0)>=0&&n.push(i)})),n}ge(e,(function(t,n){if(!D(t))return f(n,[t]),void c.push(n);var i=t.slice(0,t.length-1),r=i.length;if(0===r)return f(n,t),void c.push(n);d[n]=r,he(i,(function(o){if(!e[o])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+o+"` in "+i.join(", "));!function(e,t){var n=u[e];n||(n=u[e]=[]);n.push(t)}(o,(function(){0===--r&&f(n,t)}))}))})),function(){var e,t=0;for(;c.length;)e=c.pop(),t++,he(p(e),(function(e){0==--d[e]&&c.push(e)}));if(t!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),h()};var Ce=function(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r};var Se=function(e){return"symbol"==typeof e||A(e)&&"[object Symbol]"==g(e)},_e=s?s.prototype:void 0,Te=_e?_e.toString:void 0;var Ae=function e(t){if("string"==typeof t)return t;if(D(t))return Ce(t,e)+"";if(Se(t))return Te?Te.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var Ee=function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(r);++i<r;)o[i]=e[i+t];return o};var Le=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:Ee(e,t,n)};var Oe=function(e,t){for(var n=e.length;n--&&be(t,e[n],0)>-1;);return n};var Ie=function(e,t){for(var n=-1,i=e.length;++n<i&&be(t,e[n],0)>-1;);return n};var Me=function(e){return e.split("")},De=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var ke=function(e){return De.test(e)},We="[\\ud800-\\udfff]",je="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ne="\\ud83c[\\udffb-\\udfff]",Re="[^\\ud800-\\udfff]",Pe="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="(?:"+je+"|"+Ne+")"+"?",Be="[\\ufe0e\\ufe0f]?"+xe+("(?:\\u200d(?:"+[Re,Pe,Fe].join("|")+")[\\ufe0e\\ufe0f]?"+xe+")*"),Ue="(?:"+[Re+je+"?",je,Pe,Fe,We].join("|")+")",ze=RegExp(Ne+"(?="+Ne+")|"+Ue+Be,"g");var He=function(e){return e.match(ze)||[]};var Ve=function(e){return ke(e)?He(e):Me(e)};var qe=function(e){return null==e?"":Ae(e)},$e=/^\s+|\s+$/g;var Ge=function(e,t,n){if((e=qe(e))&&(n||void 0===t))return e.replace($e,"");if(!e||!(t=Ae(t)))return e;var i=Ve(e),r=Ve(t),o=Ie(i,r),s=Oe(i,r)+1;return Le(i,o,s).join("")},Ye=/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Qe=/,/,Ke=/(=.+)?(\s*)$/,Ze=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function Je(e,t){var n={};ge(e,(function(e,t){var i,r;if(D(e))i=e.slice(0,-1),e=e[e.length-1],n[t]=i.concat(i.length>0?o:e);else if(1===e.length)n[t]=e;else{if(i=r=(r=(r=(r=(r=e).toString().replace(Ze,"")).match(Ye)[2].replace(" ",""))?r.split(Qe):[]).map((function(e){return Ge(e.replace(Ke,""))})),0===e.length&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");i.pop(),n[t]=i.concat(o)}function o(t,n){var r=Ce(i,(function(e){return t[e]}));r.push(n),e.apply(null,r)}})),ve(n,t)}var Xe=n(2);function et(){this.head=this.tail=null,this.length=0}function tt(e,t){e.length=1,e.head=e.tail=t}function nt(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function r(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,D(e)||(e=[e]),0===e.length&&l.idle())return Object(Xe.a)((function(){l.drain()}));for(var i=0,r=e.length;i<r;i++){var o={data:e[i],callback:n||C};t?l._tasks.unshift(o):l._tasks.push(o)}Object(Xe.a)(l.process)}function o(e){return Object(i.a)((function(t){s-=1;for(var n=0,i=e.length;n<i;n++){var r=e[n],o=be(a,r,0);o>=0&&a.splice(o),r.callback.apply(r,t),null!=t[0]&&l.error(t[0],r.data)}s<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}))}var s=0,a=[],u=!1,l={_tasks:new et,concurrency:t,payload:n,saturated:C,unsaturated:C,buffer:t/4,empty:C,drain:C,error:C,started:!1,paused:!1,push:function(e,t){r(e,!1,t)},kill:function(){l.drain=C,l._tasks.empty()},unshift:function(e,t){r(e,!0,t)},process:function(){if(!u){for(u=!0;!l.paused&&s<l.concurrency&&l._tasks.length;){var t=[],n=[],i=l._tasks.length;l.payload&&(i=Math.min(i,l.payload));for(var r=0;r<i;r++){var c=l._tasks.shift();t.push(c),n.push(c.data)}0===l._tasks.length&&l.empty(),s+=1,a.push(t[0]),s===l.concurrency&&l.saturated();var d=K(o(t));e(n,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return s},workersList:function(){return a},idle:function(){return l._tasks.length+s===0},pause:function(){l.paused=!0},resume:function(){!1!==l.paused&&(l.paused=!1,Object(Xe.a)(l.process))}};return l}function it(e,t){return nt(e,1,t)}et.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},et.prototype.empty=et,et.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},et.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},et.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):tt(this,e)},et.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):tt(this,e)},et.prototype.shift=function(){return this.head&&this.removeLink(this.head)},et.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var rt=X(J,1);function ot(e,t,n,i){i=S(i||C),rt(e,(function(e,i,r){n(t,e,(function(e,n){t=n,r(e)}))}),(function(e){i(e,t)}))}var st=Object(i.a)((function(e){return Object(i.a)((function(t){var n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=C,ot(e,t,(function(e,t,r){t.apply(n,e.concat(Object(i.a)((function(e,t){r(e,t)}))))}),(function(e,t){r.apply(n,[e].concat(t))}))}))})),at=Object(i.a)((function(e){return st.apply(null,e.reverse())}));function ut(e,t,n,i){var r=[];e(t,(function(e,t,i){n(e,(function(e,t){r=r.concat(t||[]),i(e)}))}),(function(e){i(e,r)}))}var lt=ie(ut);var ct,dt=(ct=ut,function(e,t,n){return ct(rt,e,t,n)}),ft=Object(i.a)((function(e){var t=[null].concat(e);return r((function(e,n){return n.apply(this,t)}))})),ht=n(7);function pt(e,t){return function(n,i,r,o){o=o||C;var s,a=!1;n(i,(function(n,i,o){r(n,(function(i,r){i?o(i):e(r)&&!s?(a=!0,s=t(!0,n),o(null,v)):o()}))}),(function(e){e?o(e):o(null,a?s:t(!1))}))}}function gt(e,t){return t}var mt=ie(pt(ht.a,gt)),yt=ae(pt(ht.a,gt)),wt=X(yt,1);function bt(e){return Object(i.a)((function(t,n){t.apply(null,n.concat(Object(i.a)((function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&he(n,(function(t){console[e](t)})))}))))}))}var vt=bt("dir");function Ct(e,t,n){n=K(n||C);var r=Object(i.a)((function(e,i){if(e)return n(e);i.push(o),t.apply(this,i)}));function o(t,i){return t?n(t):i?void e(r):n(null)}o(null,!0)}function St(e,t,n){n=K(n||C);var r=Object(i.a)((function(i,o){return i?n(i):t.apply(this,o)?e(r):void n.apply(null,[null].concat(o))}));e(r)}function _t(e,t,n){St(e,(function(){return!t.apply(this,arguments)}),n)}function Tt(e,t,n){function i(t){if(t)return n(t);e(r)}function r(e,r){return e?n(e):r?void t(i):n(null)}n=K(n||C),e(r)}function At(e){return function(t,n,i){return e(t,i)}}function Et(e,t,n){ne(e,At(t),n)}function Lt(e,t,n,i){Z(t)(e,At(n),i)}var Ot=X(Lt,1);function It(e){return r((function(t,n){var i=!0;t.push((function(){var e=arguments;i?Object(Xe.a)((function(){n.apply(null,e)})):n.apply(null,e)})),e.apply(this,t),i=!1}))}function Mt(e){return!e}var Dt=ie(pt(Mt,Mt)),kt=ae(pt(Mt,Mt)),Wt=X(kt,1);var jt=function(e){return function(t){return null==t?void 0:t[e]}};function Nt(e,t,n,i){var r=new Array(t.length);e(t,(function(e,t,i){n(e,(function(e,n){r[t]=!!n,i(e)}))}),(function(e){if(e)return i(e);for(var n=[],o=0;o<t.length;o++)r[o]&&n.push(t[o]);i(null,n)}))}function Rt(e,t,n,i){var r=[];e(t,(function(e,t,i){n(e,(function(n,o){n?i(n):(o&&r.push({index:t,value:e}),i())}))}),(function(e){e?i(e):i(null,Ce(r.sort((function(e,t){return e.index-t.index})),jt("value")))}))}function Pt(e,t,n,i){(b(t)?Nt:Rt)(e,t,n,i||C)}var Ft=ie(Pt),xt=ae(Pt),Bt=X(xt,1);function Ut(e,t){var n=K(t||C),i=It(e);!function e(t){if(t)return n(t);i(e)}()}var zt=bt("log");function Ht(e,t,n,i){i=S(i||C);var r={};J(e,t,(function(e,t,i){n(e,t,(function(e,n){if(e)return i(e);r[t]=n,i()}))}),(function(e){i(e,r)}))}var Vt=X(Ht,1/0),qt=X(Ht,1);function $t(e,t){return t in e}function Gt(e,t){var n=Object.create(null),o=Object.create(null);t=t||ht.a;var s=r((function(r,s){var a=t.apply(null,r);$t(n,a)?Object(Xe.a)((function(){s.apply(null,n[a])})):$t(o,a)?o[a].push(s):(o[a]=[s],e.apply(null,r.concat(Object(i.a)((function(e){n[a]=e;var t=o[a];delete o[a];for(var i=0,r=t.length;i<r;i++)t[i].apply(null,e)})))))}));return s.memo=n,s.unmemoized=e,s}var Yt=n(28);function Qt(e,t,n){n=n||C;var r=b(t)?[]:{};e(t,(function(e,t,n){e(Object(i.a)((function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)})))}),(function(e){n(e,r)}))}function Kt(e,t){Qt(ne,e,t)}function Zt(e,t,n){Qt(Z(t),e,n)}var Jt=Xe.a,Xt=function(e,t){return nt((function(t,n){e(t[0],n)}),t,1)},en=function(e,t){var n=Xt(e,t);return n.push=function(e,t,i){if(null==i&&(i=C),"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,D(e)||(e=[e]),0===e.length)return Jt((function(){n.drain()}));t=t||0;for(var r=n._tasks.head;r&&t>=r.priority;)r=r.next;for(var o=0,s=e.length;o<s;o++){var a={data:e[o],priority:t,callback:i};r?n._tasks.insertBefore(r,a):n._tasks.push(a)}Jt(n.process)},delete n.unshift,n};function tn(e,t){if(t=S(t||C),!D(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,i=e.length;n<i;n++)e[n](t)}var nn=Array.prototype.slice;function rn(e,t,n,i){ot(nn.call(e).reverse(),t,n,i)}function on(e){return r((function(t,n){return t.push(Object(i.a)((function(e,t){if(e)n(null,{error:e});else{var i=null;1===t.length?i=t[0]:t.length>1&&(i=t),n(null,{value:i})}}))),e.apply(this,t)}))}function sn(e,t,n,i){Pt(e,t,(function(e,t){n(e,(function(e,n){t(e,!n)}))}),i)}var an=ie(sn);function un(e){var t;return D(e)?t=Ce(e,on):(t={},ge(e,(function(e,n){t[n]=on.call(this,e)}))),t}var ln=ae(sn),cn=X(ln,1);var dn=function(e){return function(){return e}};function fn(e,t,n){var i=5,r=0,o={times:i,intervalFunc:dn(r)};function s(e,t){if("object"==typeof t)e.times=+t.times||i,e.intervalFunc="function"==typeof t.interval?t.interval:dn(+t.interval||r),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||i}}if(arguments.length<3&&"function"==typeof e?(n=t||C,t=e):(s(o,e),n=n||C),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var a=1;function u(){t((function(e){e&&a++<o.times&&("function"!=typeof o.errorFilter||o.errorFilter(e))?setTimeout(u,o.intervalFunc(a)):n.apply(null,arguments)}))}u()}var hn=function(e,t){return t||(t=e,e=null),r((function(n,i){function r(e){t.apply(null,n.concat(e))}e?fn(e,r,i):fn(r,i)}))};function pn(e,t){Qt(rt,e,t)}var gn=ie(pt(Boolean,ht.a)),mn=ae(pt(Boolean,ht.a)),yn=X(mn,1);function wn(e,t,n){function i(e,t){var n=e.criteria,i=t.criteria;return n<i?-1:n>i?1:0}oe(e,(function(e,n){t(e,(function(t,i){if(t)return n(t);n(null,{value:e,criteria:i})}))}),(function(e,t){if(e)return n(e);n(null,Ce(t.sort(i),jt("value")))}))}function bn(e,t,n){var i,o,s=!1;function a(){s||(i.apply(null,arguments),clearTimeout(o))}function u(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),s=!0,i(r)}return r((function(n,r){i=r,o=setTimeout(u,t),e.apply(null,n.concat(a))}))}var vn=Math.ceil,Cn=Math.max;var Sn=function(e,t,n,i){for(var r=-1,o=Cn(vn((t-e)/(n||1)),0),s=Array(o);o--;)s[i?o:++r]=e,e+=n;return s};function _n(e,t,n,i){ue(Sn(0,e,1),t,n,i)}var Tn=X(_n,1/0),An=X(_n,1);function En(e,t,n,i){3===arguments.length&&(i=n,n=t,t=D(e)?[]:{}),i=S(i||C),ne(e,(function(e,i,r){n(t,e,i,r)}),(function(e){i(e,t)}))}function Ln(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function On(e,t,n){if(n=K(n||C),!e())return n(null);var r=Object(i.a)((function(i,o){return i?n(i):e()?t(r):void n.apply(null,[null].concat(o))}));t(r)}function In(e,t,n){On((function(){return!e.apply(this,arguments)}),t,n)}var Mn=function(e,t){if(t=S(t||C),!D(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;!function r(o){if(n===e.length)return t.apply(null,[null].concat(o));var s=K(Object(i.a)((function(e,n){if(e)return t.apply(null,[e].concat(n));r(n)})));o.push(s),e[n++].apply(null,o)}([])};t.default={applyEach:se,applyEachSeries:ce,apply:de,asyncify:fe,auto:ve,autoInject:Je,cargo:it,compose:at,concat:lt,concatSeries:dt,constant:ft,detect:mt,detectLimit:yt,detectSeries:wt,dir:vt,doDuring:Ct,doUntil:_t,doWhilst:St,during:Tt,each:Et,eachLimit:Lt,eachOf:ne,eachOfLimit:J,eachOfSeries:rt,eachSeries:Ot,ensureAsync:It,every:Dt,everyLimit:kt,everySeries:Wt,filter:Ft,filterLimit:xt,filterSeries:Bt,forever:Ut,log:zt,map:oe,mapLimit:ue,mapSeries:le,mapValues:Vt,mapValuesLimit:Ht,mapValuesSeries:qt,memoize:Gt,nextTick:Yt.a,parallel:Kt,parallelLimit:Zt,priorityQueue:en,queue:Xt,race:tn,reduce:ot,reduceRight:rn,reflect:on,reflectAll:un,reject:an,rejectLimit:ln,rejectSeries:cn,retry:fn,retryable:hn,seq:st,series:pn,setImmediate:Jt,some:gn,someLimit:mn,someSeries:yn,sortBy:wn,timeout:bn,times:Tn,timesLimit:_n,timesSeries:An,transform:En,unmemoize:Ln,until:In,waterfall:Mn,whilst:On,all:Dt,any:gn,forEach:Et,forEachSeries:Ot,forEachLimit:Lt,forEachOf:ne,forEachOfSeries:rt,forEachOfLimit:J,inject:ot,foldl:ot,foldr:rn,select:Ft,selectLimit:xt,selectSeries:Bt,wrapSync:fe}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MOVE_REASON=t.LAUNCHER_SERVICE=t.HEARTBEAT_TIMEOUT_CHANNEL=t.COMPONENT_STATE_STORAGE_TOPIC=t.WINDOW_SERVICE_REQUESTS=t.WORKSPACE=t.WINDOW=t.INTERRUPTIBLE_EVENTS=t.EVENT_INTERRUPT_CHANNEL=t.DOCKING=t.SERVICE_STOP_CHANNEL=t.SERVICE_START_CHANNEL=t.WINDOWSTATE=t.SERVICES_STATE_CHANNEL=t.CLIENT_SERVER_MAPPING=t.SERVICE_QUERY_READY_CHANNEL=t.SERVICE_CLOSED_CHANNEL=t.SERVICE_CLOSING_CHANNEL=t.SERVICE_READY_CHANNEL=t.SERVICE_INITIALIZING_CHANNEL=t.APPLICATION_STATE_CHANNEL=t.WRAPPERS=void 0,t.WRAPPERS={EVENTS:["title-changed","bringToFront","setBounds","alwaysOnTop","setOpacity"]},t.APPLICATION_STATE_CHANNEL="Finsemble.Application.State",t.SERVICE_INITIALIZING_CHANNEL="Finsemble.ServiceManager.serviceInitializing",t.SERVICE_READY_CHANNEL="Finsemble.ServiceManager.serviceReady",t.SERVICE_CLOSING_CHANNEL="Finsemble.ServiceManager.serviceClosing",t.SERVICE_CLOSED_CHANNEL="Finsemble.ServiceManager.serviceClosed",t.SERVICE_QUERY_READY_CHANNEL=e=>"Finsemble.ServiceManager.queryReady."+e,t.CLIENT_SERVER_MAPPING=e=>({authenticationClient:"authenticationService",configClient:"configService",distributedStoreClient:"dataStoreService",hotkeysClient:"hotkeysService",linkerClient:"linkerService",logger:"loggerService",searchClient:"searchService",storageClient:"storageService",windowClient:"windowService",workspaceClient:"workspaceService"}[e]),t.SERVICES_STATE_CHANNEL="Finsemble.State.Services",function(e){e[e.NORMAL=0]="NORMAL",e[e.MINIMIZED_WAS_NORMAL=1]="MINIMIZED_WAS_NORMAL",e[e.MAXIMIZED=2]="MAXIMIZED",e[e.MINIMIZED_WAS_MAXIMIZED=3]="MINIMIZED_WAS_MAXIMIZED",e[e.TRANSITIONING=4]="TRANSITIONING"}(t.WINDOWSTATE||(t.WINDOWSTATE={})),t.SERVICE_START_CHANNEL="Finsemble.Service.Start",t.SERVICE_STOP_CHANNEL="Finsemble.Service.Stop",t.DOCKING={GROUP_UPDATE:"DockingService.groupUpdate",WORKSPACE_GROUP_UPDATE:"Finsemble.WorkspaceService.groupUpdate",REQUEST_PUBLISH:"DockingService.requestGroupDataPublish"},t.EVENT_INTERRUPT_CHANNEL="Finsemble.Event.Interrupt",t.INTERRUPTIBLE_EVENTS=["close-requested","closed","close-complete","_container-close-handlers"],t.WINDOW={DELAYABLE_EVENTS:["close-requested","closed","close-complete","_container-close-handlers"],CANCELABLE_EVENTS:["close-requested"]},t.WORKSPACE={DELAYABLE_EVENTS:["load-requested","close-requested","save-requested"],CANCELABLE_EVENTS:["close-requested"],CLEAN_SHUTDOWN:"Finsemble.Workspace.cleanShutdown",UPDATE_PUBSUB:"Finsemble.WorkspaceService.update",STORAGE_TOPIC:"finsemble.workspace",CACHE_STORAGE_TOPIC:"finsemble.workspace.cache",ALL_WORKSPACES:"finsemble.allWorkspaces",ACTIVE_WORKSPACE:"activeWorkspace",LAST_USED_WORKSPACE_TOPIC:"finsemble",LAST_USED_WORKSPACE_NAME:"finsemble.lastUsedWorkspace.name",LAST_USED_WORKSPACE:"finsemble.lastUsedWorkspace",INITIAL_WORKSPACE_PREFERENCE:"finsemble.initialWorkspace",PUBLISH_REASONS:{INIT:"workspace:initialization",LOAD_DATA_RETRIEVED:"workspace:load:dataRetrieved",LOAD_FINISHED:"workspace:load:finished",WINDOW_REMOVED:"window:remove",WINDOW_ADDED:"window:add",LOAD_STARTED:"workspace:load:start",WORKSPACE_REMOVED:"Workspace:remove",WORKSPACE_RENAMED:"rename",SWITCHTO_TERMINATED:"workspace:switchTo:terminated",NEW_WORKSPACE:"new workspace",SAVE_AS:"APPLICATION LIFECYCLE:WORKSPACE LIFECYCLE:SaveAs:Workspace:Save As"},API_CHANNELS:{NEW_WORKSPACE:"Finsemble.Workspace.NewWorkspace",SAVE:"Finsemble.Workspace.Save",RENAME:"Finsemble.Workspace.Rename",SAVE_AS:"Finsemble.Workspace.SaveAs",SWITCH_TO:"Finsemble.Workspace.SwitchTo",IMPORT:"Finsemble.Workspace.Import",EXPORT:"Finsemble.Workspace.Export",REMOVE:"Finsemble.Workspace.Remove",SAVE_GLOBAL_DATA:"Finsemble.Workspace.SaveGlobalData",SAVE_VIEW_DATA:"Finsemble.Workspace.SaveViewData",GET_GLOBAL_DATA:"Finsemble.Workspace.GetGlobalData",GET_VIEW_DATA:"Finsemble.Workspace.GetViewData",GET_WORKSPACES:"Finsemble.Workspace.GetWorkspaces",GET_WORKSPACE_NAMES:"Finsemble.Workspace.GetWorkspaceNames",SET_WORKSPACE_ORDER:"Finsemble.Workspace.SetWorkspaceOrder",GET_ACTIVE_WORKSPACE:"Finsemble.Workspace.GetActiveWorkspace",GET_ACTIVE_WORKSPACE_DIRTY:"Finsemble.Workspace.GetActiveWorkspaceDirty",GET_TEMPLATES:"Finsemble.Workspace.GetTemplates",IMPORT_TEMPLATE:"Finsemble.Workspace.ImportTemplate",EXPORT_TEMPLATE:"Finsemble.Workspace.ExportTemplate",REMOVE_TEMPLATE:"Finsemble.Workspace.RemoveTemplate",SET_WINDOW_STATE:"Finsemble.Workspace.SetWindowData",GET_WINDOW_STATE:"Finsemble.Workspace.GetWindowData",ADD_WINDOW:"WorkspaceService.addWindow",REMOVE_WINDOW:"WorkspaceService.removeWindow"},DEFAULT_WINDOW_PROPS:["name","componentType","windowType","alwaysOnTop","autoShow","minWidth","minHeight","maxWidth","maxHeight","resizable","maximizable","minimizable","opacity","windowState","left","top","width","height","right","bottom","defaultLeft","defaultTop","defaultWidth","defaultHeight","defaultRight","defaultBottom","monitorInfo","icon","cachedBounds","showTaskbarIcon","isEvergreen","compositeComponentData"],ADDITIONAL_WINDOW_PROPS:{WebWindow:["url","fullscreen","frame","backgroundColor","transparent","waitForPageLoad","affinity","appUUID"],NativeWindow:["path","alias","arguments","argumentsAsQueryString","isWPF"],StackedWindow:["childWindowIdentifiers","visibleWindowIdentifier","bounds"]}},t.WINDOW_SERVICE_REQUESTS={REMOTE_FOCUS:"WindowService.remoteFocus",SET_ALWAYS_ON_TOP:"WindowService-Request-setAlwaysOnTop",IS_ALWAYS_ON_TOP:"WindowService-Request-isAlwaysOnTop"},t.COMPONENT_STATE_STORAGE_TOPIC="finsemble.componentStateStorage",t.HEARTBEAT_TIMEOUT_CHANNEL="Finsemble.WindowService.HeartbeatTimeout",t.LAUNCHER_SERVICE={WINDOW_CLOSED:"LauncherService.WindowClosed"},t.MOVE_REASON={AERO_KEY:"aero_key",SYSTEM_RESTORED:"system_restored"}},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FinsembleWindow=void 0;const a=s(n(8)),u=s(n(1)),l=s(n(17)),c=s(n(27)),d=o(n(9)),f=s(n(41)),h=o(n(14)),p=n(12),g=n(3),m=n(71),y=n(72);l.default.initialize(),c.default.initialize(),window._FSBLCache||(window._FSBLCache={storeClientReady:!1,windows:{},gettingWindow:[],windowAttempts:{}});let w=(()=>{class e extends f.default{constructor(t){super({name:t.name,sourceType:"Window"}),this.types={},this.wrapState=t.wrapState||"initializing",this.componentState={},this.windowState=e.WINDOWSTATE.NORMAL,this.type=null,this.windowType=null,this.bounds={},this.guid=`${Date.now()}_${Math.random()}`,this.WINDOWSTATE=h.WINDOWSTATE,this.windowOptions={},this.doConstruction(t),this.TITLE_CHANGED_CHANNEL=`Finsemble.${this.name}.titleChanged`,this.componentKey=d.camelCase("activeWorkspace",this.name,this.name),this.windowKey=d.camelCase("activeWorkspace",this.name),e.bindFunctions(this)}standardizeEventName(e){switch(e){case"bounds-set":case"stoppedMoving":return"bounds-change-end";case"startedMoving":return"bounds-change-start";case"bringToFront":return"broughtToFront";case"setParent":return"parent-set";case"clearParent":return"parent-unset";default:return e}}addEventListener(e,t){return e=this.standardizeEventName(e),super.addEventListener(e,t)}removeEventListener(e,t){if("closed"!==e||!window.finsembleWindow||this.name!==finsembleWindow.name)return e=this.standardizeEventName(e),super.removeEventListener(e,t)}windowServiceChannelName(e){return"WindowService-Request-"+e}eventChannelName(e){return`WindowService-Event-${this.name||this.windowName}-${e}`}doConstruction(t){if(t.setWindowType||t.windowType||(t.windowType="WebWindow"),t.windowType){t.setWindowType=t.windowType,delete t.windowType;return new e(t)}if(t)for(const e in t)this[e]=t[e];this.name||(this.name=t.windowName),this.windowType=this.setWindowType}static registerType(t,n){const i=e;i.types||(i.types={}),i.types[t]=n}static bindFunctions(e){e.setParent=e.setParent.bind(e),e.getParent=e.getParent.bind(e),e.eventChannelName=e.eventChannelName.bind(e),e.windowServiceChannelName=e.windowServiceChannelName.bind(e),e.handleWrapRemoveRequest=e.handleWrapRemoveRequest.bind(e)}static getInstance(t,n=Function.prototype){const i=g.System.Window.getCurrent().name;if(t&&t.windowName&&(t.name=t.windowName),!(t=m(t))||!t.name)return n("name is required");return t.windowName=t.name,new Promise((async function(r,o){if(window._FSBLCache.windows[t.name]){u.default.system.debug("WRAP LIFECYCLE:",t.name,"Window found in the cache, returning without going to the Launcher");const e=window._FSBLCache.windows[t.name];return r({wrap:e}),n(null,e)}if(t.uuid&&t.name){if(t.windowIdentifier||(t.windowIdentifier={uuid:t.uuid,name:t.name,windowName:t.name,windowType:t.windowType}),!1!==t.waitForReady)try{await e._windowReady(t.windowName),t.wrapState="ready"}catch(e){return o(e),n(e,null)}if(u.default.system.debug("WRAP LIFECYCLE:",t.name,"All information for wrap passed in, creating wrap locally"),window._FSBLCache.windows[t.name]){u.default.system.debug("WRAP LIFECYCLE:",t.name,"Window found in the cache, returning without going to the Launcher");const e=window._FSBLCache.windows[t.name];return r({wrap:e}),n(null,e)}const{wrap:i}=await e._createWrap(t);return r({wrap:i}),n(null,i)}if(!1!==t.waitForReady)try{await e._windowReady(t.windowName),t.wrapState="ready"}catch(e){return o(e),n(e,null)}a.default.query("WindowService-Request-getWindowIdentifier",{windowName:t.name,requester:i},async(i,s)=>{if(i)return u.default.system.error(i),o(i),n(i,null);if(window._FSBLCache.windows[t.name]){const e=window._FSBLCache.windows[t.name];return u.default.system.debug("WRAP LIFECYCLE:",t.name,"Information received from launcher, but wrap exists in cache. Returning cached wrap."),r({wrap:e}),n(null,e)}const{identifier:a}=s.data;a.windowName&&(a.name=a.windowName),u.default.system.debug("WRAP LIFECYCLE:",t.name,"Information received from launcher. Creating wrap."),t.retrievedIdentifier=a;const{wrap:l}=await e._createWrap(t);s.data.descriptor&&(l.descriptor=s.data.descriptor),r({wrap:l}),n(null,l)})}))}static _createWrap(t){return new Promise((function(n){const i=t.retrievedIdentifier||t.windowIdentifier;let r=null;void 0===window._FSBLCache.windowAttempts[t.name]&&(window._FSBLCache.windowAttempts[t.name]=0),(t.setWindowType||i.windowType)&&"WebApplication"!==i.windowType||(i.windowType="WebWindow");let o=Object.assign({},i);o=Object.assign(o,t),o.setWindowType=o.windowType,delete o.windowType,u.default.system.debug("WRAP LIFECYCLE: Placing wrap into the local cache.",i.windowName);const s=e;window._FSBLCache.windows[i.windowName]=new s(o),r=window._FSBLCache.windows[i.windowName],r.windowType=i.windowType,r.identifier=i,r.addEventListener("closed",r.handleWrapRemoveRequest),r.addEventListener("maximized",()=>{r.windowState=e.WINDOWSTATE.MAXIMIZED}),r.addEventListener("minimized",()=>{r.windowState=e.WINDOWSTATE.MINIMIZED}),r.addEventListener("restored",()=>{r.windowState=e.WINDOWSTATE.NORMAL});const l=a.default.subscribe("Finsemble.Component.State."+i.windowName,(e,t)=>{if(e)u.default.system.error("Finsemble component state change error",e);else{const{state:e}=t.data;r.wrapState=e,a.default.unsubscribe(l)}});r.parentSubscribeID=a.default.subscribe("Finsemble.parentChange."+i.windowName,(e,t)=>{if(e)u.default.system.error("FinsembleWindow parent change notification error",e),n({wrap:r});else{const e=t.data||{};"Added"===e.type?(u.default.system.debug("FinsembleWindow Parent Notification: window.addedToStack listener",e),r.setParent(e.stackedWindowIdentifier,()=>{n({wrap:r})})):"Exists"===e.type?(u.default.system.debug("FinsembleWindow Parent Notification: Parent already exists, checking if added to wrap",e),r.setParentOnWrap(e.stackedWindowIdentifier,()=>{n({wrap:r})})):"Removed"===e.type?(u.default.system.debug("FinsembleWindow Parent Notification: window.removedFromStack listener",e),r.clearParent(),n({wrap:r})):e.type?(u.default.system.error("FinsembleWindow Parent Notification: unknown type",e),n({wrap:r})):n({wrap:r})}})}))}static _getRemoveWrapChannel(e){return`${g.System.Window.getCurrent().name}.removeWrap.${e}`}async handleWrapRemoveRequest(e){e&&e.wait(),u.default.system.debug("WRAP Destructor. Removing cached window",this.name,"in ",window.name),this.removeListeners&&this.removeListeners(),this.cleanupRouter(),this.cleanup(),this.name!==window.name&&(delete window._FSBLCache.windows[this.name],delete window._FSBLCache.windowAttempts[this.name]),e&&e.done()}cleanupRouter(){const t=e._getRemoveWrapChannel(this.name);a.default.removeResponder(t),this.TITLE_CHANGED_SUBSCRIPTION&&a.default.unsubscribe(this.TITLE_CHANGED_SUBSCRIPTION),a.default.unsubscribe(this.parentSubscribeID)}onReady(e){if("ready"===this.wrapState)return e();this.addEventListener("ready",e)}queryWindowService(e,t,n=Function.prototype){if("close"!==e&&"setParent"!==e&&"ready"!==this.wrapState)return void this.onReady(()=>{this.wrapState="ready",this.queryWindowService(e,t,n)});return new Promise(async(i,r)=>{"function"==typeof t&&(n=t,t={}),(t=t||{}).windowIdentifier=this.identifier,u.default.setting().system.Debug&&(t.callstack=u.default.callStack()),u.default.system.debug("FinsembleWindow.queryWindowService",this.windowServiceChannelName(e),t);let o=null;a.default.query(this.windowServiceChannelName(e),t,(t,s)=>{t?(u.default.system.debug(`WindowService.${e}: failed`,t),console.debug(`WindowService.${e}: failed`,t),"getComponentState"!==e&&"Not found"!==t&&r(t)):(o=s.data,u.default.system.debug(this.windowServiceChannelName(e)+" successful",o),console.debug(this.windowServiceChannelName(e)+" successful",o)),i(o),n(t,o)})})}minimize(e=null,t=Function.prototype){this.queryWindowService("minimize",e,t)}maximize(e=null,t=Function.prototype){this.queryWindowService("maximize",e,t)}restore(e=null,t=Function.prototype){this.queryWindowService("restore",e,t)}blur(e=null,t=Function.prototype){this.queryWindowService("blur",e,t)}focus(e=null,t=Function.prototype){this.queryWindowService("focus",e,t)}bringToFront(e=null,t=Function.prototype){this.queryWindowService("bringToFront",e,t)}setAlwaysOnTop(e={alwaysOnTop:!0},t=Function.prototype){this.queryWindowService("setAlwaysOnTop",e,t)}isAlwaysOnTop(e={},t){this.queryWindowService("isAlwaysOnTop",{},t)}isShowing(e={},t){this.queryWindowService("isShowing",e,t)}setIgnoreMouseEvents(e,t,n=Function.prototype){const i={ignore:new Boolean(e).valueOf(),options:new Boolean(t).valueOf()?t:{forward:!1}};this.queryWindowService("setIgnoreMouseEvents",i,n)}setShape(e,t=Function.prototype){this.queryWindowService("setShape",e,t)}async addBrowserView(e,t=Function.prototype){const n=await this.queryWindowService("addBrowserView",e,t);return new y.FinsembleView({id:n,win:this})}async removeBrowserView(e,t=Function.prototype){await this.queryWindowService("removeBrowserView",{viewId:e.id},t)}async bringViewToFront(e,t=Function.prototype){await this.queryWindowService("bringViewToFront",{viewId:e.id},t)}async setViewBounds(e,t=Function.prototype){await this.queryWindowService("setViewBounds",{viewId:e.view.id,bounds:e.bounds},t)}setBounds(e={bounds:{}},t=Function.prototype){if("function"!=typeof e&&!e.bounds){e={bounds:e}}this.queryWindowService("setBounds",e,t)}getBounds(e={},t=Function.prototype){return new Promise(n=>{this.queryWindowService("getBounds",e,(e,i)=>{n({err:e,data:i}),t(e,i)})})}updateOptions(e,t=Function.prototype){this.queryWindowService("updateOptions",e,t)}hide(e={},t=Function.prototype){this.queryWindowService("hide",e,t)}show(e={},t=Function.prototype){this.queryWindowService("show",e,t)}showAt(e={},t=Function.prototype){this.queryWindowService("showAt",e,t)}close(e={},t=Function.prototype){u.default.system.debug("WRAP CLOSE. Public close initiated for",this.name,e),this.queryWindowService("close",e,()=>{u.default.system.debug("WRAP CLOSE. Public close initiated for",this.name),t()})}animate(e={},t=Function.prototype){this.queryWindowService("animate",e,t)}registerWithDocking(e={},t){this.onReady(()=>{a.default.query("DockingService.registerWindow",{type:this.type,windowType:this.windowType,windowMsg:e,name:this.windowName},t)})}unRegisterWithDocking(){a.default.transmit("DockingService.deregisterWindow",{name:this.windowName})}initializeWindow({manageWindowMovement:e,identifier:t},n=Function.prototype){const i=()=>{a.default.publish(`Finsemble.${this.windowName}.componentReady`,{name:this.windowName}),n()};e?this.registerWithDocking(t,i):i()}wrapReady(){a.default.publish(`Finsemble.${this.windowName}.wrapReady`,{name:this.windowName,state:"open"})}setOpacity(e,t=Function.prototype){this.queryWindowService("setOpacity",e,t)}startTabTileMonitoring(e={}){u.default.system.debug("FinsembleWindow.startTabTileMonitoring",e),a.default.transmit("TabTile.startTabTile",{params:e})}stopTabTileMonitoring(e={},t=Function.prototype){u.default.system.debug("FinsembleWindow.stopTabTileMonitoring",e),a.default.query("TabTile.stopTabTile",{params:e},(function(e,n){e?u.default.system.warn("TabTile.stopTabTile: query failed",e):u.default.system.debug("TabTile.stopTabTile results",n.data);const i=n.data;t?t(e,i,this.defaultStopTrackingAction):this.defaultTabTileAction(i)}))}defaultTabTileAction(e){const t=this;switch(u.default.system.debug("FinsembleWindow.defaultTabTileAction",e),e.stoppedLocation){case"OutsideWindow":case"TabSection":break;case"InsideWindow":e.tileGroupId?t.Group.addWindow(this.identifier,e.tileGroupId,e.dropCoordinates):t.Group.createGroup((function(n){t.Group.addWindow(this.identifier,n,e.dropCoordinates,{startingWindowIdentifier:e.droppedOnWindowIdentifier})}));break;default:u.default.system.error("stopTracking returned an unknown stoppedLocation result",e)}}mergeBounds(e){e.right=e.left+e.width;const t={left:e.left,right:e.right,width:e.width,top:e.top,bottom:e.top+e.height,height:e.height},n={defaultLeft:e.left,defaultWidth:e.width,defaultTop:e.top,defaultHeight:e.height};Object.assign(this.windowOptions,t),Object.assign(this.windowOptions,n),this.windowOptions.bounds=t}startMove(e={}){u.default.system.debug("FinsembleWindow.startMove",e),e.windowIdentifier=this.identifier,a.default.transmit(this.eventChannelName("startedMoving"),{})}stopMove(e={}){u.default.system.debug("FinsembleWindow.stopMove",e),e.windowIdentifier=this.identifier,a.default.transmit(this.eventChannelName("stoppedMoving"),{})}getMonitor(e){a.default.query("DockingService.getMonitorForWindow",{windowIdentifier:this.identifier},(t,n)=>n?e(n.data):e())}getComponentState(e,t){this.queryWindowService("getComponentState",e,t)}getWindowState(e,t){this.queryWindowService("getWindowState",e,t)}setComponentState(e,t=(()=>{})){this.queryWindowService("setComponentState",e,t)}removeComponentState(e,t=(()=>{})){this.queryWindowService("removeComponentState",e,t)}setWindowState(e,t=(()=>{})){this.queryWindowService("setWindowState",e,t)}saveCompleteWindowState(e={},t=Function.prototype){this.queryWindowService("saveCompleteWindowState",e,t)}cancelTabTileMonitoring(e={}){u.default.system.debug("FinsembleWindow.cancelTabTileMonitoring",e),a.default.transmit("TabTile.cancelTabTile",{params:e})}getParent(t){this.settingParent?e.getInstance(this.settingParent,(e,n)=>{t(null,n)}):this.parentWindow?t(null,this.parentWindow):t(null,null)}setParent(t,n){if(this.settingParent)return this.getParent(n);this.settingParent=t,this.parentWindow&&this.parentWindow.name===t.windowName?(u.default.system.debug("FinsembleWindow.setParent already set",t),this.settingParent=!1,n(null,this.parentWindow)):this.queryWindowService("setParent",t,()=>{u.default.system.debug("FinsembleWindow.setParent",t),e.getInstance(t,(e,i)=>{e?u.default.system.error("FinsembleWindow.setParent error",e):(u.default.system.debug("FinsembleWindow.setParent wrap success",t),this.parentWindow=i,this.parentWindow.windowType.includes("StackedWindow")||u.default.system.error("FinsembleWindow.setParent error",this.parentWindow.name,t.windowName)),a.default.transmit(h.DOCKING.REQUEST_PUBLISH,null),this.settingParent=!1;const r=()=>{this.removeEventListener("parent-set",r),n(e,i)};this.addEventListener("parent-set",r)})})}setParentOnWrap(t,n=Function.prototype){this.parentWindow&&this.parentWindow.name===t.windowName?(u.default.system.debug("FinsembleWindow.setParentOnWrap already set",t),n(null,this.parentWindow)):this.queryWindowService("setParent",t,()=>{u.default.system.debug("FinsembleWindow.setParentOnWrap",t),e.getInstance(t,(e,i)=>{e?u.default.system.error("FinsembleWindow.setParentOnWrap error",e):(u.default.system.debug("FinsembleWindow.setParentOnWrap success getting wrap",t),console.debug("FinsembleWindow.setParentOnWrap success getting wrap",this,i),this.parentWindow=i,!1===this.parentWindow.windowType.includes("StackedWindow")&&u.default.system.error("FinsembleWindow.setParentOnWrap error",this.parentWindow.name,t.windowName)),n(e,i)})})}clearParent(){u.default.system.debug("FinsembleWindow.clearParent",this.parentWindow),this.parentWindow=null}setTitle(e){u.default.system.debug("Title change",e),a.default.publish(this.TITLE_CHANGED_CHANNEL,e)}getOptions(e=Function.prototype){this.queryWindowService("getOptions",{},e)}_privateManagementPreface(e,t){return"function"==typeof t&&u.default.system.error("StackedWindowWrapper.wrapPreface bad params",t),(t=t||{}).stackedWindowIdentifier={windowName:this.identifier.windowName,windowType:this.identifier.windowType},u.default.system.debug(`StackedWindow.${e}  _privateManagementPreface`,t),t}addWindow(e,t=Function.prototype){e=this._privateManagementPreface("addWindow",e);return new Promise(n=>{a.default.query("StackedWindow.addWindow",e,(e,i)=>{u.default.system.debug("StackedWindow.addWindow callback",e,i),t(e,i.data),n({err:e,data:i.data})})})}removeWindow(e,t=Function.prototype){e=this._privateManagementPreface("removeWindow",e);return new Promise(n=>{a.default.query("StackedWindow.removeWindow",e,(e,i)=>{u.default.system.debug("StackedWindow.removeWindow callback",e,i),t(e,i.data),n({err:e,data:i.data})})})}deleteWindow(e,t=Function.prototype){e=this._privateManagementPreface("deleteWindow",e);return new Promise(n=>{a.default.query("StackedWindow.deleteWindow",e,(e,i)=>{u.default.system.debug("StackedWindow.deleteWindow callback",e,i),t(e,i.data),n({err:e,data:i.data})})})}setVisibleWindow(e,t=Function.prototype){e=this._privateManagementPreface("setVisibleWindow",e);return new Promise(n=>{a.default.query("StackedWindow.setVisibleWindow",e,(e,i)=>{u.default.system.debug("StackedWindow.setVisibleWindow callback",e,i),t(e,i.data),n({err:e,data:i.data})})})}reorder(e,t=Function.prototype){e=this._privateManagementPreface("reorder",e);return new Promise(n=>{a.default.query("StackedWindow.reorder",e,(e,i)=>{u.default.system.debug("StackedWindow.reorder callback",e,i),t(e,i.data),n({err:e,data:i.data})})})}formGroup(){const e=this.parentWindow?this.parentWindow.name:this.name;a.default.transmit("DockingService.formGroup",{windowName:e})}ejectFromGroup(){const e=this.parentWindow?this.parentWindow.name:this.name;a.default.query("DockingService.leaveGroup",{name:e},()=>{})}}return e.WINDOWSTATE={NORMAL:0,MINIMIZED:1,MAXIMIZED:2,HIDDEN:3},e.wrap=e.getInstance,e.isStartupApplication=async function(e){let t;const n=await new Promise((e,t)=>{g.System.Application.getCurrent().getManifest(e,t)}).catch(()=>{t=!1});return n&&(t=n&&n.startup_app&&n.startup_app.name===e),t},e._windowReady=function(t){let n;u.default.system.debug(`windowServiceReady: ${t} starting`);const i="Finsemble.Component.State."+t;return new Promise(async(r,o)=>{const s=(e,i)=>{const{state:o}=i.data;switch(u.default.system.debug(`windowServiceReady: ${t} state change: ${o}`),console.log(`windowServiceReady: ${t} state change: ${o}`),o){case"ready":case"reloading":case"closing":u.default.system.debug(`windowServiceReady: ${t} ${o}`),a.default.unsubscribe(n),r()}};await e.isStartupApplication(t)||p.isServiceInWindow(t)?o("Cannot Wrap Service Manager or Services"):(u.default.system.debug(`windowServiceReady: ${t} waiting`),n=a.default.subscribe(i,s))})},e})();t.FinsembleWindow=w},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const a=n(13),u=s(n(27)),l=s(n(42)),c=o(n(9)),d=n(3),f=n(4),h=s(n(1)),p=s(n(6)),g=n(15),m=n(11),y=s(n(8)),w=n(14),b=s(n(22)),v=n(12),C=n(38);let S;function _(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp(`(\\s|^)${t}(\\s|$)`))}class T extends f._BaseClient{constructor(e){super(e),this.showAtMousePosition=function(){this.routerClient.transmit("DockingService.showAtMousePosition",this.getWindowIdentifier())},p.default.args(e,"object=")&&e&&p.default.args2("params.onReady",e.onReady,"function="),this.options={},this.windowHash="",this.title=null,this.toolbarBottom=40,this.containers=[],this.componentState={},this.windowState="normal",this.hasHeader=!1,this.enableWindowsAeroSnap=!1,this.bindFunctions(),this.minimizeWithDockedWindows=this.minimize}bindFunctions(){this.onWindowRestored=this.onWindowRestored.bind(this),this.onWindowMaximized=this.onWindowMaximized.bind(this),this.onWindowBlurred=this.onWindowBlurred.bind(this),this.onWindowFocused=this.onWindowFocused.bind(this),this.onMinimizedRestored=this.onMinimizedRestored.bind(this),this.onWindowMinimized=this.onWindowMinimized.bind(this),this.close=this.close.bind(this),this.getInitialOptions=this.getInitialOptions.bind(this),this.cacheInitialBounds=this.cacheInitialBounds.bind(this),this._setHeaderHeight=this._setHeaderHeight.bind(this)}onWindowRestored(){this.updateHeaderState("Maximize",{hide:!1})}onWindowMaximized(){this.updateHeaderState("Maximize",{hide:!0})}onWindowBlurred(){this.setActive(!1)}onWindowFocused(){this.setActive(!0)}onMinimizedRestored(){this.routerClient.transmit("DockingService.windowRestored",S.name),S.removeEventListener("restored",this.onMinimizedRestored)}onWindowMinimized(){this.routerClient.query("DockingService.windowMinimized",{windowName:S.name}),S.addEventListener("restored",this.onMinimizedRestored)}getWindowGroups(){return this.windowGroups}groupUpdateHandler(e,t){e?FSBL.Clients.Logger.error(e):t.data&&t.data.groupData&&(this.windowGroups=Object.values(t.data.groupData).filter(e=>e.windowNames.includes(this.getWindowNameForDocking())))}close(e,t=(()=>{})){e||(e={removeFromWorkspace:!0,closeWindow:!0});const{parentWindow:n}=S;if(e.userInitiated&&n)return n.close(e,t);S.close(e,t)}getWindowHash(){return this.windowHash}getWindowTitle(){return this.title}retrieveMonitorDimensions(e=Function.prototype){c.getMonitor(null,t=>{S.updateOptions({options:{monitorDimensions:t.monitorRect}}),e&&e(t.monitorRect)})}listenForHashChanges(){d.System.hasBrowserView()||(S.updateOptions({url:window.top.location.href},()=>{}),function(e){const{pushState:t}=e;e.pushState=function(n){"function"==typeof e.onpushstate&&e.onpushstate({state:n}),t.apply(e,arguments),S.updateOptions({url:window.top.location.href},()=>{})};const{replaceState:n}=e;e.replaceState=function(t){"function"==typeof e.onreplacestate&&e.onreplacestate({state:t}),n.apply(e,arguments),S.updateOptions({url:window.top.location.toString()})}}(window.history),window.addEventListener("hashchange",()=>{S.updateOptions({url:window.top.location.toString()},()=>{})}))}getInitialOptions(e){this.isInAService?(this.options={},h.default.system.debug("WindowClient:getting options empty",this.options),e()):S.getOptions((t,n)=>{t&&(n={}),S.windowOptions=n,this.options=n,h.default.system.debug("WindowClient:getting options",this.options),e()})}cacheInitialBounds(e){if(d.System.hasBrowserView())return e();this.cacheBounds(()=>{try{if(!S.windowOptions.customData.foreign.components["Window Manager"].persistWindowState)return e();S.updateOptions({options:{url:window.top.location.toString()}})}catch(e){h.default.system.warn('customData.foreign.components["Window Manager" is undefined')}e()})}setInitialWindowBounds(e){h.default.system.warn("`FSBL.Clients.WindowClient.setInitialWindowBounds is deprecated and will be removed in a future version of finsemble. Use 'getInitialOptions' and 'cacheInitialBounds' instead."),a.parallel([this.getInitialOptions,this.cacheInitialBounds],e)}getWindowBounds(){return{top:S.windowOptions.defaultTop,left:S.windowOptions.defaultLeft,width:S.windowOptions.defaultWidth,height:S.windowOptions.defaultHeight}}saveWindowBounds(e,t){if(h.default.system.debug("WINDOW LIFECYCLE:SavingBounds:",e,"setActiveWorkspaceDirty",t),void 0===t&&(t=!1),p.default.args(e,"object")&&p.default.args2("bounds.top",e.top,"number"),e){S.updateOptions({options:{top:Math.round(e.top),defaultTop:Math.round(e.top),left:Math.round(e.left),defaultLeft:Math.round(e.left),width:Math.round(e.width),defaultWidth:Math.round(e.width),height:Math.round(e.height),defaultHeight:Math.round(e.height)}});try{S.windowOptions.customData.foreign.components["Window Manager"].persistWindowState}catch(e){}}}minimize(e){this.cacheBounds(()=>{S.minimize(null,t=>{t&&h.default.system.error("WindowClient:minimize",t),e&&e(t)})})}setAlwaysOnTop(e,t){S.setAlwaysOnTop({alwaysOnTop:e},t)}restore(e=(()=>{})){S.restore(null,t=>{t&&h.default.system.error("WindowClient:restore",t),e(t)})}cacheBounds(e){this.getBounds((t,n)=>{if(t)return e(),console.warn("Get bounds error.",t,"Window may not be registered with the window service");S.updateOptions({options:{cachedLeft:n.left,defaultLeft:n.left,cachedTop:n.top,defaultTop:n.top,cachedWidth:n.width,defaultWidth:n.width,cachedHeight:n.height,defaultHeight:n.height}}),e&&e(n)})}maximize(e){this.cacheBounds(()=>(S.maximize(),e()))}removeFinWindowEventListeners(){S.removeEventListener("maximized",this.onWindowMaximized),S.removeEventListener("restored",this.onWindowRestored),S.removeEventListener("blurred",this.onWindowBlurred),S.removeEventListener("focused",this.onWindowFocused),S.removeEventListener("close-requested",this.close),S.removeEventListener("minimized",this.onWindowMinimized)}injectDOM(e){if(h.default.system.debug("injectDOM",e),document.getElementById("FSBLHeader"))return;window.scrollTo(0,0);const t=document.createElement("div");t.innerHTML=`<div id="FSBLHeader"${e?" style=height:"+e:""}></div>`,document.body.insertBefore(t.firstChild,document.body.firstChild)}getComponentState(e,t){if(e||(e={}),e.fields&&!Array.isArray(e.fields)&&(e.fields=[e.fields]),p.default.args(e,"object",t,"function"),S)return S.getComponentState(e,t);h.default.system.warn("Attempt to use getComponentState before component is ready or in a service"),e.windowName||(e.windowName=window.name);const n=this.getContainerHash(e.windowName);u.default.get({topic:w.WORKSPACE.CACHE_STORAGE_TOPIC,key:n},(n,i)=>{if(n)return h.default.system.error("Error retrieving window client's component state."),void t(n);const r=i;if(i&&e.field)this.componentState=r||{},t(n,r[e.field]);else{if(e.fields){const n={};for(let t=0;t<e.fields.length;t++)r[e.fields[t]]&&(n[e.fields[t]]=r[e.fields[t]]);return t(null,n)}if(i)return t(null,r);h.default.system.info("WindowClient:getComponentState:error, response, params",n,i,e),t("Not found",i)}})}async setComponentState(e,t=(()=>{})){return p.default.args(e,"object",t,"function=")&&p.default.args2("params.field",e.field,"string"),S?S.setComponentState(e,t):this.isInAService?(t("Cannot call setComponentState in a service."),Promise.resolve()):(t("Cannot call setComponentState. The window may not be ready"),Promise.reject("The window is not yet ready to save state."))}async removeComponentState(e,t=(()=>{})){p.default.args(e,"object",t,"function=")&&p.default.args2("params.field",e.field,"string");return(S||await g.FinsembleWindow.getInstance({name:e.windowName||window.name})).removeComponentState(e,t)}getWindowNameForDocking(){const e=S.parentWindow;return e?e.name:S.name}getContainerHash(e){return c.camelCase(this.windowHash,e)}formGroup(){S.formGroup()}registerWithDockingManager(e,t){S.parentWindow&&(h.default.system.debug("registerWithDockingManager ignore registration request if has a parent"),t&&t());const n=S.name,{uuid:i}=S;this.startedRegistrationWithDocking=!0,this.routerClient.query("DockingService.registerWindow",{name:n,uuid:i,options:e||{},windowType:"WebWindow"},()=>{this.startedRegistrationWithDocking=!1,this.deregisterPlease&&(this.deregisterWithDockingManager(),this.deregisterPlease=!1),h.default.system.debug("WINDOW LIFECYCLE: Docking Registration complete."),t&&t()})}deregisterWithDockingManager(e){this.startedRegistrationWithDocking&&(this.deregisterPlease=!0);const t=S.name;this.routerClient.transmit("DockingService.deregisterWindow",{name:t,userInitiated:e})}bumpFixedElements(e){if("complete"!==document.readyState)return setTimeout(()=>{this.bumpFixedElements(e)},100);if(!e)return;let{absolute:t,fixed:n,bumpBy:i}=e;if(!t&&!n)return;const r=document.getElementById("FSBLHeader");if(!r||0===r.children.length||!r.children[0].clientHeight)return setTimeout(()=>{this.bumpFixedElements(e)},100);"auto"===i?i="0px":-1===new String(i).indexOf("px")&&(i+="px");const o=document.body.getElementsByTagName("*"),s=o.length;for(let e=0;e<s;e++){if("FSBLHeader"===o[e].id||o[e].classList.contains("fsbl-header"))continue;const r=window.getComputedStyle(o[e],null),s=["0","0px",0],a=r.getPropertyValue("top");t&&o[e].parentNode===document.body&&"absolute"==r.getPropertyValue("position")&&("all"==t?o[e].style.top=`calc(${a} + ${i})`:"0Positioned"==t&&s.includes(a)&&(o[e].style.top=i)),n&&"fixed"==r.getPropertyValue("position")&&("all"==n?o[e].style.top=`calc(${a} + ${i})`:"0Positioned"==n&&s.includes(a)&&(o[e].style.top=i))}}bringWindowToFront(){S.bringToFront({forceFocus:!0},e=>{e?h.default.system.error("WindowClient.bringWindowToFront: failure:"+e):h.default.system.info("WindowClient.bringWindowToFront: success")})}injectStylesheetOverride(){const e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(S.windowOptions.customData.cssOverride)),document.body.appendChild(e)}checkIfChildApp(){if(S.windowOptions&&S.windowOptions.customData&&S.windowOptions.customData.parentUUID&&S.windowOptions.customData.parentUUID!==d.System.Application.getCurrent().uuid){const e=d.System.Application.wrap(S.windowOptions.customData.parentUUID);e.addEventListener("crashed",this.close.bind(null,!1)),e.addEventListener("initialized",this.close.bind(null,!1)),e.addEventListener("out-of-memory",this.close.bind(null,!1))}}preventUnintendedDropEvents(){function e(e){e.preventDefault()}window.addEventListener("dragover",e,!1),window.addEventListener("drop",e,!1)}rejectWindowsKeyResizes(){let e=!1;const t=async t=>{this.enableWindowsAeroSnap?"Meta"===t.key&&y.default.transmit("Finsemble.WindowService.WindowsKey","up"):"Meta"===t.key&&e&&(e=!1,d.System.Window.getCurrent().updateOptions({resizable:!0}))},n=t=>{this.enableWindowsAeroSnap?"Meta"===t.key&&y.default.transmit("Finsemble.WindowService.WindowsKey","down"):"Meta"===t.key&&(e=!0,d.System.Window.getCurrent().updateOptions({resizable:!1}))};FSBL&&l.default.onReady(()=>{window.addEventListener("keyup",t),window.addEventListener("keydown",n)})}addListeners(e=Function.prototype){this.listenForHashChanges(),this.preventUnintendedDropEvents(),this.rejectWindowsKeyResizes(),S.addListener("setParent",()=>{h.default.system.info("WindowClient.setParent deregisterWithDockingManager"),this.deregisterWithDockingManager()}),S.addEventListener("maximized",this.onWindowMaximized),S.addEventListener("minimized",this.onWindowMinimized),S.addEventListener("restored",this.onWindowRestored),S.addEventListener("blurred",this.onWindowBlurred),S.addEventListener("focused",this.onWindowFocused),"undefined"!=typeof FSBL&&FSBL.onShutdown(()=>(h.default.system.info("WINDOW LIFECYCLE:SHUTDOWN: FSBL.onShutdown start"),new Promise(e=>{h.default.system.debug("FSBL.onShutdown"),FSBL.shutdownComplete(),this.close({removeFromWorkspace:!1,ignoreParent:!0,closeWindow:!1},e)}))),e()}updateHeaderState(e,t){this.commandChannel&&this.commandChannel(e,t)}headerCommandChannel(e){this.commandChannel=e}ejectFromGroup(){S.ejectFromGroup()}setWindowTitle(e){p.default.args(e,"string"),this.title=e,this.updateHeaderState("Main",{windowTitle:e}),S.setTitle(e)}getSpawnData(){if(!this.options.customData)return{};const{spawnData:e}=this.options.customData;return void 0===e?{}:e}getCurrentWindow(){return d.System.Window.getCurrent()}async getDesktopBoundingBox(e){let t=e;"string"==typeof e&&(t=document.querySelector(e));const n=t.getBoundingClientRect(),i=await S.getBounds(),r=i.data;let o,s;i.err?(o=this.options.defaultTop,s=this.options.defaultLeft):(o=r.top,s=r.left);const a={top:o+n.top,left:s+n.left,width:n.width,height:n.height,right:0,bottom:0};return a.right=a.left+a.width,a.bottom=a.top+a.height,a}isPointInBox(e,t){return t.bottom||(t.bottom=t.top+t.height),t.right||(t.right=t.left+t.width),e.x>t.left&&e.x<t.right&&e.y<t.bottom&&e.y>t.top}isMouseOverDOMElement(e,t){this.getDesktopBoundingBox(e).then(e=>{d.System.getMousePosition((n,i)=>{t(this.isPointInBox(i,e))})})}getWindowIdentifier(){var e=null;return this.options&&this.options.customData&&this.options.customData.component&&(e=this.options.customData.component.type),{windowName:S?S.name:window.name,uuid:S?S.uuid:null,componentType:e}}setActive(e){var t,n;e?(t=document.documentElement,n="desktop-active",t.classList?t.classList.add(n):_(t,n)||(t.className=`${t.className} ${n}`)):function(e,t){if(e.classList)e.classList.remove(t);else if(_(e,t)){const n=new RegExp(`(\\s|^)${t}(\\s|$)`);e.className=e.className.replace(n," ")}}(document.documentElement,"desktop-active")}getBounds(e){S.getBounds((t,n)=>{e(t,n)})}setShape(e,t=Function.prototype){S.setShape(e,t)}startTilingOrTabbing(e,t=Function.prototype){FSBL.Clients.RouterClient.transmit("DockingService.startTilingOrTabbing",e),t()}startMovingWindow(e){d.System.Window.getCurrent().startMovingWindow(e)}stopMovingWindow(){d.System.Window.getCurrent().stopMovingWindow()}cancelTilingOrTabbing(e,t=Function.prototype){console.debug("CancelTilingOrTabbing"),y.default.transmit("DockingService.cancelTilingOrTabbing",e),t()}sendIdentifierForTilingOrTabbing(e,t=Function.prototype){FSBL.Clients.RouterClient.transmit("DockingService.identifierForTilingOrTabbing",e),t()}stopTilingOrTabbing(e,t=Function.prototype){const n=()=>{y.default.query("DockingService.stopTilingOrTabbing",e,()=>{t()}),y.default.transmit("DockingService.stopTilingOrTabbing",e)};return e.mousePosition?(n(),e.allowDropOnSelf?void 0:t()):d.System.getMousePosition((i,r)=>{if(e.mousePosition=r,n(),!e.allowDropOnSelf)return t()})}getStackedWindow(e,t){if(h.default.system.debug("WindowClient.getStackedWindow",e),t=t||e,(e=e||{}).windowIdentifiers=e.windowIdentifiers||[],!S.parentWindow&&e.create){const n=e=>{const{parentName:i}=e.data;S.setParent({windowName:i},(e,n)=>{t(e,n)}),S.removeListener("parent-set",n)};S.addListener("parent-set",n),FSBL.Clients.LauncherClient.spawn("StackedWindow",{windowType:"StackedWindow",data:{windowIdentifiers:e.windowIdentifiers},options:{newStack:!0}},(e,n)=>{h.default.system.debug("WindowClient.getStackedWindow-success",e,n),e&&t(e,null)})}else S.getParent(t)}getMonitorInfo(e,t){c.getMyWindowIdentifier(n=>{e.windowIdentifier||(e.windowIdentifier=n),this.routerClient.query("Launcher.getMonitorInfo",e,(e,n)=>{t&&t(e,n.data)})})}fitToDOM(e,t){let n=document.documentElement.offsetHeight,i=this.options.width;"function"==typeof e&&(t=e,e=null),e&&e.padding&&(e.padding.height&&(n+=e.padding.height),e.padding.width&&(i+=e.padding.width)),e&&e.maxHeight&&n>e.maxHeight&&(n=e.maxHeight),h.default.system.debug("WindowClient.FitToDOM:newHeight",n,e),this.getMonitorInfo({},(e,r)=>{r&&(n>=r.availableRect.height&&(n=r.availableRect.height),i>=r.availableRect.width&&(i=r.availableRect.width)),h.default.system.debug("WindowClient.FitToDOM:fixBounds",n,i),S.getBounds((e,r)=>{r.width!=i||r.height!=n?(r.width=i,r.height=n,S.setBounds({bounds:r},t)):"function"==typeof t&&t()})})}_setHeaderHeight(e){let t=document.getElementsByClassName("fsbl-header")[0];if(!t)return setTimeout(()=>{this._setHeaderHeight(e)},100);let n=window.getComputedStyle(t,null).getPropertyValue("height");document.body.style.marginTop=n,e.bumpElements&&"auto"===e.bumpElements.bumpBy&&(e.bumpElements.bumpBy=n),this.bumpFixedElements(e.bumpElements)}async start(e=Function.prototype){if(p.default.args(e,"function"),v.iAmAServiceWindow())return this.isInAService=!0,e();const t=this;await b.default.getValue("finsemble");let n=null,i=!1,r=!1,o=!1;this.componentState={};(e=>{g.FinsembleWindow.getInstance({name:this.finWindow.name,uuid:this.finWindow.uuid},(t,n)=>{if(h.default.system.debug("FinsembleWindow.getInstance "+this.finWindow.name),"Cannot Wrap Service Manager or Services"==t)return this.isInAService=!0,this.windowHash=c.camelCase("activeWorkspace",window.name),e();!t&&n||h.default.system.error("wrap failure",t),this.finsembleWindow=n,({finsembleWindow:S}=this),this.windowHash=c.camelCase("activeWorkspace",S.name),this.addListeners(),this.routerClient.subscribe("Finsemble.WorkspaceService.groupUpdate",(e,t)=>this.groupUpdateHandler(e,t)),e()})})(()=>{this.retrieveMonitorDimensions(),this.getInitialOptions(()=>{if(!S||!S.windowOptions)return this.isInAService||h.default.system.error("Something went wrong attempting to get the current window."),e();({customData:n}=S.windowOptions),h.default.system.debug("getInitialOptions",n),n&&(i=C(n,"window.compound",!1),n.cssOverride&&(h.default.system.debug("Window has cssOverride. See local window to inspect object"),r=!0),o=!i&&C(n,["foreign","components","Window Manager","FSBLHeader"],!1)),a.parallel([function(e){r&&t.injectStylesheetOverride(),e()},function(e){b.default.getValue("finsemble",(n,i)=>{n&&h.default.system.error("Error reading windowService config from finsemble");const r=i.services.windowService.config.enableWindowsAeroSnap;t.enableWindowsAeroSnap=m.ConfigUtilInstance.getDefault(i,"config.servicesConfig.docking.enableWindowsAeroSnap",r),e()})},function(e){if(d.System.isBrowserView())e();else{if(!n||!n.component||v.iAmAServiceWindow())return e();{let i=m.ConfigUtilInstance.getDefault(n,"customData.foreign.services.windowService.manageWindowMovement",!1);i||(i=m.ConfigUtilInstance.getDefault(n,"customData.foreign.services.dockingService.manageWindowMovement",!1));const r=m.ConfigUtilInstance.getDefault(n,"customData.foreign.components.Window Manager.FSBLHeader",!1),o=m.ConfigUtilInstance.getDefault(n,"customData.window.dockable",!1);i=i||r||o;let s=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowAutoArrange",oldValue:"isArrangable"},null);null===s&&(s=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowAutoArrange",oldValue:"isArrangeable"},i));if(!(i||s))return e();if(n.window.allowAutoArrange=s,n.window.snapping=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowSnapping",oldValue:"ignoreSnappingRequests"},i),n&&n.foreign&&n.foreign.services){const e=void 0!==n.foreign.services.windowService?"windowService":"dockingService";void 0!==n.foreign.services[e].ignoreSnappingRequests&&(n.window.snapping=!n.foreign.services[e].ignoreSnappingRequests)}if(m.ConfigUtilInstance.getDefault(n,"customData.window.ephemeral",!1)&&!n.window.snapping&&(n.window.snapping=!1),n.window.tiling=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowTiling",oldValue:"ignoreTilingAndTabbingRequests"},i),n.window.tabbing=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowTabbing",oldValue:"ignoreTilingAndTabbingRequests"},i),n&&n.foreign&&n.foreign.services){const e=void 0!==n.foreign.services.windowService?"windowService":"dockingService";void 0!==n.foreign.services[e].ignoreTilingAndTabbingRequests&&(n.window.tiling=!n.window.tiling,n.window.tabbing=!n.window.tabbing)}n.window.canGroup=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowGrouping",oldValue:"canGroup"},i),n.window.canMinimize=v.checkDeprecatedConfigs(n,{baseString:"customData.foreign.services",newPath:"windowService",oldPath:"dockingService",newValue:"allowMinimize",oldValue:"canMinimize"},void 0),void 0===n.window.canMinimize&&(n.window.canMinimize=n.component.canMinimize,void 0===n.window.canMinimize&&(n.window.canMinimize=i)),void 0===n.window.canMaximize&&(n.window.canMaximize=n.component.canMaximize,void 0===n.window.canMaximize&&(n.window.canMaximize=i)),n.window.overwriteStartDocked=m.ConfigUtilInstance.getDefault(n,"customData.foreign.services.workspaceService.global",!1),t.registerWithDockingManager(n.window,()=>{t.cacheInitialBounds(e)})}}}],(t,n)=>e(t,n))})})}}var A=new T({startupDependencies:{clients:["storageClient"]},onReady(e){A.start(e)},name:"windowClient"});t.default=A},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const r=n(4),o=i(n(67));let s;const a=window;let u;const l={};function c(e,t){return u.routerClient.query("storeService.getStore",e,(function(e,n){return e?t(e):t(e,new s(n.data,u.routerClient))}))}function d(e,t){u.routerClient.query("storeService.removeStore",e,(e,n)=>t(e,!e&&n.data))}class f extends r._BaseClient{constructor(e){super(e),this.load=function(e){e()},u=this,this.ls=l}getStore(e,t){return e.global?c(e,t):l[e.store]?t(null,l[e.store]):c(e,t)}createStore(e,t=Function.prototype){return new Promise((n,i)=>{if(e.global)return this.routerClient.query("storeService.createStore",e,(e,r)=>{if(e)return i(e),t(e);const o=new s(r.data,u.routerClient);return n({err:e,data:o}),t(e,o)});if(l[e.store])return n({err:null,data:l[e.store]}),t(null,l[e.store]);const r=new s(e,u.routerClient);return l[r.name]=r,n({err:null,data:r}),t(null,r)})}removeStore(e,t){return e.global?d(e,t):l[e.store]?(delete l[e.store],t(null,!0)):void d(e,t)}}var h=new f({startupDependencies:{},onReady(e){s=o.default,h.load(e)},name:"distributedStoreClient"});a.distributedStoreClient=h,t.default=h},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const a=n(4),u=s(n(16)),l=o(n(9)),c=s(n(6)),d=n(3),f=s(n(1)),h=n(15),p=window,g={};class m extends a._BaseClient{constructor(e){super(e),c.default.args(e,"object=")&&e&&c.default.args2("params.onReady",e.onReady,"function="),this.windowClient=e.clients.windowClient}getComponentList(e=Function.prototype){c.default.args(e,"function=");return new Promise(t=>{this.routerClient.query("Launcher.componentList",{},(n,i)=>{e(n,i.data),t({err:n,data:i.data})})})}getComponentDefaultConfig(e,t=Function.prototype){c.default.args(t,"function=");return new Promise(n=>{this.routerClient.query("Launcher.componentList",{},(i,r)=>{const o=r.data[e];t(i,o),n({err:i,data:o})})})}getMonitorInfo(e={},t=Function.prototype){const n=this;if(c.default.args(t,"function="),f.default.system.debug("MONITOR: launcherClient.getMonitorInfo"),"all"===e.monitor)return n.getMonitorInfoAll(t);return new Promise(i=>{l.getMyWindowIdentifier(r=>{e.windowIdentifier||(e.windowIdentifier=r),n.routerClient.query("Launcher.getMonitorInfo",e,(e,n)=>{t&&t(e,n.data),f.default.system.log("MONITOR: launcherClient.getMonitorInfo query response data",n.data),i({err:e,data:n.data})})})})}getMonitorInfoAll(e=Function.prototype){c.default.args(e,"function="),f.default.system.debug("MONITOR: launcherClient.getMonitorInfoAll");return new Promise((t,n)=>{this.routerClient.query("Launcher.getMonitorInfoAll",{},(i,r)=>{i&&(n({err:i}),e(i)),t({err:i,data:r.data}),e(i,r.data)})})}registerComponent(e,t=Function.prototype){return new Promise(n=>{this.routerClient.query("LauncherService.registerComponent",e,(e,i)=>{t&&t(e,i.data),n({err:e,data:i.data})})})}unRegisterComponent(e,t=Function.prototype){if(!e.componentType)return t("No componentType provided");return new Promise(n=>{this.routerClient.query("LauncherService.unRegisterComponent",e,(e,i)=>{t&&t(e,i.data),n({err:e,data:i.data})})})}locatorToIdentifier(e){let t={};return t.windowName="windowName"in e?e.windowName:"","componentType"in e&&(t.componentType=e.componentType),"uuid"in e&&(t.uuid=e.uuid),t}toggleWindowOnClick(e,t,n){const i=this;let r=this.locatorToIdentifier(t),o=`${r.windowName}:${r.uuid}`;if(r.windowName||(o=r.componentType),!1===g[o])return void(g[o]=!0);n.position||(n.position="absolute"),this.showWindow(t,n,(function(t,n){if(!n)return;const{finWindow:r}=n;var s=function(){g[o]=!0,i.windowClient.isMouseOverDOMElement(e,e=>{g[o]=!e}),r.removeEventListener("blurred",s)};r.addEventListener("blurred",s)}))}showWindow(e,t,n=Function.prototype){c.default.args(e,"object",t,"object=",n,"function=");const i=this;t||(t={}),(t=l.clone(t)).staggerPixels||0===t.staggerPixels||(t.staggerPixels=100),t.windowIdentifier=this.locatorToIdentifier(e);return new Promise(e=>{l.getMyWindowIdentifier(r=>{t.relativeWindow||(t.relativeWindow=r),i.routerClient.query("Launcher.showWindow",t,async(t,i)=>{if(t)return e({err:t}),n(t);const r=i.data.windowIdentifier;i.data.windowIdentifier.name=i.data.windowIdentifier.windowName;const{wrap:o}=await h.FinsembleWindow.getInstance({name:r.windowName});i.data.finWindow=o,e({err:t,data:i.data}),n(t,i.data)})})})}spawn(e,t,n=Function.prototype){const i=this;c.default.args(e,"string",t,"object=",n,"function="),t||(t={}),(t=l.clone(t)).component=e,t.options||(t.options={}),t.options.customData||(t.options.customData={}),t.staggerPixels||0===t.staggerPixels||(t.staggerPixels=50),f.default.system.debug("LauncherClient.spawn starting for componentType:"+e);return new Promise(r=>{l.getMyWindowIdentifier(o=>{t.launchingWindow=o,i.callSpawn(t,(t,i)=>{f.default.system.debug("LauncherClient.spawn completing for componentType:"+e,t),r({err:t,response:i}),n(t,i)})})})}callSpawn(e,t=Function.prototype){const n=this;c.default.args(t,"function="),f.default.perf.debug("CallSpawn","start","from spawn to callback",e);return new Promise(i=>{function r(e,n){t(e,n),i({err:e,data:n})}n.routerClient.query("Launcher.spawn",e,async(e,t)=>{if(f.default.system.debug("CallSpawn","Initial launcher callback params",e,t),f.default.perf.debug("CallSpawn","Initial launcher callback",t),e)return r(e,t.data),f.default.system.error("LauncherClient.callSpawn",e);t.data.windowIdentifier.name=t.data.windowIdentifier.windowName;var i=t.data;if(i.windowDescriptor.native)return r(e,i);const o=i.windowIdentifier,{wrap:s}=await h.FinsembleWindow.getInstance({name:o.windowName});i.finWindow=s;const a=`Finsemble.${i.windowIdentifier.windowName}.componentReady`,u=n.routerClient.subscribe(a,(t,o)=>{if(t)return f.default.system.error(t);o&&0===Object.keys(o.data).length||(f.default.perf.debug("CallSpawn","stop"),r(e,i),n.routerClient.unsubscribe(u))})})})}getMonitor(e,t=Function.prototype){f.default.system.warn("This method is deprecated and will be removed in a future release. Method getMonitorInfo should be used instead.");return c.default.args(t,"function="),this.getMonitorInfo({windowIdentifier:e},t)}getMyWindowIdentifier(e=Function.prototype){c.default.args(e,"function=");return new Promise(t=>{l.getMyWindowIdentifier(n=>{e(n),t(n)})})}getActiveDescriptors(e=Function.prototype){c.default.args(e,"function=");return new Promise(t=>{this.routerClient.query("Launcher.getActiveDescriptors",{},(n,i)=>{n&&f.default.system.error(n),e(n,i.data),t({err:n,data:i.data})})})}getActiveAndPendingWindowNames(e=Function.prototype){return new Promise(t=>{this.routerClient.query("Launcher.getActiveAndPendingWindowNames",{},(n,i)=>{n&&f.default.system.error(n),e(n,i.data),t({err:n,data:i.data})})})}async getPendingWindows(){const{err:e,response:t}=await this.routerClient.query("Launcher.getPendingWindows",{});return e&&f.default.system.error("Error retrieving pending windows:",e),{err:e,data:t.data}}addUserDefinedComponent(e,t=Function.prototype){c.default.args(t,"function=");return new Promise(n=>{this.routerClient.query("Launcher.userDefinedComponentUpdate",{type:"add",name:e.name,url:e.url},(e,i)=>{t(e,i.data),n({err:e,data:i.data})})})}removeUserDefinedComponent(e,t=Function.prototype){c.default.args(t,"function=");return new Promise(n=>{this.routerClient.query("Launcher.userDefinedComponentUpdate",{type:"remove",name:e.name,url:e.url},(e,i)=>{t(e,i.data),n({err:e,data:i.data})})})}getComponentsThatCanReceiveDataTypes(e,t=Function.prototype){c.default.args(t,"function=");return new Promise(n=>{if(!e||!e.dataTypes){const e="Invalid params. Expected: {dataTypes: string[]}";return t(e),n({err:e})}Array.isArray(e.dataTypes)||(e.dataTypes=[e.dataTypes]),this.routerClient.query("LauncherService.getComponentsThatCanReceiveDataTypes",e,(e,i)=>{t(e,i.data),n({err:e,data:i.data})})})}bringWindowsToFront(e={},t=Function.prototype){return c.default.args(t,"function="),e.windowList&&!Array.isArray(e.windowList)&&(e.windowList=[e.windowList]),e.groupName&&c.default.args(e.groupName,"string"),e.componentType&&c.default.args(e.componentType,"string"),this.routerClient.query("LauncherService.bringWindowsToFront",e,(e,n)=>{t(e,n)}),Promise.resolve()}hyperFocus(e,t=Function.prototype){return f.default.system.warn("hyperFocus is deprecated as of version 4.0.0. This functionality may be removed in a future release"),console.warn("hyperFocus is deprecated as of version 4.0.0. This functionality may be removed in a future release"),c.default.args(t,"function="),e.windowList&&!Array.isArray(e.windowList)&&(e.windowList=[e.windowList]),e.windowList||e.groupName||e.componentType||(e.windowList=[this.myWindowIdentifier]),e.groupName&&c.default.args(e.groupName,"string"),e.componentType&&c.default.args(e.componentType,"string"),this.routerClient.transmit("LauncherService.hyperFocus",e),t(),Promise.resolve()}minimizeWindows(e,t=Function.prototype){return c.default.args(t,"function="),e.windowList&&!Array.isArray(e.windowList)&&(e.windowList=[e.windowList]),e.groupName&&c.default.args(e.groupName,"string"),e.componentType&&c.default.args(e.componentType,"string"),this.routerClient.transmit("LauncherService.minimizeWindows",e),t(),Promise.resolve()}createWindowGroup(e,t=Function.prototype){c.default.args(t,"function="),e.windowList&&!Array.isArray(e.windowList)&&(e.windowList=[e.windowList],delete e.groupName),c.default.args(e.groupName,"string");return new Promise(n=>{if(!e.groupName){const e="Invalid Parameters";return n({err:e}),void t(e)}this.routerClient.query("LauncherService.createWindowGroup",e,(e,i)=>{t(e,i),n({err:e,data:i})})})}addWindowsToGroup(e,t=Function.prototype){c.default.args(t,"function=");return new Promise(n=>{if(!e.groupName||!e.windowList){const e="Invalid Parameters";return n({err:e}),void t(e)}e.windowList&&!Array.isArray(e.windowList)&&(e.windowList=[e.windowList]),c.default.args(e.groupName,"string"),this.routerClient.query("LauncherService.addWindowsToGroup",e,(e,i)=>{t(e,i),n({err:e,data:i})})})}removeWindowsFromGroup(e,t=Function.prototype){c.default.args(t,"function=");return new Promise(n=>{if(!e.groupName||!e.windowList){const e="Invalid Parameters";return n({err:e}),void t(e)}e.windowList&&!Array.isArray(e.windowList)&&(e.windowList=[e.windowList]),this.routerClient.query("LauncherService.removeWindowsFromGroup",e,(e,i)=>{t(e,i),n({err:e,data:i})})})}getGroupsForWindow(e,t=Function.prototype){c.default.args(t,"function="),"function"==typeof e&&(t=e,e=null);return new Promise(n=>{e&&e.windowIdentifier?this.routerClient.query("LauncherService.getGroupsForWindow",e,(e,i)=>{n({err:e,data:i.data}),t(e,i.data)}):this.windowClient.getComponentState({field:"finsemble:windowGroups"},(e,i)=>{n({err:e,data:i}),t(e,i)})})}addToGroups(e,t=Function.prototype){c.default.args(t,"function="),c.default.args(e.groupNames,"array"),e.windowIdentifier||(e.windowIdentifier=this.myWindowIdentifier);return new Promise(n=>{this.routerClient.query("LauncherService.addWindowToGroups",e,(e,i)=>{t(e,i),n({err:e,data:i})})})}_createWrap(e,t){this.routerClient.query("LauncherService.createWrap",e,t)}start(e){const t=this;if(void 0!==p.FSBL){function n(){t.routerClient.subscribe("Finsemble.LauncherService.updateGroups."+t.windowName,(e,n)=>{Array.isArray(n.data)&&t.windowClient.setComponentState({field:"finsemble:windowGroups",value:n.data})})}p.FSBL.addEventListener("onReady",()=>{t.windowClient.onReady(()=>{t.windowClient.getComponentState({field:"finsemble:windowGroups"},(e,i)=>{if(!e&&i)return t.addToGroups({groupNames:i},n);n()})})})}setInterval(()=>{t.routerClient.transmit("Finsemble.heartbeat",{type:"component",windowName:t.windowName,componentType:"finsemble",isBrowserView:d.System.isBrowserView()})},1e3),this.getMyWindowIdentifier(n=>{t.myWindowIdentifier=n,e&&e()})}}let y;function w(e){return(e=e||{}).windowClient||(e.windowClient=u.default),new m({clients:e,onReady(e){f.default.system.debug("launcherClient ready",window.name),f.default.perf.debug("LauncherClientReadyTime","stop"),y.start(e)},name:"launcherClient"})}y=w(),y.constructInstance=w,t.default=y},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,l=[],c=!1,d=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=a(f);c=!0;for(var t=l.length;t;){for(u=l,l=[];++d<t;)u&&u[d].run();d=-1,t=l.length}u=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(8)),o=i(n(1)),s=n(64),a=n(40),u=n(65);const l=new class{publishBootStatus(e,t,n){console.log("publishStartingStatus",e,n),o.default.system.debug("publishBootStatus",e,t,n),r.default.publish(u.statusChannel(e),{name:e,type:t,state:n})}waitForBootStage(e,t,n=Function.prototype){return new Promise((i,u)=>{o.default.system.debug("SystemManagerClient.waitForBootStage entry",e,t);const l=s.ALL_BOOT_STAGES.indexOf(e);"microkernel"===e&&"stageEntered"===t&&o.default.system.error("Cannot wait on `stageEntered` for microkernel because router isn't up yet. So will instead wait for microkernal stage complete.");const c=r.default.subscribe(a.STAGE_CHANNEL,(a,d)=>{if(o.default.system.debug("SystemManagerClient.waitForBootStage new stage",d.data.stage,c),a)o.default.system.error("SystemManagerClient.waitForBootStage subscribe error",a),n(a),u(a);else if(-1===l)a="illegal stage argument",o.default.system.debug("SystemManagerClient.waitForBootStage subscribe error",a,e),n(a),u(a);else{const a=s.ALL_BOOT_STAGES.indexOf(d.data.stage);o.default.system.debug("SystemManagerClient.waitForBootStage new stage",d.data,c),"stageEntered"===t&&a+1>=l?(o.default.system.debug("SystemManagerClient.waitForBootStage stageEntered",e,c,n.name),n(),i(),r.default.unsubscribe(c)):"stageCompleted"===t&&a>=l?(o.default.system.debug("SystemManagerClient.waitForBootStage completed",e,c),n(),i(),r.default.unsubscribe(c)):o.default.system.debug(`SystemManagerClient.waitForBootStage else currentStageIndex=${a} stageIndex=${l} `,a,l,e,c)}})})}waitForStartup(e,t=Function.prototype){return new Promise((n,i)=>{o.default.system.debug("SystemManagerClient.waitForStartup."+e,e);const s=r.default.subscribe(u.statusChannel(e),(a,u)=>{o.default.system.debug("SystemManagerClient.waitForStartup subscribe",e,a,u),a?(o.default.system.error("SystemManagerClient.waitForStartup subscribe error",a),t(a),i()):u.data.name===e&&"completed"===u.data.state&&(o.default.system.debug("SystemManagerClient.waitForStartup completed",e),t(),n(),r.default.unsubscribe(s))})})}publishCheckpointState(e,t,n){console.log("publishCheckpoint",e,t,n,u.checkpointChannel(e,t)),o.default.system.debug("publishCheckpoint",e,t,n,u.checkpointChannel(e,t)),r.default.publish(u.checkpointChannel(e,t),{windowName:e,checkpointName:t,state:n})}showSystemLog(){o.default.system.debug("SystemManagerClient.showSystemLog"),r.default.transmit(a.SHOW_SYSLOG_CHANNEL,!0)}systemLog(e,t){o.default.system.debug("SystemManagerClient.systemLog",e,t),r.default.transmit(a.SYSLOG_CHANNEL,{params:e,logMessage:t})}};t.default=l},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(13),o=i(n(6)),s=n(4),a=i(n(21)),u=i(n(1));class l extends s._BaseClient{constructor(e){super(e),this.listeners=[],this.changeSub=e=>{this.subs||(this.subs={}),this.subs[e]||(this.routerClient.query("configService.addListener",e,t=>{t&&u.default.system.error("Error adding listener to config service",t),this.routerClient.subscribe(e,this.handleChanges)}),this.subs[e]=!0)},this.handleChanges=(e,t)=>{e&&u.default.system.error(e),t.data.field||(t.data.field=null);const n=t.data.storeData?t.data.storeData:t.data.value;this.triggerListeners(t.data.field?t.data.field:"configService",n)},this.triggerListeners=(e,t)=>{if(this.listeners[e])for(let n=0;n<this.listeners[e].length;n++)"function"==typeof this.listeners[e][n]?this.listeners[e][n](null,{field:e,value:t}):u.default.system.warn("ConfigClient:triggerListeners: listener is not a function",e)},this.set=(e,t)=>{u.default.system.debug("ConfigClient.Set",e),"function"==typeof e?(t=e,o.default.args(t,"function"),e={}):o.default.args(e,"object",t,"function"),this.routerClient.query("config.set",e,(e,n)=>{t(e,n?n.data:null)})},this.processAndSet=this.processAndSet.bind(this),this.getValue=this.getValue.bind(this),this.getValues=this.getValues.bind(this),this.setValue=this.setValue.bind(this),this.setValues=this.setValues.bind(this),this.removeValue=this.removeValue.bind(this),this.removeValues=this.removeValues.bind(this),this.addListener=this.addListener.bind(this),this.addListeners=this.addListeners.bind(this),this.removeListener=this.removeListener.bind(this),this.removeListeners=this.removeListeners.bind(this),this.setPreference=this.setPreference.bind(this),this.getPreferences=this.getPreferences.bind(this)}getValue(e,t=Function.prototype){"string"==typeof e&&(e={field:e});return new Promise((n,i)=>{if(!e.field){const e="no field provided";return i(e),t(e)}this.routerClient.query("configService.getValue",{field:e.field},(e,r)=>e?(i(e),t(e)):(n({err:e,data:r.data}),t(e,r.data)))})}getValues(e,t=Function.prototype){if("function"==typeof e&&(t=e,e=null),e&&!Array.isArray(e))return this.getValue(e,t);return new Promise(n=>{this.routerClient.query("configService.getValues",{fields:e},(e,i)=>e?t(e):(n({err:e,data:i.data}),t(e,i.data)))})}setValue(e,t){const n={field:e.field,value:e.value};return this.routerClient.query("configService.setValue",n,e=>t?t(e):null)}setValues(e,t){return e?Array.isArray(e)?this.routerClient.query("configService.setValues",e,e=>t?t(e):null):u.default.system.error("ConfigClient.SetValues. Params must be an array"):u.default.system.error("ConfigClient.SetValues. No params given")}removeValue(e,t=Function.prototype){if(void 0!==e){if(e.field||"string"!=typeof e)return t("no field provided");e={field:e}}return e.value=null,this.setValue(e,t)}removeValues(e,t=Function.prototype){if(!Array.isArray(e))return t("The passed in parameter needs to be an array");r.map(e,this.removeValue,(e,n)=>t(e,n))}addListener(e,t,n){let i=null;"function"==typeof e&&(t=e,e={field:i}),({field:i}=e);const r="configService"+(i?"."+i:"");return this.listeners[r]?this.listeners[r].push(t):this.listeners[r]=[t],this.changeSub(r),n?n():null}addListeners(e,t,n){if(!Array.isArray(e))return this.addListener({field:e.field},t,n);for(let n=0;n<e.length;n++){let r=null;const o=e[n];var i;"string"==typeof o?r=o:o.field&&(({field:r}=o),i=o.listener);const s="configService"+(r?"."+r:"");i||t&&"function"==typeof t&&(i=t),this.listeners[s]?this.listeners[s].push(i):this.listeners[s]=[i],this.changeSub(s)}return n?n():null}removeListener(e,t,n){let i=null;"function"==typeof e&&(n=t,t=e,e={field:i}),({field:i}=e);const r=this.name+(i?"."+i:"");if(this.listeners[r])for(let e=0;e<this.listeners[r].length;e++)if(this.listeners[r][e]===t)return this.listeners[r].pop(e),n?n(null,!0):null;return n?n(null,!1):null}removeListeners(e,t,n){if(!Array.isArray(e))return"function"==typeof e?this.removeListener({},e,n):e.field&&this.removeListener(e,t,n),n("missing fields");let i=0;for(let n=0;n<e.length;n++){let o=null;const s=e[n];var r;"string"==typeof s?o=s:s.field&&(({field:o}=s),r=e[n].listener);const a="configService"+(o?"."+o:"");if(!r){if(!t||"function"!=typeof t)continue;r=t}for(let e=0;e<this.listeners[a].length;e++)this.listeners[a][e]===r&&(this.listeners[a].pop(n),i++)}return i<e.length?n("All listeners could not be found",!1):n?n(null,!0):null}get(e,t){u.default.system.debug("ConfigClient.Get",e),u.default.system.warn("This functionality has been deprecated. It will be removed in Finsemble version 3.0. Use getValue instead.",e),1===arguments.length?(t=e,o.default.args(t,"function"),e={}):o.default.args(e,"object",t,"function"),this.routerClient.query("config.get",e,(e,n)=>{t(e,n?n.data:null)})}processAndSet(e,t){if(u.default.system.debug("ConfigClient.processAndSet",e),o.default.args(e,"object",t,"function=")&&o.default.args2("params.newConfig",e.newConfig,"object","params.overwrite",e.overwrite,"boolean=","params.replace",e.replace,"boolean="),!e.overwrite&&e.replace){const e="cannot use replace option unless overwrite is also true";u.default.system.warn("ConfigClient.processAndSet:",e),t&&t(e,null)}else this.routerClient.query("config.processAndSet",e,(e,n)=>{t&&t(e,n?n.data:null)})}setPreference(e,t){this.routerClient.query("PreferencesService.setPreference",e,(e,n)=>{t&&t(e,n?n.data:null)})}async getPreferences(e,t){u.default.system.debug("ConfigClient.getPreferences",e),"function"==typeof e&&(t=e,e=null),await a.default.waitForStartup("preferencesService"),this.routerClient.query("PreferencesService.getPreferences",e,(e,n)=>{u.default.system.debug("ConfigClient.getPreferences response",n),t&&t(e,n?n.data:null)})}}const c=new l({startupDependencies:{services:["configService"]},onReady(e){e&&e()},name:"configClient"});t.default=c},function(e,t,n){"use strict";var i=n(24),r="object"==typeof self&&self&&self.Object===Object&&self,o=i.a||r||Function("return this")();t.a=o},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(5))},function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,o=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,i){function r(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,r),i(n)},e.once("error",o)),e.once(t,r)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var r,o,s,a;if(l(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=f.bind(i);return r.listener=n,i.wrapFn=r,r}function p(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):m(r,r.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=r[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var l=u.length,c=m(u,l);for(n=0;n<l;++n)o(c[n],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,o,s;if(l(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){(function(e,n){var i="[object Arguments]",r="[object Map]",o="[object Object]",s="[object Set]",a=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[i]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l[r]=l["[object Number]"]=l[o]=l["[object RegExp]"]=l[s]=l["[object String]"]=l["[object WeakMap]"]=!1;var c="object"==typeof e&&e&&e.Object===Object&&e,d="object"==typeof self&&self&&self.Object===Object&&self,f=c||d||Function("return this")(),h=t&&!t.nodeType&&t,p=h&&"object"==typeof n&&n&&!n.nodeType&&n,g=p&&p.exports===h,m=g&&c.process,y=function(){try{return m&&m.binding&&m.binding("util")}catch(e){}}(),w=y&&y.isTypedArray;function b(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function v(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function C(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var S,_,T,A=Array.prototype,E=Function.prototype,L=Object.prototype,O=f["__core-js_shared__"],I=E.toString,M=L.hasOwnProperty,D=(S=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",k=L.toString,W=RegExp("^"+I.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=g?f.Buffer:void 0,N=f.Symbol,R=f.Uint8Array,P=L.propertyIsEnumerable,F=A.splice,x=N?N.toStringTag:void 0,B=Object.getOwnPropertySymbols,U=j?j.isBuffer:void 0,z=(_=Object.keys,T=Object,function(e){return _(T(e))}),H=ye(f,"DataView"),V=ye(f,"Map"),q=ye(f,"Promise"),$=ye(f,"Set"),G=ye(f,"WeakMap"),Y=ye(Object,"create"),Q=Ce(H),K=Ce(V),Z=Ce(q),J=Ce($),X=Ce(G),ee=N?N.prototype:void 0,te=ee?ee.valueOf:void 0;function ne(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ie(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function re(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function oe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new re;++t<n;)this.add(e[t])}function se(e){var t=this.__data__=new ie(e);this.size=t.size}function ae(e,t){var n=Te(e),i=!n&&_e(e),r=!n&&!i&&Ae(e),o=!n&&!i&&!r&&Me(e),s=n||i||r||o,a=s?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],u=a.length;for(var l in e)!t&&!M.call(e,l)||s&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ve(l,u))||a.push(l);return a}function ue(e,t){for(var n=e.length;n--;)if(Se(e[n][0],t))return n;return-1}function le(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":x&&x in Object(e)?function(e){var t=M.call(e,x),n=e[x];try{e[x]=void 0;var i=!0}catch(e){}var r=k.call(e);i&&(t?e[x]=n:delete e[x]);return r}(e):function(e){return k.call(e)}(e)}function ce(e){return Ie(e)&&le(e)==i}function de(e,t,n,a,u){return e===t||(null==e||null==t||!Ie(e)&&!Ie(t)?e!=e&&t!=t:function(e,t,n,a,u,l){var c=Te(e),d=Te(t),f=c?"[object Array]":be(e),h=d?"[object Array]":be(t),p=(f=f==i?o:f)==o,g=(h=h==i?o:h)==o,m=f==h;if(m&&Ae(e)){if(!Ae(t))return!1;c=!0,p=!1}if(m&&!p)return l||(l=new se),c||Me(e)?pe(e,t,n,a,u,l):function(e,t,n,i,o,a,u){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new R(e),new R(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Se(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case r:var l=v;case s:var c=1&i;if(l||(l=C),e.size!=t.size&&!c)return!1;var d=u.get(e);if(d)return d==t;i|=2,u.set(e,t);var f=pe(l(e),l(t),i,o,a,u);return u.delete(e),f;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,f,n,a,u,l);if(!(1&n)){var y=p&&M.call(e,"__wrapped__"),w=g&&M.call(t,"__wrapped__");if(y||w){var b=y?e.value():e,S=w?t.value():t;return l||(l=new se),u(b,S,n,a,l)}}if(!m)return!1;return l||(l=new se),function(e,t,n,i,r,o){var s=1&n,a=ge(e),u=a.length,l=ge(t).length;if(u!=l&&!s)return!1;var c=u;for(;c--;){var d=a[c];if(!(s?d in t:M.call(t,d)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var h=!0;o.set(e,t),o.set(t,e);var p=s;for(;++c<u;){d=a[c];var g=e[d],m=t[d];if(i)var y=s?i(m,g,d,t,e,o):i(g,m,d,e,t,o);if(!(void 0===y?g===m||r(g,m,n,i,o):y)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var w=e.constructor,b=t.constructor;w==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,a,u,l)}(e,t,n,a,de,u))}function fe(e){return!(!Oe(e)||function(e){return!!D&&D in e}(e))&&(Ee(e)?W:a).test(Ce(e))}function he(e){if(n=(t=e)&&t.constructor,i="function"==typeof n&&n.prototype||L,t!==i)return z(e);var t,n,i,r=[];for(var o in Object(e))M.call(e,o)&&"constructor"!=o&&r.push(o);return r}function pe(e,t,n,i,r,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var l=o.get(e);if(l&&o.get(t))return l==t;var c=-1,d=!0,f=2&n?new oe:void 0;for(o.set(e,t),o.set(t,e);++c<a;){var h=e[c],p=t[c];if(i)var g=s?i(p,h,c,t,e,o):i(h,p,c,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!b(t,(function(e,t){if(s=t,!f.has(s)&&(h===e||r(h,e,n,i,o)))return f.push(t);var s}))){d=!1;break}}else if(h!==p&&!r(h,p,n,i,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function ge(e){return function(e,t,n){var i=t(e);return Te(e)?i:function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}(i,n(e))}(e,De,we)}function me(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function ye(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return fe(n)?n:void 0}ne.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},ne.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ne.prototype.get=function(e){var t=this.__data__;if(Y){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return M.call(t,e)?t[e]:void 0},ne.prototype.has=function(e){var t=this.__data__;return Y?void 0!==t[e]:M.call(t,e)},ne.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Y&&void 0===t?"__lodash_hash_undefined__":t,this},ie.prototype.clear=function(){this.__data__=[],this.size=0},ie.prototype.delete=function(e){var t=this.__data__,n=ue(t,e);return!(n<0)&&(n==t.length-1?t.pop():F.call(t,n,1),--this.size,!0)},ie.prototype.get=function(e){var t=this.__data__,n=ue(t,e);return n<0?void 0:t[n][1]},ie.prototype.has=function(e){return ue(this.__data__,e)>-1},ie.prototype.set=function(e,t){var n=this.__data__,i=ue(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},re.prototype.clear=function(){this.size=0,this.__data__={hash:new ne,map:new(V||ie),string:new ne}},re.prototype.delete=function(e){var t=me(this,e).delete(e);return this.size-=t?1:0,t},re.prototype.get=function(e){return me(this,e).get(e)},re.prototype.has=function(e){return me(this,e).has(e)},re.prototype.set=function(e,t){var n=me(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},oe.prototype.add=oe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},oe.prototype.has=function(e){return this.__data__.has(e)},se.prototype.clear=function(){this.__data__=new ie,this.size=0},se.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ie){var i=n.__data__;if(!V||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new re(i)}return n.set(e,t),this.size=n.size,this};var we=B?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var s=e[n];t(s,n,e)&&(o[r++]=s)}return o}(B(e),(function(t){return P.call(e,t)})))}:function(){return[]},be=le;function ve(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||u.test(e))&&e>-1&&e%1==0&&e<t}function Ce(e){if(null!=e){try{return I.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Se(e,t){return e===t||e!=e&&t!=t}(H&&"[object DataView]"!=be(new H(new ArrayBuffer(1)))||V&&be(new V)!=r||q&&"[object Promise]"!=be(q.resolve())||$&&be(new $)!=s||G&&"[object WeakMap]"!=be(new G))&&(be=function(e){var t=le(e),n=t==o?e.constructor:void 0,i=n?Ce(n):"";if(i)switch(i){case Q:return"[object DataView]";case K:return r;case Z:return"[object Promise]";case J:return s;case X:return"[object WeakMap]"}return t});var _e=ce(function(){return arguments}())?ce:function(e){return Ie(e)&&M.call(e,"callee")&&!P.call(e,"callee")},Te=Array.isArray;var Ae=U||function(){return!1};function Ee(e){if(!Oe(e))return!1;var t=le(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Le(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Oe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ie(e){return null!=e&&"object"==typeof e}var Me=w?function(e){return function(t){return e(t)}}(w):function(e){return Ie(e)&&Le(e.length)&&!!l[le(e)]};function De(e){return null!=(t=e)&&Le(t.length)&&!Ee(t)?ae(e):he(e);var t}n.exports=function(e,t){return de(e,t)}}).call(this,n(5),n(20)(e))},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageClient=void 0;const r=i(n(69)),o=i(n(6)),s=i(n(1)),a=n(4),u=n(12),l=r.default(1);class c extends a._BaseClient{constructor(){super(...arguments),this.clientReady=!1,this.delete=this.remove}setUser(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),o.default.args(e.user,"string",t,"function="),this.routerClient.query("Storage.setUser",{user:e.user},(n,i)=>{(n?s.default.system.error:s.default.system.info)("APPLICATION LIFECYCLE:StorageClient.setUser",e,n,i),t&&t(n,i.data)})}setStore(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),o.default.args(e.topic,"string",e.dataStore,"string=",t,"function="),s.default.system.log("APPLICATION LIFECYCLE:StorageClient.setStore",e,t),this.routerClient.query("Storage.setStore",e,(e,n)=>{(e?s.default.system.error:s.default.system.info)("Storage.setStore",e,n),t&&t(e,n.data)})}save(e,t){if(this.clientReady||s.default.system.error("storageClient invoked before ready"),"string"!=typeof e.key||"string"!=typeof e.topic)throw new Error("Values for key and topic must be strings.");return new Promise((n,i)=>{o.default.args(e.topic,"string",e.key,"string",e.value,"any",t,"function="),this.routerClient.query("Storage.save",e,(e,r)=>{(e?s.default.system.error:s.default.system.info)("Storage.save",e,r),t&&t(e,r.data),e?i({err:e,data:null}):n({err:e,data:r.data})})})}save1(e){return l(()=>this.save(e))}get(e,t){if(this.clientReady||s.default.system.error("storageClient invoked before ready"),"string"!=typeof e.key||"string"!=typeof e.topic)throw new Error("Values for key and topic must be strings.");return new Promise((n,i)=>{o.default.args(e.topic,"string",e.key,"string",t,"function="),this.routerClient.query("Storage.get",e,(e,r)=>{if(e)return s.default.system.error("Storage.get",e,r),t&&t(e,r?r.data:null),i(e,r?r.data:null);s.default.system.info("Storage.get",e,r),t&&t(e,r.data),n(r.data)})})}get1(e,t){return l(()=>this.get(e,t))}async updateStorage(e){const{topic:t,key:n,updateFn:i}=e,r=await this.get({topic:t,key:n});return await this.save({topic:t,key:n,value:i(r)})}updateStorage1(e){return l(()=>this.updateStorage(e))}keys(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),o.default.args(e.topic,"string",t,"function="),s.default.system.debug("StorageClient.keys",e,t),this.routerClient.query("Storage.keys",e,(e,n)=>{(e?s.default.system.error:s.default.system.info)("Storage.keys",e,n),t&&t(e,n.data)})}keys1(e){return l(()=>u.promisify(this.keys.bind(this))(e))}getMultiple(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),s.default.system.info("StorageClient.getMultiple",e,t),this.routerClient.query("Storage.getMultiple",e,(n,i)=>{(n?s.default.system.error:s.default.system.info)("StorageClient.getMultiple:",e,i),t&&t(n,i)})}remove(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready");return new Promise((n,i)=>{o.default.args(e.topic,"string",e.key,"string",t,"function="),this.routerClient.query("Storage.delete",e,(e,r)=>{(e?s.default.system.error:s.default.system.info)("StorageClient.delete",e,r),t&&t(e,r.data),e?i({err:e,data:null}):n({err:e,data:r.data})})})}remove1(e){return l(()=>this.remove(e))}clearCache(e){s.default.system.log("StorageClient.clearCache",e),this.routerClient.query("Storage.clearCache",null,(t,n)=>{(t?s.default.system.error:s.default.system.info)("StorageClient.clearCache",t,n),e&&e(t,n.data)})}}t.StorageClient=c;var d=new c({onReady(e){e&&e(),d.clientReady=!0},name:"storageClient"});t.default=d},function(e,t,n){"use strict";(function(e,i){var r,o=n(2);r=o.c?e.nextTick:o.d?i:o.b,t.a=Object(o.e)(r)}).call(this,n(19),n(31).setImmediate)},function(e,t,n){"use strict";(function(e){var i=n(24),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=r&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===r&&i.a.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();t.a=a}).call(this,n(30)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(48),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(5))},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FSBLDependencyManagerSingleton=t.FSBLDependencyManager=void 0;const r=n(25),o=i(n(8)),s=n(14),a=i(n(21)),u=i(n(1));class l extends r.EventEmitter{constructor(e){super(),this.callback=e.callback,this.dependencies=e.dependencies,this.startupTimer=null,this.setStartupTimer=this.setStartupTimer.bind(this),this.clearStartupTimer=this.clearStartupTimer.bind(this),this.setStartupTimer()}clearStartupTimer(){clearTimeout(this.startupTimer),delete this.startupTimer}setStartupTimer(){const e=this;this.startupTimer=+setTimeout(()=>{e.emit("timeout")},1e4)}}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}class d{constructor(){this.servicesAreAllOnline={},this.clientsAreAllOnline={},this.onlineClients=[],this.dependencies={},this.startupTimers={},this.startupTimerFired=!1,this.bindCorrectContext()}waitFor(e,t){const n=c();e.clients||(e.clients=[]),e.clients.length&&(e.clients=e.clients.map(e=>e.charAt(0).toLowerCase()+e.slice(1)));const i=new l({dependencies:e,callback:t});return i.on("timeout",()=>{this.onDependencyTimeout(i)}),this.dependencies[n]=i,this.checkDependencies(),i}onDependencyTimeout(e){const t=this.getOfflineClients();let n="APPLICATION LIFECYCLE:STARTUP:Dependency not online after 10 seconds.";t.length&&(n=`${n} Waiting for these clients: ${t.join(", ")}.`),e.emit("err",n)}checkDependencies(){for(const e in this.dependencies){const t=this.dependencies[e],{dependencies:n,callback:i}=t;(!n.clients.length||this.clientsAreAllOnline[e]||(this.clientsAreAllOnline[e]=this.checkClients(n.clients),this.clientsAreAllOnline[e]))&&(delete this.dependencies[e],t.clearStartupTimer(),i&&i())}}getOfflineClients(){let e=[];for(const t in this.dependencies){const{dependencies:n}=this.dependencies[t];e=e.concat(n.clients.filter(e=>!this.onlineClients.includes(e)))}return e.filter((t,n)=>e.indexOf(t)===n)}checkClients(e){return e.every(e=>this.onlineClients.includes(e))}setClientOnline(e){this.onlineClients.includes(e)||(this.onlineClients.push(e),this.checkDependencies())}getOnlineClients(){return this.onlineClients}bindCorrectContext(){this.checkDependencies=this.checkDependencies.bind(this),this.checkClients=this.checkClients.bind(this),this.getOfflineClients=this.getOfflineClients.bind(this),this.onDependencyTimeout=this.onDependencyTimeout.bind(this),this.waitFor=this.waitFor.bind(this)}}class f{constructor(){this.offlineServices=[],this.dependencies={},this.checkDependencies=this.checkDependencies.bind(this)}waitFor(e,t){u.default.system.debug("DependencyManager:waitFor",e),e.services||(e.services=[]);const n=c();this.dependencies[n]={dependencies:e,callback:t}}checkDependencies(){if(console.debug("checkDependencies",this.dependencies),Object.keys(this.dependencies))for(const e in this.dependencies){const{dependencies:t,callback:n}=this.dependencies[e];if(u.default.system.debug("DependencyManager:checkDependency",t.services,this.offlineServices),t.services.length){if(!this.checkServices(t.services))continue}console.debug("checkDependencies callback"),delete this.dependencies[e],n&&n()}}checkServices(e){return e.every(e=>this.offlineServices.includes(e))}setServiceOffline(e){u.default.system.debug("setServiceOffline",e),console.debug("setServiceOffline",e),this.offlineServices.push(e),this.checkDependencies()}}class h extends r.EventEmitter{constructor(){super(),this.startup=new d,this.shutdown=new f,this.RouterClient=o.default,this.AuthorizationCompleted=!1,this.bindCorrectContext(),this.onAuthorizationCompleted(this.startup.checkDependencies),o.default.onReady(this.listenForServices)}bindCorrectContext(){this.listenForServices=this.listenForServices.bind(this),this.onAuthorizationCompleted=this.onAuthorizationCompleted.bind(this)}setClientOnline(e){this.startup.setClientOnline(e)}onServiceStateChange(e){Object.keys(e).forEach(t=>{const{state:n}=e[t];"closed"===n&&this.shutdown.setServiceOffline(t)})}listenForServices(){u.default.system.debug("DependencyManager:listenForServices before wait"),a.default.waitForBootStage("kernel","stageEntered",()=>{u.default.system.debug("DependencyManager:listenForServices after wait"),this.RouterClient.subscribe(s.SERVICES_STATE_CHANNEL,(e,t)=>{u.default.system.debug("DependencyManager:listenForServices SERVICES_STATE_CHANNEL",t.data),this.onServiceStateChange(t.data)}),this.RouterClient.addListener(s.SERVICE_CLOSED_CHANNEL,(e,t)=>{u.default.system.debug("DependencyManager:listenForServices SERVICE_CLOSED_CHANNEL",t.data);const n={};n[t.data.name]={state:"closed"},this.onServiceStateChange(n)}),this.RouterClient.subscribe(s.APPLICATION_STATE_CHANNEL,(e,t)=>{switch(t.data.state){case"authenticated":case"ready":break;case"closing":this.shutdown.checkDependencies()}})})}onAuthorizationCompleted(e){this.AuthorizationCompleted?e():this.addListener("AuthorizationCompleted",e)}}t.FSBLDependencyManager=h,t.FSBLDependencyManagerSingleton=new h,t.default=t.FSBLDependencyManagerSingleton},function(e,t,n){var i=n(34),r=n(35),o=i(),s=[1|o[0],o[1],o[2],o[3],o[4],o[5]],a=16383&(o[6]<<8|o[7]),u=0,l=0;e.exports=function(e,t,n){var i=t&&n||0,o=t||[],c=void 0!==(e=e||{}).clockseq?e.clockseq:a,d=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:l+1,h=d-u+(f-l)/1e4;if(h<0&&void 0===e.clockseq&&(c=c+1&16383),(h<0||d>u)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=d,l=f,a=c;var p=(1e4*(268435455&(d+=122192928e5))+f)%4294967296;o[i++]=p>>>24&255,o[i++]=p>>>16&255,o[i++]=p>>>8&255,o[i++]=255&p;var g=d/4294967296*1e4&268435455;o[i++]=g>>>8&255,o[i++]=255&g,o[i++]=g>>>24&15|16,o[i++]=g>>>16&255,o[i++]=c>>>8|128,o[i++]=255&c;for(var m=e.node||s,y=0;y<6;++y)o[i+y]=m[y];return t||r(o)}},function(e,t,n){(function(t){var n,i=t.crypto||t.msCrypto;if(i&&i.getRandomValues){var r=new Uint8Array(16);n=function(){return i.getRandomValues(r),r}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=n}).call(this,n(5))},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]}},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LocalLogger=void 0;const{debug:i,warn:r,log:o,error:s}=console,a=()=>{},u=a,l={warn:r,info:a,log:o,debug:i,error:s,verbose:u},c={Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0,Verbose:!0,LocalOnly:!1},d={console:{Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0},dev:c,system:c,perf:c};function f(e){return"logger.service.logMessages"===e}t.LocalLogger=class{constructor(){this.start=()=>{},this.isLogMessage=f,this.setting=()=>d,this.callStack=()=>function(){const{stack:e}=function(){try{throw Error("")}catch(e){return e}}(),t=(n="\n",i=4,e.split(n,i).join(n).length);var n,i;return"Log Stack: \n"+e.substring(t).substr(1)}(),this.unregisterClient=()=>{},this.setRouterClient=()=>{},this.warn=r,this.info=a,this.log=o,this.debug=i,this.error=s,this.verbose=u,this.system=l,this.perf=l}}},function(e,t,n){var i=n(33),r=n(60),o=r;o.v1=i,o.v4=r,e.exports=o},function(e,t,n){(function(t){var n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/,r=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=/^\[object .+?Constructor\]$/,u="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,c=u||l||Function("return this")();var d,f=Array.prototype,h=Function.prototype,p=Object.prototype,g=c["__core-js_shared__"],m=(d=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",y=h.toString,w=p.hasOwnProperty,b=p.toString,v=RegExp("^"+y.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=c.Symbol,S=f.splice,_=j(c,"Map"),T=j(Object,"create"),A=C?C.prototype:void 0,E=A?A.toString:void 0;function L(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function O(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function I(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function M(e,t){for(var n,i,r=e.length;r--;)if((n=e[r][0])===(i=t)||n!=n&&i!=i)return r;return-1}function D(e,t){for(var r,o=0,s=(t=function(e,t){if(F(e))return!1;var r=typeof e;if("number"==r||"symbol"==r||"boolean"==r||null==e||B(e))return!0;return i.test(e)||!n.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:F(r=t)?r:N(r)).length;null!=e&&o<s;)e=e[R(t[o++])];return o&&o==s?e:void 0}function k(e){return!(!x(e)||(t=e,m&&m in t))&&(function(e){var t=x(e)?b.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?v:a).test(function(e){if(null!=e){try{return y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function W(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function j(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return k(n)?n:void 0}L.prototype.clear=function(){this.__data__=T?T(null):{}},L.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},L.prototype.get=function(e){var t=this.__data__;if(T){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return w.call(t,e)?t[e]:void 0},L.prototype.has=function(e){var t=this.__data__;return T?void 0!==t[e]:w.call(t,e)},L.prototype.set=function(e,t){return this.__data__[e]=T&&void 0===t?"__lodash_hash_undefined__":t,this},O.prototype.clear=function(){this.__data__=[]},O.prototype.delete=function(e){var t=this.__data__,n=M(t,e);return!(n<0)&&(n==t.length-1?t.pop():S.call(t,n,1),!0)},O.prototype.get=function(e){var t=this.__data__,n=M(t,e);return n<0?void 0:t[n][1]},O.prototype.has=function(e){return M(this.__data__,e)>-1},O.prototype.set=function(e,t){var n=this.__data__,i=M(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},I.prototype.clear=function(){this.__data__={hash:new L,map:new(_||O),string:new L}},I.prototype.delete=function(e){return W(this,e).delete(e)},I.prototype.get=function(e){return W(this,e).get(e)},I.prototype.has=function(e){return W(this,e).has(e)},I.prototype.set=function(e,t){return W(this,e).set(e,t),this};var N=P((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(B(e))return E?E.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var n=[];return r.test(e)&&n.push(""),e.replace(o,(function(e,t,i,r){n.push(i?r.replace(s,"$1"):t||e)})),n}));function R(e){if("string"==typeof e||B(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function P(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=e.apply(this,i);return n.cache=o.set(r,s),s};return n.cache=new(P.Cache||I),n}P.Cache=I;var F=Array.isArray;function x(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function B(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==b.call(e)}e.exports=function(e,t,n){var i=null==e?void 0:D(e,t);return void 0===i?n:i}}).call(this,n(5))},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(1)),o=n(11),s=n(3),a=i(n(21));
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
let u=null;var l=new function(){const e={},t={};let i=null;this.getDefaultTemplateURL=function(e){i?setTimeout(()=>{e(i)},0):(u||(u=n(22).default),u.get({field:"finsemble"},(t,n)=>{i=o.ConfigUtilInstance.getDefault(n,"finsemble.notificationURL",n.moduleRoot+"/components/system/notification/notification.html"),e(i)}))},this.alert=function(e,t,n,i,r){const o=this;r&&r.url?this.alertInternal(e,t,n,i,r,r.url):this.getDefaultTemplateURL(s=>{o.alertInternal(e,t,n,i,r,s)})},this.alertInternal=function(n,i,o,u,l,c){let d=!1;const f="UserNotification.alert."+o,h=(l=l||{}).duration||864e5;switch(i){case"ONCE-SINCE-STARTUP":f in e?d=!1:(d=!0,e[f]=!0);break;case"MAX-COUNT":{let e=0;const n=l.maxCount||1;f in t&&(e=t[f]),t[f]=++e,e<=n&&(d=!0);break}default:d=!0}if(r.default.log("UserNotification.alert",n,d,i,o,u,l),d){const e={url:c,message:u,timeout:h};a.default.systemLog({notification:!0},"Notification: "+u),new s.System.Notification(e)}}};t.default=l,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHECKPOINT_CHANNEL_BASE=t.STAGE_CHANNEL=t.STATUS_CHANNEL_BASE=t.SHOW_SYSLOG_CHANNEL=t.SYSLOG_CHANNEL=t.CRITICAL_BOOT_STAGES=t.ALL_BOOT_STAGES=void 0,t.ALL_BOOT_STAGES=["microkernel","kernel","authentication","preuser","earlyuser","user"],t.CRITICAL_BOOT_STAGES=["microkernel","kernel","authentication"],t.SYSLOG_CHANNEL="systemManager.systemlog",t.SHOW_SYSLOG_CHANNEL="systemManager.showSystemlog",t.STATUS_CHANNEL_BASE="systemManager.boot.status",t.STAGE_CHANNEL="systemManager.boot.stage",t.CHECKPOINT_CHANNEL_BASE="systemManager.checkpoint"},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(8)),o=i(n(1)),s=i(n(66));t.default=class{constructor(e){this.eventList=[],this.eventHandlerMap={},this.eventGuidMap={},this.name=e.name,this.sourceType=e.sourceType,window.addEventListener("beforeunload",()=>{this.cleanup()})}addListener(e,t){return this.addEventListener(e,t)}removeListener(e,t){return this.removeEventListener(e,t)}addEventListener(e,t){if(!t)return console.error("no handler",e);if(o.default.system.debug("addEventListener:",e),this.eventHandlerMap[e]||(this.eventHandlerMap[e]=[],this.eventGuidMap[e]=[]),!this.eventHandlerMap[e].includes(t)){const n=`${window.name}_public_${Date.now()}_${Math.random()}`;this.eventHandlerMap[e].push(t),this.eventGuidMap[e].push(n),r.default.transmit("Finsemble.RegisterInterruptibleEvent."+this.name,{event:e,listenerGuid:n}),r.default.addResponder("Finsemble.Interrupt."+n,(i,r)=>{new s.default({source:this.name,sourceType:this.sourceType,listenerGuid:n,handler:t,event:e},r)})}}removeEventListener(e,t){if(o.default.system.debug("removeEventListener:",e),!this.eventHandlerMap[e])return o.default.system.warn("not found");let n=this.eventHandlerMap[e].indexOf(t);if(-1!==n){const t=this.eventGuidMap[e][n];this.eventHandlerMap[e].splice(n,1),this.eventGuidMap[e].splice(n,1),r.default.transmit("Finsemble.UnregisterInterruptibleEvent."+window.name,{event:e,guid:t}),r.default.removeResponder("Finsemble.Interrupt."+t)}}cleanup(){for(var e of Object.keys(this.eventHandlerMap))for(var t of this.eventHandlerMap[e])this.removeEventListener(e,t)}}},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(25),o=n(4),s=i(n(8)),a=i(n(1)),u=n(75).dictionary,l=window,c=new r.EventEmitter;function d(e,t=u){const n=[];return e.keys.forEach(e=>{if("string"!=typeof e)return a.default.system.error("FSBL.Clients.HotkeyClient - one of the keys passed into a function was not a string: ",e);e=e.toLowerCase();const i=t[e];if(!i)return a.default.system.error("FSBL.Clients.HotkeyClient - At least one of the key codes does not map to a supported key - registering hotkey unsuccessful. Unsupported keys: "+e);n.push(i)}),n}const f=function(e){this.cb=e,this.shift=!1,this.ctrl=!1,this.cmd=!1,this.capsLock=!1,this.initialize()};f.prototype.keyup=function(e){switch(e.key){case"Shift":return this.shift=!1,void this.cb({key:e.key,e:e,keystroke:this});case"Control":case"Alt":return this.ctrl=!1,void this.cb({key:e.key,e:e,keystroke:this});case"Meta":case"Win":return this.cmd=!1,void this.cb({key:e.key,e:e,keystroke:this})}this.key&&this.cb({key:this.key,e:e,keystroke:this})},f.prototype.keydown=function(e){if(!this.noKeyCapture)switch(this.key=e.key,e.key){case"Meta":case"Win":this.cmd=!0;break;case"Shift":this.shift=!0;break;case"Control":case"Alt":this.ctrl=!0;break;case"CapsLock":this.capsLock=!this.capsLock;break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"Up":case"Down":case"Left":case"Right":this.key=null,this.cb({key:e.key,e:e,keystroke:this})}},f.prototype.keypress=function(e){if(this.noKeyCapture)return;const t=e.which;t<32||t>222||(this.key=e.key)},f.prototype.initialize=function(){const e=this;document.addEventListener("keyup",t=>{e.keyup(t)}),document.addEventListener("keydown",t=>{e.downValue=t.key,e.keydown(t)}),document.addEventListener("keypress",t=>{e.keypress(t)}),window.addEventListener("blur",t=>{e.ctrl=!1,e.cb({key:"Control",e:t,keystroke:e})})};const h=[];class p extends o._BaseClient{constructor(e){super(e),this.onClose=e=>{this.removeAllHotkeys(e)},this.keyMap=u,this.listenForHotkeys=this.listenForHotkeys.bind(this),this.routerClient=s.default,this.routerClient.onReady(this.listenForHotkeys),this.localListeners={}}addLocalHotkey(e,t,n=(()=>{})){a.default.system.info("HotkeyClient.addLocalHotkey"),a.default.system.debug("HotkeyClient.addLocalHotkey, keyArr: ",e);const i=d({keys:e}).sort().toString(),r=()=>{document.hasFocus()&&t()};this.localListeners[i]||(this.localListeners[i]={}),this.localListeners[i][t]=r,c.addListener(i,r),this.routerClient.query("hotkeysService.registerGlobalHotkey",{keys:i,windowName:this.windowName},n)}addBrowserHotkey(e,t){this.KeyStroke||(this.KeyStroke=new f(e=>{const{key:t,keystroke:n}=e,i=[t];n.ctrl&&i.push("control"),n.shift&&i.push("shift"),n.alt&&i.push("alt");const r=i.sort().toString();h.forEach(e=>{e.keyString.toUpperCase()===r.toUpperCase()&&e.handler()})}));const n=d({keys:e}).sort().toString();h.push({keyString:n,handler:t})}removeLocalHotkey(e,t,n=(()=>{})){a.default.system.info("HotkeyClient.removeLocalHotkey"),a.default.system.debug("HotkeyClient.removeLocalHotkey, keyArr: ",e);const i=d({keys:e}).sort().toString(),r=this.localListeners[i][t];c.removeListener(i,r),this.routerClient.query("hotkeysService.unregisterGlobalHotkey",{keys:i,windowName:this.windowName},n)}addGlobalHotkey(e,t,n=(()=>{})){a.default.system.info("HotkeyClient.addGlobalHotkey"),a.default.system.debug("HotkeyClient.addGlobalHotkey, keyArr: ",e);const i=d({keys:e}).sort().join("+");c.addListener(i,t),this.routerClient.query("hotkeysService.registerGlobalHotkey",{keys:i,windowName:this.windowName},n)}removeGlobalHotkey(e,t,n=(()=>{})){a.default.system.info("HotkeyClient.removeGlobalHotkey"),a.default.system.debug("HotkeyClient.removeGlobalHotkey, keyArr: ",e);const i=d({keys:e}).sort().join("+");c.removeListener(i,t),this.routerClient.query("hotkeysService.unregisterGlobalHotkey",{keys:i,windowName:this.windowName},n)}listenForHotkeys(){const e=this;this.routerClient.addListener("HotkeyTriggered",(t,n)=>{t?console.error("Hotkey Channel Error: "+JSON.stringify(t)):n.data.windows.includes(e.windowName)&&c.emit(n.data.keys)})}removeAllHotkeys(e){c.removeAllListeners(),this.routerClient.query("hotkeysService.removeAllHotkeysForWindow",{windowName:this.windowName},e)}}const g=new p({onReady(e){e&&e()},name:"hotkeyClient"});l.Keystroke=f,t.default=g},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const r=n(13),o=i(n(6)),s=n(4),a=i(n(16)),u=i(n(18)),l=i(n(17)),c=i(n(1));c.default.system.debug("Starting LinkerClient");const d=c.default.system.info,f=c.default.system.debug,h=n(26);function p(e){return e.windowName.replace(/\./g,"_")}function g(e,t){return t&&t(null,e),e}class m extends s._BaseClient{constructor(e){super(e),this.stateChangeListeners=[],this.allChannels=[],this.channels={},this.clients={},this.channelListenerList=[],this.dataListenerList={},this.handleListeners=(e,t)=>{const n=this.dataListenerList[t.data.type];if(n&&n.length>0)for(let e=0;e<n.length;e++)n[e](t.data.data,{data:t.data.data,header:t.header,originatedHere:t.originatedHere})},this.onClose=e=>{const t=p(this.windowClient.getWindowIdentifier());this.clients[t]&&(this.clients[t]=null,this.updateClientInStore(t)),this.linkerStore.removeListener({field:"clients."+t},this.clientsKeyValueChangeStoreListener,(e,n)=>{n||c.default.system.warn("Linker Client Onclose: clientsKeyValueChangeStoreListener removeListener failed",t)}),this.linkerStore.removeListener({field:{}},this.anyFieldChangeStoreListener,(e,t)=>{t||c.default.system.warn("Linker Client Onclose: anyFieldChangeStoreListener removeListener failed")}),c.default.system.debug("LINKER-4 cleanup",t),e&&e()},this.groups=this.channels,this.allGroups=this.allChannels,this.onLinksUpdate={push:e=>{this.stateChangeListeners.push((t,n)=>{n&&(n.groups=n.channels),e(t,{groups:n})})}},this.linkerWindow=null,this.loading=!1,o.default.args(e,"object=")&&e&&o.default.args2("params.onReady",e.onReady,"function="),this.launcherClient=e.clients.launcherClient,this.windowClient=e.clients.windowClient,this.distributedStoreClient=e.clients.distributedStoreClient,this.clientsKeyValueChangeStoreListener=this.clientsKeyValueChangeStoreListener.bind(this),this.anyFieldChangeStoreListener=this.anyFieldChangeStoreListener.bind(this)}getChannel(e){return this.allChannels.filter(t=>t.name===e).length>0}createChannel(e,t){return d("LinkerClient.createChannel","PARAMS",e),o.default.args(e,"object"),e.name?this.getChannel(e.name)?(f(`LinkerClient.createChannel: Channel ${e.name} Already Exists`),g(this.allChannels,t)):(this.allChannels.push(e),this.allGroups=this.allChannels,this.linkerStore.setValue({field:"channels",value:this.allChannels}),g(this.allChannels,t)):(f("LinkerClient.createChannel: Name is required"),g(this.allChannels,t))}removeChannel(e,t){if(d("LinkerClient.removeChannel","NAME",e),o.default.args(e,"string"),!this.getChannel(e))return f(`Channel ${e}does not exist`,null),g(this.allChannels,t);const n=this.allChannels;for(let t=0;t<n.length;t++)if(e===n[t].name){n.splice(t,1);break}this.linkerStore.setValue({field:"channels",value:this.allChannels});const{clients:i}=this;for(const t in i){const n=i[t];for(const t in n.channels)if(e===t){delete n[t];break}}return this.linkerStore.setValue({field:"clients",value:this.clients}),g(this.allChannels,t)}updateClientInStore(e){this.linkerStore.setValue({field:"clients."+e,value:this.clients[e]})}linkToChannel(e,t,n){d("LinkerClient.linkToChannel","CHANNEL",e,"COMPONENT",t),o.default.args(e,"string",t),t||(t=this.windowClient.getWindowIdentifier());const i=p(t);if(this.clients[i]||(this.clients[i]={client:t,channels:{}}),Array.isArray(e))for(let t=0;t<e.length;t++)this.clients[i].channels[e[t]]=!0;else this.clients[i].channels[e]=!0;return this.updateClientInStore(i),g(this.getState(t),n)}unlinkFromChannel(e,t,n){d("LinkerClient.unlinkFromChannel","CHANNEL",e,"WINDOW IDENTIFIER",t),o.default.args(e,"string",t),t||(t=this.windowClient.getWindowIdentifier());const i=p(t),r=this.clients[i];if(Array.isArray(e))for(let t=0;t<e.length;t++)delete r.channels[e[t]];else if(e){if(!r||!r.channels[e]){const r=this.clients[i];return f("Component was not in specified channel "+e,r,r.channels[e]),g(this.getState(t),n)}delete r.channels[e]}else for(const e in r.channels)delete r.channels[e];return this.updateClientInStore(i),g(this.getState(t),n)}getAllChannels(e){return d("LinkerClient.getAllChannels"),g(this.allChannels,e)}getState(e,t){d("LinkerClient.getState","WINDOW IDENTIFIER",e);const n={channels:[],allChannels:this.allChannels};if(e||(e=this.windowClient.getWindowIdentifier()),!Object.keys(this.clients).length)return g(n,t);const i=p(e),r=this.clients[i];return r?(n.channels=this.allChannels.filter(e=>r.channels&&!0===r.channels[e.name]),c.default.system.debug("LINKER-3",this.allChannels,"state.channels",n.channels,"key",i,"windowIdentifier",e,"componentEntry",r),r.active||(r.active=!0,this.linkerStore.setValue({field:"clients."+i,value:r})),g(n,t)):g(n,t)}unsubscribe(e,t){d("LinkerClient.unsubscribe","DATA TYPE",e),o.default.args(e,"string"),this.dataListenerList[e]&&(t?this.dataListenerList[e]=this.dataListenerList[e].filter(e=>e!==t):delete this.dataListenerList[e])}publish(e,t){d("LinkerClient.publish","PARAMS",e),o.default.args(e.dataType,"string",e.data,"any");let{channels:n}=e;n||(n=Object.keys(this.channels));for(let t=0;t<n.length;t++){const i=n[t];this.routerClient.transmit(`${i}.${e.dataType}`,{type:e.dataType,data:e.data}),this.routerClient.transmit(i,{type:e.dataType,data:e.data})}return g({},t)}subscribe(e,t){d("LinkerClient.subscribe","DATA TYPE",e),o.default.args(e,"string",t,"function"),this.dataListenerList[e]?this.dataListenerList[e].includes(t)||this.dataListenerList[e].push(t):this.dataListenerList[e]=[t]}getLinkedComponents(e,t){d("LinkerClient.getLinkedComponents","PARAMS",e);const n=[];if(e||(e={}),e.channels&&!Array.isArray(e.channels)&&(o.default.args(e.channels,"string"),e.channels=[e.channels]),e.componentTypes&&!Array.isArray(e.componentTypes)&&(o.default.args(e.componentTypes,"string"),e.componentTypes=[e.componentTypes]),e.componentTypes&&o.default.args(e.componentTypes,"array"),e.windowIdentifier){const t=p(e.windowIdentifier),n=Object.keys(this.clients[t].channels);e.channels?e.channels=e.channels.filter(e=>n.includes(e)):e.channels=n}e.channels||(e.channels=this.getAllChannels().map(e=>e.name));for(const t in this.clients){let i=this.clients[t];if(!i)continue;i.channels||(i=i[Object.keys(i)[0]]);const r=Object.keys(i.channels).filter(t=>e.channels.includes(t)).length;let o=!0;e.componentTypes&&(o=e.componentTypes.includes(i.client.componentType)),i.active&&r&&o&&n.push({windowName:i.client.windowName,componentType:i.client.componentType,uuid:i.client.uuid,channels:Object.keys(i.channels)})}return g(n,t)}updateListeners(){for(let e=this.channelListenerList.length-1;e>=0;e--){const t=this.channelListenerList[e];Object.keys(this.channels).filter(e=>e==t).length||(this.routerClient.removeListener(t,this.handleListeners),this.channelListenerList.splice(e,1))}const e=Object.keys(this.channels);for(let t=0;t<e.length;t++){const n=e[t];this.channelListenerList.includes(n)||(this.routerClient.addListener(n,this.handleListeners),this.channelListenerList.push(n))}const t=this.getState();for(let e=0;e<this.stateChangeListeners.length;e++)this.stateChangeListeners[e](null,t)}onStateChange(e){this.stateChangeListeners.push(e)}persistState(e){console.info("saving state",e),this.windowClient.setComponentState({field:"Finsemble_Linker",value:e})}clientsKeyValueChangeStoreListener(e,t){if(f("My Channels Updated"),!t.value)return;const n=t.value.channels||t.value.groups,i=h(n,this.channels);n&&!i&&(this.persistState(n),this.channels=n,this.updateListeners())}anyFieldChangeStoreListener(e,t){const{values:n}=t.value;this.allChannels=n.channels,n.groups&&(this.allChannels=n.groups),c.default.system.debug("LINKER-2",this.allChannels),this.allGroups=this.allChannels,this.clients=n.clients}start(e){this.dontPersistYet=!0,f("LinkerClient Loading Channels");const t=this.windowClient.getWindowIdentifier(),n=p(t);this.distributedStoreClient.getStore({store:"Finsemble_Linker",global:!0},(i,r)=>{this.linkerStore=r,r.getValues(["channels","clients."+n],(i,r)=>{r&&r.channels&&(this.allChannels=r.channels,c.default.system.debug("LINKER-1",this.allChannels),this.allGroups=this.allChannels),this.windowClient.getComponentState({field:"Finsemble_Linker"},(i,o)=>{var s;this.channels=[],this.clients[n]={client:t,active:!0,channels:{}},o?(this.channels=o,this.clients[n].channels=o):(null===(s=r["clients."+n])||void 0===s?void 0:s.channels)&&(this.clients[n].channels=r["clients."+n].channels),this.updateClientInStore(n);const a=this.windowClient.getSpawnData();if(a&&a.linker){let e=a.linker.channels;a.linker.groups&&(e=a.linker.groups),this.linkToChannel(e,t)}else this.updateListeners();e()})}),r.addListener({field:"clients."+n},this.clientsKeyValueChangeStoreListener),r.addListener({},this.anyFieldChangeStoreListener)})}hyperFocus(e){this.launcherClient.hyperFocus({windowList:this.getLinkedComponents({channels:e})})}bringAllToFront(e){const{channel:t,restoreWindows:n}=e;this.launcherClient.bringWindowsToFront({restoreWindows:n,windowList:this.getLinkedComponents({channels:t})})}createGroup(e,t){return this.createChannel(e,t)}deleteGroup(e,t){return this.removeChannel(e,t)}addToGroup(e,t,n){const i=this.linkToChannel(e,t);return n&&n(null,i),i}removeFromGroup(e,t,n){const i=this.unlinkFromChannel(e,t);return n&&n(null,i),i}getAllGroups(e){const t=this.getAllChannels();return e&&e(t),t}getGroups(e,t){const n=this.getState(e);return n.groups=n.channels,g(n,t)}unSubscribe(e,t){this.unsubscribe(e,t)}getLinkedWindows(e,t){return e||(e={}),e.groups=e.channels,e.windowIdentifier=e.client,this.getLinkedComponents(e,t)}windowIdentifier(e,t){return g(this.windowClient.getWindowIdentifier(),t)}openLinkerWindow(e){if(o.default.args(e,"function"),this.loading)return;const t=()=>{this.routerClient.query("Finsemble.LinkerWindow.Show",{groups:this.getGroups().groups,windowIdentifier:this.windowClient.getWindowIdentifier(),windowBounds:this.windowClient.getWindowBounds()},()=>{})};this.linkerWindow?this.linkerWindow.isShowing(e=>{e?this.linkerWindow.hide():t()}):t()}}function y(e){return(e=e||{}).windowClient||(e.windowClient=a.default),e.launcherClient||(e.launcherClient=u.default),e.distributedStoreClient||(e.distributedStoreClient=l.default),new m({clients:e,startupDependencies:{clients:["windowClient","distributedStoreClient","launcherClient"]},onReady(t){f("Linker onReady"),setTimeout(()=>{r.parallel([e=>{w.start(e)},t=>{e.launcherClient.onReady(t)}],t)},0)},name:"linkerClient"})}const w=y();w.constructInstance=y,t.default=w},function(e,t,n){"use strict";(function(e){var i=n(23),r=n(45),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?i.a.Buffer:void 0,u=(a?a.isBuffer:void 0)||r.a;t.a=u}).call(this,n(30)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t,n){e.exports=n(47)},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const a=n(13),u=n(32),l=n(3),c=n(15),d=s(n(39)),f=o(n(14)),h=s(n(73)),p=n(11),g=o(n(9)),m=s(n(6)),y=s(n(21)),w=s(n(1)),{APPLICATION_STATE_CHANNEL:b}=f,v=window;let C;if(v.FSBLAlreadyPreloaded&&(console.error("window.FSBLAlreadyPreloaded detected. FSBL must already be loaded. Skipping initialization of FSBL."),e.exports=v.FSBL),("browser"===l.System.container||window.top===window)&&!v.FSBLAlreadyPreloaded){v.FSBLAlreadyPreloaded=!0;let t=Function.prototype,i=!1,r=!1;var S;const o=function(){const e=this;let r=[],o="offline",s="";this.clickedMailTo=!1,this.FinsembleWindow=c.FinsembleWindow,this.System=l.System,this.setWindowName=function(e){s=e},this.Utils=g,this.ConfigUtils=p.ConfigUtilInstance,this.Validate=m.default,this.UserNotification=d.default,this.SystemManagerClient=y.default,this.Clients={RouterClient:n(8).default,AuthenticationClient:n(74).default,WindowClient:n(16).default,DistributedStoreClient:n(17).default,LauncherClient:n(18).default,DragAndDropClient:n(76).default,LinkerClient:n(43).default,StorageClient:n(27).default,WorkspaceClient:n(82).default,DialogManager:n(83).default,ConfigClient:n(22).default,BaseClient:n(4).default,HotkeyClient:n(42).default,SearchClient:n(84).default,NotificationClient:n(85).default,Logger:n(1).default},this.displayStartupTimeoutError=!0,this.getFSBLInfo=function(t){return new Promise((n,i)=>{"online"===o?e.Clients.ConfigClient.getValue({field:"finsemble"},(e,i)=>{const r={FSBLVersion:i.system.FSBLVersion,gitHash:i.system.gitHash};t&&t(r),n(r)}):i("FSBL Not initialized")})},this.addClient=function(e,t){this.Clients[e]||(this.Clients[e]=t)},this.useClients=function(e){r=e.map(e=>e.charAt(0).toUpperCase()+e.slice(1)),S.Clients.Logger.system.log("COMPONENT LIFECYCLE:STARTUP:Using a subset of Finsemble clients for startup:",e),u.FSBLDependencyManagerSingleton.startup.waitFor({clients:e},this.setFSBLOnline)},this.useAllClients=function(){r=[];const e=[];for(let t in this.Clients)if(-1===r.indexOf(t)){if(!this.Clients[t].initialize)continue;r.push(t),t=t.charAt(0).toLowerCase()+t.slice(1),e.push(t)}this.dependencyManager=u.FSBLDependencyManagerSingleton,u.FSBLDependencyManagerSingleton.startup.waitFor({clients:e},this.setFSBLOnline)},this.isInitialized=!1,this.isinitialized=this.isInitialized,this.initialize=function(e){if(console.log("FSBL.initialize called"),this.Clients.Logger.log("WINDOW LIFECYCLE:STARTUP: FSBL.initialized invoked in "+C.name),i)if(this.isInitialized)e&&this.addEventListener("onReady",e);else{this.isInitialized=!0,e&&this.addEventListener("onReady",e);for(let e=0;e<r.length;e++)this.Clients[r[e]].windowName=s,console.log("Initializing",r[e]),this.Clients[r[e]].initialize()}else t=e||Function.prototype},this.setFSBLOnline=function(){if(console.log("FSBL Online"),v.FSBLIsSetOnline)return void S.Clients.Logger.error("Detected window.FSBLIsSetOnline assertion. Stopping onReady from being fired twice.");if(v.FSBLIsSetOnline=!0,this.Clients.DataTransferClient=S.Clients.DragAndDropClient,clearTimeout(void 0),o="online",this.isOnline=!0,this.isInitializing=!1,document.getElementsByTagName("html")[0].classList.add("finsemble"),this.listeners.onReady){for(let e=0;e<this.listeners.onReady.length;e++)this.listeners.onReady[e]();this.listeners.onReady=[]}S.Clients.Logger.debug("WINDOW LIFECYCLE:STARTUP: FSBL Online in "+C.name),this.Clients.Logger.start(),s||alert("FAILURE: WindowName is null"),this.Clients.ConfigClient.getValue({field:"finsemble"},(e,t)=>{t.system.addFSBLWrappers&&(S.Clients.Logger.debug("WINDOW LIFECYCLE:STARTUP: Wrapping OF Calls in "+C.name),h.default(l.System.Application),h.default(l.System))}),l.System.isBrowserView()||this.Clients.RouterClient.publish(`Finsemble.${s}.componentReady`,{name:s}),S.Clients.Logger.debug("FSBL.Clients.WindowClient.options",S.Clients.WindowClient.options);const e=S.Clients.WindowClient.options.customData.component.type;this.Clients.Logger.system.log("publishBootStatus",e,"components","completed",S.Clients.WindowClient.options.customData),l.System.isBrowserView()||y.default.publishBootStatus(e,"components","completed"),window.dispatchEvent(new Event("FSBLReady"))},this.setFSBLOnline=this.setFSBLOnline.bind(this),this.listeners={},this.removeEventListener=function(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))},this.addEventListener=function(e,t){m.default.args(e,"string",t,"function"),"onReady"===e&&"online"===o?setTimeout(t,0):(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t))},this.onShutdown=function(e){this.addEventListener("onShutdown",e)},this.handleShutdown=function(){const e=this;this.listeners.onShutdown?(this.Clients.RouterClient.transmit("LauncherService.shutdownResponse",{waitForMe:!0,name:s}),a.each(this.listeners.onShutdown,(function(e,t){let n=a.asyncify(e);n=a.timeout(n,2e3),n(null,t)}),(function(t){t&&e.Clients.Logger.system.error(t),e.shutdownComplete()}))):(this.Clients.RouterClient.transmit("LauncherService.shutdownResponse",{waitForMe:!1,name:s}),this.shutdownComplete())},this.shutdownComplete=function(){this.Clients.Logger.system.debug("WINDOW LIFECYCLE:Shutdown:Complete"),this.Clients.RouterClient.transmit("LauncherService.shutdownCompleted",{name:s})},this.listenForShutdown=function(){this.Clients.Logger.system.debug("WINDOW LIFECYCLE:Startup:Listening for the application shutdown request.")},this.shutdownApplication=function(){e.Clients.RouterClient.transmit("Application.shutdown")},this.restartApplication=function(e){S.Clients.RouterClient.transmit("Application.restart",e||{})},this.windowClose=function(){for(const t in e.Clients){const n=e.Clients[t];n.onClose&&n.onClose()}for(const e in v._FSBLCache.windows){v._FSBLCache.windows[e].handleWrapRemoveRequest()}S.Clients.RouterClient.disconnectAll()}};S=new o,v.FSBL=S,S.Clients.RouterClient.ready(async()=>{if(r)return;r=!0,i=!0,S.listenForShutdown();const e=l.System.Window.getCurrent();S.Clients.RouterClient.transmit(e.name+".onSpawned",{name:e.name},{suppressWarnings:!0});try{const{wrap:n}=await c.FinsembleWindow.getInstance({name:e.name,uuid:e.uuid});v.finsembleWindow=n,C=n,S.Clients.Logger.debug("WINDOW LIFECYCLE:STARTUP: RouterReady invoked in "+n.name);const i=n.name;S.setWindowName(i);const r=S.Clients.RouterClient.subscribe(b,(e,i)=>{"authenticated"===i.data.state||"ready"===i.data.state?n.getOptions((e,n)=>{n&&n.customData&&n.customData.component&&n.customData.component.neededClients?S.useClients(n.customData.component.neededClients):S.useAllClients(),S.initialize(t)}):(S.useClients(["ConfigClient","LauncherClient","DistributedStoreClient","WindowClient","AuthenticationClient","searchClient","storageClient"]),S.initialize(t)),S.Clients.RouterClient.unsubscribe(r)})}catch(t){"Cannot Wrap Service Manager or Services"!==t&&w.default.system.error("Unable to get Finsemble Window Instance for "+e.name,t)}const n=()=>{document.querySelector("body").addEventListener("click",e=>{"a"===e.target.tagName.toLowerCase()&&e.target.href.includes("mailto")&&(S.clickedMailTo=!0)})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.addEventListener("error",e=>{const t=e.error?e.error.stack.substring(e.error.stack.search("at ")):"";return S.Clients.Logger.error(e.message,"File: "+e.filename,"Line: "+e.lineno,"Column: "+e.colno,"Error Stack: \n    "+t),!1}),window.addEventListener("unhandledrejection",e=>{S.Clients.Logger.error("Unhandled rejection","reason",e.reason)}),window.addEventListener("unload",()=>{r=!1,S.windowClose()}),window.addEventListener("beforeunload",e=>{S.clickedMailTo?(S.clickedMailTo=!1,e.preventDefault()):S.windowClose()})}),e.exports=S}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,o,s,a,u=1,l={},c=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(r=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&p(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),i=function(t){e.postMessage(s+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return l[u]=r,i(u),u++},f.clearImmediate=h}function h(e){delete l[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(5),n(19))},function(e,t,n){"use strict";(function(e){
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RouterClientConstructor=void 0;const a=s(n(50)),u=o(n(9)),l=n(11),c=s(n(6)),d=s(n(39)),f=n(3),h=n(1),p=n(36),g=n(37),m=[],y=e;let w=h.Logger;y.FSBLData=y.FSBLData||{},y.FSBLData.RouterClients=y.FSBLData.RouterClients||{},t.RouterClientConstructor=function(e){c.default.args(e,"object")&&c.default.args2("params.clientName",e.clientName,"string","params.transportName",e.transportName,"string=");const t=e.clientName,{transportName:n}=e;let i,r;const o={},s={},h={},b={},v={},C={},S={},_={},T={},A={};let E,L=null,O=!1;const I=[],M=this;function D(){this.header={origin:E,type:"initialHandshake"}}function k(e,t){this.header={origin:E,type:"timeCalibration"},this.clientBaseTime=e,this.serviceBaseTime=t}function W(e){this.header={origin:E,type:"addListener",channel:e}}function j(e,t,n){this.header={origin:E,type:"transmit",channel:e},this.data=t,this.options=n}function N(e){this.header={origin:E,type:"removeListener",channel:e}}function R(e){this.header={origin:E,type:"addResponder",channel:e}}function P(e,t,n){this.header={origin:E,type:"query",queryID:e,channel:t},this.data=n}function F(e,t,n){this.header={origin:E,type:"queryResponse",queryID:e,error:t},this.data=n}function x(e){this.header={origin:E,type:"removeResponder",channel:e}}function B(e,t){this.header={origin:E,type:"subscribe",subscribeID:e,topic:t}}function U(e,t){this.header={origin:E,type:"unsubscribe",subscribeID:e,topic:t}}function z(e,t){this.header={origin:E,type:"publish",topic:e},this.data=t}function H(e,t,n,i){this.header={origin:E,type:"notify",subscribeID:e,topic:t,error:n},this.data=i}function V(e,t,n){this.header={origin:E,type:"addPubSubResponder",topic:e,handleOnServer:n},this.data=t}function q(e){this.header={origin:E,type:"removePubSubResponder",topic:e}}function $(){for(M.startupTime=performance.now()-M.startupTime,w.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient Ready"),O=!0;I.length>0;){w.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient parentReady invoked");I.shift()()}}function G(e){!L||L instanceof Promise?(w.system.warn("RouterClient: Queuing message since router initialization not complete",e),m.push(e)):L.send(e)}function Y(){return this.header.origin===this.header.lastClient}function Q(e,t){w.system.info("RouterClient: outgoing query response","CHANNEL",this.header.channel,"RESPONSE DATA",t,"QUERY ID",this.header.queryID),G(new F(this.header.queryID,e,t))}function K(e,t){const n=e[t.header.channel];void 0===n?w.system.warn(`RouterClient: no query responder define on channel ${t.header.channel} incoming from ${t.header.origin}`,t):t.header.error?(w.system.warn("RouterClient: queryResponder error",t),n(t.header.error,null),delete e[t.header.channel]):(t.originatedHere=Y,t.sendQueryResponse=Q.bind(t),w.system.info("RouterClient: incoming query","CHANNEL",t.header.channel,"FROM",t.header.origin,"QUERY MESSAGE",t),n(null,t))}function Z(e,t){const n=e[t.header.queryID];void 0===n?w.system.warn("RouterClient: no handler for incoming query response","QUERY ID",t.header.queryID):(!function(e,t){const n=e[t];void 0!==n&&clearTimeout(n)}(A,t.header.queryID),t.header.error?(w.system.debug("RouterClient: incoming queryResponse error",t.header,"QUERY ID",t.header.queryID),n(t.header.error,t)):(w.system.info("RouterClient: incoming query response","RESPONSE MESSAGE",t,"QUERY ID",t.header.queryID),n(null,t)),delete e[t.header.queryID])}function J(e,t){if(e)w.system.warn("RouterClient: income publish rejected by pubsub responder",e,t);else{b[this.header.topic]=t;const n=C[this.header.topic];if(void 0!==n)for(let i=0;i<n.length;i++)w.system.info("RouterClient: sending pubsub notify","TOPIC",this.header.topic,"NOTIFY DATA",t),G(new H(n[i],this.header.topic,e,t))}}function X(e,t){var n,i,r;(function(e){let t=!1;return void 0===e&&(t=!0),t})(t)||G(new H(this.header.subscribeID,this.header.topic,e,t)),e?w.system.warn("RouterClient: incoming subscription rejected by pubsub responder","TOPIC",this.header.topic,"MESSAGE",this):(n=C,i=this.header.topic,r=this.header.subscribeID,i in n?n[i].push(r):n[i]=[r],w.system.info("RouterClient: incoming subscription added","TOPIC",this.header.topic,"MESSAGE",this))}function ee(){!function(e,t,n){let i=!1;if(t in e){const r=C[t];for(let o=0;o<r.length;o++)if(n===r[o]){r.splice(o,1),0===r.length&&delete e[t],i=!0,w.system.info("RouterClient: PubSub removeListener","TOPIC",t,"FROM",n);break}}i||w.system.warn(`RouterClient: tried to remove non-existent listener on ${t} from ${JSON.stringify(n)}`)}(C,this.header.topic,this.header.subscribeID)}function te(e){switch(w.system.verbose("Incoming Message Type",e.header.type,e),e.header.type){case"transmit":!function(e,t){const n=e[t.header.channel]||[],i=[];if(Array.isArray(n)&&0!==n.length){t.originatedHere=Y,n.forEach(e=>{i.push(e)});for(let e=0;e<i.length;e++)w.isLogMessage(t.header.channel)||w.system.info("RouterClient: incoming transmit","CHANNEL",t.header.channel,"FROM",t.header.origin,"MESSAGE",t),i[e](null,t)}else w.system.warn(`RouterClient: no listener for incoming transmit on channel ${t.header.channel} from ${t.header.origin}`,t)}(o,e);break;case"query":K(s,e);break;case"queryResponse":Z(T,e);break;case"notify":!function(e,t){const n=e[t.header.subscribeID];void 0===n?w.system.warn("RouterClient: no subscription handler defined for incoming notify for subscriberID",t.header.subscribeID,t):t.header.error?(w.system.info("RouterClient: incoming PubSub notify error for subscriberID","SUBSCRIBER ID",t.header.subscribeID,"NOTIFY MESSAGE",t),n(t.header.error,t)):(t.originatedHere=Y,w.system.info("RouterClient: incoming PubSub notify","SUBSCRIBER ID",t.header.subscribeID,"NOTIFY MESSAGE",t),n(null,t))}(S,e);break;case"publish":!function(e){let t=h[e.header.topic];if(void 0===t)for(const n in v)if(v[n].test(e.header.topic)){t=h[n];break}void 0===t?w.system.warn("RouterClient: no pubsub responder defined for incoming publish","TOPIC",e.header.topic,"PUBLISH MESSAGE",e):(e.sendNotifyToAllSubscribers=J,t.publishCallback?(w.system.info("RouterClient: incoming PubSub publish callback invoked","TOPIC",e.header.topic,"PUBLISH MESSAGE",e),t.publishCallback(null,e)):(w.system.info("RouterClient: incoming PubSub publish","TOPIC",e.header.topic,"PUBLISH MESSAGE",e),e.sendNotifyToAllSubscribers(null,e.data)))}(e);break;case"subscribe":!function(e){w.system.info("RouterClient: PubSub subscribe","TOPIC",e.header.topic);let t=h[e.header.topic];if(void 0===t)for(const n in v)if(v[n].test(e.header.topic)){t=h[n];let i=b[e.header.topic];void 0===i&&(i=b[n]),b[e.header.topic]=i;break}void 0===t?w.system.warn("RouterClient: no pubsub responder defined for incoming subscribe",e):e.header.error?w.system.warn("RouterClient: pubsub error received from router service: "+JSON.stringify(e.header.error)):(e.sendNotifyToSubscriber=X,t.subscribeCallback?(e.data=b[e.header.topic],t.subscribeCallback(null,e)):e.sendNotifyToSubscriber(null,b[e.header.topic]))}(e);break;case"unsubscribe":!function(e){let t=h[e.header.topic];if(void 0===t)for(const n in v)if(v[n].test(e.header.topic)){t=h[n];break}void 0===t?w.system.warn("RouterClient: no pubsub responder defined for incoming unsubscribe","TOPIC",e.header.topic,"UNSUBSCRIBE MESSAGE",e):(e.removeSubscriber=ee,t.unsubscribeCallback?(w.system.info("RouterClient: incoming unsubscribe callback","TOPIC",e.header.topic,"UNSUBSCRIBE MESSAGE",e),t.unsubscribeCallback(null,e)):(w.system.info("RouterClient: incoming unsubscribe","TOPIC",e.header.topic,"UNSUBSCRIBE MESSAGE",e),e.removeSubscriber()))}(e);break;case"timeCalibration":const t=()=>{r?r(e):setTimeout(()=>{t()},10)};t();break;case"initialHandshakeResponse":i()}}function ne(e,t){t.header.lastClient=E,t.header.incomingTransportInfo=e,te(t)}function ie(){return`${E}.${g.v4()}`}function re(e,t,n){e[t]=n}function oe(e,t,n,i){i>0&&(e[t]=setTimeout(()=>{w.system.warn(`RouterClient: timeout waiting on query response on channel ${n} for queryID ${t} on timer ${e[t]} timeout=${i}`)},i))}function se(e,t){let n=!1;return void 0!==e[t]&&(delete e[t],n=!0),n}return this.startupTime=0,this.calibrateTimeWithRouterService=function(e){let t,n=0,i=1/0;r=function(r){n++,n>5?function(n){let r=0;for(let e=1;e<5;e++){const o=n.clientBaseTime[e-1],s=n.clientBaseTime[e]-o,a=n.serviceBaseTime[e-1]-(o+s/2);s<i&&(i=s,t=a),r+=a,w.system.debug("calibrationCalculation Intermediate Values","lastRRT",s,"lastOffset",a,"fastestOffset",t,"fastestRRT",i)}r/=4,w.system.debug("RouterClient calibrationCalculation","Average Offset",r,"Chosen FastestOffset",t,n),e(t)}(r):(r.clientBaseTime.push(y.performance.timing.navigationStart+y.performance.now()),G(new k(r.clientBaseTime,r.serviceBaseTime)))},r(new k([],[]))},this.ready=e=>this.onReady(e),this.getClientName=function(){return w.system.debug("RouterClient.getClientName",E),E},this.onReady=function(e){c.default.args(e,"function"),O?e():I.push(e)},this.addListener=function(e,t){w.system.info("RouterClient.addListener","CHANNEL",e),c.default.args(e,"string",t,"function");(function(e,t,n){let i=!1;const r=e[t];return void 0===r||0===r.length?(e[t]=[n],i=!0):r.push(n),i})(o,e,t)&&G(new W(e))},this.transmit=function(e,t,n={suppressWarnings:!1}){w.isLogMessage(e)||w.system.info("RouterClient.transmit","TO CHANNEL",e,"EVENT",t),c.default.args(e,"string",t,"any"),G(new j(e,t,n))},this.removeListener=function(e,t){w.system.info("RouterClient.removeListener","CHANNEL",e,"EVENT HANDLER",t),c.default.args(e,"string",t,"function");(function(e,t,n){let i=!1;const r=e[t];if(void 0!==r){const e=r.indexOf(n);e>-1?(r.splice(e,1),0===r.length&&(i=!0)):w.system.warn("no listener defined for channel: "+t)}return i})(o,e,t)&&G(new N(e))},this.addResponder=function(e,t){w.system.info("RouterClient.addResponder","CHANNEL",e),c.default.args(e,"string",t,"function");(function(e,t,n){let i=!1;return void 0===e[t]&&(e[t]=n,i=!0),i})(s,e,t)?G(new R(e)):(w.system.warn("RouterClient.addResponder: Responder already locally defined for channel "+e),t({"RouteClient QueryError":"Responder already locally defined for channel"+e},null))},this.query=function(e,t,n,i=Function.prototype){const r=`${ie()}.${e}`,o=window.performance.timing.navigationStart+window.performance.now(),s=window.performance.timing.navigationStart,a=window.performance.now();function u(u){re(T,r,(l,c)=>{u({err:l,response:c}),"function"==typeof i?i(l,c):w.system.warn("No response event handler passed to RouterClient.query","RESPONDER CHANNEL",e,"QUERY EVENT",t,"PARAMS",n,"QUERY ID",r,{timestamp:o,navstart:s,timenow:a})}),oe(A,r,e,n.timeout),G(new P(r,e,t))}return w.system.info("RouterClient.query","RESPONDER CHANNEL",e,"QUERY EVENT",t,"PARAMS",n,"QUERY ID",r,{timestamp:o,navstart:s,timenow:a}),3===arguments.length&&(i=n,n={timeout:2e4}),c.default.args(e,"string",t,"any=",n,"object=",i,"function"),n=n||{},c.default.args2("params.timeout",n.timeout,"number"),new Promise(u)},this.removeResponder=function(e){w.system.info("RouterClient.removeResponder","RESPONDER CHANNEL",e),c.default.args(e,"string");se(s,e)&&G(new x(e))},this.addPubSubResponder=function(t,n,i,r){let o,s;if(w.system.info("RouterClient.addPubSubResponder","TOPIC",t,"INITIAL STATE",n,"PARAMS",i),c.default.args(t,"any",n,"object=",e,"object="),i=i||{},c.default.args2("params.subscribeCallback",i.subscribeCallback,"function=","params.publishCallback",i.publishCallback,"function=")&&c.default.args2("params.unsubscribeCallback",i.unsubscribeCallback,"function="),void 0===i.subscribeCallback&&void 0===i.publishCallback&&void 0===i.unsubscribeCallback)n=n||{},G(new V(t.toString(),n,!0)),s="success";else{(function(e,t,n,i){let r=!1;return void 0===h[e.toString()]&&(e instanceof RegExp&&(v[e.toString()]=e,w.system.info("RouterClient: PubSub RegEx added for topic "+e.toString())),h[e.toString()]={subscribeCallback:t,publishCallback:n,unsubscribeCallback:i},r=!0),r})(t,i.subscribeCallback,i.publishCallback,i.unsubscribeCallback)?(n=n||{},b[t.toString()]=u.clone(n),G(new V(t.toString(),n,!1)),s="success"):(o="RouterClient.addPubSubResponder: Responder already locally defined for topic "+t,w.system.error(o))}r&&r(o,s)},this.removePubSubResponder=function(e){w.system.info("RouterClient.removePubSubResponder","TOPIC",e),c.default.args(e,"any");se(h,e)?(delete b[e.toString()],delete v[e.toString()],G(new q(e))):w.system.warn("RouterClient.removePubSubResponder failed: Could not find responder for topic "+e)},this.subscribe=function(e,t){w.system.info("RouterClient.subscribe","TOPIC",e),c.default.args(e,"string",t,"function");const n=ie();return function(e,t,n,i){e[t]=n,_[t]=i}(S,n,t,e),G(new B(n,e)),{subscribeID:n,topic:e}},this.publish=function(e,t){w.system.info("RouterClient.publish","TOPIC",e,"EVENT",t),c.default.args(e,"string",t,"any"),G(new z(e,t))},this.unsubscribe=function(e){w.system.info("RouterClient.unsubscribe","SUBSCRIBE ID",e),c.default.args(e,"object")&&c.default.args2("subscribeIDStruct.subscribeID",e.subscribeID,"string");(function(e,t){let n=!1;return void 0!==e[t]&&(delete e[t],n=!0),n})(S,e.subscribeID)?G(new U(e.subscribeID,e.topic)):w.system.warn("RouterClient.unsubscribe: Could not find subscribeID for topic "+e.topic)},this.trustedMessage=function(e){let t=!0;return w.system.debug("RouterClient.trustedMessage header",e.header),"SharedWorker"===e.header.originIncomingTransportInfo.transportID&&(t=!0),t},this.disconnectAll=function(){w.system.info("RouterClient.disconnectAll");for(const e in o)w.system.debug("RouterClient.disconnectAll is removing listener on "+e),G(new N(e)),delete o[e];for(const e in s)w.system.debug("RouterClient.disconnectAll is removing responder on "+e),G(new x(e)),delete s[e];for(const e in h)w.system.debug("RouterClient.disconnectAll is removing pubsub responder on "+e),G(new q(e)),delete h[e.toString()],delete b[e.toString()],delete v[e.toString()];for(const e in S){const t=_[e];w.system.debug("RouterClient.disconnectAll is removing subscriber on "+t),G(new U(e,t)),delete S[e],delete _[e]}},"loggerService"===f.System.Window.getCurrent().name&&(w=new p.LocalLogger),E=`${t}.${f.System.Window.getCurrent().name}`,E in y.FSBLData.RouterClients?(w.system.debug('"RouterClient Check: reusing existing client for '+E),console.debug('"RouterClient Check: reusing existing client for '+E,y)):(w.system.debug('"RouterClient Check: constructing new client for '+E),console.debug('"RouterClient Check: constructing new client for '+E,y),y.FSBLData.RouterClients[E]=this,function(e,t){w.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient Constructor:Name:",e);let r=0;function o(r){w.system.info("WINDOW LIFECYCLE:STARTUP:RouterClient:processManifest"),r&&"string"!=typeof r?function(e,t,r,o){w.system.verbose(`Client ${t} connecting to event router`),w.system.verbose("Name of transport to establish: "+r);const s=void 0===r;let u,c,f=!1,h=0;const p=e.finsemble,g={FinsembleUUID:p.FinsembleUUID,applicationRoot:p.applicationRoot,routerDomainRoot:p.moduleRoot,forceWindowTransport:l.ConfigUtilInstance.getDefault(p,"finConfig.router.forceWindowTransport",{}),sameDomainTransport:l.ConfigUtilInstance.getDefault(p,"finConfig.router.sameDomainTransport","SharedWorker"),crossDomainTransport:l.ConfigUtilInstance.getDefault(p,"finConfig.router.crossDomainTransport","IPCBus"),transportSettings:l.ConfigUtilInstance.getDefault(p,"finConfig.router.transportSettings",{}),IAC:l.ConfigUtilInstance.getDefault(p,"finConfig.IAC",{})};let y,b,v,C,S,_;y=e=>{c=0,w.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient:transport ready","TRANSPORT OBJECT",e),L=e,i=_,S(),u=setInterval(S,200)},b=e=>{w.system.error("RouterClientError",e)},v=()=>{w.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient:getClientTransport","ROUTER PARAMS:",g),L=s?a.default.getRecommendedTransport(g,ne,E,"RouterService").then(y).catch(b):a.default.getTransport(g,n,ne,E,"RouterService").then(y).catch(b)},C=()=>{if(clearInterval(u),h++,h<=3)w.system.error("WINDOW LIFECYCLE:STARTUP:RouterClient: failure to connect to router service. Retrying...",h,g),v();else{const e="A cross domain transport has failed to connect. Cross domain components may not work. Please contact your administrator.";w.system.error(e,g);const t=l.ConfigUtilInstance.getDefault(p,"finConfig.notificationURL",p.moduleRoot+"/components/system/notification/notification.html");d.default.alert("dev","ONCE-SINCE-STARTUP","FSBL-Internal-Transport-Failure",e,{url:t})}},S=()=>{w.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient: sendHandshake",c),G(new D),c++>50&&C()},_=()=>{if(!f){if(w.system.debug(`WINDOW LIFECYCLE:STARTUP:RouterClient connected: Starting ${E} with transport ${L.identifier()}`),f=!0,clearInterval(u),m)for(let e=0;e<m.length;e++){w.system.debug("RouterClient: firing queued msg");const t=m[e];L.send(t)}o&&o()}},v()}(r,e,t,$):w.system.error("WINDOW LIFECYCLE:STARTUP:RouterClient:processManifest failed -- fatal error",r)}f.System.ready(()=>{const e=f.System.Window.getCurrent();w.system.debug("WINDOW LIFECYCLE:STARTUP: System.ready invoked in "+e.name),console.debug("WINDOW LIFECYCLE:STARTUP: System.ready invoked in "+e.name),M.startupTime=performance.now(),0==r++&&e.getOptions(e=>{e.customData&&e.customData.manifest?(w.system.debug("Router Init using custom data"),o(e.customData.manifest)):l.ConfigUtilInstance.getExpandedRawManifest(e=>{w.system.debug("Router Init using getExpandedRawManifest"),y.FinsembleUUID&&(e.finsemble.FinsembleUUID=y.FinsembleUUID),o(e)},e=>{w.system.error("WINDOW LIFECYCLE:STARTUP:RouterClient:manifest error",e)})},e=>{w.system.error("WINDOW LIFECYCLE:STARTUP:finWindow.getOptions error",e)})})}(E,n)),y.FSBLData.RouterClients[E]}}).call(this,n(5))},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(11),o=i(n(1)),s=n(3),a={activeTransports:{},addTransport(e,t){this.activeTransports[e]=t,o.default.system.log(`RouterTransport ${e} added to activeTransports`)},getActiveTransports(e){const t=[];function n(e){-1===t.indexOf(e)&&t.push(e)}return s.System.InterApplicationBus&&n("IPCBus"),"Electron"===s.System.container&&n("FinsembleTransport"),SharedWorker&&n("SharedWorker"),n(e.sameDomainTransport),n(e.crossDomainTransport),o.default.system.log("getActiveTransports",t),t},getDefaultTransport:(e,t,n,i)=>a.getTransport(e,"IPCBus",t,n,i),getRecommendedTransport(e,t,n,i){const r=function(){const{sameDomainTransport:t}=e,{crossDomainTransport:n}=e;let i=t;return function(){const t=document.createElement("a");t.href=e.routerDomainRoot;const n=window.location.hostname===t.hostname,i=window.location.protocol===t.protocol,r=(void 0!==window.location.port?window.location.port:80)===(void 0!==t.port?t.port:80),s=!(n&&r&&i);return o.default.system.debug(`Transport crossDomain=${s} (${n}:${i}:${r})`),s}()&&(i=n),o.default.system.log(`Transport Info: Selected=${i} SameDomainDefault=${t} CrossDomainDefault=${n}`),console.log(`Transport Info: Selected=${i} SameDomainDefault=${t} CrossDomainDefault=${n}`),i}();return a.getTransport(e,r,t,n,i)},getTransport(e,t,n,i,r){const o=this;return new Promise((s,a)=>{const u=o.activeTransports[t];u?new u(e,n,i,r,e=>{s(e)}):a("unknown router transport name: "+t)})}};const u={SharedWorkerTransport:function(e,t,n,i,r){let s;const a=this;this.send=function(e,t){1===arguments.length?(t=arguments[0],e=null):(e=arguments[0],t=arguments[1]),o.default.system.verbose("SharedWorkerTransport Outgoing Transport",t);try{s.port.postMessage([e,t])}catch(e){o.default.system.error("SharedWorkerTransport: post message failed: "+JSON.stringify(e),"Probable cause is sending illegal data type (e.g. function).")}},this.identifier=function(){return"SharedWorker"};const u=e.transportSettings.SharedWorker&&e.transportSettings.SharedWorker.workerPath?e.transportSettings.SharedWorker.workerPath:e.routerDomainRoot+"/common/routerSharedWorker.js";o.default.system.log(`SharedWorker Transport Initializing for ${n} using ${u}`),console.log(`SharedWorker Transport Initializing for ${n} using ${u}`),s=new SharedWorker(u,{name:"Finsemble",credentials:"include"}),s.port.onmessage=function(e){const n=e.data[0],i=e.data[1],r={transportID:a.identifier(),port:n};o.default.system.verbose("SharedWorkerTransport Incoming Transport",r,"Message",i),t(r,i)},s.onerror=function(e){o.default.system.error("SharedWorkerTransport Transport Error"+JSON.stringify(e))},s.port.start(),"RouterService"===n&&s.port.postMessage({data:"connect",source:"RouterService"}),r(this)},IPCTransport:function(e,t,n,i,r){const{uuid:a}=s.System.Application.getCurrent(),u=this;this.send=function(e,t){let n;1===arguments.length?(n=i,t=arguments[0]):(n=e.name,t=arguments[1]),o.default.system.verbose("IPCTransport Outgoing Transport",a,n,"Message",t),s.System.InterApplicationBus.publish(n,t,()=>{},()=>{})},this.identifier=function(){return"IPCBus"},o.default.system.log("IPCBus Transport Initializing for "+n),console.log("IPCBus Transport Initializing for "+n),s.System.InterApplicationBus.subscribe("*",n,(function(e,n){const i={transportID:u.identifier(),senderUuid:n,name:e.header.origin};o.default.system.verbose("IPCTransport Incoming Transport",i,"Message",e),t(i,e)}),null,(function(e){o.default.system.error("IPCBus Subscribe Failure: "+e)})),r(this)},FinsembleTransport:function(e,t,n,i,s){const a=r.ConfigUtilInstance.getDefault(e,"params.IAC.serverAddress","ws://127.0.0.1:3376"),u=r.ConfigUtilInstance.getDefault(e,"params.transportSettings.FinsembleTransport.serverAddress",a)+"/router",l=this;let c;function d(e){const n={transportID:l.identifier(),client:e.clientMessage.header.origin};o.default.system.verbose("FinsembleTransport Incoming Transport",n,"Message",e),t(n,e.clientMessage)}function f(){o.default.system.error("FinsembleTransport Connection Timeout for "+n),s(l)}function h(){o.default.system.log(`FinsembleTransport Transport Initializing for ${n} using ${u}`),console.log(`FinsembleTransport Transport Initializing for ${n} using ${u}`),u.startsWith("ws:")||u.startsWith("wss:")||console.error("wss not found as SOCKET_SERVER_ADDRESS.  Use wss!",u),c=new WebSocket(u);const e=setTimeout(f,3e3);c.addEventListener("open",()=>{clearTimeout(e),o.default.system.log("FinsembleTransport Connected to Server"),console.log("FinsembleTransport Connected to Server"),c.addEventListener("message",e=>{const t=JSON.parse(e.data);("RouterService"===n&&"ROUTER_SERVICE"==t.dest||n===t.message.client)&&d(t.message)}),s(l)})}this.send=function(e,t){let n,i;1===arguments.length?(n="ROUTER_SERVICE",i={clientMessage:t=arguments[0]}):(n="ROUTER_CLIENT",t=arguments[1],i={client:e.client,clientMessage:t}),o.default.system.verbose("FinsembleTransport Outgoing Transport",n,"NewMessage",i),c.readyState===WebSocket.OPEN&&c.send(JSON.stringify({dest:n,message:i})),c.readyState===WebSocket.CONNECTING&&c.addEventListener("open",()=>{c.send(JSON.stringify({dest:n,message:i}))}),c.readyState===WebSocket.CLOSED&&(h(),c.addEventListener("open",()=>{c.send(JSON.stringify({dest:n,message:i}))})),c.readyState===WebSocket.CLOSING&&(c.onclose=()=>{h(),c.addEventListener("open",()=>{c.send(JSON.stringify({dest:n,message:i}))})})},this.identifier=function(){return"FinsembleTransport"},h(),o.default.system.log(`FinsembleTransport Transport Initializing for ${n} using ${u}`),console.log(`FinsembleTransport Transport Initializing for ${n} using ${u}`),(u.startsWith("ws:")||u.startsWith("wss:"))&&console.error("wss not found as SOCKET_SERVER_ADDRESS.  Use wss!",u)},FinsembleCloudTransport:function(e,t,n,i,s){let a;const u=r.ConfigUtilInstance.getDefault(e,"params.transportSettings.FinsembleCloudTransport.serverAddress",e.applicationRoot),{FinsembleUUID:l}=e;a="/"===u.substr(u.length-1)?u.substring(0,u.length-1):u;const c=a+"/router",d=this;let f;function h(e){const n={transportID:d.identifier(),client:e.clientMessage.header.origin};o.default.system.verbose("FinsembleCloudTransport Incoming Transport",n,"Message",e),t(n,e.clientMessage)}this.send=function(e,t){let n,i;1===arguments.length?(n="ROUTER_SERVICE",i={FinsembleUUID:l,clientMessage:t=arguments[0]}):(n="ROUTER_CLIENT",t=arguments[1],i={FinsembleUUID:l,client:e.client,clientMessage:t}),o.default.system.verbose("FinsembleCloudTransport Outgoing Transport",n,"NewMessage",i),f.emit(n,i)},this.identifier=function(){return"FinsembleCloudTransport"},o.default.system.log(`FinsembleCloudTransport Transport Initializing for ${n} using ${c}`),console.log(`FinsembleCloudTransport Transport Initializing for ${n} using ${c}`),-1!==c.indexOf("ws:")||console.error("SOCKET_SERVER_ADDRESS not wss!",c),f=new WebSocket(c);const p=setTimeout((function(){o.default.system.error("FinsembleCloudTransport Connection Timeout for "+n),s(d)}),3e3);f.on("connect",()=>{clearTimeout(p),o.default.system.log("FinsembleCloudTransport Connected to Server",l),console.log("FinsembleCloudTransport Connected to Server"),"RouterService"===n?(o.default.system.debug("Setting Up Socket Connection","ROUTER_SERVICE_IN"+l),console.log("Setting Up Socket Connection","ROUTER_SERVICE_IN"+l),f.on("ROUTER_SERVICE_IN"+l,e=>{h(e)})):(o.default.system.debug("Setting Up Socket Connection",n+l),console.log("SETTING UP Socket CONNECTION",n+l),f.on(n+l,e=>{h(e)})),s(d)})}};a.addTransport("SharedWorker",u.SharedWorkerTransport),a.addTransport("IPCBus",u.IPCTransport),a.addTransport("FinsembleTransport",u.FinsembleTransport);var l=a;t.default=l,e.exports=t.default},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(25),o=i(n(1)),s=(i(n(26)),i(n(53))),a=i(n(59)),u=n(12);let l;class c extends r.EventEmitter{constructor(e,t,n){if(super(),!n||!n.System)throw new Error("Monitors class requires dependency injection. Ensure that System is being passed in.");({System:l}=n),this.cachedMonitorInfo=null,this.limitedMonitorRefreshQueue=new s.default({concurrency:1}),this.bindAllFunctions(),this.limitedMonitorRefreshQueue.add(()=>this.refreshMonitors(e)),l.addEventListener("monitor-info-changed",()=>{this.limitedMonitorRefreshQueue.add(()=>this.refreshMonitors(t))}),l.addEventListener("session-changed",e=>{e&&("object"!=typeof e||!e.hasOwnProperty("reason")||"unlock"!==e.reason&&"remote-connect"!==e.reason&&"unknown"!==e.reason)||this.limitedMonitorRefreshQueue.add(()=>this.refreshMonitors(t))})}bindAllFunctions(){let e=this;for(let t of Object.getOwnPropertyNames(Object.getPrototypeOf(e))){let n=e[t];n instanceof Function&&n!==c&&(e[t]=e[t].bind(e))}}asyncIt(e,t){return t(e),e}rationalizeMonitor(e){e.monitorRect.width=e.monitorRect.right-e.monitorRect.left,e.monitorRect.height=e.monitorRect.bottom-e.monitorRect.top,e.availableRect.width=e.availableRect.right-e.availableRect.left,e.availableRect.height=e.availableRect.bottom-e.availableRect.top}calculateMonitorScale(e,t){return(t.right-t.left)/(e.right-e.left)}monitorInfoIsChanged(e,t){if(!e||!t)return!0;if(e.nonPrimaryMonitors.length!==t.nonPrimaryMonitors.length)return!0;if(!(0,u.checkIfBoundsAreEqual)(e.primaryMonitor.availableRect,t.primaryMonitor.availableRect))return!0;if(!(0,u.checkIfBoundsAreEqual)(e.primaryMonitor.monitorRect,t.primaryMonitor.monitorRect))return!0;e.nonPrimaryMonitors.sort((e,t)=>e.deviceName>t.deviceName?1:e.deviceName<t.deviceName?-1:0),t.nonPrimaryMonitors.sort((e,t)=>e.deviceName>t.deviceName?1:e.deviceName<t.deviceName?-1:0);let n=!1;return e.nonPrimaryMonitors.forEach((e,i)=>{const r=t.nonPrimaryMonitors[i];(0,u.checkIfBoundsAreEqual)(e.availableRect,r.availableRect)&&(0,u.checkIfBoundsAreEqual)(e.monitorRect,r.monitorRect)||(n=!0)}),n}async refreshMonitors(e=Function.prototype){this.limitedMonitorRefreshQueue.clear();const t=await l.getMonitorInfo();if(!this.monitorInfoIsChanged(this.cachedMonitorInfo,t))return o.default.system.info("Skipped refreshMonitors because monitors do not change."),e(this.allMonitors);this.allMonitors=[];let{primaryMonitor:n}=t;if(Object.entries(n).length){n.whichMonitor="primary",n.position=0,this.allMonitors.push(Object.assign({},n));for(let e=0;e<t.nonPrimaryMonitors.length;e++){let n=t.nonPrimaryMonitors[e];n.whichMonitor=e,n.position=e+1,this.allMonitors.push(n)}for(let e=0;e<this.allMonitors.length;e++){let t=this.allMonitors[e];this.rationalizeMonitor(t)}this.cachedMonitorInfo=(0,a.default)(t),e(this.allMonitors),this.ready=!0,1===this.limitedMonitorRefreshQueue.pending&&this.emit("monitors-changed",{monitors:this.allMonitors})}else o.default.system.info("There is no primary monitor in 'monitorInfo' - the system is still in the process of updating the monitor information. Returning from monitorsAndScaling -> refreshMonitors")}getAllMonitors(e=Function.prototype){return this.ready?this.asyncIt(JSON.parse(JSON.stringify(this.allMonitors)),e):e?void this.refreshMonitors(e):"not ready"}getMonitorFromScaledXY(e,t,n=Function.prototype){return new Promise(i=>{if(!this.ready)return this.refreshMonitors(()=>{this.getMonitorFromScaledXY(e,t,n)}),"not ready";let r=null;for(var o=this.allMonitors,s=0;s<o.length;s++){var a=o[s],{monitorRect:u}=a;if(e>=u.left&&e<u.right&&t>=u.top&&t<u.bottom){r=a;break}}i(r),n(r)})}getMonitorFromUnscaledXY(e,t,n=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.getMonitorFromUnscaledXY(e,t,n)}),"not ready";for(var i=this.allMonitors,r=0;r<i.length;r++){var o=i[r],s=o.monitor.scaledRect;if(e>=s.left&&e<s.right&&t>=s.top&&t<s.bottom)return this.asyncIt(o,n)}return this.asyncIt(null,n)}async translatePointFromScaled(e,t=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.translatePointFromScaled(e,t)}),"not ready";var n;e.point?({point:n}=e):n=e;var{monitor:i}=e;if(!i){i=(await this.getMonitorFromScaledXY(n.x,n.y)).data}let r=null;if(i){var o=n.x-i.monitorRect.left,s=n.y-i.monitorRect.top,a=o*i.deviceScaleFactor,u=s*i.deviceScaleFactor;r={x:a+i.monitor.scaledRect.left,y:u+i.monitor.scaledRect.top}}return t(r),Promise.resolve(r)}translatePointToScaled(e,t=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.translatePointToScaled(e,t)}),"not ready";var n;e.point?({point:n}=e):n=e;var i=e.monitor||this.getMonitorFromUnscaledXY(n.x,n.y);if(!i)return this.asyncIt(null,t);var r=n.x-i.monitor.scaledRect.left,o=n.y-i.monitor.scaledRect.top,s=r/i.deviceScaleFactor,a=o/i.deviceScaleFactor,u={x:s+i.monitorRect.left,y:a+i.monitorRect.top};return this.asyncIt(u,t)}async translateRectToScaled(e,t=Function.prototype){let n;if(!this.ready)return this.refreshMonitors(()=>{this.translateRectToScaled(e,t)}),"not ready";var i=this.translatePointToScaled({x:e.left,y:e.top}),r=this.translatePointToScaled({x:e.right,y:e.bottom});return!i&&r&&(n=await this.getMonitorFromScaledXY(r),i=this.translatePointToScaled({monitor:n,point:{x:e.left,y:e.top}})),!r&&i&&(n=await this.getMonitorFromScaledXY(r),r=this.translatePointToScaled({monitor:n,point:{x:e.right,y:e.bottom}})),this.asyncIt({top:i?i.y:null,left:i?i.x:null,bottom:r?r.y:null,right:r?r.x:null,height:i&&r?r.y-i.y:null,width:i&&r?r.x-i.x:null},t)}translateRectFromScaled(e,t=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.translateRectFromScaled(e,t)}),"not ready";var n=this.translatePointFromScaled({x:e.left,y:e.top}),i=this.translatePointFromScaled({x:e.right,y:e.bottom});return!n&&i&&(n=this.translatePointFromScaled({monitor:this.getMonitorFromUnscaledXY(i),point:{x:e.left,y:e.top}})),!i&&n&&(i=this.translatePointFromScaled({monitor:this.getMonitorFromUnscaledXY(n),point:{x:e.right,y:e.bottom}})),this.asyncIt({top:n?n.y:null,left:n?n.x:null,bottom:i?i.y:null,right:i?i.x:null,height:n&&i?i.y-n.y:null,width:n&&i?i.x-n.x:null},t)}}var d=c;t.default=d,e.exports=t.default},function(e,t,n){(function(t){var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,l=a||u||Function("return this")(),c=Object.prototype.toString,d=Math.max,f=Math.min,h=function(){return l.Date.now()};function p(e,t,n){var i,r,o,s,a,u,l=0,c=!1,p=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function w(t){var n=i,o=r;return i=r=void 0,l=t,s=e.apply(o,n)}function b(e){return l=e,a=setTimeout(C,t),c?w(e):s}function v(e){var n=e-u;return void 0===u||n>=t||n<0||p&&e-l>=o}function C(){var e=h();if(v(e))return S(e);a=setTimeout(C,function(e){var n=t-(e-u);return p?f(n,o-(e-l)):n}(e))}function S(e){return a=void 0,y&&i?w(e):(i=r=void 0,s)}function _(){var e=h(),n=v(e);if(i=arguments,r=this,u=e,n){if(void 0===a)return b(u);if(p)return a=setTimeout(C,t),w(u)}return void 0===a&&(a=setTimeout(C,t)),s}return t=m(t)||0,g(n)&&(c=!!n.leading,o=(p="maxWait"in n)?d(m(n.maxWait)||0,t):o,y="trailing"in n?!!n.trailing:y),_.cancel=function(){void 0!==a&&clearTimeout(a),l=0,i=u=r=a=void 0},_.flush=function(){return void 0===a?s:S(h())},_}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var a=r.test(e);return a||o.test(e)?s(e.slice(2),a?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return g(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),p(e,t,{leading:i,maxWait:t,trailing:r})}}).call(this,n(5))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(54),r=n(55),o=n(57),s=()=>{},a=new r.TimeoutError;t.default=class extends i{constructor(e){if(super(),Object.defineProperty(this,"_carryoverConcurrencyCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isIntervalIgnored",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_intervalCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_intervalCap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interval",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_intervalEnd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_intervalId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_timeoutId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_queueClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pendingCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_concurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isPaused",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_resolveEmpty",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_resolveIdle",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_throwOnTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother()}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s)}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother)return this.emit("active"),this._queue.dequeue()(),e&&this._initializeIntervalIfNeeded(),!0}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,i)=>{this._queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{const o=void 0===this._timeout&&void 0===t.timeout?e():r.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&i(a)});n(await o)}catch(e){i(e)}this._next()},t),this._tryToStartAnother()})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}set timeout(e){this._timeout=e}get timeout(){return this._timeout}}},function(e,t,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function o(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,i||e,o),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function l(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(r=!1)),l.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)i.call(e,t)&&n.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},l.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},l.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},l.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var u,l,c=this._events[a],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,s),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var f,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u)}}return!0},l.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},l.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},l.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return u(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||u(this,o);else{for(var a=0,l=[],c=s.length;a<c;a++)(s[a].fn!==t||i&&!s[a].once||n&&s[a].context!==n)&&l.push(s[a]);l.length?this._events[o]=1===l.length?l[0]:l:u(this,o)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&u(this,t)):(this._events=new o,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l},function(e,t,n){"use strict";const i=n(56);class r extends Error{constructor(e){super(e),this.name="TimeoutError"}}const o=(e,t,n)=>new Promise((o,s)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const a=setTimeout(()=>{if("function"==typeof n){try{o(n())}catch(e){s(e)}return}const i=n instanceof Error?n:new r("string"==typeof n?n:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),s(i)},t);i(e.then(o,s),()=>{clearTimeout(a)})});e.exports=o,e.exports.default=o,e.exports.TimeoutError=r},function(e,t,n){"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(58);t.default=class{constructor(){Object.defineProperty(this,"_queue",{enumerable:!0,configurable:!0,writable:!0,value:[]})}enqueue(e,t){const n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(n);const r=i.default(this._queue,n,(e,t)=>t.priority-e.priority);this._queue.splice(r,0,n)}dequeue(){const e=this._queue.shift();return e&&e.run}get size(){return this._queue.length}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){let i=0,r=e.length;for(;r>0;){const o=r/2|0;let s=i+o;n(e[s],t)<=0?(i=++s,r-=o+1):r=o}return i}},function(e,t,n){(function(e,n){var i="[object Arguments]",r="[object Function]",o="[object GeneratorFunction]",s="[object Map]",a="[object Set]",u=/\w*$/,l=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,d={};d[i]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object DataView]"]=d["[object Boolean]"]=d["[object Date]"]=d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d[s]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d[a]=d["[object String]"]=d["[object Symbol]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Error]"]=d[r]=d["[object WeakMap]"]=!1;var f="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,p=f||h||Function("return this")(),g=t&&!t.nodeType&&t,m=g&&"object"==typeof n&&n&&!n.nodeType&&n,y=m&&m.exports===g;function w(e,t){return e.set(t[0],t[1]),e}function b(e,t){return e.add(t),e}function v(e,t,n,i){var r=-1,o=e?e.length:0;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function C(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function S(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function _(e,t){return function(n){return e(t(n))}}function T(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var A,E=Array.prototype,L=Function.prototype,O=Object.prototype,I=p["__core-js_shared__"],M=(A=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",D=L.toString,k=O.hasOwnProperty,W=O.toString,j=RegExp("^"+D.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=y?p.Buffer:void 0,R=p.Symbol,P=p.Uint8Array,F=_(Object.getPrototypeOf,Object),x=Object.create,B=O.propertyIsEnumerable,U=E.splice,z=Object.getOwnPropertySymbols,H=N?N.isBuffer:void 0,V=_(Object.keys,Object),q=me(p,"DataView"),$=me(p,"Map"),G=me(p,"Promise"),Y=me(p,"Set"),Q=me(p,"WeakMap"),K=me(Object,"create"),Z=Ce(q),J=Ce($),X=Ce(G),ee=Ce(Y),te=Ce(Q),ne=R?R.prototype:void 0,ie=ne?ne.valueOf:void 0;function re(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function oe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function se(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ae(e){this.__data__=new oe(e)}function ue(e,t){var n=_e(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Te(e)}(e)&&k.call(e,"callee")&&(!B.call(e,"callee")||W.call(e)==i)}(e)?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],r=n.length,o=!!r;for(var s in e)!t&&!k.call(e,s)||o&&("length"==s||be(s,r))||n.push(s);return n}function le(e,t,n){var i=e[t];k.call(e,t)&&Se(i,n)&&(void 0!==n||t in e)||(e[t]=n)}function ce(e,t){for(var n=e.length;n--;)if(Se(e[n][0],t))return n;return-1}function de(e,t,n,l,c,f,h){var p;if(l&&(p=f?l(e,c,f,h):l(e)),void 0!==p)return p;if(!Le(e))return e;var g=_e(e);if(g){if(p=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&k.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!t)return function(e,t){var n=-1,i=e.length;t||(t=Array(i));for(;++n<i;)t[n]=e[n];return t}(e,p)}else{var m=we(e),y=m==r||m==o;if(Ae(e))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if("[object Object]"==m||m==i||y&&!f){if(C(e))return f?e:{};if(p=function(e){return"function"!=typeof e.constructor||ve(e)?{}:(t=F(e),Le(t)?x(t):{});var t}(y?{}:e),!t)return function(e,t){return pe(e,ye(e),t)}(e,function(e,t){return e&&pe(t,Oe(t),e)}(p,e))}else{if(!d[m])return f?e:{};p=function(e,t,n,i){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return he(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e,t){var n=t?he(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var n=t?he(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,i);case s:return function(e,t,n){return v(t?n(S(e),!0):S(e),w,new e.constructor)}(e,i,n);case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,u.exec(e));return t.lastIndex=e.lastIndex,t}(e);case a:return function(e,t,n){return v(t?n(T(e),!0):T(e),b,new e.constructor)}(e,i,n);case"[object Symbol]":return o=e,ie?Object(ie.call(o)):{}}var o}(e,m,de,t)}}h||(h=new ae);var _=h.get(e);if(_)return _;if(h.set(e,p),!g)var A=n?function(e){return function(e,t,n){var i=t(e);return _e(e)?i:function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}(i,n(e))}(e,Oe,ye)}(e):Oe(e);return function(e,t){for(var n=-1,i=e?e.length:0;++n<i&&!1!==t(e[n],n,e););}(A||e,(function(i,r){A&&(i=e[r=i]),le(p,r,de(i,t,n,l,r,e,h))})),p}function fe(e){return!(!Le(e)||(t=e,M&&M in t))&&(Ee(e)||C(e)?j:l).test(Ce(e));var t}function he(e){var t=new e.constructor(e.byteLength);return new P(t).set(new P(e)),t}function pe(e,t,n,i){n||(n={});for(var r=-1,o=t.length;++r<o;){var s=t[r],a=i?i(n[s],e[s],s,n,e):void 0;le(n,s,void 0===a?e[s]:a)}return n}function ge(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function me(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return fe(n)?n:void 0}re.prototype.clear=function(){this.__data__=K?K(null):{}},re.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},re.prototype.get=function(e){var t=this.__data__;if(K){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return k.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:k.call(t,e)},re.prototype.set=function(e,t){return this.__data__[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},oe.prototype.clear=function(){this.__data__=[]},oe.prototype.delete=function(e){var t=this.__data__,n=ce(t,e);return!(n<0)&&(n==t.length-1?t.pop():U.call(t,n,1),!0)},oe.prototype.get=function(e){var t=this.__data__,n=ce(t,e);return n<0?void 0:t[n][1]},oe.prototype.has=function(e){return ce(this.__data__,e)>-1},oe.prototype.set=function(e,t){var n=this.__data__,i=ce(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},se.prototype.clear=function(){this.__data__={hash:new re,map:new($||oe),string:new re}},se.prototype.delete=function(e){return ge(this,e).delete(e)},se.prototype.get=function(e){return ge(this,e).get(e)},se.prototype.has=function(e){return ge(this,e).has(e)},se.prototype.set=function(e,t){return ge(this,e).set(e,t),this},ae.prototype.clear=function(){this.__data__=new oe},ae.prototype.delete=function(e){return this.__data__.delete(e)},ae.prototype.get=function(e){return this.__data__.get(e)},ae.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.set=function(e,t){var n=this.__data__;if(n instanceof oe){var i=n.__data__;if(!$||i.length<199)return i.push([e,t]),this;n=this.__data__=new se(i)}return n.set(e,t),this};var ye=z?_(z,Object):function(){return[]},we=function(e){return W.call(e)};function be(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}function ve(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||O)}function Ce(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Se(e,t){return e===t||e!=e&&t!=t}(q&&"[object DataView]"!=we(new q(new ArrayBuffer(1)))||$&&we(new $)!=s||G&&"[object Promise]"!=we(G.resolve())||Y&&we(new Y)!=a||Q&&"[object WeakMap]"!=we(new Q))&&(we=function(e){var t=W.call(e),n="[object Object]"==t?e.constructor:void 0,i=n?Ce(n):void 0;if(i)switch(i){case Z:return"[object DataView]";case J:return s;case X:return"[object Promise]";case ee:return a;case te:return"[object WeakMap]"}return t});var _e=Array.isArray;function Te(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Ee(e)}var Ae=H||function(){return!1};function Ee(e){var t=Le(e)?W.call(e):"";return t==r||t==o}function Le(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Oe(e){return Te(e)?ue(e):function(e){if(!ve(e))return V(e);var t=[];for(var n in Object(e))k.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}n.exports=function(e){return de(e,!1,!0)}}).call(this,n(5),n(20)(e))},function(e,t,n){var i=n(34),r=n(35);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||r(s)}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t,i="object"==typeof self&&self&&self.Object===Object&&self,r=n||i||Function("return this")();function o(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function s(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}var a=Object.prototype,u=a.hasOwnProperty,l=a.toString,c=r.Symbol,d=a.propertyIsEnumerable,f=c?c.isConcatSpreadable:void 0,h=Math.max;function p(e){return m(e)||function(e){return function(e){return y(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?l.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(e)}(e)&&u.call(e,"callee")&&(!d.call(e,"callee")||"[object Arguments]"==l.call(e))}(e)||!!(f&&e&&e[f])}function g(e){if("string"==typeof e||function(e){return"symbol"==typeof e||y(e)&&"[object Symbol]"==l.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}var m=Array.isArray;function y(e){return!!e&&"object"==typeof e}var w,b,v=(w=function(e,t){return null==e?{}:function(e,t){return function(e,t,n){for(var i=-1,r=t.length,o={};++i<r;){var s=t[i],a=e[s];n(a,s)&&(o[s]=a)}return o}(e=Object(e),t,(function(t,n){return n in e}))}(e,function(e,t){for(var n=-1,i=e?e.length:0,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}(function e(t,n,i,r,o){var a=-1,u=t.length;for(i||(i=p),o||(o=[]);++a<u;){var l=t[a];n>0&&i(l)?n>1?e(l,n-1,i,r,o):s(o,l):r||(o[o.length]=l)}return o}(t,1),g))},b=h(void 0===b?w.length-1:b,0),function(){for(var e=arguments,t=-1,n=h(e.length-b,0),i=Array(n);++t<n;)i[t]=e[b+t];t=-1;for(var r=Array(b+1);++t<b;)r[t]=e[t];return r[b]=i,o(w,this,r)});e.exports=v}).call(this,n(5))},function(e,t,n){(function(e,n){var i="[object Arguments]",r="[object Map]",o="[object Object]",s="[object Set]",a=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[i]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l[r]=l["[object Number]"]=l[o]=l["[object RegExp]"]=l[s]=l["[object String]"]=l["[object WeakMap]"]=!1;var c="object"==typeof e&&e&&e.Object===Object&&e,d="object"==typeof self&&self&&self.Object===Object&&self,f=c||d||Function("return this")(),h=t&&!t.nodeType&&t,p=h&&"object"==typeof n&&n&&!n.nodeType&&n,g=p&&p.exports===h&&c.process,m=function(){try{return g&&g.binding("util")}catch(e){}}(),y=m&&m.isTypedArray;function w(e,t){for(var n=-1,i=e?e.length:0;++n<i;)if(t(e[n],n,e))return!0;return!1}function b(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function v(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function C(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var S,_,T,A=Array.prototype,E=Function.prototype,L=Object.prototype,O=f["__core-js_shared__"],I=(S=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",M=E.toString,D=L.hasOwnProperty,k=L.toString,W=RegExp("^"+M.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=f.Symbol,N=f.Uint8Array,R=L.propertyIsEnumerable,P=A.splice,F=(_=Object.keys,T=Object,function(e){return _(T(e))}),x=ce(f,"DataView"),B=ce(f,"Map"),U=ce(f,"Promise"),z=ce(f,"Set"),H=ce(f,"WeakMap"),V=ce(Object,"create"),q=he(x),$=he(B),G=he(U),Y=he(z),Q=he(H),K=j?j.prototype:void 0,Z=K?K.valueOf:void 0;function J(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function X(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ee(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function te(e){var t=-1,n=e?e.length:0;for(this.__data__=new ee;++t<n;)this.add(e[t])}function ne(e){this.__data__=new X(e)}function ie(e,t){var n=ge(e)||function(e){return function(e){return ve(e)&&me(e)}(e)&&D.call(e,"callee")&&(!R.call(e,"callee")||k.call(e)==i)}(e)?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],r=n.length,o=!!r;for(var s in e)!t&&!D.call(e,s)||o&&("length"==s||fe(s,r))||n.push(s);return n}function re(e,t){for(var n=e.length;n--;)if(pe(e[n][0],t))return n;return-1}function oe(e,t,n,a,u){return e===t||(null==e||null==t||!be(e)&&!ve(t)?e!=e&&t!=t:function(e,t,n,a,u,l){var c=ge(e),d=ge(t),f="[object Array]",h="[object Array]";c||(f=(f=de(e))==i?o:f);d||(h=(h=de(t))==i?o:h);var p=f==o&&!b(e),g=h==o&&!b(t),m=f==h;if(m&&!p)return l||(l=new ne),c||Ce(e)?ue(e,t,n,a,u,l):function(e,t,n,i,o,a,u){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new N(e),new N(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return pe(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case r:var l=v;case s:var c=2&a;if(l||(l=C),e.size!=t.size&&!c)return!1;var d=u.get(e);if(d)return d==t;a|=1,u.set(e,t);var f=ue(l(e),l(t),i,o,a,u);return u.delete(e),f;case"[object Symbol]":if(Z)return Z.call(e)==Z.call(t)}return!1}(e,t,f,n,a,u,l);if(!(2&u)){var y=p&&D.call(e,"__wrapped__"),w=g&&D.call(t,"__wrapped__");if(y||w){var S=y?e.value():e,_=w?t.value():t;return l||(l=new ne),n(S,_,a,u,l)}}if(!m)return!1;return l||(l=new ne),function(e,t,n,i,r,o){var s=2&r,a=Se(e),u=a.length,l=Se(t).length;if(u!=l&&!s)return!1;var c=u;for(;c--;){var d=a[c];if(!(s?d in t:D.call(t,d)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var h=!0;o.set(e,t),o.set(t,e);var p=s;for(;++c<u;){d=a[c];var g=e[d],m=t[d];if(i)var y=s?i(m,g,d,t,e,o):i(g,m,d,e,t,o);if(!(void 0===y?g===m||n(g,m,i,r,o):y)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var w=e.constructor,b=t.constructor;w==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,a,u,l)}(e,t,oe,n,a,u))}function se(e){return!(!be(e)||function(e){return!!I&&I in e}(e))&&(ye(e)||b(e)?W:a).test(he(e))}function ae(e){if(n=(t=e)&&t.constructor,i="function"==typeof n&&n.prototype||L,t!==i)return F(e);var t,n,i,r=[];for(var o in Object(e))D.call(e,o)&&"constructor"!=o&&r.push(o);return r}function ue(e,t,n,i,r,o){var s=2&r,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var l=o.get(e);if(l&&o.get(t))return l==t;var c=-1,d=!0,f=1&r?new te:void 0;for(o.set(e,t),o.set(t,e);++c<a;){var h=e[c],p=t[c];if(i)var g=s?i(p,h,c,t,e,o):i(h,p,c,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!w(t,(function(e,t){if(!f.has(t)&&(h===e||n(h,e,i,r,o)))return f.add(t)}))){d=!1;break}}else if(h!==p&&!n(h,p,i,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function le(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function ce(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return se(n)?n:void 0}J.prototype.clear=function(){this.__data__=V?V(null):{}},J.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},J.prototype.get=function(e){var t=this.__data__;if(V){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return D.call(t,e)?t[e]:void 0},J.prototype.has=function(e){var t=this.__data__;return V?void 0!==t[e]:D.call(t,e)},J.prototype.set=function(e,t){return this.__data__[e]=V&&void 0===t?"__lodash_hash_undefined__":t,this},X.prototype.clear=function(){this.__data__=[]},X.prototype.delete=function(e){var t=this.__data__,n=re(t,e);return!(n<0)&&(n==t.length-1?t.pop():P.call(t,n,1),!0)},X.prototype.get=function(e){var t=this.__data__,n=re(t,e);return n<0?void 0:t[n][1]},X.prototype.has=function(e){return re(this.__data__,e)>-1},X.prototype.set=function(e,t){var n=this.__data__,i=re(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},ee.prototype.clear=function(){this.__data__={hash:new J,map:new(B||X),string:new J}},ee.prototype.delete=function(e){return le(this,e).delete(e)},ee.prototype.get=function(e){return le(this,e).get(e)},ee.prototype.has=function(e){return le(this,e).has(e)},ee.prototype.set=function(e,t){return le(this,e).set(e,t),this},te.prototype.add=te.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},te.prototype.has=function(e){return this.__data__.has(e)},ne.prototype.clear=function(){this.__data__=new X},ne.prototype.delete=function(e){return this.__data__.delete(e)},ne.prototype.get=function(e){return this.__data__.get(e)},ne.prototype.has=function(e){return this.__data__.has(e)},ne.prototype.set=function(e,t){var n=this.__data__;if(n instanceof X){var i=n.__data__;if(!B||i.length<199)return i.push([e,t]),this;n=this.__data__=new ee(i)}return n.set(e,t),this};var de=function(e){return k.call(e)};function fe(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||u.test(e))&&e>-1&&e%1==0&&e<t}function he(e){if(null!=e){try{return M.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function pe(e,t){return e===t||e!=e&&t!=t}(x&&"[object DataView]"!=de(new x(new ArrayBuffer(1)))||B&&de(new B)!=r||U&&"[object Promise]"!=de(U.resolve())||z&&de(new z)!=s||H&&"[object WeakMap]"!=de(new H))&&(de=function(e){var t=k.call(e),n=t==o?e.constructor:void 0,i=n?he(n):void 0;if(i)switch(i){case q:return"[object DataView]";case $:return r;case G:return"[object Promise]";case Y:return s;case Q:return"[object WeakMap]"}return t});var ge=Array.isArray;function me(e){return null!=e&&we(e.length)&&!ye(e)}function ye(e){var t=be(e)?k.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function we(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function be(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ve(e){return!!e&&"object"==typeof e}var Ce=y?function(e){return function(t){return e(t)}}(y):function(e){return ve(e)&&we(e.length)&&!!l[k.call(e)]};function Se(e){return me(e)?ie(e):ae(e)}n.exports=function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?oe(e,t,n):!!i}}).call(this,n(5),n(20)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=new function(){let e=3;this.diagLevel=function(){return e},this.setDiagLevel=function(t){e=t},this.validationEnabled=function(){return e>=4}};t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BootReadyItem=t.BootConfigElement=t.ALL_BOOT_STAGES=void 0,t.ALL_BOOT_STAGES=["microkernel","kernel","authentication","preuser","earlyuser","user"];t.BootConfigElement=class{};t.BootReadyItem=class{constructor(e,t,n){this.name=e,this.type=t,this.config=n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkpointChannel=t.statusChannel=t.killOldApplications=void 0;const i=n(3),r=n(40);t.killOldApplications=function(e){return new Promise(async t=>{i.System.getAllApplications(async n=>{if(n)for(let t=0;t<n.length;t++){const r=n[t];if(r.uuid.endsWith("-"+e)){const e=i.System.Application.wrap(r.uuid);await i.System.closeApplication(e)}}console.log("killOldApplications: finished closing old apps"),t()})})},t.statusChannel=function(e){return`${r.STATUS_CHANNEL_BASE}.${e}`},t.checkpointChannel=function(e,t){return`${r.CHECKPOINT_CHANNEL_BASE}.${e}.${t}`}},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(n(8)),u=o(n(14));t.default=class{constructor(e,t){this.allowDelay=!1,this.delayed=!1,this.allowCancel=!1,this.canceled=!1,this.completed=!1,this.event=e.event,this.source=e.source,this.sourceType=e.sourceType,this.listenerGuid=e.listenerGuid,u[this.sourceType.toUpperCase()]&&u[this.sourceType.toUpperCase()].DELAYABLE_EVENTS.includes(this.event)&&(this.allowDelay=!0),u[this.sourceType.toUpperCase()]&&u[this.sourceType.toUpperCase()].CANCELABLE_EVENTS.includes(this.event)&&(this.allowCancel=!0),this.handler=e.handler,this.queryMessage=t,this.guid=t.data.guid,this.internalHandler()}async internalHandler(){this.data=this.queryMessage.data.data,this.handler&&await this.handler(this),this.delayed||this.canceled||this.completed||this.done()}cancel(){this.allowCancel&&(this.canceled=!0,this.done())}wait(){this.allowDelay?(this.delayed=!0,this.queryMessage.sendQueryResponse(null,{delayed:!0})):this.done()}done(e){this.completed=!0,this.delayed?a.default.transmit(`Finsemble.Listener.Done.${this.guid}.${this.listenerGuid}`,{canceled:this.canceled,data:e}):this.queryMessage.sendQueryResponse(null,{canceled:this.canceled,data:e})}}},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(13),u=o(n(68)),l=s(n(1)),c=window;t.default=class{constructor(e,t){this.values={},this.listeners=[],this.registeredDispatchListeners=[],this.mapping={},this.Dispatcher={register:e=>{this.registeredDispatchListeners.push(e)},dispatch:e=>{this.isGlobal?this.routerClient.transmit("storeService.dispatch."+this.name,e):this.handleDispatchedMessages(null,{data:e})}},this.handleChanges=(e,t)=>{if(e&&l.default.system.error("DistributedStoreClient",e),!t.data.store)return;t.data.field||(t.data.field=null);const n=this.name+(t.data.field?"."+t.data.field:""),i=t.data.storeData?t.data.storeData:t.data.value;this.triggerListeners(n,i)},this.routerClient=t,this.isGlobal=e.global,this.name=e.store?e.store:"finsemble",e.values&&(this.values=e.values),this.lst=this.listeners,u.initObject(this.values,null,this.mapping),this.isGlobal&&this.routerClient.addListener("storeService.dispatch."+this.name,this.handleDispatchedMessages.bind(this))}handleDispatchedMessages(e,t){for(let e=0;e<this.registeredDispatchListeners.length;e++)this.registeredDispatchListeners[e](t.data)}setValue(e,t){if(e.field||l.default.system.error("DistributedStore.setValue:no field provided",e),e.hasOwnProperty("value")||l.default.system.error("DistributedStore.setValue:no value provided",e),this.isGlobal){const n={store:this.name,field:e.field,value:e.value};return c.distributedStoreClient.routerClient.query("storeService.setValue",n,e=>{if(t)return t(e)})}const n=u.checkForObjectChange(this.values,e.field,this.mapping);return u.setPath(this.values,e.field,e.value),u.mapField(this.values,e.field,this.mapping),n&&this.sendRemovals(n),this.triggerListeners(this.name,this),this.publishObjectUpdates(e.field,this.mapping),t?t(null):null}publishObjectUpdates(e,t){const n=t;for(;e;)this.triggerListeners(`${this.name}.${e}`,u.byString(this.values,e)),e=n[e]}sendRemovals(e){for(let t=0;t<e.length;t++)this.triggerListeners(`${this.name}.${e[t]}`,u.byString(this.values,e[t]))}setValues(e,t){return e?Array.isArray(e)?void a.each(e,(e,t)=>{this.setValue(e,t)},e=>t?t(e):null):l.default.system.error("DistributedStore.setValues:params must be an array"):l.default.system.error("DistributedStore.setValues:no params given")}getValue(e,t){if("string"==typeof e&&(e={field:e}),!e.field)return t?t("no field provided"):"no field provided";if(this.isGlobal)return this.getGlobalValue(e,t);const n=u.byString(this.values,e.field);return void 0!==n?t?t(null,n):n:t?t("couldn't find a value"):null}getValues(e,t){if(null===e&&(e=t),"function"==typeof e)return t=e,this.isGlobal?this.getGlobalValues(null,t):t?t(null,this.values):this.values;if(!Array.isArray(e))return this.getValue(e,t);if(this.isGlobal)return this.getGlobalValues(e,t);const n={};for(let t=0;t<e.length;t++){const i=e[t],r="string"==typeof i?i:i.field,o=u.byString(this.values,r);n[r]=o}return t?t(null,n):n}getGlobalValue(e,t){c.distributedStoreClient.routerClient.query("storeService.getValue",{store:this.name,field:e.field},(e,n)=>e?t(e):t(e,n.data))}getGlobalValues(e,t){c.distributedStoreClient.routerClient.query("storeService.getValues",{store:this.name,fields:e},(e,n)=>e?t(e):t(e,n.data))}removeValue(e,t){if(!e.field){if(void 0===e)return t("no field provided");e={field:e}}return e.value=null,this.setValue(e,t)}removeValues(e,t){if(!Array.isArray(e))return t("The passed in parameter needs to be an array");a.map(e,this.removeValue,(e,n)=>t(e,n))}destroy(e){const t={store:this.name,global:this.isGlobal};c.distributedStoreClient.removeStore(t,t=>t?e(t):e(null,!0))}changeSub(e){this.subs||(this.subs=[]),this.subs[e]||(this.isGlobal&&c.distributedStoreClient.routerClient.subscribe("storeService"+e,this.handleChanges),this.subs[e]=!0)}addListener(e,t,n){"function"==typeof e&&(t=e,e={});let{field:i}=e;const r=this.name+(i?"."+i:"");return this.listeners[r]?this.listeners[r].push(t):this.listeners[r]=[t],this.changeSub(r),n?n():null}addListeners(e,t,n){if(!Array.isArray(e))return this.addListener(e,t,n);for(let n=0;n<e.length;n++){let r=null;const o=e[n];var i;"string"==typeof o?r=o:o.field&&(({field:r}=o),i=e[n].listener);const s=this.name+(r?"."+r:"");i||t&&"function"==typeof t&&(i=t),this.listeners[s]?this.listeners[s].push(i):this.listeners[s]=[i],this.changeSub(s)}return n?n():null}removeListener(e,t,n){"function"==typeof e&&(n=t,t=e,e={});let{field:i}=e;const r=this.name+(i?"."+i:"");if(this.listeners[r])for(let e=0;e<this.listeners[r].length;e++)if(this.listeners[r][e]===t)return this.listeners[r].splice(e,1),n?n(null,!0):null;return n?n(null,!1):null}removeListeners(e,t,n){if(!Array.isArray(e))return"function"==typeof e?this.removeListener({},e,n):e.field&&this.removeListener(e,t,n),n("missing fields");let i=0;for(let n=0;n<e.length;n++){let o=null;const s=e[n];var r;"string"==typeof s?o=s:s.field&&(({field:o}=s),r=e[n].listener);const a=this.name+(o?"."+o:"");if(!r){if(!t||"function"!=typeof t)continue;r=t}for(let e=0;e<this.listeners[a].length;e++)this.listeners[a][e]===r&&(this.listeners[a].splice(e,1),i++)}return i<e.length?n("All listeners could not be found",!1):n?n(null,!0):null}triggerListeners(e,t){if(this.listeners[e])for(let n=0;n<this.listeners[e].length;n++)"function"==typeof this.listeners[e][n]?(l.default.system.debug("DistributedStore.triggerListeners",e,t),this.listeners[e][n](null,{field:e,value:t})):l.default.system.warn("DistributedStoreClient:triggerListeners: listener is not a function",e,n,this.listeners[e][n])}}},function(e,t,i){"use strict";function r(e,t){const n=(t=t.replace(/^\./,"")).split(/\.(?![^[]*])/g);for(let t=0;t<n.length;++t){const i=n[t].replace(/[["\]]/g,"");if(!e)return null;if("string"==typeof e)return null;if(!(i in e))return null;e=e[i]}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.byString=r,t.initObject=function e(t,i,r){let o;i||(i=null);if("object"!=typeof t)return o=i?`${i}.${n}`:n,void(r[o]=i);for(const n in t)"object"==typeof t[n]&&"undefined"!==t[n]?(o=i?`${i}.${n}`:n,r[o]=i,e(t[n],o,r)):(o=i?`${i}.${n}`:n,r[o]=i)},t.mapField=function e(t,n,i){if(i[n])return;const o=(n=(n=n.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),s=n;if(!i.hasOwnProperty(s)){let e=null;o.length>1&&(o.pop(),e=o.join(".")),i[s]=e}const a=r(t,s);if("undefined"===a)return;if("object"==typeof a)for(const n in a)e(t,`${s}.${n}`,i)},t.checkForObjectChange=function(e,t,n){const i=r(e,t);if(null===i)return!1;if("object"==typeof i)return o(n,t);if("object"!=typeof i&&"object"==typeof t)return o(n,t);return null},t.setPath=void 0;function o(e,t){const n=[];for(const i in e){const r=t+".";i.includes(r)&&(n.push(i),delete e[i])}return n}t.setPath=(e,t,n)=>t.split(".").reduce((e,i)=>e[i]=t.split(".").pop()===i?n:e[i]||{},e)},function(e,t,n){"use strict";const i=n(70);e.exports=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=[];let n=0;const r=async(e,r,...o)=>{n++;const s=i(e,...o);r(s);try{await s}catch{}n--,t.length>0&&t.shift()()},o=(i,...o)=>new Promise(s=>((i,o,...s)=>{t.push(r.bind(null,i,o,...s)),(async()=>{await Promise.resolve(),n<e&&t.length>0&&t.shift()()})()})(i,s,...o));return Object.defineProperties(o,{activeCount:{get:()=>n},pendingCount:{get:()=>t.length},clearQueue:{value:()=>{t.length=0}}}),o}},function(e,t,n){"use strict";const i=(e,...t)=>new Promise(n=>{n(e(...t))});e.exports=i,e.exports.default=i},function(e,t,n){(function(e,n){var i="[object Arguments]",r="[object Function]",o="[object GeneratorFunction]",s="[object Map]",a="[object Set]",u=/\w*$/,l=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,d={};d[i]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object DataView]"]=d["[object Boolean]"]=d["[object Date]"]=d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d[s]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d[a]=d["[object String]"]=d["[object Symbol]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Error]"]=d[r]=d["[object WeakMap]"]=!1;var f="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,p=f||h||Function("return this")(),g=t&&!t.nodeType&&t,m=g&&"object"==typeof n&&n&&!n.nodeType&&n,y=m&&m.exports===g;function w(e,t){return e.set(t[0],t[1]),e}function b(e,t){return e.add(t),e}function v(e,t,n,i){var r=-1,o=e?e.length:0;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function C(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function S(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function _(e,t){return function(n){return e(t(n))}}function T(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var A,E=Array.prototype,L=Function.prototype,O=Object.prototype,I=p["__core-js_shared__"],M=(A=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",D=L.toString,k=O.hasOwnProperty,W=O.toString,j=RegExp("^"+D.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=y?p.Buffer:void 0,R=p.Symbol,P=p.Uint8Array,F=_(Object.getPrototypeOf,Object),x=Object.create,B=O.propertyIsEnumerable,U=E.splice,z=Object.getOwnPropertySymbols,H=N?N.isBuffer:void 0,V=_(Object.keys,Object),q=me(p,"DataView"),$=me(p,"Map"),G=me(p,"Promise"),Y=me(p,"Set"),Q=me(p,"WeakMap"),K=me(Object,"create"),Z=Ce(q),J=Ce($),X=Ce(G),ee=Ce(Y),te=Ce(Q),ne=R?R.prototype:void 0,ie=ne?ne.valueOf:void 0;function re(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function oe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function se(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ae(e){this.__data__=new oe(e)}function ue(e,t){var n=_e(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Te(e)}(e)&&k.call(e,"callee")&&(!B.call(e,"callee")||W.call(e)==i)}(e)?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],r=n.length,o=!!r;for(var s in e)!t&&!k.call(e,s)||o&&("length"==s||be(s,r))||n.push(s);return n}function le(e,t,n){var i=e[t];k.call(e,t)&&Se(i,n)&&(void 0!==n||t in e)||(e[t]=n)}function ce(e,t){for(var n=e.length;n--;)if(Se(e[n][0],t))return n;return-1}function de(e,t,n,l,c,f,h){var p;if(l&&(p=f?l(e,c,f,h):l(e)),void 0!==p)return p;if(!Le(e))return e;var g=_e(e);if(g){if(p=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&k.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!t)return function(e,t){var n=-1,i=e.length;t||(t=Array(i));for(;++n<i;)t[n]=e[n];return t}(e,p)}else{var m=we(e),y=m==r||m==o;if(Ae(e))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if("[object Object]"==m||m==i||y&&!f){if(C(e))return f?e:{};if(p=function(e){return"function"!=typeof e.constructor||ve(e)?{}:(t=F(e),Le(t)?x(t):{});var t}(y?{}:e),!t)return function(e,t){return pe(e,ye(e),t)}(e,function(e,t){return e&&pe(t,Oe(t),e)}(p,e))}else{if(!d[m])return f?e:{};p=function(e,t,n,i){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return he(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e,t){var n=t?he(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var n=t?he(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,i);case s:return function(e,t,n){return v(t?n(S(e),!0):S(e),w,new e.constructor)}(e,i,n);case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,u.exec(e));return t.lastIndex=e.lastIndex,t}(e);case a:return function(e,t,n){return v(t?n(T(e),!0):T(e),b,new e.constructor)}(e,i,n);case"[object Symbol]":return o=e,ie?Object(ie.call(o)):{}}var o}(e,m,de,t)}}h||(h=new ae);var _=h.get(e);if(_)return _;if(h.set(e,p),!g)var A=n?function(e){return function(e,t,n){var i=t(e);return _e(e)?i:function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}(i,n(e))}(e,Oe,ye)}(e):Oe(e);return function(e,t){for(var n=-1,i=e?e.length:0;++n<i&&!1!==t(e[n],n,e););}(A||e,(function(i,r){A&&(i=e[r=i]),le(p,r,de(i,t,n,l,r,e,h))})),p}function fe(e){return!(!Le(e)||(t=e,M&&M in t))&&(Ee(e)||C(e)?j:l).test(Ce(e));var t}function he(e){var t=new e.constructor(e.byteLength);return new P(t).set(new P(e)),t}function pe(e,t,n,i){n||(n={});for(var r=-1,o=t.length;++r<o;){var s=t[r],a=i?i(n[s],e[s],s,n,e):void 0;le(n,s,void 0===a?e[s]:a)}return n}function ge(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function me(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return fe(n)?n:void 0}re.prototype.clear=function(){this.__data__=K?K(null):{}},re.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},re.prototype.get=function(e){var t=this.__data__;if(K){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return k.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:k.call(t,e)},re.prototype.set=function(e,t){return this.__data__[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},oe.prototype.clear=function(){this.__data__=[]},oe.prototype.delete=function(e){var t=this.__data__,n=ce(t,e);return!(n<0)&&(n==t.length-1?t.pop():U.call(t,n,1),!0)},oe.prototype.get=function(e){var t=this.__data__,n=ce(t,e);return n<0?void 0:t[n][1]},oe.prototype.has=function(e){return ce(this.__data__,e)>-1},oe.prototype.set=function(e,t){var n=this.__data__,i=ce(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},se.prototype.clear=function(){this.__data__={hash:new re,map:new($||oe),string:new re}},se.prototype.delete=function(e){return ge(this,e).delete(e)},se.prototype.get=function(e){return ge(this,e).get(e)},se.prototype.has=function(e){return ge(this,e).has(e)},se.prototype.set=function(e,t){return ge(this,e).set(e,t),this},ae.prototype.clear=function(){this.__data__=new oe},ae.prototype.delete=function(e){return this.__data__.delete(e)},ae.prototype.get=function(e){return this.__data__.get(e)},ae.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.set=function(e,t){var n=this.__data__;if(n instanceof oe){var i=n.__data__;if(!$||i.length<199)return i.push([e,t]),this;n=this.__data__=new se(i)}return n.set(e,t),this};var ye=z?_(z,Object):function(){return[]},we=function(e){return W.call(e)};function be(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}function ve(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||O)}function Ce(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Se(e,t){return e===t||e!=e&&t!=t}(q&&"[object DataView]"!=we(new q(new ArrayBuffer(1)))||$&&we(new $)!=s||G&&"[object Promise]"!=we(G.resolve())||Y&&we(new Y)!=a||Q&&"[object WeakMap]"!=we(new Q))&&(we=function(e){var t=W.call(e),n="[object Object]"==t?e.constructor:void 0,i=n?Ce(n):void 0;if(i)switch(i){case Z:return"[object DataView]";case J:return s;case X:return"[object Promise]";case ee:return a;case te:return"[object WeakMap]"}return t});var _e=Array.isArray;function Te(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Ee(e)}var Ae=H||function(){return!1};function Ee(e){var t=Le(e)?W.call(e):"";return t==r||t==o}function Le(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Oe(e){return Te(e)?ue(e):function(e){if(!ve(e))return V(e);var t=[];for(var n in Object(e))k.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}n.exports=function(e){return de(e,!0,!0)}}).call(this,n(5),n(20)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FinsembleView=void 0;t.FinsembleView=class{constructor(e){this.win=e.win,this.id=e.id}async remove(e=Function.prototype){await this.win.removeBrowserView(this,e)}async setBounds(e,t=Function.prototype){await this.win.setViewBounds({view:this,bounds:e},t)}async bringToFront(e=Function.prototype){await this.win.bringViewToFront(this,e)}}},function(e,t,n){"use strict";var i=n(10);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(1));var o=function(e,t){const n=(t=t||{}).successCallbackName||"callback",i=t.errorCallbackName||"errorCallback",o=t.noResponseTimeout||1e4,s=t.verySlowTimeout||2e3,a=t.slowTimeout||1e3;function u(e){let t;const n=function(){const e={launchExternalProcess:["options","callback","errorCallbackName"]};return e}();return t=e.name in n?n[e.name]:function(e){const t=e.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,"");let n=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(/([^\s,]+)/g);return null===n&&(n=[]),n}(e),r.default.system.verbose(`Signature for ${e.name}: ${t}`),t}function l(e,t){const n={};return o&&(n.noResponseTimeoutID=setTimeout(()=>{r.default.error(`Callback Timeout: ${o} millisecond timeout waiting on ${e}`,t)},o)),s&&(n.verySlowTimeoutID=setTimeout(()=>{r.default.warn(`Callback Timeout: ${s} millisecond timeout waiting on ${e}`,t)},s)),a&&(n.slowTimeoutID=setTimeout(()=>{r.default.debug(`Callback Timeout: ${a} millisecond timeout waiting on ${e}`,t)},a)),n}function c(e){r.default.system.debug("wrapCallbacks Clearing Timers:",e),clearTimeout(e.noResponseTimeoutID),clearTimeout(e.verySlowTimeoutID),clearTimeout(e.slowTimeoutID)}function d(e,t,n,i){let o=!1;if(n>-1&&t.length>=n&&"function"==typeof t[n]){const s=t[n],a=function(){r.default.system.verbose("In Wrap Callback "+e),c(i),s&&s.apply(null,arguments)};t[n]=a,o=!0}return o}"wrapCallbacksDone"in e||(!function(e){for(const t in e)if("function"==typeof e[t]){r.default.system.verbose("Iterating through function "+t);const o=e[t],s=u(o),a=s.indexOf(n),f=s.indexOf(i);(a>-1||f>-1)&&(r.default.system.verbose(`Wrapping ${n} and/or ${i} in ${t}: ${o}`),e[t]=function(){const e=Array.from(arguments);let n="Wrapper call trace disabled for efficiency";const i=l(t,n),r=d(t,e,a,i),s=d(t,e,f,i);r||s||c(i),o.apply(this,e)})}}(e),e.wrapCallbacksDone=!0)};t.default=o,e.exports=t.default},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationClient=void 0;const r=i(n(6)),o=n(4),s=n(15),a=n(12);class u extends o._BaseClient{constructor(e){super(e),this.publishAuthorization=(e,t)=>{r.default.args(e,"string",t,"object"),this.routerClient.transmit("AuthenticationService.authorization",{user:e,credentials:t})},this.getCurrentCredentials=e=>{this.routerClient.query("authentication.currentCredentials",null,(t,n)=>{const i=t?null:n.data;e(t,i)})},this.transmitSignOnToAuthService=e=>{r.default.args(e,"object"),this.logger.system.debug("AUTHORIZATION: Transmitting SignOn To AuthService"),this.routerClient.transmit("authentication.dialogSignOnToAuthService",e)},this.appSignOn=(e,t,n)=>{this.logger.system.debug("AUTHORIZATION: Signing on to app "+e),r.default.args(e,"string",t,"object",n,"function"),this.routerClient.query("authentication.appSignOn",{signOnKey:e,params:t},{timeout:-1},(e,t)=>{n&&n(e,t.data)})},this.appRejectAndRetrySignOn=(e,t,n)=>{this.logger.system.warn("AUTHORIZATION: appRejectAndRetrySignOn",e),r.default.args(e,"string",t,"object",n,"function"),this.routerClient.query("authentication.appRejectAndRetrySignOn",{signOnKey:e,params:t},{timeout:-1},(e,t)=>{n&&n(e,t.data)})},this.appAcceptSignOn=e=>{this.logger.system.info("AUTHORIZATION: Accepted application sign on.",e),r.default.args(e,"string"),this.routerClient.transmit("authentication.appAcceptSignOn",{signOnKey:e})},this.appRejectSignOn=e=>{this.logger.system.error("AUTHORIZATION: Rejected application sign on.",e),r.default.args(e,"string"),this.routerClient.transmit("authentication.appRejectSignOn",{signOnKey:e})},this.completeOAUTH=(e,t,n)=>{if(this.logger.system.log("completeOAUTH",t),r.default.args(t,"object="),!t){t={};const e=new URLSearchParams(window.location.search);for(const n of e.entries())t[n[0]]=n[1]}const i=()=>{this.routerClient.query("authentication.completeOAUTH",{err:e,params:t},(e,t)=>{let{data:i}=t;n(e,i)})};t.state?i():this.isInAService?this.logger.system.error("OAUTH Error. This functionality is not yet available in services."):this.finsembleWindow.getOptions((e,n)=>{t.state=n.customData.OAuthState,i()})},this.start=e=>{if(a.iAmAServiceWindow())return this.isInAService=!0,void(e&&e());s.FinsembleWindow.getInstance({name:this.finWindow.name,uuid:this.finWindow.uuid},(t,n)=>{"Cannot Wrap Service Manager or Services"===t?this.isInAService=!0:this.finsembleWindow=n,e&&e()})},this.beginAuthentication=this.beginAuthentication.bind(this)}beginAuthentication(e,t){this.routerClient.query("authentication.beginAuthentication",e,(e,n)=>{t(e,n.data)})}}t.AuthenticationClient=u;var l=new u({onReady:e=>{l.start(e)},name:"authenticationClient"});t.default=l},function(e){e.exports=JSON.parse('{"dictionary":{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7","8":"8","9":"9","backspace":"Backspace","bs":"Backspace","bksp":"Backspace","tab":"Tab","escape":"Escape","esc":"Escape","clear":"Clear","enter":"Enter","return":"Enter","shift":"Shift","shft":"Shift","lshift":"Shift","lshft":"Shift","left shift":"Shift","leftshift":"Shift","rshift":"Shift","rshft":"Shift","right shift":"Shift","rightshift":"Shift","control":"Control","ctrl":"Control","alt":"Alt","alternate":"Alt","pause":"Pause","caps lock":"Capslock","capslock":"Capslock","spacebar":"Space","space":"Space","space bar":"Space","page up":"PageUp","pgup":"PageUp","pg up":"PageUp","page down":"PageDown","pgdn":"PageDown","pg dn":"PageDown","pgdown":"PageDown","end":"End","home":"Home","left arrow":"Left","left":"Left","up arrow":"Up","up":"Up","right arrow":"Right","right":"Right","down arrow":"Down","down":"Down","select":"Select","slct":"Select","print":"PrintScreen","prnt":"PrintScreen","execute":"Execute","print screen":"PrintScreen","printscreen":"PrintScreen","print scrn":"PrintScreen","printscrn":"PrintScreen","prnt scrn":"PrintScreen","prntscrn":"PrintScreen","prt scrn":"PrintScreen","prtscrn":"PrintScreen","prt scn":"PrintScreen","prtscn":"PrintScreen","prt scr":"PrintScreen","prtscr":"PrintScreen","prt sc":"PrintScreen","prtsc":"PrintScreen","pr sc":"PrintScreen","prsc":"PrintScreen","insert":"Insert","ins":"Insert","delete":"Delete","del":"Delete","a":"A","b":"B","c":"C","d":"D","e":"E","f":"F","g":"G","h":"H","i":"I","j":"J","k":"K","l":"L","m":"M","n":"N","o":"O","p":"P","q":"Q","r":"R","s":"S","t":"T","u":"U","v":"V","w":"W","x":"X","y":"Y","z":"Z","windows":"Super","left windows":"Super","right windows":"Super","numpad 0":"num0","numpad 1":"num1","numpad 2":"num2","numpad 3":"num3","numpad 4":"num4","numpad 5":"num5","numpad 6":"num6","numpad 7":"num7","numpad 8":"num8","numpad 9":"num9","f1":"F1","fn1":"F1","function 1":"F1","f2":"F2","fn2":"F2","function 2":"F2","f3":"F3","fn3":"F3","function 3":"F3","f4":"F4","fn4":"F4","function 4":"F4","f5":"F5","fn5":"F5","function 5":"F5","f6":"F6","fn6":"F6","function 6":"F6","f7":"F7","fn7":"F7","function 7":"F7","f8":"F8","fn8":"F8","function 8":"F8","f9":"F9","fn9":"F9","function 9":"F9","f10":"F10","fn10":"F10","function 10":"F10","f11":"F11","fn11":"F11","function 11":"F11","f12":"F12","fn12":"F12","function 12":"F12","f13":"F13","fn":"F13","function 13":"F13","f14":"F14","fn14":"F14","function 14":"F14","f15":"F15","fn15":"F15","function 15":"F15","f16":"F16","fn16":"F16","function 16":"F16","num lock":"Numlock","numlock":"Numlock","number lock":"Numlock","numeric lock":"Numlock","scroll lock":"Scrolllock","sclk":"Scrolllock","scrlk":"Scrolllock","slk":"Scrolllock","*":"*","+":"+","-":"-","/":"/",";":";","=":"=",",":",","_":"-",".":".","`":"`","[":"[","]":"]","\'":"\'"}}')},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const r=n(13),o=i(n(1)),s=i(n(6)),a=n(4),u=i(n(43)),l=i(n(18)),c=i(n(16)),d=i(n(17)),f=n(15),h=n(9),p=n(3),g=n(77),m=n(80).default,y=n(81).default,w={DROP:"drop",SPAWN:"spawn",LINKER:"linker"};class b extends a._BaseClient{constructor(e){super(e),s.default.args(e,"object=")&&e&&s.default.args2("params.onReady",e.onReady,"function="),this.emitters={},this.sourceData=[],this.receivers={},this.receiveResponder=!1,this.linkerListener=!1,this.openLinkerDataByDefault=!0,this.SHARE_METHOD=w,this.bindAllFunctions()}bindAllFunctions(){const e=this;for(const t of Object.getOwnPropertyNames(Object.getPrototypeOf(e))){const n=e[t];n instanceof Function&&n!==b&&(e[t]=e[t].bind(e))}}setEmitters(e){if(!Array.isArray(e.emitters))return;const t=this;e.emitters.forEach(e=>{t.emitters[e.type]=e}),this.routerClient.publish(this.windowName+"Finsemble.Sharer",{emitterEnabled:!!Object.keys(t.emitters).length,receiverEnabled:!!Object.keys(t.receivers).length}),this.receiveResponder||(this.routerClient.addResponder(this.windowName+".Share",(e,n)=>{t.emit.call(t,e,n)}),this.receiveResponder=!0)}addReceivers(e){if(!Array.isArray(e.receivers))return;const t=this;e.receivers.forEach(e=>{const n=e.type.toString();t.receivers[n]?t.receivers[n].push(e):t.receivers[n]=[e]}),this.routerClient.publish(this.windowName+"Finsemble.Sharer",{emitterEnabled:!!Object.keys(t.emitters).length,receiverEnabled:!!Object.keys(t.receivers).length});const n=c.default.getSpawnData();n&&n.sharedData&&c.default.getComponentState({field:"Finsemble.DealtWithSpawnSharedData"},(e,i)=>{i||c.default.setComponentState({field:"Finsemble.DealtWithSpawnSharedData",value:"done"},()=>{t.handleSharedData(n.sharedData,w.SPAWN)})}),!this.linkerListener&&this.openLinkerDataByDefault&&(u.default.subscribe("Finsemble.DragAndDropClient",(e,n)=>{n.originatedHere()||Object.keys(e).forEach(n=>{if(t.canReceiveData(n)){const i={};i[n]=e[n],t.handleSharedData(i,w.LINKER)}})}),this.linkerListener=!0)}updateReceivers(e){if(!Array.isArray(e.receivers))return;const t=this;e.receivers.forEach(e=>{const n=e.type.toString();t.receivers[n]||(t.receivers[n]=[]);const i=t.receivers[n];for(let t=0;t<i.length;t++)i[t].handler===e.oldHandler&&(i[t].handler=e.handler);t.receivers[n].push(e.handler)}),t.linkerListener||(u.default.subscribe("Finsemble.DragAndDropClient",(e,n)=>{n.originatedHere()||t.handleSharedData(e,w.LINKER)}),t.linkerListener=!0)}removeReceivers(e){if(!Array.isArray(e.receivers))return;const t=this;e.receivers.forEach(e=>{const n=e.type.toString();if(!t.receivers[n])return;const i=t.receivers[n];for(let t=0;t<i.length;t++)if(i[t].handler===e.handler){i.splice(t,1);break}})}dragStart(e){const t={FSBL:!0,window:this.windowName};this.routerClient.transmit("DragAndDropClient.prepareDrag",Object.keys(this.emitters)),e.dataTransfer.setData("text/plain",JSON.stringify(t))}dragStartWithData(e,t){this.routerClient.transmit("DragAndDropClient.dragStart",Object.keys(t));const n={FSBL:!0,containsData:!0,window:this.windowName,data:t};e.dataTransfer.setData("text/plain",JSON.stringify(n))}handleSharedData(e,t){const n=this;Object.keys(n.receivers).forEach(i=>{const r=n.receivers[i],s={};Object.keys(e).forEach(t=>{o.default.system.info("DragAndDropClient:handleSharedData:Data value:",t),r[0].type instanceof RegExp?t.match(r.type)&&(s[t]=e[t]):r[0].type==t&&(s[t]=e[t])}),Object.keys(s).length&&r.forEach(e=>{e.handler(null,{data:s,shareMethod:t})})})}drop(e){const t=this;e.dataTransfer||(e.dataTransfer=e.originalEvent.dataTransfer);let n=e.dataTransfer.getData("text/plain");if(n){try{n=JSON.parse(n)}catch(e){return}if(n.FSBL)if(e.preventDefault(),e.stopPropagation(),n.containsData)t.handleSharedData(n.data,w.DROP);else{const e=n.window,i=this.sourceData,r=[];for(let e=0;e<i.length;e++){const n=i[e];t.canReceiveData(n)&&r.push(n)}t.routerClient.query(e+".Share",r,(e,n)=>{t.handleSharedData(n.data,w.DROP)})}}}emit(e,t){const n={},i=this;r.each(t.data,(e,t)=>{const r=i.emitters[e];r.data&&"function"==typeof r.data?(n[e]=r.data(),t()):(n[e]=r.data,t())},()=>{t.sendQueryResponse(null,n)})}getComponentsThatCanReceiveType(e,t){o.default.system.warn("DragAndDropClient.getComponentsThatCanReceiveType has been deprecated. Use LauncherClient.getComponentsThatCanReceiveDataTypes instead."),l.default.getComponentsThatCanReceiveDataTypes({dataTypes:[e]},(n,i)=>{t(n,i&&i[e]?i[e].componentTypes:[])})}openSharedData(e,t){h.openSharedData(e,t)}addWindowHighlight(e){const t=this,n=document.createElement("div");n.id="fsbl-share-scrim",n.className="fsbl-share-scrim";const i=document.createElement("style");i.innerHTML=g;const r=document.createElement("img");e?(r.src=m,r.className="ff-share",document.addEventListener("dragover",t.dragover),document.addEventListener("drop",t.drop)):(n.className="fsbl-share-scrim no",r.src=y,r.className="ff-delete-circle"),n.appendChild(i),n.appendChild(r),document.body.appendChild(n),this.finsembleWindow.updateOptions({options:{opacity:1}})}removeWindowHighlight(){const e=document.getElementById("fsbl-share-scrim");e&&e.parentNode.removeChild(e),document.removeEventListener("dragover",this.dragover),document.removeEventListener("drop",this.drop),this.finsembleWindow.updateOptions({options:{opacity:1}})}canReceiveData(e,t=null){Array.isArray(e)||(e=[e]);const n=this;let i=!1;t||(t=Object.keys(n.receivers),i=!0);for(let r=0;r<e.length;r++){const o=e[r];for(let e=0;e<t.length;e++){if(!i){if(o===t[e])return!0;continue}let r=n.receivers[t[e]];if(r.length)if(r=r[0],r.type instanceof RegExp){if(o.match(r.type))return!0}else if(o===r.type)return!0}}return!1}dragover(e){return e.preventDefault(),!1}addListeners(e){const t=this;window.addEventListener("dragend",()=>{t.routerClient.transmit("DragAndDropClient.dragEnd",{})}),this.routerClient.addListener("DragAndDropClient.prepareDrag",(e,t)=>{t.originatedHere()&&(p.System.isBrowserView()?this.routerClient.transmit("DragAndDropClient.dragStart",Object.keys(this.emitters)):p.System.hasBrowserView()||this.routerClient.transmit("DragAndDropClient.dragStart",t.data))}),this.routerClient.addListener("DragAndDropClient.dragStart",(e,n)=>{this.sourceData=n.data,!t.canReceiveData(this.sourceData)||n.originatedHere()?t.addWindowHighlight(!1):t.addWindowHighlight(!0)}),this.routerClient.addListener("DragAndDropClient.dragEnd",()=>{t.removeWindowHighlight()}),e(),d.default.createStore({store:"Finsemble-Share",global:!0},(e,n)=>{t.store=n})}getFinsembleWindow(e){f.FinsembleWindow.getInstance({name:this.finWindow.name,uuid:this.finWindow.uuid},(t,n)=>{this.finsembleWindow=n,e()})}}var v=new b({startupDependencies:{clients:["windowClient","distributedStoreClient"]},onReady(e=Function.prototype){r.parallel([e=>{v.addListeners(e)},e=>{u.default.onReady(e)},e=>{l.default.onReady(e)},e=>{v.getFinsembleWindow(e)}],(t,n)=>e(t,n))},name:"dragAndDropClient"});t.default=v},function(e,t,n){var i=n(78);e.exports="string"==typeof i?i:i.toString()},function(e,t,n){(t=n(79)(!1)).push([e.i,"/**\r\n * The contents of this file are dynamically injected as a <style> tag\r\n * within the scrim container element.\r\n */\r\n:root {\r\n\t--accent-primary-1: #36788b;\r\n\t--accent-negative: #f26666;\r\n\t--scrim-positive-background-color: var(--accent-primary-1);\r\n\t--scrim-negative-background-color: var(--accent-negative);\r\n}\r\n\r\n.fsbl-share-scrim {\r\n\tposition: fixed;\r\n\tdisplay: flex;\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\tz-index: 1000000;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tjustify-content: center;\r\n\talign-content: center;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\ttransition: all 0.3s ease;\r\n\topacity: 0.85;\r\n\tbackground-color: var(--scrim-positive-background-color);\r\n}\r\n\r\n.fsbl-share-scrim .error-message {\r\n\tdisplay: flex;\r\n\theight: 100%;\r\n\talign-content: center;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tpadding: 1em;\r\n\tbackground-color: var(--scrim-negative-background-color);\r\n}\r\n\r\n.fsbl-share-scrim img {\r\n\tdisplay: flex;\r\n\theight: 10%;\r\n\twidth: 10%;\r\n\tz-index: 1000000;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tjustify-content: center;\r\n\talign-content: center;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n}\r\n\r\n.fsbl-share-scrim.no {\r\n\tbackground-color: var(--scrim-negative-background-color);\r\n}\r\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(u," */")),o=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(o).concat([r]).join("\n")}var s,a,u;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<e.length;a++){var u=[].concat(e[a]);i&&r[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},function(e,t,n){"use strict";n.r(t),t.default="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjIzcHgiIGhlaWdodD0iMjNweCIgdmlld0JveD0iMCAwIDIzIDIzIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDx0aXRsZT5TaGFyZSBXaGl0ZTwvdGl0bGU+DQogICAgPGcgaWQ9IlNoYXJlLVdoaXRlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IlBhZ2UtMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEuMDAwMDAwKSIgZmlsbD0iI0ZGRkZGRiI+DQogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOC4wMDAwMDAsIDAuNDc5MTAwKSI+DQogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0LjMyNzE3MTcsNi4wNjQ4MDg1OSBDMTQuMzU4Nzg0Myw2LjAxODIyMTU3IDE0LjM5NTM4ODQsNS45NzY2MjYwMiAxNC40MTcwMTgxLDUuOTI1MDQ3NTQgQzE0LjQ5ODU0NTQsNS43MjM3MjUwNyAxNC40OTg1NDU0LDUuNDk5MTA5MDkgMTQuNDE3MDE4MSw1LjI5OTQ1MDQ0IEMxNC4zOTUzODg0LDUuMjQ2MjA4MTQgMTQuMzU4Nzg0Myw1LjIwNDYxMjU5IDE0LjMyNzE3MTcsNS4xNTgwMjU1NyBDMTQuMzAwNTUwNiw1LjExOTc1NzY2IDE0LjI4NTU3NjIsNS4wNzQ4MzQ0NyAxNC4yNTIyOTk3LDUuMDM5ODk0MiBMMTQuMjM1NjYxNSw1LjAyNDkxOTgxIEMxNC4yMzU2NjE1LDUuMDIzMjU1OTggMTQuMjM1NjYxNSw1LjAyMzI1NTk4IDE0LjIzMzk5NzcsNS4wMjMyNTU5OCBMOS43MzUwMjI4NCwwLjI1OTczMzQzOSBDOS40MTg4OTY2NSwtMC4wNzEzNjcxNSA4Ljg5MzEyODg5LC0wLjA4OTY2OTE5MjYgOC41NTg3MDA2NSwwLjIyNjQ1Njk5OCBDOC4yMjU5MzYyNCwwLjU0MjU4MzE4OCA4LjIxMDk2MTg0LDEuMDY4MzUwOTYgOC41MjcwODgwMywxLjQwMjc3OTE5IEwxMS43MTgyOTg3LDQuNzgwMzM3OTYgTDIuOTkxNTUyMDYsNC43ODAzMzc5NiBDMS4zNDEwNDA1OCw0Ljc4MDMzNzk2IDAsNi40MzQxNzcwOSAwLDguNDY5MDMxNDYgTDAsMTAuNjkwMjMzOSBDMCwxMS4xNTExMTI2IDAuMzcxMDMyMzE4LDExLjUyMjE0NDkgMC44MzE5MTEwMjgsMTEuNTIyMTQ0OSBDMS4yOTExMjU5MSwxMS41MjIxNDQ5IDEuNjYzODIyMDYsMTEuMTUxMTEyNiAxLjY2MzgyMjA2LDEwLjY5MDIzMzkgTDEuNjYzODIyMDYsOC40NjkwMzE0NiBDMS42NjM4MjIwNiw3LjM3MDkwODkgMi4yNzExMTcxMSw2LjQ0NDE2MDAyIDIuOTkxNTUyMDYsNi40NDQxNjAwMiBMMTEuNzE4Mjk4Nyw2LjQ0NDE2MDAyIEw4LjUyNzA4ODAzLDkuODIwMDU0OTcgQzguMjEwOTYxODQsMTAuMTU0NDgzMiA4LjIyNTkzNjI0LDEwLjY3ODU4NzEgOC41NTg3MDA2NSwxMC45OTYzNzcyIEM4LjcyMDA5MTM5LDExLjE0Nzc4NSA4LjkyNjQwNTMzLDExLjIyNDMyMDggOS4xMzEwNTU0NCwxMS4yMjQzMjA4IEM5LjM1MjM0Mzc3LDExLjIyNDMyMDggOS41NzE5NjgyOCwxMS4xMzYxMzgyIDkuNzM1MDIyODQsMTAuOTYxNDM2OSBMMTQuMjMzOTk3Nyw2LjIwMTI0MiBDMTQuMjM1NjYxNSw2LjE5OTU3ODE4IDE0LjIzNTY2MTUsNi4xOTk1NzgxOCAxNC4yMzU2NjE1LDYuMTk5NTc4MTggTDE0LjI1MjI5OTcsNi4xODI5Mzk5NiBDMTQuMjg1NTc2Miw2LjE0Nzk5OTY5IDE0LjMwMDU1MDYsNi4xMDMwNzY1IDE0LjMyNzE3MTcsNi4wNjQ4MDg1OSIgaWQ9IkZpbGwtMSI+PC9wYXRoPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAyLjQ3OTEwMCkiPg0KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yMS45NzA3NzAyLDE4LjUxNjY3NTcgTDAuODMxOTExMDI4LDE4LjUxNjY3NTcgQzAuMzcyNjk2MTQsMTguNTE2Njc1NyAwLDE4LjE0Mzk3OTUgMCwxNy42ODQ3NjQ2IEwwLDAuODMxOTExMDI4IEMwLDAuMzcxMDMyMzE4IDAuMzcyNjk2MTQsMCAwLjgzMTkxMTAyOCwwIEw1LjQwNzQyMTY4LDAgQzUuODY2NjM2NTcsMCA2LjIzOTMzMjcxLDAuMzcxMDMyMzE4IDYuMjM5MzMyNzEsMC44MzE5MTEwMjggQzYuMjM5MzMyNzEsMS4yOTExMjU5MSA1Ljg2NjYzNjU3LDEuNjYzODIyMDYgNS40MDc0MjE2OCwxLjY2MzgyMjA2IEwxLjY2MzgyMjA2LDEuNjYzODIyMDYgTDEuNjYzODIyMDYsMTYuODUyODUzNiBMMjEuMTM4ODU5MiwxNi44NTI4NTM2IEwyMS4xMzg4NTkyLDEwLjc0OTk1NDMgQzIxLjEzODg1OTIsMTAuMjkwNzM5NCAyMS41MTE1NTU0LDkuOTE4MDQzMjcgMjEuOTcwNzcwMiw5LjkxODA0MzI3IEMyMi40Mjk5ODUxLDkuOTE4MDQzMjcgMjIuODAyNjgxMywxMC4yOTA3Mzk0IDIyLjgwMjY4MTMsMTAuNzQ5OTU0MyBMMjIuODAyNjgxMywxNy42ODQ3NjQ2IEMyMi44MDI2ODEzLDE4LjE0Mzk3OTUgMjIuNDI5OTg1MSwxOC41MTY2NzU3IDIxLjk3MDc3MDIsMTguNTE2Njc1NyIgaWQ9IkZpbGwtNCI+PC9wYXRoPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+"},function(e,t,n){"use strict";n.r(t),t.default="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjI0cHgiIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPg0KICAgIDx0aXRsZT5mZi1kZWxldGUtY2lyY2xlPC90aXRsZT4NCiAgICA8ZyBpZD0iU3ltYm9scyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSJmZi1kZWxldGUtY2lyY2xlIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPg0KICAgICAgICAgICAgPHBhdGggZD0iTTguOCwxNS44IEM4LjYsMTUuOCA4LjQsMTUuNyA4LjMsMTUuNiBDOCwxNS4zIDgsMTQuOCA4LjMsMTQuNSBMMTQuNCw4LjMgQzE0LjcsOCAxNS4yLDggMTUuNSw4LjMgQzE1LjgsOC42IDE1LjgsOS4xIDE1LjUsOS40IEw5LjQsMTUuNiBDOS4yLDE1LjcgOSwxNS44IDguOCwxNS44IiBpZD0iUGF0aCI+PC9wYXRoPg0KICAgICAgICAgICAgPHBhdGggZD0iTTE0LjksMTUuOCBDMTQuNywxNS44IDE0LjUsMTUuNyAxNC40LDE1LjYgTDguMyw5LjQgQzgsOS4xIDgsOC42IDguMyw4LjMgQzguNiw4IDkuMSw4IDkuNCw4LjMgTDE1LjUsMTQuNSBDMTUuOCwxNC44IDE1LjgsMTUuMyAxNS41LDE1LjYgQzE1LjMsMTUuNyAxNS4xLDE1LjggMTQuOSwxNS44IiBpZD0iUGF0aCI+PC9wYXRoPg0KICAgICAgICAgICAgPHBhdGggZD0iTTExLjYsMS42IEM2LjEsMS42IDEuNiw2LjIgMS42LDExLjcgQzEuNiwxNy4zIDYuMSwyMS44IDExLjYsMjEuOCBDMTcuMSwyMS44IDIxLjYsMTcuMiAyMS42LDExLjcgQzIxLjYsNi4xIDE3LjEsMS42IDExLjYsMS42IFogTTExLjYsMjMuNCBDNS4yLDIzLjQgMCwxOC4xIDAsMTEuNyBDMCw1LjMgNS4yLDAgMTEuNiwwIEMxOCwwIDIzLjIsNS4yIDIzLjIsMTEuNyBDMjMuMiwxOC4yIDE3LjksMjMuNCAxMS42LDIzLjQgTDExLjYsMjMuNCBaIiBpZD0iU2hhcGUiPjwvcGF0aD4NCiAgICAgICAgPC9nPg0KICAgIDwvZz4NCjwvc3ZnPg=="},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(4),u=o(n(9)),l=s(n(6)),c=s(n(1)),d=n(14),f=n(11);class h extends a._BaseClient{constructor(e){super(e),this.workspaces=[],this.setWorkspaces=this.setWorkspaceOrder,this.createNewWorkspace=this.createWorkspace,this.getWorkspaceDefinition=this.export,this.addWorkspaceDefinition=this.import,this.saveWorkspaceTemplateToConfigFile=this.exportToFile,l.default.args(e,"object=")&&e&&l.default.args2("params.onReady",e.onReady,"function=")}_serviceResponseHandler(e,t,n,i,r=Function.prototype){if(e)return i(new Error(e)),r(e);t||(t={data:null}),n(t.data),r(null,t.data)}saveGlobalData(e,t){c.default.system.debug("WorkspaceClient.saveGlobalData",e);return new Promise((n,i)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.SAVE_GLOBAL_DATA,e,(e,r)=>{this._serviceResponseHandler(e,r,n,i,t)})})}saveViewData(e,t){c.default.system.debug("WorkspaceClient.saveViewData",e);return new Promise((n,i)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.SAVE_VIEW_DATA,e,(e,r)=>{this._serviceResponseHandler(e,r,n,i,t)})})}addEventListener(e,t){super.addEventListener(e,t)}async addWindow(e,t=null){l.default.args(e,"object",t,"function=")&&e&&l.default.args2("params.name",e.name,"string");const{err:n,response:i}=await this.routerClient.query("WorkspaceService.addWindow",e,()=>{});if(c.default.system.log(`WORKSPACE LIFECYCLE: Window added:WorkspaceClient.addWindow: Name (${e.name})`),t&&t(n,i),!t&&n)throw n;return i}removeWindow(e,t=Function.prototype){l.default.args(e,"object",t,"function=")&&l.default.args2("params.name",e.name,"string"),this.routerClient.query("WorkspaceService.removeWindow",e,(n,i)=>{if(n)return c.default.system.error(n);c.default.system.log(`WORKSPACE LIFECYCLE:WorkspaceClient.removeWindow:Window removed: Name (${e.name})`),t(n,i?i.data:null)})}autoArrange(e,t=Function.prototype){l.default.args(e,"object",t,"function="),e=e||{},u.getMyWindowIdentifier(e=>{this.routerClient.query("DockingService.autoArrange",{windowIdentifier:e},t)})}minimizeAll(e,t=Function.prototype){l.default.args(e,"object",t,"function="),e=e||{monitor:"all"},u.getMyWindowIdentifier(n=>{e.windowIdentifier||(e.windowIdentifier=n),this.routerClient.query("WorkspaceService.minimizeAll",e,t)})}bringWindowsToFront(e,t=Function.prototype){l.default.args(e,"object",t,"function="),e=e||{monitor:"all"},u.getMyWindowIdentifier(n=>{e.windowIdentifier||(e.windowIdentifier=n),this.routerClient.query("WorkspaceService.bringWindowsToFront",e,t)})}async getActiveWorkspace(e){c.default.system.debug("WorkspaceClient.getActiveWorkspace");const t=(await this.routerClient.query(d.WORKSPACE.API_CHANNELS.GET_ACTIVE_WORKSPACE,{})).response;if(this.activeWorkspace=t.data,t.data.err)throw e&&e(t.data.err),new Error(t.data.err);return e&&e(null,t),t}getWorkspaces(e){l.default.args(e,"function="),c.default.system.debug("WorkspaceClient.getWorkspaces");return new Promise(async(t,n)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.GET_WORKSPACES,{},(i,r)=>{this._serviceResponseHandler(i,r,t,n,e)})})}getWorkspaceActions(e){return e(null,d.WORKSPACE.API_CHANNELS)}getWorkspaceNames(e){l.default.args(e,"function="),c.default.system.debug("WorkspaceClient.getWorkspaceNames");return new Promise(async(t,n)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.GET_WORKSPACE_NAMES,{},(i,r)=>{this._serviceResponseHandler(i,r,t,n,e)})})}setWorkspaceOrder(e,t){const{workspaces:n}=e;l.default.args(t,"function"),c.default.system.debug("WorkspaceClient.setWorkspaceOrder",e);return new Promise((i,r)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.SET_WORKSPACE_ORDER,n||e,(e,n)=>{this._serviceResponseHandler(e,n,i,r,t)})})}remove(e,t=Function.prototype){l.default.args(e,"object",t,"function=")&&!e.name&&!e.workspace&&l.default.args2("params.name",e.name,"string"),c.default.system.debug("WorkspaceClient.remove",e);return new Promise(async(n,i)=>{e.name||(e.name=e.workspace.name,delete e.workspace);const r=(await this.getActiveWorkspace()).data;if(e.name===r.name){c.default.system.error("APPLICATION LIFECYCLE:  Cannot remove active workspace: WorkspaceClient.remove:attempt to remove active workspace name:"+r.name);const e="Cannot remove active workspace";return this._serviceResponseHandler(e,null,n,i,t)}this.routerClient.query(d.WORKSPACE.API_CHANNELS.REMOVE,e,(e,r)=>{this._serviceResponseHandler(e,r,n,i,t)})})}rename(e,t=Function.prototype){l.default.args(e,"object",t,"function=")&&l.default.args2("params.oldName",e.oldName,"string","params.newName",e.newName,"string"),c.default.system.debug("WorkspaceClient.rename",e);return new Promise((n,i)=>{if(!e.overwriteExisting&&this.workspaceExists(e.newName)){const e="Workspace Already Exists";return this._serviceResponseHandler(e,null,n,i,t)}this.routerClient.query(d.WORKSPACE.API_CHANNELS.RENAME,e,(e,r)=>{this._serviceResponseHandler(e,r,n,i,t)})})}clone(e,t=Function.prototype){return l.default.args(e,"object",t,"function=")&&l.default.args2("params.name",e.name,"string"),delete e.name,e.newName||(e.newName=e.name+"_clone"),e.removeOldWorkspace=!1,this.rename({removeOldWorkspace:!1,newName:e.newName,oldName:e.name},t)}save(e=Function.prototype){c.default.system.debug("WorkspaceClient.save");return new Promise((t,n)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.SAVE,{},(i,r)=>{this._serviceResponseHandler(i,r,t,n,e)})})}workspaceExists(e){l.default.args(e,"string");for(let t=0;t<this.workspaces.length;t++)if(e===this.workspaces[t])return!0;return!1}saveAs(e,t=Function.prototype){l.default.args(e,"object",t,"function=")&&l.default.args2("params.name",e.name,"string"),c.default.system.debug("WorkspaceClient.saveAs",e);return new Promise((n,i)=>{if(!e.force&&this.workspaceExists(e.name))return this._serviceResponseHandler("Workspace Already Exists",null,n,i,t);this.routerClient.query(d.WORKSPACE.API_CHANNELS.SAVE_AS,e,(e,r)=>{this._serviceResponseHandler(e,r,n,i,t)})})}async switchTo(e,t=Function.prototype){l.default.args(e,"object",t,"function")&&l.default.args2("params.name",e.name,"string"),c.default.system.debug("WorkspaceClient.switchTo",e);const n=await this.routerClient.query(d.WORKSPACE.API_CHANNELS.SWITCH_TO,e);if(n.err)throw t(n.err,null),new Error(n.err);return t(n),n}async _setWindowState(e){if(!this.activeWorkspace)throw"Workspace is not yet ready";if(!this.activeWorkspace.windows.includes(e.windowName))throw"Cannot set state for Window not in workspace";return c.default.system.debug("WorkspaceClient.setWindowData",e),this.routerClient.query(d.WORKSPACE.API_CHANNELS.SET_WINDOW_STATE,e)}async _getWindowState(e){return c.default.system.debug("WorkspaceClient.getWindowData",e),this.routerClient.query(d.WORKSPACE.API_CHANNELS.GET_WINDOW_STATE,e)}async isWorkspaceDirty(e=Function.prototype){l.default.args(e,"function"),c.default.system.debug("WorkspaceClient.isWorkspaceDirty");const{err:t,response:n}=await this.routerClient.query(d.WORKSPACE.API_CHANNELS.GET_ACTIVE_WORKSPACE_DIRTY,{},()=>{});return e(t,n),n.data}async createWorkspace(e,t,n=((e,t)=>{e&&(c.default.system.error("Error creating workspace: "+e),c.default.system.info("Result from create workspace: "+t))})){c.default.system.log(`WorkspaceClient: Creating Workspace Request for name "${e}"`);const i=(await this.routerClient.query(d.WORKSPACE.API_CHANNELS.NEW_WORKSPACE,{workspaceName:e})).response.data;!1!==t.switchAfterCreation&&await this.switchTo({name:i});const r={workspaceName:i};return n(null,r),r}export(e,t){l.default.args(e,"object",t,"function")&&l.default.args2("params.workspaceName",e.workspaceName,"string"),c.default.system.debug("WorkspaceClient.export",e);return new Promise((n,i)=>{this.routerClient.query(d.WORKSPACE.API_CHANNELS.EXPORT,e,(r,o)=>{const s={};s[e.workspaceName]=o.data,this._serviceResponseHandler(r,{data:s},n,i,t)})})}async import(e,t){l.default.args(e,"object",t,"function=")&&l.default.args2("params.workspaceJSONDefinition",e.workspaceJSONDefinition,"object"),c.default.system.debug("WorkspaceClient.import",e);const n=(await this.routerClient.query(d.WORKSPACE.API_CHANNELS.IMPORT,e)).response.data;if(n&&n.err)throw t(n.err),new Error(n.err);return t&&t(null,n),n}exportToFile(e){c.default.system.info("workspaceClient.saveWorkspaceTemplateToConfigFile",e),l.default.args(e,"object")&&l.default.args2("params.workspaceTemplateDefinition",e.workspaceTemplateDefinition,"object");const{workspaceTemplateDefinition:t}=e;if("object"==typeof t){const e=Object.keys(t)[0];if(e&&t[e].templateDefinitionFlag){const n={workspaceTemplates:t};f.ConfigUtilInstance.promptAndSaveJSONToLocalFile("workspaceConfig-"+e,n)}else c.default.system.error("workspaceClient.saveWorkspaceTemplateToConfigFile. Input is not a legal template")}else c.default.system.error("workspaceClient.saveWorkspaceTemplateToConfigFile: Input is not a legal object")}async start(e){this.routerClient.subscribe("Finsemble.WorkspaceService.update",(t,n)=>{c.default.system.debug("workspaceClient init subscribe response",t,n),t?c.default.system.error(t):(this.activeWorkspace=n.data.activeWorkspace,this.workspaces=n.data.workspaces,e&&e())})}}var p=new h({onReady:e=>{p.start(e)},name:"workspaceClient"});t.default=p},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(13),o=i(n(18)),s=i(n(16)),a=i(n(17)),u=i(n(6)),l=n(4),c=n(15),d=i(n(1)),f=n(3),h=n(12);s.default.initialize(),o.default.initialize(),a.default.initialize();class p extends l._BaseClient{constructor(e){super(e),this.getParametersFromInDialog=()=>{const{inputParams:e}=s.default.getSpawnData();return d.default.system.debug("DialogManagerClient:getParametersFromInDialog: "+JSON.stringify(e)),e},this.respondAndExitFromInDialog=e=>{u.default.args(e,"any"),d.default.system.debug("DialogManagerClient:respondAndExitFromInDialog: "+JSON.stringify(e));const{responseChannel:t}=s.default.getSpawnData();this.routerClient.transmit(t,e)},this.getAvailableDialog=(e,t)=>{this.DialogStore.getValue("dialogs.available",(n,i)=>{for(const n in i){const r=i[n];if(r.componentType===e)return t(r)}t(null)})},this.generateDialogReadyChannel=e=>`Dialog.${e.windowName+e.uuid}.ready`,this.showDialog=()=>{const e=this.generateDialogReadyChannel(o.default.myWindowIdentifier);this.routerClient.transmit(e,{userInputTimeout:void 0===this.userInputTimeout?1e4:this.userInputTimeout})},this.sendQueryToDialog=(e,t,n)=>{function i(t){console.warn(`No response from dialog ${e.windowName} after ${t/1e3} seconds. Check to make sure your dialog is sending back data.`)}this.moveDialogFromAvailableToOpened(e);const r=`Dialog.${e.windowName+e.uuid}.Show`,s=this.generateDialogReadyChannel(e);let a;const u=(n,r)=>{a=setTimeout(i.bind(null,r.data.userInputTimeout),r.data.userInputTimeout),d.default.perf.info("DialogManagerClient:sendQueryToDialog:Dialog: ShowWindow Start"),o.default.showWindow(e,{monitor:t.monitor||"mine",left:"center",top:"center"},(e,t)=>{c.FinsembleWindow.getInstance({name:t.finWindow.name},(e,t)=>{t.bringToFront(),t.focus()}),d.default.perf.info("DialogManagerClient:sendQueryToDialog:ShowWindow finish")}),this.routerClient.removeListener(s,u)};this.routerClient.addListener(s,u),d.default.perf.info("DialogManagerClient:sendQueryToDialog ShowWindow Query begin."),this.routerClient.query(r,t,(t,i)=>{clearTimeout(a),this.moveDialogFromOpenedToAvailable(e),n(t,i.data)})},this.moveDialogFromOpenedToAvailable=e=>{this.DialogStore.getValue("dialogs",(t,n)=>{const i=n.opened,r=n.available;delete i[e.windowName],r[e.windowName]=e,this.DialogStore.setValue({field:"dialogs.opened",value:i}),this.DialogStore.setValue({field:"dialogs.available",value:r})})},this.moveDialogFromAvailableToOpened=e=>{this.DialogStore.getValue("dialogs",(t,n)=>{const i=n.available,r=n.opened;delete i[e.windowName],r[e.windowName]=e,this.DialogStore.setValue({field:"dialogs.available",value:i}),this.DialogStore.setValue({field:"dialogs.opened",value:r})})},this.registerModal=()=>{this.isModal&&(f.System.getMonitorInfo(e=>{const t=e.virtualScreen;t.width=t.right-t.left,t.height=t.bottom-t.top,this.finsembleWindow.setBounds({bounds:t})}),this.DialogStore.setValue({field:"modalIdentifier",value:o.default.myWindowIdentifier}))},this.showModal=e=>{this.DialogStore.getValue("modalIdentifier",async(t,n)=>{if(null==n)return;const{wrap:i}=await c.FinsembleWindow.getInstance({uuid:n.uuid,name:n.windowName});i.updateOptions({options:{opacity:.4}},()=>{i.show(()=>{i.bringToFront(()=>{this.finsembleWindow.focus(()=>{this.finsembleWindow.bringToFront(),e&&"function"==typeof e&&e()})})})})})},this.open=(e,t,n)=>{this.getAvailableDialog(e,i=>{i?this.sendQueryToDialog(i,t,n):o.default.spawn(e,{options:{customData:{foreign:{clients:{dialogManager:{isDialog:!0}}}}}},()=>{this.open(e,t,n)})})},this.DialogStore=null,this.isDialog=!1,this.isModal=!1,this.RESPONDER_CHANNEL=null,this.openerMessage=null,this.registerDialogCallback=e=>{this.routerClient.addResponder(this.RESPONDER_CHANNEL,(t,n)=>{this.openerMessage=n,e(t,n)})},this.hideModal=()=>{this.DialogStore.getValue("modalIdentifier",async(e,t)=>{if(null==t)return;const{wrap:n}=await c.FinsembleWindow.getInstance({uuid:t.uuid,name:t.windowName});n.hide()})},this.respondToOpener=e=>{d.default.system.info("DialogManagerClient:RespondToOpener:",e),this.openerMessage.sendQueryResponse(null,e),!1!==e.hideModalOnClose&&this.hideModal(),this.finsembleWindow.hide(),this.openerMessage=null},this.registerWithStore=e=>{if(this.isDialog){const t=o.default.myWindowIdentifier;this.RESPONDER_CHANNEL=`Dialog.${t.windowName+t.uuid}.Show`,this.DialogStore.setValue({field:"dialogs.available."+t.windowName,value:t},e)}else e()},this.checkIfWindowIsDialog=e=>{let t=null;try{this.isDialog=s.default.options.customData.foreign.clients.dialogManager.isDialog}catch(e){t=e}e&&e(t)},this.createStore=e=>{a.default.createStore({store:"DialogStore",values:{dialogs:{opened:{},available:{}}},global:!0},(t,n)=>{this.DialogStore=n,e()})},this.getFinsembleWindow=e=>{if(!this.isDialog)return e();c.FinsembleWindow.getInstance({name:this.finWindow.name,uuid:this.finWindow.uuid},(t,n)=>{this.finsembleWindow=n,e()})},this.spawnDialog=this.spawnDialog.bind(this)}spawnDialog(e,t,n,i){u.default.args(e,"object",t,"object",n,"function");const r=h.getUniqueName("DialogChannel");e.data={inputParams:t,responseChannel:r},e.left||0===e.left||e.right||0===e.right||(e.left="center"),e.top||0===e.top||e.bottom||0===e.bottom||(e.top="center"),this.routerClient.addListener(r,(e,t)=>{n(e,t.data),this.routerClient.removeListener(r,i)}),o.default.spawn("dialogTemplate",e,(e,t)=>{e&&(d.default.system.error("ERROR",e),n(e,t)),i&&i(e,t)})}}var g=new p({startupDependencies:{clients:["distributedStoreClient","windowClient"]},onReady(e){g.checkIfWindowIsDialog(),r.series([g.createStore.bind(g),g.registerWithStore.bind(g),g.getFinsembleWindow.bind(g),e=>{o.default.onReady(e)},e=>{s.default.onReady(e)}],e)},name:"dialogManager"});t.default=g},function(e,t,n){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(1)),o=n(4);r.default.system.debug("Starting searchClient");class s extends o._BaseClient{constructor(){super(...arguments),this.providers={},this.resultProviders={},this.searchResultsList=[],this.isSearching=!1,this.unRegister=this.unregister,this.handleResults=(e,t)=>{t.data.searchId&&t.data.searchId==this.searchId&&(this.resultProviders[t.data.provider.channel]=t.data,this.searchResultsList.push(t.data),this.resultsCallback(null,this.searchResultsList))}}register(e,t){return e.name?e.searchCallback?void this.routerClient.query("Search.register",{name:e.name,channel:`${this.finWindow.name}.${e.name}`,providerActionTitle:e.providerActionTitle,providerActionCallback:!!e.providerActionCallback},(n,i)=>{if(n)return t?t(n):console.error(n);const r=`${this.finWindow.name}.${e.name}`;return this.providers[e.name]=e.name,this.routerClient.addResponder("Search.Provider."+r,(t,n)=>{if(t)return console.error(t);n&&e.searchCallback(n.data,(e,t)=>{n.sendQueryResponse(e,t)})}),this.routerClient.addResponder("Search.Provider.ItemAction."+r,(t,n)=>{if(t)return console.error(t);n&&e.itemActionCallback&&e.itemActionCallback(n.data,n.header.origin,(e,t)=>{n.sendQueryResponse(e,t)})}),e.providerActionCallback&&this.routerClient.addResponder("Search.Provider.Action."+r,(t,n)=>{if(t)return console.error(t);n&&e.providerActionCallback&&e.providerActionCallback(n.header.origin,(e,t)=>{n.sendQueryResponse(e,t)})}),t?t(null,i.data):null}):t("no provider callback provided"):t("no provider name provided")}unregister(e,t){if(!e.name)return t("Provider name was not provided");const n=`${this.finWindow.name}.${e.name}`;this.routerClient.query("Search.unregister",{channel:n},()=>(this.routerClient.removeResponder("Search.Provider."+n),this.routerClient.removeResponder("Search.Provider.ItemAction."+n),this.routerClient.removeResponder("Search.Provider.Action."+n),delete this.providers[e.name],t?t():null))}search(e,t){this.isSearching||(this.routerClient.addPubSubResponder("Search."+this.finWindow.name),this.routerClient.subscribe("Search."+this.finWindow.name,this.handleResults),this.isSearching=!0),this.searchResultsList=[],e.windowName=this.finWindow.name,this.routerClient.query("Search.search",e,(e,n)=>{if(e)return t(e);this.resultsCallback=t,this.searchId=n.data.searchId})}invokeItemAction(e,t){this.routerClient.query("Search.Provider.ItemAction."+e.provider,{item:e,action:t})}invokeProviderAction(e){this.routerClient.query("Search.Provider.Action."+e.channel,{})}}const a=new s({onReady(e){e&&e()},name:"searchClient"});t.default=a},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationClient=t.ActionTypes=t.ROUTER_NAMESPACE=void 0;const r=n(86);Object.defineProperty(t,"ActionTypes",{enumerable:!0,get:function(){return r.ActionTypes}});const o=i(n(87)),s=i(n(89)),a=i(n(90)),u=i(n(91)),l=n(12),c=n(4),d=i(n(22)),f=i(n(16)),h=i(n(18)),p="action.",g="notification.",m="delete",y="fetch_history",w="last_issued",b="mark_read",v="mark_unread",C="mute",S="notify",_="perform_action",T="subscribe",A="unmute",E="unsubscribe",L="sources",O="mute_filters",I="preferences";t.ROUTER_NAMESPACE={ACTION_PREFIX:g+p};class M extends c._BaseClient{constructor(){super(...arguments),this.subscriptions=[],this.Notification=o.default,this.ActionTypes=r.ActionTypes,this.Subscription=s.default,this.Action=a.default,this.Filter=u.default,this.actionTypes=r.ActionTypes}async applyOverrides(){var e,t;const{data:n}=await d.default.getValue("finsemble.servicesConfig.notifications.applyNotificationOverrides");if(!n)return;const i=f.default.getWindowIdentifier().windowName,{data:r}=await h.default.getActiveDescriptors(),o=Object.keys(r).filter(e=>e===i).map(e=>r[e]);let s,a="Unknown Source";function u(e,t){const{componentType:n}=f.default.getWindowIdentifier();t.finsembleSource=a,D.notify(JSON.parse(JSON.stringify({title:e,options:t})))}1!==o.length?this.logger.warn("Unable to fetch component to extract type or display name"):(s=o[0],a=(null===(t=null===(e=s.customData)||void 0===e?void 0:e.component)||void 0===t?void 0:t.displayName)||s.componentType);const l=window.Notification;u.requestPermission=l.requestPermission.bind(l),Object.defineProperty(u,"permission",{get:function(){return l.permission}}),window.Notification=u}setup(){window&&window.addEventListener&&window.addEventListener("unload",()=>{this.unsubscribeAll()})}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}query(e,t,n,i){return new Promise(async(r,o)=>{try{null==n&&(n=g),this.logger.system.info(`sending message on ${n+e} channel`,t);const s=await this.routerClient.query(n+e,t,()=>{});s.err?(this.logger.system.error("Error: ",s.err),o(s.err)):(this.logger.system.log(e+" raw response: ",s),i&&i(null,s.response.data.data),r(s.response.data.data))}catch(e){this.logger.system.error("Error: ",e),i&&i(e),o(e)}})}async fetchHistory(e,t){return this.logger.system.info("FetchHistory() called with params: ",e,t),await this.query(y,{options:e,filter:t})}async getLastIssuedAt(e){return this.logger.system.info("getLastIssued called with params: ",e),await this.query(w,e)}async performAction(e,t){return this.logger.system.info("performAction() called with params: ",e,t),Array.isArray(e)||(e=[e]),await this.query(_,{notifications:e,action:t})}async markRead(e){this.logger.info("markRead() called with params: ",e),Array.isArray(e)||(e=[e]),await this.query(b,{notifications:e,isRead:!0})}async markUnread(e){this.logger.info("markUnread() called with params: ",e),Array.isArray(e)||(e=[e]),await this.query(v,{notifications:e,isRead:!1})}deleteNotifications(e){return this.logger.info("deleteNotifications() called with params: ",e),new Promise(async(t,n)=>{try{t(this.query(m,e))}catch(e){n(e)}})}async notify(e){this.logger.system.info("notify() called with params: ",e);try{await this.query(S,Array.isArray(e)?e:[e])}catch(t){if(!t.includes("No responder"))throw t;await l.sleep(500),await this.notify(e)}}async subscribe(e,t){this.logger.system.info("subscribe() called with params: ",e,t);const n=await this.query(T,JSON.parse(JSON.stringify(e)));return this.logger.system.info("Got a return value containing a channel",n),await this.monitorChannel(n.channel,t),this.subscriptions.push(n),n}async unsubscribe(e){this.logger.system.info("unsubscribe() called with params: ",e),await this.query(E,e),this.cleanupSubscription(e)}removeResponder(e,t){null==t&&(t=g),this.routerClient.removeResponder(t+e)}unsubscribeAll(){this.logger.system.info("unsubscribeAll() called"),this.subscriptions.forEach(e=>{this.query(E,e.id).then(),this.removeResponder(e.id)}),this.subscriptions=[]}async mute(e){return this.logger.system.info("mute() called with params: ",e),await this.query(C,{filter:e})}async unmute(e){return this.logger.system.info("unmute() called with params: ",e),await this.query(A,{filter:e})}async getSources(){return this.logger.system.info("getSources() called"),await this.query(L,{})}async getMuteFilters(){return this.logger.system.info("getSources() called"),await this.query(O,{})}async getPreferences(){return this.logger.system.info("getPreferences() called"),await this.query(I,{})}cleanupSubscription(e){const t=this.subscriptions.findIndex(t=>t.id===e);t>-1&&(this.removeResponder(this.subscriptions[t].channel),this.subscriptions.splice(t,1))}addResponder(e,t,n){null==n&&(n=g),this.logger.system.info("Adding responder for endpoint: "+(n+e)),this.routerClient.addResponder(n+e,(n,i)=>{if(this.logger.system.info(`Message received on ${e}: `,i),n)this.logger.system.error(`Failed to setup ${e} responder`,n);else try{this.logger.system.info(`Processing message on channel ${e}: `,i);const n=t(i.data);this.logger.system.info(`Message response on ${e}: `,n),i.sendQueryResponse(null,{status:"success",data:n})}catch(n){this.logger.system.error("Failed to process query",n),i.sendQueryResponse(n)}})}monitorChannel(e,t){return new Promise(n=>{this.logger.system.info("Listening for messages on channel",e),this.addResponder(e,e=>{this.logger.system.info("Notification received: ",e.id);try{t(e)}catch(e){this.logger.system.error("Error thrown in the subscription.onNotification()",e)}return{message:"success"}}),n()})}}t.NotificationClient=M;const D=new M({onReady:function(e){this.logger.system.log("notificationClient Online"),e()},name:"notificationClient"});D.applyOverrides(),D.initialize(),D.setup(),t.default=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FinsembleNotificationOptions=t.ActionTypes=void 0,function(e){e.DISMISS="DISMISS",e.SNOOZE="SNOOZE",e.SPAWN="SPAWN",e.QUERY="QUERY",e.PUBLISH="PUBLISH",e.TRANSMIT="TRANSMIT"}(t.ActionTypes||(t.ActionTypes={})),function(e){e.MARK_AS_UNREAD="MARK_AS_UNREAD",e.MARK_AS_READ="MARK_AS_READ",e.SNOOZE="SNOOZE",e.DISMISS="DISMISS",e.SETTINGS="SETTINGS",e.DETAILS="DETAILS"}(t.FinsembleNotificationOptions||(t.FinsembleNotificationOptions={}))},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(88));t.default=class{constructor(){this.actions=[],this.isRead=!1,this.isSnoozed=!1,this.isMuted=!1,this.isDeleted=!1,this.actionsHistory=[],this.meta=new r.default,this.stateHistory=[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.id=e||null,this.filter=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.include=[],this.exclude=[]}}}])}));