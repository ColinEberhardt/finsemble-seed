!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=135)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},i=Math.max;var o=function(e,t,r){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),l=Array(a);++s<a;)l[s]=o[t+s];s=-1;for(var u=Array(t+1);++s<t;)u[s]=o[s];return u[t]=r(l),n(e,this,u)}},s=r(4);function a(e,t){return o(e,t,s.a)}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.LoggerConstructor=void 0;const n=r(5),i=r(32),o={Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0,Verbose:!0,LocalOnly:!1},s={Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0},a=r(43);t.LoggerConstructor=function(e){const i=this;let l;i.RouterClient=e&&e.RouterClient;let u=!1,c=!1;const f=i;let d,h,p=0,m=0;this.startupTime=0;let v=[];if("undefined"==typeof window)return;let g=n.System.Window.getCurrent().name;window.top!==window&&(g+=".Frame"),this.onLogStateChangeCallback=[];const y="finsemble.logger.client."+g;let b={console:s,dev:o,system:o,perf:o};function S(e,t,r){this.category=e,!l&&n.System.isBrowserView()&&(l=n.System.getViewId()),this.logClientName=l?`${g}: view-${l}`:g,this.logType=t,this.logData=r,this.logTimestamp=window.performance.timing.navigationStart+window.performance.now()+p}function w(e,t){e&&e.dev&&(b=e,i.onLogStateChangeCallback.forEach(t=>{t(e)})),function(e){f.system.debug("Logger updateQueueBasedOnState",e,p,"QUEUE LENGTH",v.length,b);const t=[];for(let r=0,{length:n}=v;r<n;r++)if(b[v[r].category][v[r].logType]&&!b[v[r].category].LocalOnly)e&&(v[r].logTimestamp=v[r].logTimestamp+p),t.push(v[r]);else if(b[v[r].category][v[r].logType]&&b[v[r].category].LocalOnly){const e=v[r];console.log(e.category,e.logType,e.logTimestamp-window.performance.timing.navigationStart,e.logData,"(Previously queued!)")}v=t}(t)}function _(){const{stack:e}=function(){try{throw Error("")}catch(e){return e}}(),t=(r="\n",n=4,e.split(r,n).join(r).length);var r,n;return"Log Stack: \n"+e.substring(t).substr(1)}this.onStateChanged=e=>{-1===this.onLogStateChangeCallback.indexOf(e)&&this.onLogStateChangeCallback.push(e)},this.setClientName=function(e){g=e},this.getClientName=function(){return g},this.clearMessageList=function(){v=[]},this.callStack=function(){return _()},this.setting=function(){return b};const E=console.error,C=console.warn,P=console.info,O=console.log,R=console.debug;function A(e,t){try{e.apply(console,function e(t){return t.reduce((t,r)=>t.concat(Array.isArray(r)?e(r):r),[])}(t))}catch(e){(t=[]).push(_())}}let T=()=>{v.length>0&&(i.RouterClient.transmit("logger.service.logMessages",v),f.clearMessageList())};function I(e,r,n){let i,o=!1,s=!0;"forceObjectsToLogger"===n[0]&&(o=!0,s=!1,n.splice(0,1)),n=n.map(e=>{if(s){if(function(e){const t=[],r=[e];let n=0,i=0;for(;r.length&&i<1e3;){i++;const e=r.pop();if("boolean"==typeof e)n+=4;else if("string"==typeof e)n+=2*e.length;else if("number"==typeof e)n+=8;else if("object"==typeof e&&-1===t.indexOf(e)){t.push(e);for(const t in e)r.push(e[t])}}return n}(e)>5e4)return A(P,["Message too large to send to the logger.",n]),"Log argument greater than 50KB. Check local Console to see output of the object."}return e});try{for(let e=0;e<n.length;e++)n[e]instanceof Error&&(n[e]=n[e].toString());i=new S(e,r,JSON.stringify(n))}catch(t){n.splice(0,n.length),n.push(_()),i=new S(e,r,"*** Logging Error: "+JSON.stringify(n))}if(o||!function(e){return!0===e.logData.includes("Finsemble.heartbeat")}(i))!function(e){if(v.length<2e4)v.push(e);else{console.error("Logging Queue Overflowed! Dumping queue here then continuing.",v.length);let e,r=0;for(;e=v.shift();)console.log("Message "+r++,e);t.Logger.system.error("Logging Queue Overflowed! Dumping queue in client then continuing.")}}(i);else if(++m<=5){A(P,[`"Filtered Logger Message (${m} of first 5 shown)`,i])}c&&T()}function j(){!l&&n.System.isBrowserView()&&(l=n.System.getViewId()),f.system.debug("logger.service.registering",g),i.RouterClient.query("logger.service.register",{clientName:g,clientChannel:y,uuid:n.System.Window.getCurrent().uuid,windowName:n.System.Window.getCurrent().name,viewId:l},(e,t)=>{if(e)setTimeout(j,750);else{for(const e of v)e.viewId=l;c=!0,f.system.debug("logger.service.registered"),d=t.data,"routerService"!==g?(p=h,w(d,!0)):w(d,!1),I("system","Debug",["Logger Registered"]),T()}}),i.RouterClient.addListener(y,(e,t)=>{f.system.debug("logger.client.setLogState",t.data),d=t.data,w(d,!1)})}T=a(T,"routerService"===g?100:250,{leading:!1}),this.error=function(){const e=Array.prototype.slice.call(arguments);e.push(_()),b.dev.Error&&!b.dev.LocalOnly&&I("dev","Error",e),e.unshift(`dev error (${window.performance.now()}):`),A(E,e)},this.warn=function(){if(b.dev.Warn){const e=Array.prototype.slice.call(arguments);e.push(_()),b.dev.Warn&&!b.dev.LocalOnly&&I("dev","Warn",e),b.dev.Warn&&b.dev.LocalOnly&&(e.unshift(`dev warn (${window.performance.now()}):`),A(C,e))}},this.info=function(){if(b.dev.Info){const e=Array.prototype.slice.call(arguments);0,b.dev.Info&&!b.dev.LocalOnly&&I("dev","Info",e),b.dev.Info&&b.dev.LocalOnly&&(e.unshift(`dev info (${window.performance.now()}):`),A(P,e))}},this.log=function(){if(b.dev.Log){const e=Array.prototype.slice.call(arguments);0,b.dev.Log&&!b.dev.LocalOnly&&I("dev","Log",e),b.dev.Log&&b.dev.LocalOnly&&(e.unshift(`dev log (${window.performance.now()}):`),A(O,e))}},this.debug=function(){if(b.dev.Debug){const e=Array.prototype.slice.call(arguments);0,b.dev.Debug&&!b.dev.LocalOnly&&I("dev","Debug",e),b.dev.Debug&&b.dev.LocalOnly&&(e.unshift(`dev debug (${window.performance.now()}):`),A(R,e))}},this.verbose=function(){if(b.dev.Verbose){const e=Array.prototype.slice.call(arguments);0,b.dev.Verbose&&!b.dev.LocalOnly&&I("dev","Verbose",e),b.dev.Verbose&&b.dev.LocalOnly&&(e.unshift(`dev verbose (${window.performance.now()}):`),A(R,e))}},this.system={},this.system.error=function(){const e=Array.prototype.slice.call(arguments);e.push(_()),b.system.Error&&!b.system.LocalOnly&&I("system","Error",e),e.unshift(`system error (${window.performance.now()}):`),A(E,e)},this.system.warn=function(){if(b.system.Warn){const e=Array.prototype.slice.call(arguments);e.push(_()),b.system.Warn&&!b.system.LocalOnly&&I("system","Warn",e),b.system.Warn&&b.system.LocalOnly&&(e.unshift(`system warn (${window.performance.now()}):`),A(C,e))}},this.system.info=function(){if(b.system.Info){const e=Array.prototype.slice.call(arguments);0,b.system.Info&&!b.system.LocalOnly&&I("system","Info",e),b.system.Info&&b.system.LocalOnly&&(e.unshift(`system info (${window.performance.now()}):`),A(P,e))}},this.system.log=function(){if(b.system.Log){const e=Array.prototype.slice.call(arguments);0,b.system.Log&&!b.system.LocalOnly&&I("system","Log",e),b.system.Log&&b.system.LocalOnly&&(e.unshift(`system log (${window.performance.now()}):`),A(O,e))}},this.system.debug=function(){if(b.system.Debug){const e=Array.prototype.slice.call(arguments);0,b.system.Debug&&!b.system.LocalOnly&&I("system","Debug",e),b.system.Debug&&b.system.LocalOnly&&(e.unshift(`system debug (${window.performance.now()}):`),A(R,e))}},this.system.verbose=function(){if(b.system.Verbose){var e=Array.prototype.slice.call(arguments);0,b.system.Verbose&&!b.system.LocalOnly&&I("system","Verbose",e),b.system.Verbose&&b.system.LocalOnly&&((e=Array.prototype.slice.call(arguments)).unshift(`system log (${window.performance.now()}):`),A(R,e))}},this.perf={},this.perf.error=function(){const e=Array.prototype.slice.call(arguments);e.push(_()),b.perf.Error&&!b.perf.LocalOnly&&I("perf","Error",e),e.unshift(`perf error (${window.performance.now()}):`),A(E,e)},this.perf.warn=function(){if(b.perf.Warn){const e=Array.prototype.slice.call(arguments);e.push(_()),b.perf.Warn&&!b.perf.LocalOnly&&I("perf","Warn",e),b.perf.Warn&&b.perf.LocalOnly&&(e.unshift(`perf warn (${window.performance.now()}):`),A(C,e))}},this.perf.info=function(){if(b.perf.Info){const e=Array.prototype.slice.call(arguments);0,b.perf.Info&&!b.perf.LocalOnly&&I("perf","Info",e),b.perf.Info&&b.perf.LocalOnly&&(e.unshift(`perf info (${window.performance.now()}):`),A(P,e))}},this.perf.log=function(){if(b.perf.Log){const e=Array.prototype.slice.call(arguments);0,b.perf.Log&&!b.perf.LocalOnly&&I("perf","Log",e),b.perf.Log&&b.perf.LocalOnly&&(e.unshift(`perf log (${window.performance.now()}):`),A(O,e))}},this.perf.debug=function(){if(b.perf.Debug){const e=Array.prototype.slice.call(arguments);0,b.perf.Debug&&!b.perf.LocalOnly&&I("perf","Debug",e),b.perf.Debug&&b.perf.LocalOnly&&(e.unshift(`perf debug (${window.performance.now()}):`),A(R,e))}},this.perf.verbose=function(){if(b.perf.Verbose){const e=Array.prototype.slice.call(arguments);0,b.perf.Verbose&&!b.perf.LocalOnly&&I("perf","Verbose",e),b.perf.Verbose&&b.perf.LocalOnly&&(e.unshift(`perf verbose (${window.performance.now()}):`),A(R,e))}},this.unregisterClient=function(e=null,t=Function.prototype){f.system.debug("logger.service.unregister",g,e,l),T();const r=e||{clientName:g,viewId:l};i.RouterClient.query("logger.service.unregister",r,t)},this.isLogMessage=function(e){return"logger.service.logMessages"===e},this.status="offline",this.setRouterClient=e=>{this.RouterClient=e},this.start=function(){let e;function t(){i.status="online",f.system.debug("Logger onReady",g),i.RouterClient.calibrateTimeWithRouterService(e=>{h=e,u||(i.startupTime=performance.now()-i.startupTime,j(),u=!0)})}this.startupTime=performance.now(),i.RouterClient||(console.log("No instance of the RouterClient found for this instance of the Logger. Dynamically requiring it."),i.RouterClient=r(6).default);const o=()=>{e=i.RouterClient.subscribe("Finsemble.Service.State.loggerService",(r,n)=>{"ready"===n.data.state&&(t(),i.RouterClient.unsubscribe(e))})};"routerService"===window.name?i.RouterClient.query("logger.service.register",{},e=>{e?setTimeout(o,750):o()}):i.RouterClient.onReady(o),n.System.isBrowserView()&&window.addEventListener("beforeunload",()=>{i.unregisterClient()})}},t.Logger="undefined"!=typeof window?new t.LoggerConstructor:new i.LocalLogger,t.default=t.Logger},function(e,t,r){"use strict";(function(e,n){r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return l})),r.d(t,"e",(function(){return u}));var i,o=r(0),s="function"==typeof e&&e,a="object"==typeof n&&"function"==typeof n.nextTick;function l(e){setTimeout(e,0)}function u(e){return Object(o.a)((function(t,r){e((function(){t.apply(null,r)}))}))}i=s?e:a?n.nextTick:l,t.a=u(i)}).call(this,r(26).setImmediate,r(14))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";t.a=function(e){return e}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.System=void 0;const r="undefined"!=typeof window?window:e;class n{constructor(e,t,r){return new fin.desktop.Window(e,t)}static get getCurrent(){return fin.desktop.Window.getCurrent}static get wrap(){return fin.desktop.Window.wrap}}class i{constructor(e,t,r){return new fin.desktop.Application(e,t)}static get getCurrent(){return fin.desktop.Application.getCurrent}static get wrap(){return fin.desktop.Application.wrap}}class o{constructor(e){new fin.desktop.Notification(e)}}class s{constructor(){return new fin.desktop.System.Clipboard}static get writeText(){return fin.desktop.System.Clipboard.writeText}static get writeHTML(){return fin.desktop.System.Clipboard.writeHTML}static get writeRTF(){return fin.desktop.System.Clipboard.writeRTF}static get readText(){return fin.desktop.System.Clipboard.readText}static get readHTML(){return fin.desktop.System.Clipboard.readHTML}static get readRTF(){return fin.desktop.System.Clipboard.readRTF}}t.System=class{static get Application(){return i}static get Window(){return n}static get Notification(){return o}static get Clipboard(){return s}static async getMousePosition(e=Function.prototype){return new Promise((t,r)=>{fin.desktop.System.getMousePosition(r=>{(r.left||0===r.left)&&(r.x=r.left),(r.top||0===r.top)&&(r.y=r.top),e(null,r),t(r)},t=>{e(t,null),r(t)})})}static getMonitorInfo(e=Function.prototype){return new Promise(t=>{fin.desktop.System.getMonitorInfo(r=>{t(r),e(r)})})}static get container(){return fin.container?fin.container:"Electron"}static get isBrowserView(){return e2o.isBrowserView}static get getViewId(){return e2o.getViewId}static get hasBrowserView(){return e2o.hasBrowserView}static get fin(){return e2o||fin||{}}static get ready(){return fin.desktop.main}static getHostSpecs(e=Function.prototype){return new Promise(t=>{fin.desktop.System.getHostSpecs(r=>{t(r),e(r)})})}static get InterApplicationBus(){return fin.desktop.InterApplicationBus}static get launchExternalProcess(){return fin.desktop.System.launchExternalProcess}static get terminateExternalProcess(){return fin.desktop.System.terminateExternalProcess}static get getAllApplications(){return fin.desktop.System.getAllApplications}static get exit(){return fin.desktop.System.exit}static get clearCache(){return fin.desktop.System.clearCache}static get showDeveloperTools(){return fin.desktop.System.showDeveloperTools}static get getRuntimeInfo(){return fin.desktop.System.getRuntimeInfo||chrome.desktop.getDetails}static get addEventListener(){return fin.desktop.System.addEventListener}static get addSelectClientCertificateListener(){return fin.desktop.System.addSelectClientCertificateListener}static get addCertificateErrorListener(){return fin.desktop.System.addCertificateErrorListener}static get getVersion(){return fin.desktop.System.getVersion}static get getUpdateAvailable(){return fin.desktop.System.getUpdateAvailable}static get openUrlWithBrowser(){return fin.desktop.System.openUrlWithBrowser}static get getAllWindows(){return fin.desktop.System.getAllWindows}static get getProcessList(){return fin.desktop.System.getProcessList}static get getProtocolString(){return fin.desktop.System.getProtocolString}static get hideSplashScreen(){return fin.desktop.System.hideSplashScreen}static FinsembleReady(e){return r.FSBL&&r.FSBL.addEventListener?r.FSBL.addEventListener("onready",e):window.addEventListener("FSBLready",e)}static startupApplicationHandshake(){fin.desktop.System.startupApplicationHandshake&&fin.desktop.System.startupApplicationHandshake()}static closeApplication(e,t=Function.prototype){return new Promise(r=>{let n,i=!1;const o=()=>{i||(console.log("Attempting to terminate",e.uuid),e.terminate(()=>{t(),r()},()=>{i||(i=!0,clearInterval(n),console.log("force closing ",e.uuid),e.terminate())}))};n=setInterval(o,2e3),console.log("closing ",e.uuid),e.close(!1,()=>{console.log("app.close: successfully closed",e.uuid),i=!0,clearInterval(n),t(),r()},o)})}static isElectron(){return"Electron"===fin.container}}}).call(this,r(14))},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0});const n=r(47),i=r(1),o=new(0,n.RouterClientConstructor)({clientName:"RouterClient"});i.Logger.setRouterClient(o),t.default=o},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MOVE_REASON=t.LAUNCHER_SERVICE=t.HEARTBEAT_TIMEOUT_CHANNEL=t.COMPONENT_STATE_STORAGE_TOPIC=t.WINDOW_SERVICE_REQUESTS=t.WORKSPACE=t.WINDOW=t.INTERRUPTIBLE_EVENTS=t.EVENT_INTERRUPT_CHANNEL=t.DOCKING=t.SERVICE_STOP_CHANNEL=t.SERVICE_START_CHANNEL=t.WINDOWSTATE=t.SERVICES_STATE_CHANNEL=t.CLIENT_SERVER_MAPPING=t.SERVICE_QUERY_READY_CHANNEL=t.SERVICE_CLOSED_CHANNEL=t.SERVICE_CLOSING_CHANNEL=t.SERVICE_READY_CHANNEL=t.SERVICE_INITIALIZING_CHANNEL=t.APPLICATION_STATE_CHANNEL=t.WRAPPERS=void 0,t.WRAPPERS={EVENTS:["title-changed","bringToFront","setBounds","alwaysOnTop","setOpacity"]},t.APPLICATION_STATE_CHANNEL="Finsemble.Application.State",t.SERVICE_INITIALIZING_CHANNEL="Finsemble.ServiceManager.serviceInitializing",t.SERVICE_READY_CHANNEL="Finsemble.ServiceManager.serviceReady",t.SERVICE_CLOSING_CHANNEL="Finsemble.ServiceManager.serviceClosing",t.SERVICE_CLOSED_CHANNEL="Finsemble.ServiceManager.serviceClosed",t.SERVICE_QUERY_READY_CHANNEL=e=>"Finsemble.ServiceManager.queryReady."+e,t.CLIENT_SERVER_MAPPING=e=>({authenticationClient:"authenticationService",configClient:"configService",distributedStoreClient:"dataStoreService",hotkeysClient:"hotkeysService",linkerClient:"linkerService",logger:"loggerService",searchClient:"searchService",storageClient:"storageService",windowClient:"windowService",workspaceClient:"workspaceService"}[e]),t.SERVICES_STATE_CHANNEL="Finsemble.State.Services",function(e){e[e.NORMAL=0]="NORMAL",e[e.MINIMIZED_WAS_NORMAL=1]="MINIMIZED_WAS_NORMAL",e[e.MAXIMIZED=2]="MAXIMIZED",e[e.MINIMIZED_WAS_MAXIMIZED=3]="MINIMIZED_WAS_MAXIMIZED",e[e.TRANSITIONING=4]="TRANSITIONING"}(t.WINDOWSTATE||(t.WINDOWSTATE={})),t.SERVICE_START_CHANNEL="Finsemble.Service.Start",t.SERVICE_STOP_CHANNEL="Finsemble.Service.Stop",t.DOCKING={GROUP_UPDATE:"DockingService.groupUpdate",WORKSPACE_GROUP_UPDATE:"Finsemble.WorkspaceService.groupUpdate",REQUEST_PUBLISH:"DockingService.requestGroupDataPublish"},t.EVENT_INTERRUPT_CHANNEL="Finsemble.Event.Interrupt",t.INTERRUPTIBLE_EVENTS=["close-requested","closed","close-complete","_container-close-handlers"],t.WINDOW={DELAYABLE_EVENTS:["close-requested","closed","close-complete","_container-close-handlers"],CANCELABLE_EVENTS:["close-requested"]},t.WORKSPACE={DELAYABLE_EVENTS:["load-requested","close-requested","save-requested"],CANCELABLE_EVENTS:["close-requested"],CLEAN_SHUTDOWN:"Finsemble.Workspace.cleanShutdown",UPDATE_PUBSUB:"Finsemble.WorkspaceService.update",STORAGE_TOPIC:"finsemble.workspace",CACHE_STORAGE_TOPIC:"finsemble.workspace.cache",ALL_WORKSPACES:"finsemble.allWorkspaces",ACTIVE_WORKSPACE:"activeWorkspace",LAST_USED_WORKSPACE_TOPIC:"finsemble",LAST_USED_WORKSPACE_NAME:"finsemble.lastUsedWorkspace.name",LAST_USED_WORKSPACE:"finsemble.lastUsedWorkspace",INITIAL_WORKSPACE_PREFERENCE:"finsemble.initialWorkspace",PUBLISH_REASONS:{INIT:"workspace:initialization",LOAD_DATA_RETRIEVED:"workspace:load:dataRetrieved",LOAD_FINISHED:"workspace:load:finished",WINDOW_REMOVED:"window:remove",WINDOW_ADDED:"window:add",LOAD_STARTED:"workspace:load:start",WORKSPACE_REMOVED:"Workspace:remove",WORKSPACE_RENAMED:"rename",SWITCHTO_TERMINATED:"workspace:switchTo:terminated",NEW_WORKSPACE:"new workspace",SAVE_AS:"APPLICATION LIFECYCLE:WORKSPACE LIFECYCLE:SaveAs:Workspace:Save As"},API_CHANNELS:{NEW_WORKSPACE:"Finsemble.Workspace.NewWorkspace",SAVE:"Finsemble.Workspace.Save",RENAME:"Finsemble.Workspace.Rename",SAVE_AS:"Finsemble.Workspace.SaveAs",SWITCH_TO:"Finsemble.Workspace.SwitchTo",IMPORT:"Finsemble.Workspace.Import",EXPORT:"Finsemble.Workspace.Export",REMOVE:"Finsemble.Workspace.Remove",SAVE_GLOBAL_DATA:"Finsemble.Workspace.SaveGlobalData",SAVE_VIEW_DATA:"Finsemble.Workspace.SaveViewData",GET_GLOBAL_DATA:"Finsemble.Workspace.GetGlobalData",GET_VIEW_DATA:"Finsemble.Workspace.GetViewData",GET_WORKSPACES:"Finsemble.Workspace.GetWorkspaces",GET_WORKSPACE_NAMES:"Finsemble.Workspace.GetWorkspaceNames",SET_WORKSPACE_ORDER:"Finsemble.Workspace.SetWorkspaceOrder",GET_ACTIVE_WORKSPACE:"Finsemble.Workspace.GetActiveWorkspace",GET_ACTIVE_WORKSPACE_DIRTY:"Finsemble.Workspace.GetActiveWorkspaceDirty",GET_TEMPLATES:"Finsemble.Workspace.GetTemplates",IMPORT_TEMPLATE:"Finsemble.Workspace.ImportTemplate",EXPORT_TEMPLATE:"Finsemble.Workspace.ExportTemplate",REMOVE_TEMPLATE:"Finsemble.Workspace.RemoveTemplate",SET_WINDOW_STATE:"Finsemble.Workspace.SetWindowData",GET_WINDOW_STATE:"Finsemble.Workspace.GetWindowData",ADD_WINDOW:"WorkspaceService.addWindow",REMOVE_WINDOW:"WorkspaceService.removeWindow"},DEFAULT_WINDOW_PROPS:["name","componentType","windowType","alwaysOnTop","autoShow","minWidth","minHeight","maxWidth","maxHeight","resizable","maximizable","minimizable","opacity","windowState","left","top","width","height","right","bottom","defaultLeft","defaultTop","defaultWidth","defaultHeight","defaultRight","defaultBottom","monitorInfo","icon","cachedBounds","showTaskbarIcon","isEvergreen","compositeComponentData"],ADDITIONAL_WINDOW_PROPS:{WebWindow:["url","fullscreen","frame","backgroundColor","transparent","waitForPageLoad","affinity","appUUID"],NativeWindow:["path","alias","arguments","argumentsAsQueryString","isWPF"],StackedWindow:["childWindowIdentifiers","visibleWindowIdentifier","bounds"]}},t.WINDOW_SERVICE_REQUESTS={REMOTE_FOCUS:"WindowService.remoteFocus",SET_ALWAYS_ON_TOP:"WindowService-Request-setAlwaysOnTop",IS_ALWAYS_ON_TOP:"WindowService-Request-isAlwaysOnTop"},t.COMPONENT_STATE_STORAGE_TOPIC="finsemble.componentStateStorage",t.HEARTBEAT_TIMEOUT_CHANNEL="Finsemble.WindowService.HeartbeatTimeout",t.LAUNCHER_SERVICE={WINDOW_CLOSED:"LauncherService.WindowClosed"},t.MOVE_REASON={AERO_KEY:"aero_key",SYSTEM_RESTORED:"system_restored"}},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigUtilInstance=void 0;var i=n(r(11)),o=n(r(1)),s=r(5);
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const a=new function(){const e=this;this.resolveConfigVariables=function(e,t){let r=0,n=0,i=!0;function s(e){const t=e.split(/[/\\:?=&\s]/);for(let r=0;r<t.length;r++)if("$"===t[r][0]){const n=t[r].substring(1);let s=a(n);if(void 0!==s){const a=e.replace(t[r],s);o.default.system.verbose("forceObjectsToLogger","ConfigUtil.resolveConfigVariables:resolveString configString",t[r],n,s,"old value=",e,"value=",a),i=!0,e=a}}return e}function a(t){let r=e[t];return void 0===r&&(e.custom?(r=e.custom[t],void 0===r&&o.default.system.warn("ConfigUtil.resolveString",`Missing [${t}] variable from finsemble.custom configuration object`)):o.default.system.error("ConfigUtil.resolveString",'Missing "custom" node from finsemble configuration - unable to get variable resoution for variable: '+t)),r}function l(e,t,r){e=e||{},o.default.system.verbose("forceObjectsToLogger","ConfigUtil.resolveConfigVariables:resolveObject","pass",t,"recursionLevel",r,"configObject:",e),Object.keys(e).forEach(n=>{const i=e[n];"string"==typeof i&&i.indexOf("$")>-1?e[n]=s(i):i instanceof Array?function e(t,r,n){o.default.system.verbose("forceObjectsToLogger","resolveArray","pass",r,"recursionLevel",n,"configArray:",t);for(let i=0;i<t.length;i++){const o=t[i];"string"==typeof o&&o.indexOf("$")>-1?t[i]=s(o):o instanceof Array?e(o,r,n+1):"object"==typeof o&&l(o,r,n+1)}}(i,t,r+1):"object"==typeof i&&l(i,t,r+1)})}for(;i&&n++<100;)i=!1,l(t,++r,1);n>=100&&o.default.system.error("forceObjectsToLogger","resolveConfigVariables exceeded maximum passes so continuing -- probably a recursive macro definitions.  Look in this config for unresolved macro variables",e)},this.getExpandedRawManifest=function(t,r){o.default.system.debug("ConfigUtil.getExpandedRawManifest starting"),s.System.ready(()=>{const n=s.System.Application.getCurrent();!function t(n,i,a){o.default.system.debug("forceObjectsToLogger","ConfigUtil.getExpandedRawManifest:getRawManifest",i,a),i.getManifest(t=>{o.default.system.debug("forceObjectsToLogger","ConfigUtil.getExpandedRawManifest:getExpandedRawManifest: manifest retrieved. Pre-variable resolution",t),e.resolveConfigVariables(t.finsemble,t.finsemble),o.default.system.debug("forceObjectsToLogger","ConfigUtil.getExpandedRawManifest:getExpandedRawManifest:Complete. post-variable resolution",t),n(t)},e=>{e&&(o.default.system.error("ConfigUtil.getExpandedRawManifest:application.getManifest:err",e),r&&r()),i.getParentUuid(e=>{const r=s.System.Application.wrap(e);o.default.system.debug("forceObjectsToLogger","uuid",e,"parentApplication",r),a<10?t(n,r,++a):n("could not find manifest in parent applications")})})}(t,n,1)})},this.readConfigFile=function(e,t){o.default.system.debug("fetching "+e),fetch(e,{credentials:"include",cache:"no-cache"}).then(e=>e.json()).catch(r=>{t(`Failure importing ${e}: ${r}`,null)}).then(e=>{t(null,e)})},this.getInitialManifest=function(t){s.System.ready(()=>{s.System.Application.getCurrent().getManifest(r=>{r.finsemble=r.finsemble||{},e.resolveConfigVariables(r.finsemble,r.finsemble),r.finsemble.applicationRoot||o.default.system.error("FATAL ERROR: applicationRoot was not defined in manifest file.");const n=r.finsemble.moduleRoot+"/configs/core/config.json";e.readConfigFile(n,(i,s)=>{i?o.default.system.error(`ConfigUtil.getInitialManifest:getCoreConfig:failed importing into finsemble config. $moduleRoot=${r.finsemble.moduleRoot}; Full Path=${n}`,i):(Object.keys(s).forEach(e=>{if("importConfig"===e){r.finsemble.importConfig=r.finsemble.importConfig||[];for(let e=0;e<s.importConfig.length;e++)r.finsemble.importConfig.unshift(s.importConfig[e])}else if("importThirdPartyConfig"===e){r.finsemble.importThirdPartyConfig=r.finsemble.importThirdPartyConfig||[];for(let e=0;e<s.importThirdPartyConfig.length;e++)r.finsemble.importThirdPartyConfig.unshift(s.importThirdPartyConfig[e])}else r.finsemble[e]=s[e]}),e.resolveConfigVariables(r.finsemble,r.finsemble),o.default.system.debug("forceObjectsToLogger","ConfigUtil.getInitialManifest:getCoreConfig:Initial Manifest after variables Resolved",r)),t(r)})})})},this.promptAndSaveJSONToLocalFile=function(e,t){o.default.system.debug("saveJSONToLocalFile",e,t);const r=JSON.stringify(t,null,"\t"),n="data:application/json;charset=utf-8,"+encodeURIComponent(r),i=e+".json",s=document.createElement("a");s.setAttribute("href",n),s.setAttribute("download",i),s.click()},this.configFormatForExport=function(e,t){o.default.system.debug("configFormatForExport starting",e,t);let r=i.default.clone(t);if("raw"===e);else if("all"===e)delete r.importConfig,delete r.comment;else if("application"===e)delete r.importConfig,delete r.comment,delete r.system,delete r.services;else if("workspace"===e)r={workspace:r};else if("workspaceTemplate"===e){const e={};e[r.name]=r,r={workspaceTemplates:e}}else"services"===e?r=r.services:"components"===e&&(r=r.components);return r},this.getDefault=function(e,t,r){let n=r;if(e){try{const r=t.split(".");let i=e;for(let e=1;e<r.length;e++)i=i[r[e]];n=i}catch(e){n=r}void 0===n&&(n=r)}return n},this.getFile=async function(e,t=Function.prototype){o.default.system.debug("fetching import "+e);let r=null;return await fetch(e,{credentials:"include",cache:"no-cache"}).then(e=>e.json()).catch(r=>{t(`failure importing ${e}: ${r}`,null)}).then(e=>{t(null,e),r=e}),r}};t.ConfigUtilInstance=a},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(55));
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var o=new function(){function e(e,t,r){const n=function(){try{throw Error("")}catch(e){return e}}(),i=n.stack.split("\n")[5],o=i.indexOf("at "),s=i.slice(o+2,i.length),a=n.stack.split("\n")[6],l=a.indexOf("at "),u=a.slice(l+2,a.length);console.warn(`parameter validation failed: parameter ${e} is of type '${typeof t}' but should be of type '${r}' in${s} called by${u}`)}this.args=function(){let t=!0;if(i.default.validationEnabled()){const r=arguments.length;if((r+1)%2!=0)for(let n=0;n<r;n+=2){let r=!1;const i=arguments[n];let o=arguments[n+1];if("="===o.slice(-1)&&(o=o.slice(0,-1),r=!0),typeof i!==o&&!(r&&void 0===i||void 0!==i&&"any"===o)){e(n/2+1,i,o),t=!1;break}}else console.warn("validate.args requires even number of parameters: "+JSON.stringify(arguments))}return t},this.args2=function(){let t=!0;if(i.default.validationEnabled()){const r=arguments.length;if((r+1)%3!=0)for(let n=0;n<r;n+=3){let r=!1;const i=arguments[n],o=arguments[n+1];let s=arguments[n+2];if("="===s.slice(-1)&&(s=s.slice(0,-1),r=!0),typeof o!==s&&!(r&&void 0===o||void 0!==o&&"any"===s)){e(i,o,s),t=!1;break}}else console.warn("validate.args requires even number of parameters: "+JSON.stringify(arguments))}return t}};t.default=o,e.exports=t.default},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.clone=u,t.getContainerVersion=function(e=Function.prototype){return new Promise(t=>{o.System.getVersion(r=>{const n=r.split(".").map(Number),i={major:n[0],chromium:n[1],minor:n[2],patch:n[3]};e(i),t({versionObject:i})})})},t.castToPromise=function(e){return function(){return new Promise((t,r)=>{const n=e.apply(null,Array.from(arguments));try{return n.then(t,r)}catch(e){e instanceof TypeError?t(n):r(e)}})}},t.isPercentage=function(e){if("string"!=typeof e)return!1;return-1!==e.indexOf("%")},t.crossDomain=function(e){const t=document.createElement("a");t.href=e;const r=window.location.hostname===t.hostname,n=window.location.protocol===t.protocol,i=void 0!==window.location.port?window.location.port:80,o=void 0!==t.port?t.port:80,s=i===o,l=!(r&&s&&n);return a.default.system.debug(`Launcher crossDomain=${l} (${r}:${n}:${s})`),l},t.getMonitorFromWindow=d,t.getFinWindow=h,t.getWindowDescriptor=p,t.findMonitor=m,t.getWhichMonitor=v,t.getMonitor=g,t.getMonitorFromCommand=function(e,t,r){return new Promise(n=>{g(t,t=>{l.getAllMonitors(i=>{v({commandMonitor:e,monitors:i,launchingMonitorPosition:t.position},e=>{r&&r(e),n(e)})})})})},t.windowOnMonitor=function(e,t){if(e.left>=t.left&&e.left<t.right||e.right<=t.right&&e.right>t.left)return!0;return!1},t.getMonitorByDescriptor=function(e,t){return new Promise(r=>{d(e,e=>{t&&t(e),r(e)})})},t.getMyWindowIdentifier=function(e){const t=o.System.Window.getCurrent();return new Promise(r=>{t.getOptions(n=>{let i=null;const{customData:o}=n;o&&o.component&&(i=o.component.type);const s={windowName:t.name,uuid:t.uuid,componentType:i};e&&e(s),r(s)})})},t.camelCase=function(){let e="";for(let t=0;t<arguments.length;t++)e=`${e} ${arguments[t]}`;return e.replace(/\s(.)/g,e=>e.toUpperCase()).replace(/\s/g,"").replace(/^(.)/,e=>e.toLowerCase())},t.guuid=function(){return(0,i.default)()},t.injectJS=function(e,t){const r=document.createElement("script");r.onload=t,r.type="text/javascript",r.async=!0,r.src=e;const n=document.getElementsByTagName("head")[0],i=n.getElementsByTagName("script")[0];n.insertBefore(r,i)},t.openSharedData=function(e,t){const r=FSBL.Clients.LauncherClient,n=FSBL.Clients.LinkerClient;e.multipleOpenerHandler||(e.multipleOpenerHandler=function(e){let t,r=0;for(const n of Object.keys(e))e[n].length>r&&(t=n,r=e[n].length);return[t]});const i=[],o={};r.getComponentsThatCanReceiveDataTypes({dataTypes:Object.keys(e.data)},(s,l)=>{for(const e of Object.keys(l))if(l[e].componentTypes.length)for(const t of l[e].componentTypes)o[t]?o[t].push(e):o[t]=[e];else{const t="No Components Available to Handle the type: "+e;i.push(t),a.default.system.error(t)}let u=Object.keys(o);if(u.length){u.length>1&&(u=e.multipleOpenerHandler(o));const s=Object.keys(n.channels);if(s.length){if(n.getLinkedComponents({componentTypes:u,windowIdentifier:n.windowIdentifier()}).length||e.publishOnly)n.publish({dataType:"Finsemble.DragAndDropClient",data:e.data}),t&&t(i.length?i:null,"Data published");else{for(const t of u)r.spawn(t,{data:{sharedData:e.data,linker:{channels:s}},addToWorkspace:!0});t&&t(i.length?i:null,"Linked Window(s) spawned with data")}}else if(!e.publishOnly){for(const t of u)r.spawn(t,{data:{sharedData:e.data},addToWorkspace:!0});t&&t(i.length?i:null,"New Window(s) spawned with data")}}else t&&t(i.length?i:null,null)})},t.getNewBoundsWhenMovedToMonitor=function(e,t,r="availableRect"){const n=e[r]||e.availableRect||e.monitorRect,i=u(t);t.top<n.top?i.top=n.top:t.top>n.bottom-t.height&&(i.top=n.bottom-t.height);t.left<n.left?i.left=n.left:t.left>n.right-t.width&&(i.left=n.right-t.width);i.bottom=i.top+i.height,i.right=i.left+i.width,i.right>n.right&&(i.right=n.right);i.top<n.top&&(i.top=n.top);i.left<n.left&&(i.left=n.left);i.bottom>n.bottom&&(i.bottom=n.bottom);i.height=i.bottom-i.top,i.width=i.right-i.left;const o=Math.sqrt((t.left-i.left)**2+(t.top-i.top)**2);return{newBounds:i,distanceMoved:o,monitor:e}},t.isOnAMonitor=function(e){return this.Monitors.allMonitors.some(t=>{const{monitorRect:r}=t;return e.left>=r.left&&e.left<=r.right&&e.right>=r.left&&e.right<=r.right&&e.top>=r.top&&e.top<=r.bottom&&e.bottom>=r.top&&e.bottom<=r.bottom})},t.adjustBoundsToBeOnMonitor=function(e,t="availableRect"){if(this.isOnAMonitor(e))return a.default.system.info("Launcher.adjustWindowDescriptorBoundsToBeOnMonitor: on monitor."),e;const r=this.Monitors.allMonitors.map(r=>{let n=r.rawMonitor?r.rawMonitor:r;return this.getNewBoundsWhenMovedToMonitor(n,e,t)}).sort((e,t)=>e.distanceMoved-t.distanceMoved)[0];return a.default.system.info("Launcher.adjustWindowDescriptorBoundsToBeOnMonitor: not on monitor.  bounds",e,"monitor name",r.monitor.name,"newBounds",r.newBounds),r.newBounds},t.isWindows=async function(e=Function.prototype){const t=(await o.System.getHostSpecs()).name.toUpperCase().includes("WINDOWS");return e(t),t},t.getWindowType=function(e){if(e.windowType&&!["assimilation","assimilated","native","application","NativeWindow","FinsembleNativeWindow","CompoundWindow","WebWindow","WebApplication","StackedWindow"].includes(e.windowType))return a.default.system.error(`Invalid windowType: ${e.windowType}, defaulting to windowType: WebWindow`),"WebWindow";let t=e.windowType||"WebWindow";switch(e.windowType){case"assimilation":case"assimilated":t="NativeWindow";break;case"native":t="FinsembleNativeWindow";break;case"application":t="WebApplication";break;case"Web":t="WebWindow";break;case"StackedWindow":t="StackedWindow"}e.native&&(t="NativeWindow");e.compound&&(t="CompoundWindow");return t},t.getMonitorFromXY=t.getAllMonitors=t.Monitors=void 0;var i=n(r(29)),o=r(5),s=n(r(42)),a=n(r(1));
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const l=new s.default(Function.prototype,Function.prototype,{System:o.System});function u(e,t){if(null===e||"object"!=typeof e)return e;if(e.constructor==Date||e.constructor==RegExp||e.constructor==Function||e.constructor==String||e.constructor==Number||e.constructor==Boolean)return new e.constructor(e);t=t||new e.constructor;for(const r in e)t[r]=void 0===t[r]?u(e[r],null):t[r];return t}t.Monitors=l;var{getAllMonitors:c}=l;t.getAllMonitors=c;var f=l.getMonitorFromScaledXY;function d(e,t){const r=Number.isFinite(e.x)?e.x:e.defaultLeft,n=Number.isFinite(e.y)?e.y:e.defaultTop,i=r+e.defaultWidth,o=n+e.defaultHeight;return new Promise((e,s)=>{l.getMonitorFromScaledXY(r,n,c=>{if(!c)return a.default.system.debug("getMonitorFromWindow - top-left is off screen, trying bottom right"),void l.getMonitorFromScaledXY(i,o,i=>{if(!i)return a.default.system.debug("getMonitorFromWindow - bottom-right is off screen, getting primary"),void l.getAllMonitors(r=>{r[0]?(t&&t(r[0]),e(r[0])):(s(new Error("Cannot find monitor for window.")),t&&t(null))});i=u(i);const{monitorRect:o}=i;(o.left<r||o.right<n)&&(i.straddling=!0),t&&t(i),e(i)});c=u(c);const{monitorRect:f}=c;(f.right>i||f.bottom>o)&&(c.straddling=!0),t&&t(c),e(c)})})}function h(e,t){return new Promise((r,n)=>{const i=o.System.Window.getCurrent();i.getOptions(s=>{if(e&&e.windowName){e.uuid||(e.uuid=s.uuid);const i=o.System.Window.wrap(e.uuid,e.windowName);i.getInfo(()=>{t&&t(i),r(i)},()=>{t&&t(null),n(`Window ${e.windowName} not found. UUID: ${e.uuid}`),console.debug(`util.getFinWindow: Window ${e.windowName} not found`)})}else if(e&&e.componentType)if(void 0!==window.LauncherService){const i=window.LauncherService.componentFinder(e);i?(r(i),t&&t(i)):(n(`util.getFinWindow: Component ${e.componentType} not found.`),t&&t(null))}else n("getFinWindow by componentType is currently only operable within LaunchService"),t&&t(null);else t&&t(i),r(i)})})}function p(e,t){return new Promise((r,n)=>{h(e).then(e=>{e.getOptions(e=>{t&&t(e),r(e)})}).catch(e=>{console.warn(e),t&&t(null),n(e)})})}function m(e,t,r){for(let n=0;n<e.length;n++){const i=e[n];if(i[t]===r)return i}return null}function v(e,t){let r;arguments.length>2&&(e={commandMonitor:arguments[0],monitors:arguments[1],launchingMonitorPosition:arguments[2]},t=null);let{commandMonitor:n,monitors:i,launchingMonitorPosition:o}=e;const s=n&&""!==n||0===n;if("primary"===n)r=m(i,"whichMonitor","primary");else if("next"===n){let e=o+1;e>=i.length&&(e=0),r=i[e]}else if("previous"===n){let e=o-1;e<0&&(e=i.length-1),r=i[e]}else if("mine"===n){var a=!0;activeWindows.getWindow(e.windowIdentifier.windowName)._getBounds((e,n)=>{e?(r=i[0],t(r)):l.getMonitorFromScaledXY(n.left,n.top,e=>{t(e)})})}else s?(n>=i.length&&(n=i.length-1),r=i.filter(e=>e.position===n)[0]):o&&(r=i[o]);if(r||(r=i[0]),!a){if(!t)return r;t(r)}}function g(e,t){return new Promise((r,n)=>{p(e,e=>{e?d(e,e=>{t&&t(e),r(e)}):n("util.getMonitor: Can't locate windowDescriptor.")})})}t.getMonitorFromXY=f},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(6)),o=n(r(1)),s=r(56),a=r(34),l=r(57);const u=new class{publishBootStatus(e,t,r){console.log("publishStartingStatus",e,r),o.default.system.debug("publishBootStatus",e,t,r),i.default.publish(l.statusChannel(e),{name:e,type:t,state:r})}waitForBootStage(e,t,r=Function.prototype){return new Promise((n,l)=>{o.default.system.debug("SystemManagerClient.waitForBootStage entry",e,t);const u=s.ALL_BOOT_STAGES.indexOf(e);"microkernel"===e&&"stageEntered"===t&&o.default.system.error("Cannot wait on `stageEntered` for microkernel because router isn't up yet. So will instead wait for microkernal stage complete.");const c=i.default.subscribe(a.STAGE_CHANNEL,(a,f)=>{if(o.default.system.debug("SystemManagerClient.waitForBootStage new stage",f.data.stage,c),a)o.default.system.error("SystemManagerClient.waitForBootStage subscribe error",a),r(a),l(a);else if(-1===u)a="illegal stage argument",o.default.system.debug("SystemManagerClient.waitForBootStage subscribe error",a,e),r(a),l(a);else{const a=s.ALL_BOOT_STAGES.indexOf(f.data.stage);o.default.system.debug("SystemManagerClient.waitForBootStage new stage",f.data,c),"stageEntered"===t&&a+1>=u?(o.default.system.debug("SystemManagerClient.waitForBootStage stageEntered",e,c,r.name),r(),n(),i.default.unsubscribe(c)):"stageCompleted"===t&&a>=u?(o.default.system.debug("SystemManagerClient.waitForBootStage completed",e,c),r(),n(),i.default.unsubscribe(c)):o.default.system.debug(`SystemManagerClient.waitForBootStage else currentStageIndex=${a} stageIndex=${u} `,a,u,e,c)}})})}waitForStartup(e,t=Function.prototype){return new Promise((r,n)=>{o.default.system.debug("SystemManagerClient.waitForStartup."+e,e);const s=i.default.subscribe(l.statusChannel(e),(a,l)=>{o.default.system.debug("SystemManagerClient.waitForStartup subscribe",e,a,l),a?(o.default.system.error("SystemManagerClient.waitForStartup subscribe error",a),t(a),n()):l.data.name===e&&"completed"===l.data.state&&(o.default.system.debug("SystemManagerClient.waitForStartup completed",e),t(),r(),i.default.unsubscribe(s))})})}publishCheckpointState(e,t,r){console.log("publishCheckpoint",e,t,r,l.checkpointChannel(e,t)),o.default.system.debug("publishCheckpoint",e,t,r,l.checkpointChannel(e,t)),i.default.publish(l.checkpointChannel(e,t),{windowName:e,checkpointName:t,state:r})}showSystemLog(){o.default.system.debug("SystemManagerClient.showSystemLog"),i.default.transmit(a.SHOW_SYSLOG_CHANNEL,!0)}systemLog(e,t){o.default.system.debug("SystemManagerClient.systemLog",e,t),i.default.transmit(a.SYSLOG_CHANNEL,{params:e,logMessage:t})}};t.default=u},function(e,t,r){"use strict";r.r(t),r.d(t,"applyEach",(function(){return se})),r.d(t,"applyEachSeries",(function(){return ce})),r.d(t,"apply",(function(){return fe})),r.d(t,"asyncify",(function(){return de})),r.d(t,"auto",(function(){return Se})),r.d(t,"autoInject",(function(){return Xe})),r.d(t,"cargo",(function(){return nt})),r.d(t,"compose",(function(){return at})),r.d(t,"concat",(function(){return ut})),r.d(t,"concatSeries",(function(){return ft})),r.d(t,"constant",(function(){return dt})),r.d(t,"detect",(function(){return vt})),r.d(t,"detectLimit",(function(){return gt})),r.d(t,"detectSeries",(function(){return yt})),r.d(t,"dir",(function(){return St})),r.d(t,"doDuring",(function(){return wt})),r.d(t,"doUntil",(function(){return Et})),r.d(t,"doWhilst",(function(){return _t})),r.d(t,"during",(function(){return Ct})),r.d(t,"each",(function(){return Ot})),r.d(t,"eachLimit",(function(){return Rt})),r.d(t,"eachOf",(function(){return re})),r.d(t,"eachOfLimit",(function(){return X})),r.d(t,"eachOfSeries",(function(){return it})),r.d(t,"eachSeries",(function(){return At})),r.d(t,"ensureAsync",(function(){return Tt})),r.d(t,"every",(function(){return jt})),r.d(t,"everyLimit",(function(){return Lt})),r.d(t,"everySeries",(function(){return Dt})),r.d(t,"filter",(function(){return Mt})),r.d(t,"filterLimit",(function(){return $t})),r.d(t,"filterSeries",(function(){return Vt})),r.d(t,"forever",(function(){return Wt})),r.d(t,"log",(function(){return Ut})),r.d(t,"map",(function(){return oe})),r.d(t,"mapLimit",(function(){return le})),r.d(t,"mapSeries",(function(){return ue})),r.d(t,"mapValues",(function(){return zt})),r.d(t,"mapValuesLimit",(function(){return Bt})),r.d(t,"mapValuesSeries",(function(){return qt})),r.d(t,"memoize",(function(){return Qt})),r.d(t,"nextTick",(function(){return Gt.a})),r.d(t,"parallel",(function(){return Kt})),r.d(t,"parallelLimit",(function(){return Jt})),r.d(t,"priorityQueue",(function(){return er})),r.d(t,"queue",(function(){return Zt})),r.d(t,"race",(function(){return tr})),r.d(t,"reduce",(function(){return ot})),r.d(t,"reduceRight",(function(){return nr})),r.d(t,"reflect",(function(){return ir})),r.d(t,"reflectAll",(function(){return ar})),r.d(t,"reject",(function(){return sr})),r.d(t,"rejectLimit",(function(){return lr})),r.d(t,"rejectSeries",(function(){return ur})),r.d(t,"retry",(function(){return fr})),r.d(t,"retryable",(function(){return dr})),r.d(t,"seq",(function(){return st})),r.d(t,"series",(function(){return hr})),r.d(t,"setImmediate",(function(){return Xt})),r.d(t,"some",(function(){return pr})),r.d(t,"someLimit",(function(){return mr})),r.d(t,"someSeries",(function(){return vr})),r.d(t,"sortBy",(function(){return gr})),r.d(t,"timeout",(function(){return yr})),r.d(t,"times",(function(){return Er})),r.d(t,"timesLimit",(function(){return _r})),r.d(t,"timesSeries",(function(){return Cr})),r.d(t,"transform",(function(){return Pr})),r.d(t,"unmemoize",(function(){return Or})),r.d(t,"until",(function(){return Ar})),r.d(t,"waterfall",(function(){return Tr})),r.d(t,"whilst",(function(){return Rr})),r.d(t,"all",(function(){return jt})),r.d(t,"allLimit",(function(){return Lt})),r.d(t,"allSeries",(function(){return Dt})),r.d(t,"any",(function(){return pr})),r.d(t,"anyLimit",(function(){return mr})),r.d(t,"anySeries",(function(){return vr})),r.d(t,"find",(function(){return vt})),r.d(t,"findLimit",(function(){return gt})),r.d(t,"findSeries",(function(){return yt})),r.d(t,"forEach",(function(){return Ot})),r.d(t,"forEachSeries",(function(){return At})),r.d(t,"forEachLimit",(function(){return Rt})),r.d(t,"forEachOf",(function(){return re})),r.d(t,"forEachOfSeries",(function(){return it})),r.d(t,"forEachOfLimit",(function(){return X})),r.d(t,"inject",(function(){return ot})),r.d(t,"foldl",(function(){return ot})),r.d(t,"foldr",(function(){return nr})),r.d(t,"select",(function(){return Mt})),r.d(t,"selectLimit",(function(){return $t})),r.d(t,"selectSeries",(function(){return Vt})),r.d(t,"wrapSync",(function(){return de}));var n=r(0),i=function(e){return Object(n.a)((function(t){var r=t.pop();e.call(this,t,r)}))};function o(e){return Object(n.a)((function(t,r){var n=i((function(r,n){var i=this;return e(t,(function(e,t){e.apply(i,r.concat(t))}),n)}));return r.length?n.apply(this,r):n}))}var s=r(15).a.Symbol,a=Object.prototype,l=a.hasOwnProperty,u=a.toString,c=s?s.toStringTag:void 0;var f=function(e){var t=l.call(e,c),r=e[c];try{e[c]=void 0;var n=!0}catch(e){}var i=u.call(e);return n&&(t?e[c]=r:delete e[c]),i},d=Object.prototype.toString;var h=function(e){return d.call(e)},p=s?s.toStringTag:void 0;var m=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":p&&p in Object(e)?f(e):h(e)};var v=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var g=function(e){if(!v(e))return!1;var t=m(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var y=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var b=function(e){return null!=e&&y(e.length)&&!g(e)},S={};var w=function(){};function _(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var E="function"==typeof Symbol&&Symbol.iterator;var C=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var P=function(e){return null!=e&&"object"==typeof e};var O=function(e){return P(e)&&"[object Arguments]"==m(e)},R=Object.prototype,A=R.hasOwnProperty,T=R.propertyIsEnumerable,I=O(function(){return arguments}())?O:function(e){return P(e)&&A.call(e,"callee")&&!T.call(e,"callee")},j=Array.isArray,L=r(35),D=/^(?:0|[1-9]\d*)$/;var F=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&D.test(e))&&e>-1&&e%1==0&&e<t},k={};k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Arguments]"]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object Boolean]"]=k["[object DataView]"]=k["[object Date]"]=k["[object Error]"]=k["[object Function]"]=k["[object Map]"]=k["[object Number]"]=k["[object Object]"]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object WeakMap]"]=!1;var N=function(e){return P(e)&&y(e.length)&&!!k[m(e)]};var x=function(e){return function(t){return e(t)}},M=r(21),$=M.a&&M.a.isTypedArray,V=$?x($):N,W=Object.prototype.hasOwnProperty;var U=function(e,t){var r=j(e),n=!r&&I(e),i=!r&&!n&&Object(L.a)(e),o=!r&&!n&&!i&&V(e),s=r||n||i||o,a=s?C(e.length,String):[],l=a.length;for(var u in e)!t&&!W.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||F(u,l))||a.push(u);return a},B=Object.prototype;var z=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||B)};var q=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),H=Object.prototype.hasOwnProperty;var Q=function(e){if(!z(e))return q(e);var t=[];for(var r in Object(e))H.call(e,r)&&"constructor"!=r&&t.push(r);return t};var G=function(e){return b(e)?U(e):Q(e)};function Y(e){if(b(e))return function(e){var t=-1,r=e.length;return function(){return++t<r?{value:e[t],key:t}:null}}(e);var t,r,n,i,o=function(e){return E&&e[E]&&e[E]()}(e);return o?function(e){var t=-1;return function(){var r=e.next();return r.done?null:(t++,{value:r.value,key:t})}}(o):(r=G(t=e),n=-1,i=r.length,function(){var e=r[++n];return n<i?{value:t[e],key:e}:null})}function K(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function J(e){return function(t,r,n){if(n=_(n||w),e<=0||!t)return n(null);var i=Y(t),o=!1,s=0;function a(e,t){if(s-=1,e)o=!0,n(e);else{if(t===S||o&&s<=0)return o=!0,n(null);l()}}function l(){for(;s<e&&!o;){var t=i();if(null===t)return o=!0,void(s<=0&&n(null));s+=1,r(t.value,t.key,K(a))}}l()}}function X(e,t,r,n){J(t)(e,r,n)}function Z(e,t){return function(r,n,i){return e(r,t,n,i)}}function ee(e,t,r){r=_(r||w);var n=0,i=0,o=e.length;function s(e,t){e?r(e):++i!==o&&t!==S||r(null)}for(0===o&&r(null);n<o;n++)t(e[n],n,K(s))}var te=Z(X,1/0),re=function(e,t,r){(b(e)?ee:te)(e,t,r)};function ne(e){return function(t,r,n){return e(re,t,r,n)}}function ie(e,t,r,n){n=n||w;var i=[],o=0;e(t=t||[],(function(e,t,n){var s=o++;r(e,(function(e,t){i[s]=t,n(e)}))}),(function(e){n(e,i)}))}var oe=ne(ie),se=o(oe);function ae(e){return function(t,r,n,i){return e(J(r),t,n,i)}}var le=ae(ie),ue=Z(le,1),ce=o(ue),fe=Object(n.a)((function(e,t){return Object(n.a)((function(r){return e.apply(null,t.concat(r))}))}));function de(e){return i((function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}v(n)&&"function"==typeof n.then?n.then((function(e){r(null,e)}),(function(e){r(e.message?e:new Error(e))})):r(null,n)}))}var he=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var pe=function(e){return function(t,r,n){for(var i=-1,o=Object(t),s=n(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===r(o[l],l,o))break}return t}}();var me=function(e,t){return e&&pe(e,t,G)};var ve=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var ge=function(e){return e!=e};var ye=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var be=function(e,t,r){return t==t?ye(e,t,r):ve(e,ge,r)},Se=function(e,t,r){"function"==typeof t&&(r=t,t=null),r=_(r||w);var i=G(e).length;if(!i)return r(null);t||(t=i);var o={},s=0,a=!1,l=Object.create(null),u=[],c=[],f={};function d(e,t){u.push((function(){!function(e,t){if(a)return;var i=K(Object(n.a)((function(t,n){if(s--,n.length<=1&&(n=n[0]),t){var i={};me(o,(function(e,t){i[t]=e})),i[e]=n,a=!0,l=Object.create(null),r(t,i)}else o[e]=n,u=l[e]||[],he(u,(function(e){e()})),h();var u})));s++;var u=t[t.length-1];t.length>1?u(o,i):u(i)}(e,t)}))}function h(){if(0===u.length&&0===s)return r(null,o);for(;u.length&&s<t;){u.shift()()}}function p(t){var r=[];return me(e,(function(e,n){j(e)&&be(e,t,0)>=0&&r.push(n)})),r}me(e,(function(t,r){if(!j(t))return d(r,[t]),void c.push(r);var n=t.slice(0,t.length-1),i=n.length;if(0===i)return d(r,t),void c.push(r);f[r]=i,he(n,(function(o){if(!e[o])throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+o+"` in "+n.join(", "));!function(e,t){var r=l[e];r||(r=l[e]=[]);r.push(t)}(o,(function(){0===--i&&d(r,t)}))}))})),function(){var e,t=0;for(;c.length;)e=c.pop(),t++,he(p(e),(function(e){0==--f[e]&&c.push(e)}));if(t!==i)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),h()};var we=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var _e=function(e){return"symbol"==typeof e||P(e)&&"[object Symbol]"==m(e)},Ee=s?s.prototype:void 0,Ce=Ee?Ee.toString:void 0;var Pe=function e(t){if("string"==typeof t)return t;if(j(t))return we(t,e)+"";if(_e(t))return Ce?Ce.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r};var Oe=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var Re=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:Oe(e,t,r)};var Ae=function(e,t){for(var r=e.length;r--&&be(t,e[r],0)>-1;);return r};var Te=function(e,t){for(var r=-1,n=e.length;++r<n&&be(t,e[r],0)>-1;);return r};var Ie=function(e){return e.split("")},je=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Le=function(e){return je.test(e)},De="[\\ud800-\\udfff]",Fe="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ke="\\ud83c[\\udffb-\\udfff]",Ne="[^\\ud800-\\udfff]",xe="(?:\\ud83c[\\udde6-\\uddff]){2}",Me="[\\ud800-\\udbff][\\udc00-\\udfff]",$e="(?:"+Fe+"|"+ke+")"+"?",Ve="[\\ufe0e\\ufe0f]?"+$e+("(?:\\u200d(?:"+[Ne,xe,Me].join("|")+")[\\ufe0e\\ufe0f]?"+$e+")*"),We="(?:"+[Ne+Fe+"?",Fe,xe,Me,De].join("|")+")",Ue=RegExp(ke+"(?="+ke+")|"+We+Ve,"g");var Be=function(e){return e.match(Ue)||[]};var ze=function(e){return Le(e)?Be(e):Ie(e)};var qe=function(e){return null==e?"":Pe(e)},He=/^\s+|\s+$/g;var Qe=function(e,t,r){if((e=qe(e))&&(r||void 0===t))return e.replace(He,"");if(!e||!(t=Pe(t)))return e;var n=ze(e),i=ze(t),o=Te(n,i),s=Ae(n,i)+1;return Re(n,o,s).join("")},Ge=/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Ye=/,/,Ke=/(=.+)?(\s*)$/,Je=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function Xe(e,t){var r={};me(e,(function(e,t){var n,i;if(j(e))n=e.slice(0,-1),e=e[e.length-1],r[t]=n.concat(n.length>0?o:e);else if(1===e.length)r[t]=e;else{if(n=i=(i=(i=(i=(i=e).toString().replace(Je,"")).match(Ge)[2].replace(" ",""))?i.split(Ye):[]).map((function(e){return Qe(e.replace(Ke,""))})),0===e.length&&0===n.length)throw new Error("autoInject task functions require explicit parameters.");n.pop(),r[t]=n.concat(o)}function o(t,r){var i=we(n,(function(e){return t[e]}));i.push(r),e.apply(null,i)}})),Se(r,t)}var Ze=r(2);function et(){this.head=this.tail=null,this.length=0}function tt(e,t){e.length=1,e.head=e.tail=t}function rt(e,t,r){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function i(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(u.started=!0,j(e)||(e=[e]),0===e.length&&u.idle())return Object(Ze.a)((function(){u.drain()}));for(var n=0,i=e.length;n<i;n++){var o={data:e[n],callback:r||w};t?u._tasks.unshift(o):u._tasks.push(o)}Object(Ze.a)(u.process)}function o(e){return Object(n.a)((function(t){s-=1;for(var r=0,n=e.length;r<n;r++){var i=e[r],o=be(a,i,0);o>=0&&a.splice(o),i.callback.apply(i,t),null!=t[0]&&u.error(t[0],i.data)}s<=u.concurrency-u.buffer&&u.unsaturated(),u.idle()&&u.drain(),u.process()}))}var s=0,a=[],l=!1,u={_tasks:new et,concurrency:t,payload:r,saturated:w,unsaturated:w,buffer:t/4,empty:w,drain:w,error:w,started:!1,paused:!1,push:function(e,t){i(e,!1,t)},kill:function(){u.drain=w,u._tasks.empty()},unshift:function(e,t){i(e,!0,t)},process:function(){if(!l){for(l=!0;!u.paused&&s<u.concurrency&&u._tasks.length;){var t=[],r=[],n=u._tasks.length;u.payload&&(n=Math.min(n,u.payload));for(var i=0;i<n;i++){var c=u._tasks.shift();t.push(c),r.push(c.data)}0===u._tasks.length&&u.empty(),s+=1,a.push(t[0]),s===u.concurrency&&u.saturated();var f=K(o(t));e(r,f)}l=!1}},length:function(){return u._tasks.length},running:function(){return s},workersList:function(){return a},idle:function(){return u._tasks.length+s===0},pause:function(){u.paused=!0},resume:function(){!1!==u.paused&&(u.paused=!1,Object(Ze.a)(u.process))}};return u}function nt(e,t){return rt(e,1,t)}et.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},et.prototype.empty=et,et.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},et.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},et.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):tt(this,e)},et.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):tt(this,e)},et.prototype.shift=function(){return this.head&&this.removeLink(this.head)},et.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var it=Z(X,1);function ot(e,t,r,n){n=_(n||w),it(e,(function(e,n,i){r(t,e,(function(e,r){t=r,i(e)}))}),(function(e){n(e,t)}))}var st=Object(n.a)((function(e){return Object(n.a)((function(t){var r=this,i=t[t.length-1];"function"==typeof i?t.pop():i=w,ot(e,t,(function(e,t,i){t.apply(r,e.concat(Object(n.a)((function(e,t){i(e,t)}))))}),(function(e,t){i.apply(r,[e].concat(t))}))}))})),at=Object(n.a)((function(e){return st.apply(null,e.reverse())}));function lt(e,t,r,n){var i=[];e(t,(function(e,t,n){r(e,(function(e,t){i=i.concat(t||[]),n(e)}))}),(function(e){n(e,i)}))}var ut=ne(lt);var ct,ft=(ct=lt,function(e,t,r){return ct(it,e,t,r)}),dt=Object(n.a)((function(e){var t=[null].concat(e);return i((function(e,r){return r.apply(this,t)}))})),ht=r(4);function pt(e,t){return function(r,n,i,o){o=o||w;var s,a=!1;r(n,(function(r,n,o){i(r,(function(n,i){n?o(n):e(i)&&!s?(a=!0,s=t(!0,r),o(null,S)):o()}))}),(function(e){e?o(e):o(null,a?s:t(!1))}))}}function mt(e,t){return t}var vt=ne(pt(ht.a,mt)),gt=ae(pt(ht.a,mt)),yt=Z(gt,1);function bt(e){return Object(n.a)((function(t,r){t.apply(null,r.concat(Object(n.a)((function(t,r){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&he(r,(function(t){console[e](t)})))}))))}))}var St=bt("dir");function wt(e,t,r){r=K(r||w);var i=Object(n.a)((function(e,n){if(e)return r(e);n.push(o),t.apply(this,n)}));function o(t,n){return t?r(t):n?void e(i):r(null)}o(null,!0)}function _t(e,t,r){r=K(r||w);var i=Object(n.a)((function(n,o){return n?r(n):t.apply(this,o)?e(i):void r.apply(null,[null].concat(o))}));e(i)}function Et(e,t,r){_t(e,(function(){return!t.apply(this,arguments)}),r)}function Ct(e,t,r){function n(t){if(t)return r(t);e(i)}function i(e,i){return e?r(e):i?void t(n):r(null)}r=K(r||w),e(i)}function Pt(e){return function(t,r,n){return e(t,n)}}function Ot(e,t,r){re(e,Pt(t),r)}function Rt(e,t,r,n){J(t)(e,Pt(r),n)}var At=Z(Rt,1);function Tt(e){return i((function(t,r){var n=!0;t.push((function(){var e=arguments;n?Object(Ze.a)((function(){r.apply(null,e)})):r.apply(null,e)})),e.apply(this,t),n=!1}))}function It(e){return!e}var jt=ne(pt(It,It)),Lt=ae(pt(It,It)),Dt=Z(Lt,1);var Ft=function(e){return function(t){return null==t?void 0:t[e]}};function kt(e,t,r,n){var i=new Array(t.length);e(t,(function(e,t,n){r(e,(function(e,r){i[t]=!!r,n(e)}))}),(function(e){if(e)return n(e);for(var r=[],o=0;o<t.length;o++)i[o]&&r.push(t[o]);n(null,r)}))}function Nt(e,t,r,n){var i=[];e(t,(function(e,t,n){r(e,(function(r,o){r?n(r):(o&&i.push({index:t,value:e}),n())}))}),(function(e){e?n(e):n(null,we(i.sort((function(e,t){return e.index-t.index})),Ft("value")))}))}function xt(e,t,r,n){(b(t)?kt:Nt)(e,t,r,n||w)}var Mt=ne(xt),$t=ae(xt),Vt=Z($t,1);function Wt(e,t){var r=K(t||w),n=Tt(e);!function e(t){if(t)return r(t);n(e)}()}var Ut=bt("log");function Bt(e,t,r,n){n=_(n||w);var i={};X(e,t,(function(e,t,n){r(e,t,(function(e,r){if(e)return n(e);i[t]=r,n()}))}),(function(e){n(e,i)}))}var zt=Z(Bt,1/0),qt=Z(Bt,1);function Ht(e,t){return t in e}function Qt(e,t){var r=Object.create(null),o=Object.create(null);t=t||ht.a;var s=i((function(i,s){var a=t.apply(null,i);Ht(r,a)?Object(Ze.a)((function(){s.apply(null,r[a])})):Ht(o,a)?o[a].push(s):(o[a]=[s],e.apply(null,i.concat(Object(n.a)((function(e){r[a]=e;var t=o[a];delete o[a];for(var n=0,i=t.length;n<i;n++)t[n].apply(null,e)})))))}));return s.memo=r,s.unmemoized=e,s}var Gt=r(20);function Yt(e,t,r){r=r||w;var i=b(t)?[]:{};e(t,(function(e,t,r){e(Object(n.a)((function(e,n){n.length<=1&&(n=n[0]),i[t]=n,r(e)})))}),(function(e){r(e,i)}))}function Kt(e,t){Yt(re,e,t)}function Jt(e,t,r){Yt(J(t),e,r)}var Xt=Ze.a,Zt=function(e,t){return rt((function(t,r){e(t[0],r)}),t,1)},er=function(e,t){var r=Zt(e,t);return r.push=function(e,t,n){if(null==n&&(n=w),"function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,j(e)||(e=[e]),0===e.length)return Xt((function(){r.drain()}));t=t||0;for(var i=r._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,s=e.length;o<s;o++){var a={data:e[o],priority:t,callback:n};i?r._tasks.insertBefore(i,a):r._tasks.push(a)}Xt(r.process)},delete r.unshift,r};function tr(e,t){if(t=_(t||w),!j(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,n=e.length;r<n;r++)e[r](t)}var rr=Array.prototype.slice;function nr(e,t,r,n){ot(rr.call(e).reverse(),t,r,n)}function ir(e){return i((function(t,r){return t.push(Object(n.a)((function(e,t){if(e)r(null,{error:e});else{var n=null;1===t.length?n=t[0]:t.length>1&&(n=t),r(null,{value:n})}}))),e.apply(this,t)}))}function or(e,t,r,n){xt(e,t,(function(e,t){r(e,(function(e,r){t(e,!r)}))}),n)}var sr=ne(or);function ar(e){var t;return j(e)?t=we(e,ir):(t={},me(e,(function(e,r){t[r]=ir.call(this,e)}))),t}var lr=ae(or),ur=Z(lr,1);var cr=function(e){return function(){return e}};function fr(e,t,r){var n=5,i=0,o={times:n,intervalFunc:cr(i)};function s(e,t){if("object"==typeof t)e.times=+t.times||n,e.intervalFunc="function"==typeof t.interval?t.interval:cr(+t.interval||i),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||n}}if(arguments.length<3&&"function"==typeof e?(r=t||w,t=e):(s(o,e),r=r||w),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var a=1;function l(){t((function(e){e&&a++<o.times&&("function"!=typeof o.errorFilter||o.errorFilter(e))?setTimeout(l,o.intervalFunc(a)):r.apply(null,arguments)}))}l()}var dr=function(e,t){return t||(t=e,e=null),i((function(r,n){function i(e){t.apply(null,r.concat(e))}e?fr(e,i,n):fr(i,n)}))};function hr(e,t){Yt(it,e,t)}var pr=ne(pt(Boolean,ht.a)),mr=ae(pt(Boolean,ht.a)),vr=Z(mr,1);function gr(e,t,r){function n(e,t){var r=e.criteria,n=t.criteria;return r<n?-1:r>n?1:0}oe(e,(function(e,r){t(e,(function(t,n){if(t)return r(t);r(null,{value:e,criteria:n})}))}),(function(e,t){if(e)return r(e);r(null,we(t.sort(n),Ft("value")))}))}function yr(e,t,r){var n,o,s=!1;function a(){s||(n.apply(null,arguments),clearTimeout(o))}function l(){var t=e.name||"anonymous",i=new Error('Callback function "'+t+'" timed out.');i.code="ETIMEDOUT",r&&(i.info=r),s=!0,n(i)}return i((function(r,i){n=i,o=setTimeout(l,t),e.apply(null,r.concat(a))}))}var br=Math.ceil,Sr=Math.max;var wr=function(e,t,r,n){for(var i=-1,o=Sr(br((t-e)/(r||1)),0),s=Array(o);o--;)s[n?o:++i]=e,e+=r;return s};function _r(e,t,r,n){le(wr(0,e,1),t,r,n)}var Er=Z(_r,1/0),Cr=Z(_r,1);function Pr(e,t,r,n){3===arguments.length&&(n=r,r=t,t=j(e)?[]:{}),n=_(n||w),re(e,(function(e,n,i){r(t,e,n,i)}),(function(e){n(e,t)}))}function Or(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function Rr(e,t,r){if(r=K(r||w),!e())return r(null);var i=Object(n.a)((function(n,o){return n?r(n):e()?t(i):void r.apply(null,[null].concat(o))}));t(i)}function Ar(e,t,r){Rr((function(){return!e.apply(this,arguments)}),t,r)}var Tr=function(e,t){if(t=_(t||w),!j(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;!function i(o){if(r===e.length)return t.apply(null,[null].concat(o));var s=K(Object(n.a)((function(e,r){if(e)return t.apply(null,[e].concat(r));i(r)})));o.push(s),e[r++].apply(null,o)}([])};t.default={applyEach:se,applyEachSeries:ce,apply:fe,asyncify:de,auto:Se,autoInject:Xe,cargo:nt,compose:at,concat:ut,concatSeries:ft,constant:dt,detect:vt,detectLimit:gt,detectSeries:yt,dir:St,doDuring:wt,doUntil:Et,doWhilst:_t,during:Ct,each:Ot,eachLimit:Rt,eachOf:re,eachOfLimit:X,eachOfSeries:it,eachSeries:At,ensureAsync:Tt,every:jt,everyLimit:Lt,everySeries:Dt,filter:Mt,filterLimit:$t,filterSeries:Vt,forever:Wt,log:Ut,map:oe,mapLimit:le,mapSeries:ue,mapValues:zt,mapValuesLimit:Bt,mapValuesSeries:qt,memoize:Qt,nextTick:Gt.a,parallel:Kt,parallelLimit:Jt,priorityQueue:er,queue:Zt,race:tr,reduce:ot,reduceRight:nr,reflect:ir,reflectAll:ar,reject:sr,rejectLimit:lr,rejectSeries:ur,retry:fr,retryable:dr,seq:st,series:hr,setImmediate:Xt,some:pr,someLimit:mr,someSeries:vr,sortBy:gr,timeout:yr,times:Er,timesLimit:_r,timesSeries:Cr,transform:Pr,unmemoize:Or,until:Ar,waterfall:Tr,whilst:Rr,all:jt,any:pr,forEach:Ot,forEachSeries:At,forEachLimit:Rt,forEachOf:re,forEachOfSeries:it,forEachOfLimit:X,inject:ot,foldl:ot,foldr:nr,select:Mt,selectLimit:$t,selectSeries:Vt,wrapSync:de}},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l,u=[],c=!1,f=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&h())}function h(){if(!c){var e=a(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++f<t;)l&&l[f].run();f=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||c||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=r(16),i="object"==typeof self&&self&&self.Object===Object&&self,o=n.a||i||Function("return this")();t.a=o},function(e,t,r){"use strict";(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.a=r}).call(this,r(3))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkDeprecatedConfigs=t.isEqualIgnoringArrayOrder=t.sleep=t.checkIfBoundsAreEqual=t.removeKeys=t.toRecord=t.isStackedWindow=t.wrapWithTimeout=t.timeoutPromise=t.getRandomWindowName=t.getUniqueName=t.getProp=t.composeRL=t.instrumentPromise=t.promisify=t.identity=t.isNumber=t.chunkArray=t.Timeout=t.mockLogger=t.capitalizeFirst=t.clone=t.isServiceInWindow=t.iAmAServiceWindow=t.guuid=void 0;const i=r(24),o=n(r(27)),s=n(r(53)),a=n(r(33)),l=n(r(54)),u=r(9),c=n(r(1)),f=window;function d(e,t){if(Array.isArray(e))return e.slice();try{return JSON.parse(JSON.stringify(e))}catch(e){return t("clone error",e),e}}t.guuid=function(){return i.v1()},t.iAmAServiceWindow=function(){return!(!f.finsembleServices||!f.finsembleServices.length)},t.isServiceInWindow=function(e){return f.finsembleServices&&f.finsembleServices.find(t=>t.name===e)},t.clone=d,t.capitalizeFirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};t.mockLogger=new class{constructor({debug:e}={debug:!0}){e?(this.system=console,this.system.debug=console.log):this.system={warn:Function.prototype,debug:Function.prototype,log:Function.prototype,info:Function.prototype,error:console.error}}isLogMessage(){return!0}start(){}};function h(e="RouterClient"){return`${e}-${Math.floor(100*Math.random())}-${Math.floor(1e4*Math.random())}`}function p(e,t){return new Promise((r,n)=>{const i=setTimeout(()=>{clearTimeout(i),n(t)},e)})}function m(e,t,r){return`${e}.${t}.${r}`}function v(e,t,r){const n=""+m(e.baseString,e.newPath,e.newValue);c.default.system.warn(`${m(e.baseString,t,r)} has been deprecated in favor of ${n}`)}t.Timeout=class{constructor(e,t){this.fired=!1,this.id=setTimeout(()=>{e(),this.fired=!0},t),this.clear=this.clear.bind(this),this.didFire=this.didFire.bind(this)}clear(){this.fired||clearTimeout(this.id)}didFire(){return this.fired}},t.chunkArray=function(e,t){if(e<=0)throw new Error("Can't chunk array by number less than 0");return t.reduce((r,n,i)=>{if(i%e==0){const n=[];for(let r=i;r<i+e;r++)r<t.length&&n.push(t[r]);r.push(n)}return r},[])},t.isNumber=function(e){return!(!e||Number.isNaN(Number(e)))&&Number(e)},t.identity=function(e){return e},t.promisify=function(e,t){return function(){const r=Array.prototype.slice.call(arguments);return new Promise((n,i)=>{r.push((e,t)=>e?i(e):n(t)),e.apply(t,r)})}},t.instrumentPromise=async(e,t,r)=>{const n=t+" end";return e(t+" start"),r.then(()=>e(n))},t.composeRL=(...e)=>e.reduce((e,t)=>(...r)=>e(t(...r))),t.getProp=function e(t,r,n){const i=Array.isArray(r)?r:r.split(".").filter(e=>e.length);return i.length?e(t[i.shift()],i,n):void 0===t?n:t},t.getUniqueName=h,t.getRandomWindowName=function(e,t){return`${h(e)}-${t}`},t.timeoutPromise=p,t.wrapWithTimeout=function(e,t,r){return Promise.race([e,p(t,r)])},t.isStackedWindow=function(e){return e&&"StackedWindow"===(o.default(e,"windowIdentifier.windowType")||e.windowType)},t.toRecord=function(e,t){const r="string"==typeof e?t=>t[e]:e;return t.reduce((e,t)=>(e[r(t)]=t,e),{})},t.removeKeys=function(e,t){if(!e)return e;const r=Object.keys(e).filter(e=>!t.includes(e));return s.default(e,r)},t.checkIfBoundsAreEqual=function(e,t){if(!e||!t)return!1;const r=["left","right","top","bottom","width","height"],n=s.default(e,r),i=s.default(t,r);return!!a.default(n,i)},t.sleep=function(e,t=!1){return new Promise((r,n)=>{t?setTimeout(()=>{try{n("timeout expired")}catch(e){}},e):setTimeout(r,e)})},t.isEqualIgnoringArrayOrder=function(e,t){const r=d(e,Function.prototype),n=d(t,Function.prototype);return l.default(r,n,(e,t)=>{if(Array.isArray(e)&&Array.isArray(t))return l.default(e.sort(),t.sort())})},t.checkDeprecatedConfigs=function(e,t,r){const{baseString:n,oldPath:i,newPath:o,oldValue:s,newValue:a}=t;let l=u.ConfigUtilInstance.getDefault(e,m(n,o,a),null);return null===l&&(l=u.ConfigUtilInstance.getDefault(e,m(n,o,s),null),l?v(t,o,s):(l=u.ConfigUtilInstance.getDefault(e,m(n,i,a),null),l?v(t,i,a):(l=u.ConfigUtilInstance.getDefault(e,m(n,i,s),null),l?v(t,i,s):l=r))),l}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._BaseClient=void 0;
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const i=n(r(6)),o=n(r(10)),s=n(r(1)),a=r(5),l=n(r(37)),u=r(28);class c extends l.default{constructor(e){super({name:e.name,sourceType:e.name.replace("Client","")}),this.status="offline",this.startupTime=0,this.initialized=!1,this.startupDependencies={services:[],clients:[]},this.finsembleWindow=null,this.windowName="",this.clientReadyQueue=[],this.processClientReadyQueue=()=>{for(const e of this.clientReadyQueue)e();this.clientReadyQueue=[]},this.onReady=e=>{this.clientReadyQueue.push(e),"online"===this.status&&this.processClientReadyQueue()},this.setClientOnline=()=>{this.status="online";const e=`STARTUP:CLIENT ONLINE:${this.finWindow.name}:${this.name}`;this.startupTime=window.performance.now()-this.startupTime;const t=()=>{this.logger.system.debug(e),this.processClientReadyQueue(),u.FSBLDependencyManagerSingleton.setClientOnline(this.name)};this._onReady?this._onReady(t):t()},this.initialize=(e=Function.prototype)=>{this.initialized||(this.initialized=!0,this.startupTime=performance.now(),this.routerClient.onReady(()=>{this.finWindow=a.System.Window.getCurrent(),this.windowName=this.finWindow.name,this.logger.system.debug("Baseclient Init Router Ready",this.name),u.FSBLDependencyManagerSingleton.startup.waitFor(this.startupDependencies,()=>{e(),this.setClientOnline()})}))},this.onClose=e=>{this.cleanup(),e&&e()},this.name=e.name,this._onReady=e.onReady,this.startupDependencies=e.startupDependencies||{services:[],clients:[]},this.logger=s.default,this.routerClient=i.default}addEventListener(e,t){super.addEventListener(e,t)}}t._BaseClient=c;t.default=function(e){o.default.args(e,"object=");const t=this;let r,n="offline";this.startupTime=0,e&&(e.onReady&&({onReady:r}=e),this.name=e.name),this.initialized=!1,this.startupDependencies=e.startupDependencies||{services:[],clients:[]},this.routerClient=i.default,this.finWindow=null,this.finsembleWindow=null,this.windowName="",this.requiredServices=[],this.requiredClients=[],this.clientReadyQueue=[],this.processClientReadyQueue=function(){for(let e=0;e<this.clientReadyQueue.length;e++){const t=this.clientReadyQueue[e];"function"==typeof t&&t()}this.clientReadyQueue=[]},this.onReady=function(e){this.clientReadyQueue.push(e),"online"===n&&this.processClientReadyQueue()},this.setClientOnline=function(){n="online";const e=`STARTUP:CLIENT ONLINE:${t.finWindow.name}:${t.name}`;t.startupTime=performance.now()-t.startupTime,r?r(()=>{s.default.system.debug(e),t.processClientReadyQueue(),u.FSBLDependencyManagerSingleton.setClientOnline(t.name)}):(s.default.system.debug(e),t.processClientReadyQueue(),u.FSBLDependencyManagerSingleton.setClientOnline(t.name))},this.initialize=function(e=Function.prototype){t.initialized||(t.initialized=!0,t.setClientOnline=t.setClientOnline.bind(t),t.startupTime=performance.now(),t.routerClient.onReady(()=>{t.finWindow=a.System.Window.getCurrent(),t.windowName=t.finWindow.name,s.default.system.debug("Baseclient Init Router Ready",t.name),u.FSBLDependencyManagerSingleton.startup.waitFor({clients:t.startupDependencies.clients||[]},()=>{e(),t.setClientOnline()})}))},this.onClose=function(){}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";(function(e,n){var i,o=r(2);i=o.c?e.nextTick:o.d?n:o.b,t.a=Object(o.e)(i)}).call(this,r(14),r(26).setImmediate)},function(e,t,r){"use strict";(function(e){var n=r(16),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&n.a.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();t.a=a}).call(this,r(25)(e))},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(13),o=n(r(10)),s=r(18),a=n(r(12)),l=n(r(1));class u extends s._BaseClient{constructor(e){super(e),this.listeners=[],this.changeSub=e=>{this.subs||(this.subs={}),this.subs[e]||(this.routerClient.query("configService.addListener",e,t=>{t&&l.default.system.error("Error adding listener to config service",t),this.routerClient.subscribe(e,this.handleChanges)}),this.subs[e]=!0)},this.handleChanges=(e,t)=>{e&&l.default.system.error(e),t.data.field||(t.data.field=null);const r=t.data.storeData?t.data.storeData:t.data.value;this.triggerListeners(t.data.field?t.data.field:"configService",r)},this.triggerListeners=(e,t)=>{if(this.listeners[e])for(let r=0;r<this.listeners[e].length;r++)"function"==typeof this.listeners[e][r]?this.listeners[e][r](null,{field:e,value:t}):l.default.system.warn("ConfigClient:triggerListeners: listener is not a function",e)},this.set=(e,t)=>{l.default.system.debug("ConfigClient.Set",e),"function"==typeof e?(t=e,o.default.args(t,"function"),e={}):o.default.args(e,"object",t,"function"),this.routerClient.query("config.set",e,(e,r)=>{t(e,r?r.data:null)})},this.processAndSet=this.processAndSet.bind(this),this.getValue=this.getValue.bind(this),this.getValues=this.getValues.bind(this),this.setValue=this.setValue.bind(this),this.setValues=this.setValues.bind(this),this.removeValue=this.removeValue.bind(this),this.removeValues=this.removeValues.bind(this),this.addListener=this.addListener.bind(this),this.addListeners=this.addListeners.bind(this),this.removeListener=this.removeListener.bind(this),this.removeListeners=this.removeListeners.bind(this),this.setPreference=this.setPreference.bind(this),this.getPreferences=this.getPreferences.bind(this)}getValue(e,t=Function.prototype){"string"==typeof e&&(e={field:e});return new Promise((r,n)=>{if(!e.field){const e="no field provided";return n(e),t(e)}this.routerClient.query("configService.getValue",{field:e.field},(e,i)=>e?(n(e),t(e)):(r({err:e,data:i.data}),t(e,i.data)))})}getValues(e,t=Function.prototype){if("function"==typeof e&&(t=e,e=null),e&&!Array.isArray(e))return this.getValue(e,t);return new Promise(r=>{this.routerClient.query("configService.getValues",{fields:e},(e,n)=>e?t(e):(r({err:e,data:n.data}),t(e,n.data)))})}setValue(e,t){const r={field:e.field,value:e.value};return this.routerClient.query("configService.setValue",r,e=>t?t(e):null)}setValues(e,t){return e?Array.isArray(e)?this.routerClient.query("configService.setValues",e,e=>t?t(e):null):l.default.system.error("ConfigClient.SetValues. Params must be an array"):l.default.system.error("ConfigClient.SetValues. No params given")}removeValue(e,t=Function.prototype){if(void 0!==e){if(e.field||"string"!=typeof e)return t("no field provided");e={field:e}}return e.value=null,this.setValue(e,t)}removeValues(e,t=Function.prototype){if(!Array.isArray(e))return t("The passed in parameter needs to be an array");i.map(e,this.removeValue,(e,r)=>t(e,r))}addListener(e,t,r){let n=null;"function"==typeof e&&(t=e,e={field:n}),({field:n}=e);const i="configService"+(n?"."+n:"");return this.listeners[i]?this.listeners[i].push(t):this.listeners[i]=[t],this.changeSub(i),r?r():null}addListeners(e,t,r){if(!Array.isArray(e))return this.addListener({field:e.field},t,r);for(let r=0;r<e.length;r++){let i=null;const o=e[r];var n;"string"==typeof o?i=o:o.field&&(({field:i}=o),n=o.listener);const s="configService"+(i?"."+i:"");n||t&&"function"==typeof t&&(n=t),this.listeners[s]?this.listeners[s].push(n):this.listeners[s]=[n],this.changeSub(s)}return r?r():null}removeListener(e,t,r){let n=null;"function"==typeof e&&(r=t,t=e,e={field:n}),({field:n}=e);const i=this.name+(n?"."+n:"");if(this.listeners[i])for(let e=0;e<this.listeners[i].length;e++)if(this.listeners[i][e]===t)return this.listeners[i].pop(e),r?r(null,!0):null;return r?r(null,!1):null}removeListeners(e,t,r){if(!Array.isArray(e))return"function"==typeof e?this.removeListener({},e,r):e.field&&this.removeListener(e,t,r),r("missing fields");let n=0;for(let r=0;r<e.length;r++){let o=null;const s=e[r];var i;"string"==typeof s?o=s:s.field&&(({field:o}=s),i=e[r].listener);const a="configService"+(o?"."+o:"");if(!i){if(!t||"function"!=typeof t)continue;i=t}for(let e=0;e<this.listeners[a].length;e++)this.listeners[a][e]===i&&(this.listeners[a].pop(r),n++)}return n<e.length?r("All listeners could not be found",!1):r?r(null,!0):null}get(e,t){l.default.system.debug("ConfigClient.Get",e),l.default.system.warn("This functionality has been deprecated. It will be removed in Finsemble version 3.0. Use getValue instead.",e),1===arguments.length?(t=e,o.default.args(t,"function"),e={}):o.default.args(e,"object",t,"function"),this.routerClient.query("config.get",e,(e,r)=>{t(e,r?r.data:null)})}processAndSet(e,t){if(l.default.system.debug("ConfigClient.processAndSet",e),o.default.args(e,"object",t,"function=")&&o.default.args2("params.newConfig",e.newConfig,"object","params.overwrite",e.overwrite,"boolean=","params.replace",e.replace,"boolean="),!e.overwrite&&e.replace){const e="cannot use replace option unless overwrite is also true";l.default.system.warn("ConfigClient.processAndSet:",e),t&&t(e,null)}else this.routerClient.query("config.processAndSet",e,(e,r)=>{t&&t(e,r?r.data:null)})}setPreference(e,t){this.routerClient.query("PreferencesService.setPreference",e,(e,r)=>{t&&t(e,r?r.data:null)})}async getPreferences(e,t){l.default.system.debug("ConfigClient.getPreferences",e),"function"==typeof e&&(t=e,e=null),await a.default.waitForStartup("preferencesService"),this.routerClient.query("PreferencesService.getPreferences",e,(e,r)=>{l.default.system.debug("ConfigClient.getPreferences response",r),t&&t(e,r?r.data:null)})}}const c=new u({startupDependencies:{services:["configService"]},onReady(e){e&&e()},name:"configClient"});t.default=c},function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(){void 0!==o&&e.removeListener("error",o),r([].slice.call(arguments))}var o;"error"!==t&&(o=function(r){e.removeListener(t,i),n(r)},e.once("error",o)),e.once(t,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,r,n){var i,o,s,a;if(u(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,a=l,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=d.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):v(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var u=l.length,c=v(l,u);for(r=0;r<u;++r)o(c[r],this,t)}return!0},a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,o,s;if(u(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,r){var n=r(29),i=r(40),o=i;o.v1=n,o.v4=i,e.exports=o},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(46),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(3))},function(e,t,r){(function(t){var r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/,i=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=/^\[object .+?Constructor\]$/,l="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,c=l||u||Function("return this")();var f,d=Array.prototype,h=Function.prototype,p=Object.prototype,m=c["__core-js_shared__"],v=(f=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+f:"",g=h.toString,y=p.hasOwnProperty,b=p.toString,S=RegExp("^"+g.call(y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),w=c.Symbol,_=d.splice,E=F(c,"Map"),C=F(Object,"create"),P=w?w.prototype:void 0,O=P?P.toString:void 0;function R(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function A(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function T(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function I(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function j(e,t){for(var i,o=0,s=(t=function(e,t){if(M(e))return!1;var i=typeof e;if("number"==i||"symbol"==i||"boolean"==i||null==e||V(e))return!0;return n.test(e)||!r.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:M(i=t)?i:k(i)).length;null!=e&&o<s;)e=e[N(t[o++])];return o&&o==s?e:void 0}function L(e){return!(!$(e)||(t=e,v&&v in t))&&(function(e){var t=$(e)?b.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?S:a).test(function(e){if(null!=e){try{return g.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function D(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function F(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return L(r)?r:void 0}R.prototype.clear=function(){this.__data__=C?C(null):{}},R.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},R.prototype.get=function(e){var t=this.__data__;if(C){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return y.call(t,e)?t[e]:void 0},R.prototype.has=function(e){var t=this.__data__;return C?void 0!==t[e]:y.call(t,e)},R.prototype.set=function(e,t){return this.__data__[e]=C&&void 0===t?"__lodash_hash_undefined__":t,this},A.prototype.clear=function(){this.__data__=[]},A.prototype.delete=function(e){var t=this.__data__,r=I(t,e);return!(r<0)&&(r==t.length-1?t.pop():_.call(t,r,1),!0)},A.prototype.get=function(e){var t=this.__data__,r=I(t,e);return r<0?void 0:t[r][1]},A.prototype.has=function(e){return I(this.__data__,e)>-1},A.prototype.set=function(e,t){var r=this.__data__,n=I(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},T.prototype.clear=function(){this.__data__={hash:new R,map:new(E||A),string:new R}},T.prototype.delete=function(e){return D(this,e).delete(e)},T.prototype.get=function(e){return D(this,e).get(e)},T.prototype.has=function(e){return D(this,e).has(e)},T.prototype.set=function(e,t){return D(this,e).set(e,t),this};var k=x((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(V(e))return O?O.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var r=[];return i.test(e)&&r.push(""),e.replace(o,(function(e,t,n,i){r.push(n?i.replace(s,"$1"):t||e)})),r}));function N(e){if("string"==typeof e||V(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function x(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s),s};return r.cache=new(x.Cache||T),r}x.Cache=T;var M=Array.isArray;function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function V(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==b.call(e)}e.exports=function(e,t,r){var n=null==e?void 0:j(e,t);return void 0===n?r:n}}).call(this,r(3))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FSBLDependencyManagerSingleton=t.FSBLDependencyManager=void 0;const i=r(23),o=n(r(6)),s=r(8),a=n(r(12)),l=n(r(1));class u extends i.EventEmitter{constructor(e){super(),this.callback=e.callback,this.dependencies=e.dependencies,this.startupTimer=null,this.setStartupTimer=this.setStartupTimer.bind(this),this.clearStartupTimer=this.clearStartupTimer.bind(this),this.setStartupTimer()}clearStartupTimer(){clearTimeout(this.startupTimer),delete this.startupTimer}setStartupTimer(){const e=this;this.startupTimer=+setTimeout(()=>{e.emit("timeout")},1e4)}}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}class f{constructor(){this.servicesAreAllOnline={},this.clientsAreAllOnline={},this.onlineClients=[],this.dependencies={},this.startupTimers={},this.startupTimerFired=!1,this.bindCorrectContext()}waitFor(e,t){const r=c();e.clients||(e.clients=[]),e.clients.length&&(e.clients=e.clients.map(e=>e.charAt(0).toLowerCase()+e.slice(1)));const n=new u({dependencies:e,callback:t});return n.on("timeout",()=>{this.onDependencyTimeout(n)}),this.dependencies[r]=n,this.checkDependencies(),n}onDependencyTimeout(e){const t=this.getOfflineClients();let r="APPLICATION LIFECYCLE:STARTUP:Dependency not online after 10 seconds.";t.length&&(r=`${r} Waiting for these clients: ${t.join(", ")}.`),e.emit("err",r)}checkDependencies(){for(const e in this.dependencies){const t=this.dependencies[e],{dependencies:r,callback:n}=t;(!r.clients.length||this.clientsAreAllOnline[e]||(this.clientsAreAllOnline[e]=this.checkClients(r.clients),this.clientsAreAllOnline[e]))&&(delete this.dependencies[e],t.clearStartupTimer(),n&&n())}}getOfflineClients(){let e=[];for(const t in this.dependencies){const{dependencies:r}=this.dependencies[t];e=e.concat(r.clients.filter(e=>!this.onlineClients.includes(e)))}return e.filter((t,r)=>e.indexOf(t)===r)}checkClients(e){return e.every(e=>this.onlineClients.includes(e))}setClientOnline(e){this.onlineClients.includes(e)||(this.onlineClients.push(e),this.checkDependencies())}getOnlineClients(){return this.onlineClients}bindCorrectContext(){this.checkDependencies=this.checkDependencies.bind(this),this.checkClients=this.checkClients.bind(this),this.getOfflineClients=this.getOfflineClients.bind(this),this.onDependencyTimeout=this.onDependencyTimeout.bind(this),this.waitFor=this.waitFor.bind(this)}}class d{constructor(){this.offlineServices=[],this.dependencies={},this.checkDependencies=this.checkDependencies.bind(this)}waitFor(e,t){l.default.system.debug("DependencyManager:waitFor",e),e.services||(e.services=[]);const r=c();this.dependencies[r]={dependencies:e,callback:t}}checkDependencies(){if(console.debug("checkDependencies",this.dependencies),Object.keys(this.dependencies))for(const e in this.dependencies){const{dependencies:t,callback:r}=this.dependencies[e];if(l.default.system.debug("DependencyManager:checkDependency",t.services,this.offlineServices),t.services.length){if(!this.checkServices(t.services))continue}console.debug("checkDependencies callback"),delete this.dependencies[e],r&&r()}}checkServices(e){return e.every(e=>this.offlineServices.includes(e))}setServiceOffline(e){l.default.system.debug("setServiceOffline",e),console.debug("setServiceOffline",e),this.offlineServices.push(e),this.checkDependencies()}}class h extends i.EventEmitter{constructor(){super(),this.startup=new f,this.shutdown=new d,this.RouterClient=o.default,this.AuthorizationCompleted=!1,this.bindCorrectContext(),this.onAuthorizationCompleted(this.startup.checkDependencies),o.default.onReady(this.listenForServices)}bindCorrectContext(){this.listenForServices=this.listenForServices.bind(this),this.onAuthorizationCompleted=this.onAuthorizationCompleted.bind(this)}setClientOnline(e){this.startup.setClientOnline(e)}onServiceStateChange(e){Object.keys(e).forEach(t=>{const{state:r}=e[t];"closed"===r&&this.shutdown.setServiceOffline(t)})}listenForServices(){l.default.system.debug("DependencyManager:listenForServices before wait"),a.default.waitForBootStage("kernel","stageEntered",()=>{l.default.system.debug("DependencyManager:listenForServices after wait"),this.RouterClient.subscribe(s.SERVICES_STATE_CHANNEL,(e,t)=>{l.default.system.debug("DependencyManager:listenForServices SERVICES_STATE_CHANNEL",t.data),this.onServiceStateChange(t.data)}),this.RouterClient.addListener(s.SERVICE_CLOSED_CHANNEL,(e,t)=>{l.default.system.debug("DependencyManager:listenForServices SERVICE_CLOSED_CHANNEL",t.data);const r={};r[t.data.name]={state:"closed"},this.onServiceStateChange(r)}),this.RouterClient.subscribe(s.APPLICATION_STATE_CHANNEL,(e,t)=>{switch(t.data.state){case"authenticated":case"ready":break;case"closing":this.shutdown.checkDependencies()}})})}onAuthorizationCompleted(e){this.AuthorizationCompleted?e():this.addListener("AuthorizationCompleted",e)}}t.FSBLDependencyManager=h,t.FSBLDependencyManagerSingleton=new h,t.default=t.FSBLDependencyManagerSingleton},function(e,t,r){var n=r(30),i=r(31),o=n(),s=[1|o[0],o[1],o[2],o[3],o[4],o[5]],a=16383&(o[6]<<8|o[7]),l=0,u=0;e.exports=function(e,t,r){var n=t&&r||0,o=t||[],c=void 0!==(e=e||{}).clockseq?e.clockseq:a,f=void 0!==e.msecs?e.msecs:(new Date).getTime(),d=void 0!==e.nsecs?e.nsecs:u+1,h=f-l+(d-u)/1e4;if(h<0&&void 0===e.clockseq&&(c=c+1&16383),(h<0||f>l)&&void 0===e.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,u=d,a=c;var p=(1e4*(268435455&(f+=122192928e5))+d)%4294967296;o[n++]=p>>>24&255,o[n++]=p>>>16&255,o[n++]=p>>>8&255,o[n++]=255&p;var m=f/4294967296*1e4&268435455;o[n++]=m>>>8&255,o[n++]=255&m,o[n++]=m>>>24&15|16,o[n++]=m>>>16&255,o[n++]=c>>>8|128,o[n++]=255&c;for(var v=e.node||s,g=0;g<6;++g)o[n+g]=v[g];return t||i(o)}},function(e,t,r){(function(t){var r,n=t.crypto||t.msCrypto;if(n&&n.getRandomValues){var i=new Uint8Array(16);r=function(){return n.getRandomValues(i),i}}if(!r){var o=new Array(16);r=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=r}).call(this,r(3))},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,i=r;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LocalLogger=void 0;const{debug:n,warn:i,log:o,error:s}=console,a=()=>{},l=a,u={warn:i,info:a,log:o,debug:n,error:s,verbose:l},c={Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0,Verbose:!0,LocalOnly:!1},f={console:{Error:!0,Warn:!0,Info:!0,Log:!0,Debug:!0},dev:c,system:c,perf:c};function d(e){return"logger.service.logMessages"===e}t.LocalLogger=class{constructor(){this.start=()=>{},this.isLogMessage=d,this.setting=()=>f,this.callStack=()=>function(){const{stack:e}=function(){try{throw Error("")}catch(e){return e}}(),t=(r="\n",n=4,e.split(r,n).join(r).length);var r,n;return"Log Stack: \n"+e.substring(t).substr(1)}(),this.unregisterClient=()=>{},this.setRouterClient=()=>{},this.warn=i,this.info=a,this.log=o,this.debug=n,this.error=s,this.verbose=l,this.system=u,this.perf=u}}},function(e,t,r){(function(e,r){var n="[object Arguments]",i="[object Map]",o="[object Object]",s="[object Set]",a=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[n]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u[i]=u["[object Number]"]=u[o]=u["[object RegExp]"]=u[s]=u["[object String]"]=u["[object WeakMap]"]=!1;var c="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,d=c||f||Function("return this")(),h=t&&!t.nodeType&&t,p=h&&"object"==typeof r&&r&&!r.nodeType&&r,m=p&&p.exports===h,v=m&&c.process,g=function(){try{return v&&v.binding&&v.binding("util")}catch(e){}}(),y=g&&g.isTypedArray;function b(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function S(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function w(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var _,E,C,P=Array.prototype,O=Function.prototype,R=Object.prototype,A=d["__core-js_shared__"],T=O.toString,I=R.hasOwnProperty,j=(_=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",L=R.toString,D=RegExp("^"+T.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=m?d.Buffer:void 0,k=d.Symbol,N=d.Uint8Array,x=R.propertyIsEnumerable,M=P.splice,$=k?k.toStringTag:void 0,V=Object.getOwnPropertySymbols,W=F?F.isBuffer:void 0,U=(E=Object.keys,C=Object,function(e){return E(C(e))}),B=ge(d,"DataView"),z=ge(d,"Map"),q=ge(d,"Promise"),H=ge(d,"Set"),Q=ge(d,"WeakMap"),G=ge(Object,"create"),Y=we(B),K=we(z),J=we(q),X=we(H),Z=we(Q),ee=k?k.prototype:void 0,te=ee?ee.valueOf:void 0;function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ie;++t<r;)this.add(e[t])}function se(e){var t=this.__data__=new ne(e);this.size=t.size}function ae(e,t){var r=Ce(e),n=!r&&Ee(e),i=!r&&!n&&Pe(e),o=!r&&!n&&!i&&Ie(e),s=r||n||i||o,a=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=a.length;for(var u in e)!t&&!I.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Se(u,l))||a.push(u);return a}function le(e,t){for(var r=e.length;r--;)if(_e(e[r][0],t))return r;return-1}function ue(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":$&&$ in Object(e)?function(e){var t=I.call(e,$),r=e[$];try{e[$]=void 0;var n=!0}catch(e){}var i=L.call(e);n&&(t?e[$]=r:delete e[$]);return i}(e):function(e){return L.call(e)}(e)}function ce(e){return Te(e)&&ue(e)==n}function fe(e,t,r,a,l){return e===t||(null==e||null==t||!Te(e)&&!Te(t)?e!=e&&t!=t:function(e,t,r,a,l,u){var c=Ce(e),f=Ce(t),d=c?"[object Array]":be(e),h=f?"[object Array]":be(t),p=(d=d==n?o:d)==o,m=(h=h==n?o:h)==o,v=d==h;if(v&&Pe(e)){if(!Pe(t))return!1;c=!0,p=!1}if(v&&!p)return u||(u=new se),c||Ie(e)?pe(e,t,r,a,l,u):function(e,t,r,n,o,a,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new N(e),new N(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _e(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case i:var u=S;case s:var c=1&n;if(u||(u=w),e.size!=t.size&&!c)return!1;var f=l.get(e);if(f)return f==t;n|=2,l.set(e,t);var d=pe(u(e),u(t),n,o,a,l);return l.delete(e),d;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,d,r,a,l,u);if(!(1&r)){var g=p&&I.call(e,"__wrapped__"),y=m&&I.call(t,"__wrapped__");if(g||y){var b=g?e.value():e,_=y?t.value():t;return u||(u=new se),l(b,_,r,a,u)}}if(!v)return!1;return u||(u=new se),function(e,t,r,n,i,o){var s=1&r,a=me(e),l=a.length,u=me(t).length;if(l!=u&&!s)return!1;var c=l;for(;c--;){var f=a[c];if(!(s?f in t:I.call(t,f)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);var p=s;for(;++c<l;){f=a[c];var m=e[f],v=t[f];if(n)var g=s?n(v,m,f,t,e,o):n(m,v,f,e,t,o);if(!(void 0===g?m===v||i(m,v,r,n,o):g)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,r,a,l,u)}(e,t,r,a,fe,l))}function de(e){return!(!Ae(e)||function(e){return!!j&&j in e}(e))&&(Oe(e)?D:a).test(we(e))}function he(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||R,t!==n)return U(e);var t,r,n,i=[];for(var o in Object(e))I.call(e,o)&&"constructor"!=o&&i.push(o);return i}function pe(e,t,r,n,i,o){var s=1&r,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var c=-1,f=!0,d=2&r?new oe:void 0;for(o.set(e,t),o.set(t,e);++c<a;){var h=e[c],p=t[c];if(n)var m=s?n(p,h,c,t,e,o):n(h,p,c,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(d){if(!b(t,(function(e,t){if(s=t,!d.has(s)&&(h===e||i(h,e,r,n,o)))return d.push(t);var s}))){f=!1;break}}else if(h!==p&&!i(h,p,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function me(e){return function(e,t,r){var n=t(e);return Ce(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,je,ye)}function ve(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ge(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return de(r)?r:void 0}re.prototype.clear=function(){this.__data__=G?G(null):{},this.size=0},re.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},re.prototype.get=function(e){var t=this.__data__;if(G){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return I.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return G?void 0!==t[e]:I.call(t,e)},re.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=G&&void 0===t?"__lodash_hash_undefined__":t,this},ne.prototype.clear=function(){this.__data__=[],this.size=0},ne.prototype.delete=function(e){var t=this.__data__,r=le(t,e);return!(r<0)&&(r==t.length-1?t.pop():M.call(t,r,1),--this.size,!0)},ne.prototype.get=function(e){var t=this.__data__,r=le(t,e);return r<0?void 0:t[r][1]},ne.prototype.has=function(e){return le(this.__data__,e)>-1},ne.prototype.set=function(e,t){var r=this.__data__,n=le(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},ie.prototype.clear=function(){this.size=0,this.__data__={hash:new re,map:new(z||ne),string:new re}},ie.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},ie.prototype.get=function(e){return ve(this,e).get(e)},ie.prototype.has=function(e){return ve(this,e).has(e)},ie.prototype.set=function(e,t){var r=ve(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},oe.prototype.add=oe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},oe.prototype.has=function(e){return this.__data__.has(e)},se.prototype.clear=function(){this.__data__=new ne,this.size=0},se.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ne){var n=r.__data__;if(!z||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ie(n)}return r.set(e,t),this.size=r.size,this};var ye=V?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}(V(e),(function(t){return x.call(e,t)})))}:function(){return[]},be=ue;function Se(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function we(e){if(null!=e){try{return T.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function _e(e,t){return e===t||e!=e&&t!=t}(B&&"[object DataView]"!=be(new B(new ArrayBuffer(1)))||z&&be(new z)!=i||q&&"[object Promise]"!=be(q.resolve())||H&&be(new H)!=s||Q&&"[object WeakMap]"!=be(new Q))&&(be=function(e){var t=ue(e),r=t==o?e.constructor:void 0,n=r?we(r):"";if(n)switch(n){case Y:return"[object DataView]";case K:return i;case J:return"[object Promise]";case X:return s;case Z:return"[object WeakMap]"}return t});var Ee=ce(function(){return arguments}())?ce:function(e){return Te(e)&&I.call(e,"callee")&&!x.call(e,"callee")},Ce=Array.isArray;var Pe=W||function(){return!1};function Oe(e){if(!Ae(e))return!1;var t=ue(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Re(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ae(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Te(e){return null!=e&&"object"==typeof e}var Ie=y?function(e){return function(t){return e(t)}}(y):function(e){return Te(e)&&Re(e.length)&&!!u[ue(e)]};function je(e){return null!=(t=e)&&Re(t.length)&&!Oe(t)?ae(e):he(e);var t}r.exports=function(e,t){return fe(e,t)}}).call(this,r(3),r(19)(e))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHECKPOINT_CHANNEL_BASE=t.STAGE_CHANNEL=t.STATUS_CHANNEL_BASE=t.SHOW_SYSLOG_CHANNEL=t.SYSLOG_CHANNEL=t.CRITICAL_BOOT_STAGES=t.ALL_BOOT_STAGES=void 0,t.ALL_BOOT_STAGES=["microkernel","kernel","authentication","preuser","earlyuser","user"],t.CRITICAL_BOOT_STAGES=["microkernel","kernel","authentication"],t.SYSLOG_CHANNEL="systemManager.systemlog",t.SHOW_SYSLOG_CHANNEL="systemManager.showSystemlog",t.STATUS_CHANNEL_BASE="systemManager.boot.status",t.STAGE_CHANNEL="systemManager.boot.stage",t.CHECKPOINT_CHANNEL_BASE="systemManager.checkpoint"},function(e,t,r){"use strict";(function(e){var n=r(15),i=r(36),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?n.a.Buffer:void 0,l=(a?a.isBuffer:void 0)||i.a;t.a=l}).call(this,r(25)(e))},function(e,t,r){"use strict";t.a=function(){return!1}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(6)),o=n(r(1)),s=n(r(58));t.default=class{constructor(e){this.eventList=[],this.eventHandlerMap={},this.eventGuidMap={},this.name=e.name,this.sourceType=e.sourceType,window.addEventListener("beforeunload",()=>{this.cleanup()})}addListener(e,t){return this.addEventListener(e,t)}removeListener(e,t){return this.removeEventListener(e,t)}addEventListener(e,t){if(!t)return console.error("no handler",e);if(o.default.system.debug("addEventListener:",e),this.eventHandlerMap[e]||(this.eventHandlerMap[e]=[],this.eventGuidMap[e]=[]),!this.eventHandlerMap[e].includes(t)){const r=`${window.name}_public_${Date.now()}_${Math.random()}`;this.eventHandlerMap[e].push(t),this.eventGuidMap[e].push(r),i.default.transmit("Finsemble.RegisterInterruptibleEvent."+this.name,{event:e,listenerGuid:r}),i.default.addResponder("Finsemble.Interrupt."+r,(n,i)=>{new s.default({source:this.name,sourceType:this.sourceType,listenerGuid:r,handler:t,event:e},i)})}}removeEventListener(e,t){if(o.default.system.debug("removeEventListener:",e),!this.eventHandlerMap[e])return o.default.system.warn("not found");let r=this.eventHandlerMap[e].indexOf(t);if(-1!==r){const t=this.eventGuidMap[e][r];this.eventHandlerMap[e].splice(r,1),this.eventGuidMap[e].splice(r,1),i.default.transmit("Finsemble.UnregisterInterruptibleEvent."+window.name,{event:e,guid:t}),i.default.removeResponder("Finsemble.Interrupt."+t)}}cleanup(){for(var e of Object.keys(this.eventHandlerMap))for(var t of this.eventHandlerMap[e])this.removeEventListener(e,t)}}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageClient=void 0;const i=n(r(62)),o=n(r(10)),s=n(r(1)),a=r(18),l=r(17),u=i.default(1);class c extends a._BaseClient{constructor(){super(...arguments),this.clientReady=!1,this.delete=this.remove}setUser(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),o.default.args(e.user,"string",t,"function="),this.routerClient.query("Storage.setUser",{user:e.user},(r,n)=>{(r?s.default.system.error:s.default.system.info)("APPLICATION LIFECYCLE:StorageClient.setUser",e,r,n),t&&t(r,n.data)})}setStore(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),o.default.args(e.topic,"string",e.dataStore,"string=",t,"function="),s.default.system.log("APPLICATION LIFECYCLE:StorageClient.setStore",e,t),this.routerClient.query("Storage.setStore",e,(e,r)=>{(e?s.default.system.error:s.default.system.info)("Storage.setStore",e,r),t&&t(e,r.data)})}save(e,t){if(this.clientReady||s.default.system.error("storageClient invoked before ready"),"string"!=typeof e.key||"string"!=typeof e.topic)throw new Error("Values for key and topic must be strings.");return new Promise((r,n)=>{o.default.args(e.topic,"string",e.key,"string",e.value,"any",t,"function="),this.routerClient.query("Storage.save",e,(e,i)=>{(e?s.default.system.error:s.default.system.info)("Storage.save",e,i),t&&t(e,i.data),e?n({err:e,data:null}):r({err:e,data:i.data})})})}save1(e){return u(()=>this.save(e))}get(e,t){if(this.clientReady||s.default.system.error("storageClient invoked before ready"),"string"!=typeof e.key||"string"!=typeof e.topic)throw new Error("Values for key and topic must be strings.");return new Promise((r,n)=>{o.default.args(e.topic,"string",e.key,"string",t,"function="),this.routerClient.query("Storage.get",e,(e,i)=>{if(e)return s.default.system.error("Storage.get",e,i),t&&t(e,i?i.data:null),n(e,i?i.data:null);s.default.system.info("Storage.get",e,i),t&&t(e,i.data),r(i.data)})})}get1(e,t){return u(()=>this.get(e,t))}async updateStorage(e){const{topic:t,key:r,updateFn:n}=e,i=await this.get({topic:t,key:r});return await this.save({topic:t,key:r,value:n(i)})}updateStorage1(e){return u(()=>this.updateStorage(e))}keys(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),o.default.args(e.topic,"string",t,"function="),s.default.system.debug("StorageClient.keys",e,t),this.routerClient.query("Storage.keys",e,(e,r)=>{(e?s.default.system.error:s.default.system.info)("Storage.keys",e,r),t&&t(e,r.data)})}keys1(e){return u(()=>l.promisify(this.keys.bind(this))(e))}getMultiple(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready"),s.default.system.info("StorageClient.getMultiple",e,t),this.routerClient.query("Storage.getMultiple",e,(r,n)=>{(r?s.default.system.error:s.default.system.info)("StorageClient.getMultiple:",e,n),t&&t(r,n)})}remove(e,t){this.clientReady||s.default.system.error("storageClient invoked before ready");return new Promise((r,n)=>{o.default.args(e.topic,"string",e.key,"string",t,"function="),this.routerClient.query("Storage.delete",e,(e,i)=>{(e?s.default.system.error:s.default.system.info)("StorageClient.delete",e,i),t&&t(e,i.data),e?n({err:e,data:null}):r({err:e,data:i.data})})})}remove1(e){return u(()=>this.remove(e))}clearCache(e){s.default.system.log("StorageClient.clearCache",e),this.routerClient.query("Storage.clearCache",null,(t,r)=>{(t?s.default.system.error:s.default.system.info)("StorageClient.clearCache",t,r),e&&e(t,r.data)})}}t.StorageClient=c;var f=new c({onReady(e){e&&e(),f.clientReady=!0},name:"storageClient"});t.default=f},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(1)),o=r(9),s=r(5),a=n(r(12));
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
let l=null;var u=new function(){const e={},t={};let n=null;this.getDefaultTemplateURL=function(e){n?setTimeout(()=>{e(n)},0):(l||(l=r(22).default),l.get({field:"finsemble"},(t,r)=>{n=o.ConfigUtilInstance.getDefault(r,"finsemble.notificationURL",r.moduleRoot+"/components/system/notification/notification.html"),e(n)}))},this.alert=function(e,t,r,n,i){const o=this;i&&i.url?this.alertInternal(e,t,r,n,i,i.url):this.getDefaultTemplateURL(s=>{o.alertInternal(e,t,r,n,i,s)})},this.alertInternal=function(r,n,o,l,u,c){let f=!1;const d="UserNotification.alert."+o,h=(u=u||{}).duration||864e5;switch(n){case"ONCE-SINCE-STARTUP":d in e?f=!1:(f=!0,e[d]=!0);break;case"MAX-COUNT":{let e=0;const r=u.maxCount||1;d in t&&(e=t[d]),t[d]=++e,e<=r&&(f=!0);break}default:f=!0}if(i.default.log("UserNotification.alert",r,f,n,o,l,u),f){const e={url:c,message:l,timeout:h};a.default.systemLog({notification:!0},"Notification: "+l),new s.System.Notification(e)}}};t.default=u,e.exports=t.default},function(e,t,r){var n=r(30),i=r(31);e.exports=function(e,t,r){var o=t&&r||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(9),o=n(r(1)),s=r(5),a={activeTransports:{},addTransport(e,t){this.activeTransports[e]=t,o.default.system.log(`RouterTransport ${e} added to activeTransports`)},getActiveTransports(e){const t=[];function r(e){-1===t.indexOf(e)&&t.push(e)}return s.System.InterApplicationBus&&r("IPCBus"),"Electron"===s.System.container&&r("FinsembleTransport"),SharedWorker&&r("SharedWorker"),r(e.sameDomainTransport),r(e.crossDomainTransport),o.default.system.log("getActiveTransports",t),t},getDefaultTransport:(e,t,r,n)=>a.getTransport(e,"IPCBus",t,r,n),getRecommendedTransport(e,t,r,n){const i=function(){const{sameDomainTransport:t}=e,{crossDomainTransport:r}=e;let n=t;return function(){const t=document.createElement("a");t.href=e.routerDomainRoot;const r=window.location.hostname===t.hostname,n=window.location.protocol===t.protocol,i=(void 0!==window.location.port?window.location.port:80)===(void 0!==t.port?t.port:80),s=!(r&&i&&n);return o.default.system.debug(`Transport crossDomain=${s} (${r}:${n}:${i})`),s}()&&(n=r),o.default.system.log(`Transport Info: Selected=${n} SameDomainDefault=${t} CrossDomainDefault=${r}`),console.log(`Transport Info: Selected=${n} SameDomainDefault=${t} CrossDomainDefault=${r}`),n}();return a.getTransport(e,i,t,r,n)},getTransport(e,t,r,n,i){const o=this;return new Promise((s,a)=>{const l=o.activeTransports[t];l?new l(e,r,n,i,e=>{s(e)}):a("unknown router transport name: "+t)})}};const l={SharedWorkerTransport:function(e,t,r,n,i){let s;const a=this;this.send=function(e,t){1===arguments.length?(t=arguments[0],e=null):(e=arguments[0],t=arguments[1]),o.default.system.verbose("SharedWorkerTransport Outgoing Transport",t);try{s.port.postMessage([e,t])}catch(e){o.default.system.error("SharedWorkerTransport: post message failed: "+JSON.stringify(e),"Probable cause is sending illegal data type (e.g. function).")}},this.identifier=function(){return"SharedWorker"};const l=e.transportSettings.SharedWorker&&e.transportSettings.SharedWorker.workerPath?e.transportSettings.SharedWorker.workerPath:e.routerDomainRoot+"/common/routerSharedWorker.js";o.default.system.log(`SharedWorker Transport Initializing for ${r} using ${l}`),console.log(`SharedWorker Transport Initializing for ${r} using ${l}`),s=new SharedWorker(l,{name:"Finsemble",credentials:"include"}),s.port.onmessage=function(e){const r=e.data[0],n=e.data[1],i={transportID:a.identifier(),port:r};o.default.system.verbose("SharedWorkerTransport Incoming Transport",i,"Message",n),t(i,n)},s.onerror=function(e){o.default.system.error("SharedWorkerTransport Transport Error"+JSON.stringify(e))},s.port.start(),"RouterService"===r&&s.port.postMessage({data:"connect",source:"RouterService"}),i(this)},IPCTransport:function(e,t,r,n,i){const{uuid:a}=s.System.Application.getCurrent(),l=this;this.send=function(e,t){let r;1===arguments.length?(r=n,t=arguments[0]):(r=e.name,t=arguments[1]),o.default.system.verbose("IPCTransport Outgoing Transport",a,r,"Message",t),s.System.InterApplicationBus.publish(r,t,()=>{},()=>{})},this.identifier=function(){return"IPCBus"},o.default.system.log("IPCBus Transport Initializing for "+r),console.log("IPCBus Transport Initializing for "+r),s.System.InterApplicationBus.subscribe("*",r,(function(e,r){const n={transportID:l.identifier(),senderUuid:r,name:e.header.origin};o.default.system.verbose("IPCTransport Incoming Transport",n,"Message",e),t(n,e)}),null,(function(e){o.default.system.error("IPCBus Subscribe Failure: "+e)})),i(this)},FinsembleTransport:function(e,t,r,n,s){const a=i.ConfigUtilInstance.getDefault(e,"params.IAC.serverAddress","ws://127.0.0.1:3376"),l=i.ConfigUtilInstance.getDefault(e,"params.transportSettings.FinsembleTransport.serverAddress",a)+"/router",u=this;let c;function f(e){const r={transportID:u.identifier(),client:e.clientMessage.header.origin};o.default.system.verbose("FinsembleTransport Incoming Transport",r,"Message",e),t(r,e.clientMessage)}function d(){o.default.system.error("FinsembleTransport Connection Timeout for "+r),s(u)}function h(){o.default.system.log(`FinsembleTransport Transport Initializing for ${r} using ${l}`),console.log(`FinsembleTransport Transport Initializing for ${r} using ${l}`),l.startsWith("ws:")||l.startsWith("wss:")||console.error("wss not found as SOCKET_SERVER_ADDRESS.  Use wss!",l),c=new WebSocket(l);const e=setTimeout(d,3e3);c.addEventListener("open",()=>{clearTimeout(e),o.default.system.log("FinsembleTransport Connected to Server"),console.log("FinsembleTransport Connected to Server"),c.addEventListener("message",e=>{const t=JSON.parse(e.data);("RouterService"===r&&"ROUTER_SERVICE"==t.dest||r===t.message.client)&&f(t.message)}),s(u)})}this.send=function(e,t){let r,n;1===arguments.length?(r="ROUTER_SERVICE",n={clientMessage:t=arguments[0]}):(r="ROUTER_CLIENT",t=arguments[1],n={client:e.client,clientMessage:t}),o.default.system.verbose("FinsembleTransport Outgoing Transport",r,"NewMessage",n),c.readyState===WebSocket.OPEN&&c.send(JSON.stringify({dest:r,message:n})),c.readyState===WebSocket.CONNECTING&&c.addEventListener("open",()=>{c.send(JSON.stringify({dest:r,message:n}))}),c.readyState===WebSocket.CLOSED&&(h(),c.addEventListener("open",()=>{c.send(JSON.stringify({dest:r,message:n}))})),c.readyState===WebSocket.CLOSING&&(c.onclose=()=>{h(),c.addEventListener("open",()=>{c.send(JSON.stringify({dest:r,message:n}))})})},this.identifier=function(){return"FinsembleTransport"},h(),o.default.system.log(`FinsembleTransport Transport Initializing for ${r} using ${l}`),console.log(`FinsembleTransport Transport Initializing for ${r} using ${l}`),(l.startsWith("ws:")||l.startsWith("wss:"))&&console.error("wss not found as SOCKET_SERVER_ADDRESS.  Use wss!",l)},FinsembleCloudTransport:function(e,t,r,n,s){let a;const l=i.ConfigUtilInstance.getDefault(e,"params.transportSettings.FinsembleCloudTransport.serverAddress",e.applicationRoot),{FinsembleUUID:u}=e;a="/"===l.substr(l.length-1)?l.substring(0,l.length-1):l;const c=a+"/router",f=this;let d;function h(e){const r={transportID:f.identifier(),client:e.clientMessage.header.origin};o.default.system.verbose("FinsembleCloudTransport Incoming Transport",r,"Message",e),t(r,e.clientMessage)}this.send=function(e,t){let r,n;1===arguments.length?(r="ROUTER_SERVICE",n={FinsembleUUID:u,clientMessage:t=arguments[0]}):(r="ROUTER_CLIENT",t=arguments[1],n={FinsembleUUID:u,client:e.client,clientMessage:t}),o.default.system.verbose("FinsembleCloudTransport Outgoing Transport",r,"NewMessage",n),d.emit(r,n)},this.identifier=function(){return"FinsembleCloudTransport"},o.default.system.log(`FinsembleCloudTransport Transport Initializing for ${r} using ${c}`),console.log(`FinsembleCloudTransport Transport Initializing for ${r} using ${c}`),-1!==c.indexOf("ws:")||console.error("SOCKET_SERVER_ADDRESS not wss!",c),d=new WebSocket(c);const p=setTimeout((function(){o.default.system.error("FinsembleCloudTransport Connection Timeout for "+r),s(f)}),3e3);d.on("connect",()=>{clearTimeout(p),o.default.system.log("FinsembleCloudTransport Connected to Server",u),console.log("FinsembleCloudTransport Connected to Server"),"RouterService"===r?(o.default.system.debug("Setting Up Socket Connection","ROUTER_SERVICE_IN"+u),console.log("Setting Up Socket Connection","ROUTER_SERVICE_IN"+u),d.on("ROUTER_SERVICE_IN"+u,e=>{h(e)})):(o.default.system.debug("Setting Up Socket Connection",r+u),console.log("SETTING UP Socket CONNECTION",r+u),d.on(r+u,e=>{h(e)})),s(f)})}};a.addTransport("SharedWorker",l.SharedWorkerTransport),a.addTransport("IPCBus",l.IPCTransport),a.addTransport("FinsembleTransport",l.FinsembleTransport);var u=a;t.default=u,e.exports=t.default},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(23),o=n(r(1)),s=(n(r(33)),n(r(44))),a=n(r(45)),l=r(17);let u;class c extends i.EventEmitter{constructor(e,t,r){if(super(),!r||!r.System)throw new Error("Monitors class requires dependency injection. Ensure that System is being passed in.");({System:u}=r),this.cachedMonitorInfo=null,this.limitedMonitorRefreshQueue=new s.default({concurrency:1}),this.bindAllFunctions(),this.limitedMonitorRefreshQueue.add(()=>this.refreshMonitors(e)),u.addEventListener("monitor-info-changed",()=>{this.limitedMonitorRefreshQueue.add(()=>this.refreshMonitors(t))}),u.addEventListener("session-changed",e=>{e&&("object"!=typeof e||!e.hasOwnProperty("reason")||"unlock"!==e.reason&&"remote-connect"!==e.reason&&"unknown"!==e.reason)||this.limitedMonitorRefreshQueue.add(()=>this.refreshMonitors(t))})}bindAllFunctions(){let e=this;for(let t of Object.getOwnPropertyNames(Object.getPrototypeOf(e))){let r=e[t];r instanceof Function&&r!==c&&(e[t]=e[t].bind(e))}}asyncIt(e,t){return t(e),e}rationalizeMonitor(e){e.monitorRect.width=e.monitorRect.right-e.monitorRect.left,e.monitorRect.height=e.monitorRect.bottom-e.monitorRect.top,e.availableRect.width=e.availableRect.right-e.availableRect.left,e.availableRect.height=e.availableRect.bottom-e.availableRect.top}calculateMonitorScale(e,t){return(t.right-t.left)/(e.right-e.left)}monitorInfoIsChanged(e,t){if(!e||!t)return!0;if(e.nonPrimaryMonitors.length!==t.nonPrimaryMonitors.length)return!0;if(!(0,l.checkIfBoundsAreEqual)(e.primaryMonitor.availableRect,t.primaryMonitor.availableRect))return!0;if(!(0,l.checkIfBoundsAreEqual)(e.primaryMonitor.monitorRect,t.primaryMonitor.monitorRect))return!0;e.nonPrimaryMonitors.sort((e,t)=>e.deviceName>t.deviceName?1:e.deviceName<t.deviceName?-1:0),t.nonPrimaryMonitors.sort((e,t)=>e.deviceName>t.deviceName?1:e.deviceName<t.deviceName?-1:0);let r=!1;return e.nonPrimaryMonitors.forEach((e,n)=>{const i=t.nonPrimaryMonitors[n];(0,l.checkIfBoundsAreEqual)(e.availableRect,i.availableRect)&&(0,l.checkIfBoundsAreEqual)(e.monitorRect,i.monitorRect)||(r=!0)}),r}async refreshMonitors(e=Function.prototype){this.limitedMonitorRefreshQueue.clear();const t=await u.getMonitorInfo();if(!this.monitorInfoIsChanged(this.cachedMonitorInfo,t))return o.default.system.info("Skipped refreshMonitors because monitors do not change."),e(this.allMonitors);this.allMonitors=[];let{primaryMonitor:r}=t;if(Object.entries(r).length){r.whichMonitor="primary",r.position=0,this.allMonitors.push(Object.assign({},r));for(let e=0;e<t.nonPrimaryMonitors.length;e++){let r=t.nonPrimaryMonitors[e];r.whichMonitor=e,r.position=e+1,this.allMonitors.push(r)}for(let e=0;e<this.allMonitors.length;e++){let t=this.allMonitors[e];this.rationalizeMonitor(t)}this.cachedMonitorInfo=(0,a.default)(t),e(this.allMonitors),this.ready=!0,1===this.limitedMonitorRefreshQueue.pending&&this.emit("monitors-changed",{monitors:this.allMonitors})}else o.default.system.info("There is no primary monitor in 'monitorInfo' - the system is still in the process of updating the monitor information. Returning from monitorsAndScaling -> refreshMonitors")}getAllMonitors(e=Function.prototype){return this.ready?this.asyncIt(JSON.parse(JSON.stringify(this.allMonitors)),e):e?void this.refreshMonitors(e):"not ready"}getMonitorFromScaledXY(e,t,r=Function.prototype){return new Promise(n=>{if(!this.ready)return this.refreshMonitors(()=>{this.getMonitorFromScaledXY(e,t,r)}),"not ready";let i=null;for(var o=this.allMonitors,s=0;s<o.length;s++){var a=o[s],{monitorRect:l}=a;if(e>=l.left&&e<l.right&&t>=l.top&&t<l.bottom){i=a;break}}n(i),r(i)})}getMonitorFromUnscaledXY(e,t,r=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.getMonitorFromUnscaledXY(e,t,r)}),"not ready";for(var n=this.allMonitors,i=0;i<n.length;i++){var o=n[i],s=o.monitor.scaledRect;if(e>=s.left&&e<s.right&&t>=s.top&&t<s.bottom)return this.asyncIt(o,r)}return this.asyncIt(null,r)}async translatePointFromScaled(e,t=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.translatePointFromScaled(e,t)}),"not ready";var r;e.point?({point:r}=e):r=e;var{monitor:n}=e;if(!n){n=(await this.getMonitorFromScaledXY(r.x,r.y)).data}let i=null;if(n){var o=r.x-n.monitorRect.left,s=r.y-n.monitorRect.top,a=o*n.deviceScaleFactor,l=s*n.deviceScaleFactor;i={x:a+n.monitor.scaledRect.left,y:l+n.monitor.scaledRect.top}}return t(i),Promise.resolve(i)}translatePointToScaled(e,t=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.translatePointToScaled(e,t)}),"not ready";var r;e.point?({point:r}=e):r=e;var n=e.monitor||this.getMonitorFromUnscaledXY(r.x,r.y);if(!n)return this.asyncIt(null,t);var i=r.x-n.monitor.scaledRect.left,o=r.y-n.monitor.scaledRect.top,s=i/n.deviceScaleFactor,a=o/n.deviceScaleFactor,l={x:s+n.monitorRect.left,y:a+n.monitorRect.top};return this.asyncIt(l,t)}async translateRectToScaled(e,t=Function.prototype){let r;if(!this.ready)return this.refreshMonitors(()=>{this.translateRectToScaled(e,t)}),"not ready";var n=this.translatePointToScaled({x:e.left,y:e.top}),i=this.translatePointToScaled({x:e.right,y:e.bottom});return!n&&i&&(r=await this.getMonitorFromScaledXY(i),n=this.translatePointToScaled({monitor:r,point:{x:e.left,y:e.top}})),!i&&n&&(r=await this.getMonitorFromScaledXY(i),i=this.translatePointToScaled({monitor:r,point:{x:e.right,y:e.bottom}})),this.asyncIt({top:n?n.y:null,left:n?n.x:null,bottom:i?i.y:null,right:i?i.x:null,height:n&&i?i.y-n.y:null,width:n&&i?i.x-n.x:null},t)}translateRectFromScaled(e,t=Function.prototype){if(!this.ready)return this.refreshMonitors(()=>{this.translateRectFromScaled(e,t)}),"not ready";var r=this.translatePointFromScaled({x:e.left,y:e.top}),n=this.translatePointFromScaled({x:e.right,y:e.bottom});return!r&&n&&(r=this.translatePointFromScaled({monitor:this.getMonitorFromUnscaledXY(n),point:{x:e.left,y:e.top}})),!n&&r&&(n=this.translatePointFromScaled({monitor:this.getMonitorFromUnscaledXY(r),point:{x:e.right,y:e.bottom}})),this.asyncIt({top:r?r.y:null,left:r?r.x:null,bottom:n?n.y:null,right:n?n.x:null,height:r&&n?n.y-r.y:null,width:r&&n?n.x-r.x:null},t)}}var f=c;t.default=f,e.exports=t.default},function(e,t,r){(function(t){var r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,u=a||l||Function("return this")(),c=Object.prototype.toString,f=Math.max,d=Math.min,h=function(){return u.Date.now()};function p(e,t,r){var n,i,o,s,a,l,u=0,c=!1,p=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var r=n,o=i;return n=i=void 0,u=t,s=e.apply(o,r)}function b(e){return u=e,a=setTimeout(w,t),c?y(e):s}function S(e){var r=e-l;return void 0===l||r>=t||r<0||p&&e-u>=o}function w(){var e=h();if(S(e))return _(e);a=setTimeout(w,function(e){var r=t-(e-l);return p?d(r,o-(e-u)):r}(e))}function _(e){return a=void 0,g&&n?y(e):(n=i=void 0,s)}function E(){var e=h(),r=S(e);if(n=arguments,i=this,l=e,r){if(void 0===a)return b(l);if(p)return a=setTimeout(w,t),y(l)}return void 0===a&&(a=setTimeout(w,t)),s}return t=v(t)||0,m(r)&&(c=!!r.leading,o=(p="maxWait"in r)?f(v(r.maxWait)||0,t):o,g="trailing"in r?!!r.trailing:g),E.cancel=function(){void 0!==a&&clearTimeout(a),u=0,n=l=i=a=void 0},E.flush=function(){return void 0===a?s:_(h())},E}function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var a=i.test(e);return a||o.test(e)?s(e.slice(2),a?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return m(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),p(e,t,{leading:n,maxWait:t,trailing:i})}}).call(this,r(3))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(48),i=r(49),o=r(51),s=()=>{},a=new i.TimeoutError;t.default=class extends n{constructor(e){if(super(),Object.defineProperty(this,"_carryoverConcurrencyCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isIntervalIgnored",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_intervalCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_intervalCap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interval",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_intervalEnd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_intervalId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_timeoutId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_queueClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pendingCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_concurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isPaused",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_resolveEmpty",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_resolveIdle",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_throwOnTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother()}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s)}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother)return this.emit("active"),this._queue.dequeue()(),e&&this._initializeIntervalIfNeeded(),!0}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,n)=>{this._queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{const o=void 0===this._timeout&&void 0===t.timeout?e():i.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(a)});r(await o)}catch(e){n(e)}this._next()},t),this._tryToStartAnother()})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}set timeout(e){this._timeout=e}get timeout(){return this._timeout}}},function(e,t,r){(function(e,r){var n="[object Arguments]",i="[object Function]",o="[object GeneratorFunction]",s="[object Map]",a="[object Set]",l=/\w*$/,u=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,f={};f[n]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object DataView]"]=f["[object Boolean]"]=f["[object Date]"]=f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f[s]=f["[object Number]"]=f["[object Object]"]=f["[object RegExp]"]=f[a]=f["[object String]"]=f["[object Symbol]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f["[object Error]"]=f[i]=f["[object WeakMap]"]=!1;var d="object"==typeof e&&e&&e.Object===Object&&e,h="object"==typeof self&&self&&self.Object===Object&&self,p=d||h||Function("return this")(),m=t&&!t.nodeType&&t,v=m&&"object"==typeof r&&r&&!r.nodeType&&r,g=v&&v.exports===m;function y(e,t){return e.set(t[0],t[1]),e}function b(e,t){return e.add(t),e}function S(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function w(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function _(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function E(e,t){return function(r){return e(t(r))}}function C(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var P,O=Array.prototype,R=Function.prototype,A=Object.prototype,T=p["__core-js_shared__"],I=(P=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"",j=R.toString,L=A.hasOwnProperty,D=A.toString,F=RegExp("^"+j.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=g?p.Buffer:void 0,N=p.Symbol,x=p.Uint8Array,M=E(Object.getPrototypeOf,Object),$=Object.create,V=A.propertyIsEnumerable,W=O.splice,U=Object.getOwnPropertySymbols,B=k?k.isBuffer:void 0,z=E(Object.keys,Object),q=ve(p,"DataView"),H=ve(p,"Map"),Q=ve(p,"Promise"),G=ve(p,"Set"),Y=ve(p,"WeakMap"),K=ve(Object,"create"),J=we(q),X=we(H),Z=we(Q),ee=we(G),te=we(Y),re=N?N.prototype:void 0,ne=re?re.valueOf:void 0;function ie(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ae(e){this.__data__=new oe(e)}function le(e,t){var r=Ee(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ce(e)}(e)&&L.call(e,"callee")&&(!V.call(e,"callee")||D.call(e)==n)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],i=r.length,o=!!i;for(var s in e)!t&&!L.call(e,s)||o&&("length"==s||be(s,i))||r.push(s);return r}function ue(e,t,r){var n=e[t];L.call(e,t)&&_e(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function ce(e,t){for(var r=e.length;r--;)if(_e(e[r][0],t))return r;return-1}function fe(e,t,r,u,c,d,h){var p;if(u&&(p=d?u(e,c,d,h):u(e)),void 0!==p)return p;if(!Re(e))return e;var m=Ee(e);if(m){if(p=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&L.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(e,p)}else{var v=ye(e),g=v==i||v==o;if(Pe(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if("[object Object]"==v||v==n||g&&!d){if(w(e))return d?e:{};if(p=function(e){return"function"!=typeof e.constructor||Se(e)?{}:(t=M(e),Re(t)?$(t):{});var t}(g?{}:e),!t)return function(e,t){return pe(e,ge(e),t)}(e,function(e,t){return e&&pe(t,Ae(t),e)}(p,e))}else{if(!f[v])return d?e:{};p=function(e,t,r,n){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return he(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var r=t?he(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var r=t?he(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case s:return function(e,t,r){return S(t?r(_(e),!0):_(e),y,new e.constructor)}(e,n,r);case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,l.exec(e));return t.lastIndex=e.lastIndex,t}(e);case a:return function(e,t,r){return S(t?r(C(e),!0):C(e),b,new e.constructor)}(e,n,r);case"[object Symbol]":return o=e,ne?Object(ne.call(o)):{}}var o}(e,v,fe,t)}}h||(h=new ae);var E=h.get(e);if(E)return E;if(h.set(e,p),!m)var P=r?function(e){return function(e,t,r){var n=t(e);return Ee(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Ae,ge)}(e):Ae(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(P||e,(function(n,i){P&&(n=e[i=n]),ue(p,i,fe(n,t,r,u,i,e,h))})),p}function de(e){return!(!Re(e)||(t=e,I&&I in t))&&(Oe(e)||w(e)?F:u).test(we(e));var t}function he(e){var t=new e.constructor(e.byteLength);return new x(t).set(new x(e)),t}function pe(e,t,r,n){r||(r={});for(var i=-1,o=t.length;++i<o;){var s=t[i],a=n?n(r[s],e[s],s,r,e):void 0;ue(r,s,void 0===a?e[s]:a)}return r}function me(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return de(r)?r:void 0}ie.prototype.clear=function(){this.__data__=K?K(null):{}},ie.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},ie.prototype.get=function(e){var t=this.__data__;if(K){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return L.call(t,e)?t[e]:void 0},ie.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:L.call(t,e)},ie.prototype.set=function(e,t){return this.__data__[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},oe.prototype.clear=function(){this.__data__=[]},oe.prototype.delete=function(e){var t=this.__data__,r=ce(t,e);return!(r<0)&&(r==t.length-1?t.pop():W.call(t,r,1),!0)},oe.prototype.get=function(e){var t=this.__data__,r=ce(t,e);return r<0?void 0:t[r][1]},oe.prototype.has=function(e){return ce(this.__data__,e)>-1},oe.prototype.set=function(e,t){var r=this.__data__,n=ce(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},se.prototype.clear=function(){this.__data__={hash:new ie,map:new(H||oe),string:new ie}},se.prototype.delete=function(e){return me(this,e).delete(e)},se.prototype.get=function(e){return me(this,e).get(e)},se.prototype.has=function(e){return me(this,e).has(e)},se.prototype.set=function(e,t){return me(this,e).set(e,t),this},ae.prototype.clear=function(){this.__data__=new oe},ae.prototype.delete=function(e){return this.__data__.delete(e)},ae.prototype.get=function(e){return this.__data__.get(e)},ae.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.set=function(e,t){var r=this.__data__;if(r instanceof oe){var n=r.__data__;if(!H||n.length<199)return n.push([e,t]),this;r=this.__data__=new se(n)}return r.set(e,t),this};var ge=U?E(U,Object):function(){return[]},ye=function(e){return D.call(e)};function be(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}function Se(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||A)}function we(e){if(null!=e){try{return j.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function _e(e,t){return e===t||e!=e&&t!=t}(q&&"[object DataView]"!=ye(new q(new ArrayBuffer(1)))||H&&ye(new H)!=s||Q&&"[object Promise]"!=ye(Q.resolve())||G&&ye(new G)!=a||Y&&"[object WeakMap]"!=ye(new Y))&&(ye=function(e){var t=D.call(e),r="[object Object]"==t?e.constructor:void 0,n=r?we(r):void 0;if(n)switch(n){case J:return"[object DataView]";case X:return s;case Z:return"[object Promise]";case ee:return a;case te:return"[object WeakMap]"}return t});var Ee=Array.isArray;function Ce(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Oe(e)}var Pe=B||function(){return!1};function Oe(e){var t=Re(e)?D.call(e):"";return t==i||t==o}function Re(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ae(e){return Ce(e)?le(e):function(e){if(!Se(e))return z(e);var t=[];for(var r in Object(e))L.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}r.exports=function(e){return fe(e,!1,!0)}}).call(this,r(3),r(19)(e))},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,i,o,s,a,l=1,u={},c=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){o.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,n=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(p,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&p(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),n=function(t){e.postMessage(s+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return u[l]=i,n(l),l++},d.clearImmediate=h}function h(e){delete u[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{h(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(3),r(14))},function(e,t,r){"use strict";(function(e){
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RouterClientConstructor=void 0;const a=s(r(41)),l=o(r(11)),u=r(9),c=s(r(10)),f=s(r(39)),d=r(5),h=r(1),p=r(32),m=r(24),v=[],g=e;let y=h.Logger;g.FSBLData=g.FSBLData||{},g.FSBLData.RouterClients=g.FSBLData.RouterClients||{},t.RouterClientConstructor=function(e){c.default.args(e,"object")&&c.default.args2("params.clientName",e.clientName,"string","params.transportName",e.transportName,"string=");const t=e.clientName,{transportName:r}=e;let n,i;const o={},s={},h={},b={},S={},w={},_={},E={},C={},P={};let O,R=null,A=!1;const T=[],I=this;function j(){this.header={origin:O,type:"initialHandshake"}}function L(e,t){this.header={origin:O,type:"timeCalibration"},this.clientBaseTime=e,this.serviceBaseTime=t}function D(e){this.header={origin:O,type:"addListener",channel:e}}function F(e,t,r){this.header={origin:O,type:"transmit",channel:e},this.data=t,this.options=r}function k(e){this.header={origin:O,type:"removeListener",channel:e}}function N(e){this.header={origin:O,type:"addResponder",channel:e}}function x(e,t,r){this.header={origin:O,type:"query",queryID:e,channel:t},this.data=r}function M(e,t,r){this.header={origin:O,type:"queryResponse",queryID:e,error:t},this.data=r}function $(e){this.header={origin:O,type:"removeResponder",channel:e}}function V(e,t){this.header={origin:O,type:"subscribe",subscribeID:e,topic:t}}function W(e,t){this.header={origin:O,type:"unsubscribe",subscribeID:e,topic:t}}function U(e,t){this.header={origin:O,type:"publish",topic:e},this.data=t}function B(e,t,r,n){this.header={origin:O,type:"notify",subscribeID:e,topic:t,error:r},this.data=n}function z(e,t,r){this.header={origin:O,type:"addPubSubResponder",topic:e,handleOnServer:r},this.data=t}function q(e){this.header={origin:O,type:"removePubSubResponder",topic:e}}function H(){for(I.startupTime=performance.now()-I.startupTime,y.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient Ready"),A=!0;T.length>0;){y.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient parentReady invoked");T.shift()()}}function Q(e){!R||R instanceof Promise?(y.system.warn("RouterClient: Queuing message since router initialization not complete",e),v.push(e)):R.send(e)}function G(){return this.header.origin===this.header.lastClient}function Y(e,t){y.system.info("RouterClient: outgoing query response","CHANNEL",this.header.channel,"RESPONSE DATA",t,"QUERY ID",this.header.queryID),Q(new M(this.header.queryID,e,t))}function K(e,t){const r=e[t.header.channel];void 0===r?y.system.warn(`RouterClient: no query responder define on channel ${t.header.channel} incoming from ${t.header.origin}`,t):t.header.error?(y.system.warn("RouterClient: queryResponder error",t),r(t.header.error,null),delete e[t.header.channel]):(t.originatedHere=G,t.sendQueryResponse=Y.bind(t),y.system.info("RouterClient: incoming query","CHANNEL",t.header.channel,"FROM",t.header.origin,"QUERY MESSAGE",t),r(null,t))}function J(e,t){const r=e[t.header.queryID];void 0===r?y.system.warn("RouterClient: no handler for incoming query response","QUERY ID",t.header.queryID):(!function(e,t){const r=e[t];void 0!==r&&clearTimeout(r)}(P,t.header.queryID),t.header.error?(y.system.debug("RouterClient: incoming queryResponse error",t.header,"QUERY ID",t.header.queryID),r(t.header.error,t)):(y.system.info("RouterClient: incoming query response","RESPONSE MESSAGE",t,"QUERY ID",t.header.queryID),r(null,t)),delete e[t.header.queryID])}function X(e,t){if(e)y.system.warn("RouterClient: income publish rejected by pubsub responder",e,t);else{b[this.header.topic]=t;const r=w[this.header.topic];if(void 0!==r)for(let n=0;n<r.length;n++)y.system.info("RouterClient: sending pubsub notify","TOPIC",this.header.topic,"NOTIFY DATA",t),Q(new B(r[n],this.header.topic,e,t))}}function Z(e,t){var r,n,i;(function(e){let t=!1;return void 0===e&&(t=!0),t})(t)||Q(new B(this.header.subscribeID,this.header.topic,e,t)),e?y.system.warn("RouterClient: incoming subscription rejected by pubsub responder","TOPIC",this.header.topic,"MESSAGE",this):(r=w,n=this.header.topic,i=this.header.subscribeID,n in r?r[n].push(i):r[n]=[i],y.system.info("RouterClient: incoming subscription added","TOPIC",this.header.topic,"MESSAGE",this))}function ee(){!function(e,t,r){let n=!1;if(t in e){const i=w[t];for(let o=0;o<i.length;o++)if(r===i[o]){i.splice(o,1),0===i.length&&delete e[t],n=!0,y.system.info("RouterClient: PubSub removeListener","TOPIC",t,"FROM",r);break}}n||y.system.warn(`RouterClient: tried to remove non-existent listener on ${t} from ${JSON.stringify(r)}`)}(w,this.header.topic,this.header.subscribeID)}function te(e){switch(y.system.verbose("Incoming Message Type",e.header.type,e),e.header.type){case"transmit":!function(e,t){const r=e[t.header.channel]||[],n=[];if(Array.isArray(r)&&0!==r.length){t.originatedHere=G,r.forEach(e=>{n.push(e)});for(let e=0;e<n.length;e++)y.isLogMessage(t.header.channel)||y.system.info("RouterClient: incoming transmit","CHANNEL",t.header.channel,"FROM",t.header.origin,"MESSAGE",t),n[e](null,t)}else y.system.warn(`RouterClient: no listener for incoming transmit on channel ${t.header.channel} from ${t.header.origin}`,t)}(o,e);break;case"query":K(s,e);break;case"queryResponse":J(C,e);break;case"notify":!function(e,t){const r=e[t.header.subscribeID];void 0===r?y.system.warn("RouterClient: no subscription handler defined for incoming notify for subscriberID",t.header.subscribeID,t):t.header.error?(y.system.info("RouterClient: incoming PubSub notify error for subscriberID","SUBSCRIBER ID",t.header.subscribeID,"NOTIFY MESSAGE",t),r(t.header.error,t)):(t.originatedHere=G,y.system.info("RouterClient: incoming PubSub notify","SUBSCRIBER ID",t.header.subscribeID,"NOTIFY MESSAGE",t),r(null,t))}(_,e);break;case"publish":!function(e){let t=h[e.header.topic];if(void 0===t)for(const r in S)if(S[r].test(e.header.topic)){t=h[r];break}void 0===t?y.system.warn("RouterClient: no pubsub responder defined for incoming publish","TOPIC",e.header.topic,"PUBLISH MESSAGE",e):(e.sendNotifyToAllSubscribers=X,t.publishCallback?(y.system.info("RouterClient: incoming PubSub publish callback invoked","TOPIC",e.header.topic,"PUBLISH MESSAGE",e),t.publishCallback(null,e)):(y.system.info("RouterClient: incoming PubSub publish","TOPIC",e.header.topic,"PUBLISH MESSAGE",e),e.sendNotifyToAllSubscribers(null,e.data)))}(e);break;case"subscribe":!function(e){y.system.info("RouterClient: PubSub subscribe","TOPIC",e.header.topic);let t=h[e.header.topic];if(void 0===t)for(const r in S)if(S[r].test(e.header.topic)){t=h[r];let n=b[e.header.topic];void 0===n&&(n=b[r]),b[e.header.topic]=n;break}void 0===t?y.system.warn("RouterClient: no pubsub responder defined for incoming subscribe",e):e.header.error?y.system.warn("RouterClient: pubsub error received from router service: "+JSON.stringify(e.header.error)):(e.sendNotifyToSubscriber=Z,t.subscribeCallback?(e.data=b[e.header.topic],t.subscribeCallback(null,e)):e.sendNotifyToSubscriber(null,b[e.header.topic]))}(e);break;case"unsubscribe":!function(e){let t=h[e.header.topic];if(void 0===t)for(const r in S)if(S[r].test(e.header.topic)){t=h[r];break}void 0===t?y.system.warn("RouterClient: no pubsub responder defined for incoming unsubscribe","TOPIC",e.header.topic,"UNSUBSCRIBE MESSAGE",e):(e.removeSubscriber=ee,t.unsubscribeCallback?(y.system.info("RouterClient: incoming unsubscribe callback","TOPIC",e.header.topic,"UNSUBSCRIBE MESSAGE",e),t.unsubscribeCallback(null,e)):(y.system.info("RouterClient: incoming unsubscribe","TOPIC",e.header.topic,"UNSUBSCRIBE MESSAGE",e),e.removeSubscriber()))}(e);break;case"timeCalibration":const t=()=>{i?i(e):setTimeout(()=>{t()},10)};t();break;case"initialHandshakeResponse":n()}}function re(e,t){t.header.lastClient=O,t.header.incomingTransportInfo=e,te(t)}function ne(){return`${O}.${m.v4()}`}function ie(e,t,r){e[t]=r}function oe(e,t,r,n){n>0&&(e[t]=setTimeout(()=>{y.system.warn(`RouterClient: timeout waiting on query response on channel ${r} for queryID ${t} on timer ${e[t]} timeout=${n}`)},n))}function se(e,t){let r=!1;return void 0!==e[t]&&(delete e[t],r=!0),r}return this.startupTime=0,this.calibrateTimeWithRouterService=function(e){let t,r=0,n=1/0;i=function(i){r++,r>5?function(r){let i=0;for(let e=1;e<5;e++){const o=r.clientBaseTime[e-1],s=r.clientBaseTime[e]-o,a=r.serviceBaseTime[e-1]-(o+s/2);s<n&&(n=s,t=a),i+=a,y.system.debug("calibrationCalculation Intermediate Values","lastRRT",s,"lastOffset",a,"fastestOffset",t,"fastestRRT",n)}i/=4,y.system.debug("RouterClient calibrationCalculation","Average Offset",i,"Chosen FastestOffset",t,r),e(t)}(i):(i.clientBaseTime.push(g.performance.timing.navigationStart+g.performance.now()),Q(new L(i.clientBaseTime,i.serviceBaseTime)))},i(new L([],[]))},this.ready=e=>this.onReady(e),this.getClientName=function(){return y.system.debug("RouterClient.getClientName",O),O},this.onReady=function(e){c.default.args(e,"function"),A?e():T.push(e)},this.addListener=function(e,t){y.system.info("RouterClient.addListener","CHANNEL",e),c.default.args(e,"string",t,"function");(function(e,t,r){let n=!1;const i=e[t];return void 0===i||0===i.length?(e[t]=[r],n=!0):i.push(r),n})(o,e,t)&&Q(new D(e))},this.transmit=function(e,t,r={suppressWarnings:!1}){y.isLogMessage(e)||y.system.info("RouterClient.transmit","TO CHANNEL",e,"EVENT",t),c.default.args(e,"string",t,"any"),Q(new F(e,t,r))},this.removeListener=function(e,t){y.system.info("RouterClient.removeListener","CHANNEL",e,"EVENT HANDLER",t),c.default.args(e,"string",t,"function");(function(e,t,r){let n=!1;const i=e[t];if(void 0!==i){const e=i.indexOf(r);e>-1?(i.splice(e,1),0===i.length&&(n=!0)):y.system.warn("no listener defined for channel: "+t)}return n})(o,e,t)&&Q(new k(e))},this.addResponder=function(e,t){y.system.info("RouterClient.addResponder","CHANNEL",e),c.default.args(e,"string",t,"function");(function(e,t,r){let n=!1;return void 0===e[t]&&(e[t]=r,n=!0),n})(s,e,t)?Q(new N(e)):(y.system.warn("RouterClient.addResponder: Responder already locally defined for channel "+e),t({"RouteClient QueryError":"Responder already locally defined for channel"+e},null))},this.query=function(e,t,r,n=Function.prototype){const i=`${ne()}.${e}`,o=window.performance.timing.navigationStart+window.performance.now(),s=window.performance.timing.navigationStart,a=window.performance.now();function l(l){ie(C,i,(u,c)=>{l({err:u,response:c}),"function"==typeof n?n(u,c):y.system.warn("No response event handler passed to RouterClient.query","RESPONDER CHANNEL",e,"QUERY EVENT",t,"PARAMS",r,"QUERY ID",i,{timestamp:o,navstart:s,timenow:a})}),oe(P,i,e,r.timeout),Q(new x(i,e,t))}return y.system.info("RouterClient.query","RESPONDER CHANNEL",e,"QUERY EVENT",t,"PARAMS",r,"QUERY ID",i,{timestamp:o,navstart:s,timenow:a}),3===arguments.length&&(n=r,r={timeout:2e4}),c.default.args(e,"string",t,"any=",r,"object=",n,"function"),r=r||{},c.default.args2("params.timeout",r.timeout,"number"),new Promise(l)},this.removeResponder=function(e){y.system.info("RouterClient.removeResponder","RESPONDER CHANNEL",e),c.default.args(e,"string");se(s,e)&&Q(new $(e))},this.addPubSubResponder=function(t,r,n,i){let o,s;if(y.system.info("RouterClient.addPubSubResponder","TOPIC",t,"INITIAL STATE",r,"PARAMS",n),c.default.args(t,"any",r,"object=",e,"object="),n=n||{},c.default.args2("params.subscribeCallback",n.subscribeCallback,"function=","params.publishCallback",n.publishCallback,"function=")&&c.default.args2("params.unsubscribeCallback",n.unsubscribeCallback,"function="),void 0===n.subscribeCallback&&void 0===n.publishCallback&&void 0===n.unsubscribeCallback)r=r||{},Q(new z(t.toString(),r,!0)),s="success";else{(function(e,t,r,n){let i=!1;return void 0===h[e.toString()]&&(e instanceof RegExp&&(S[e.toString()]=e,y.system.info("RouterClient: PubSub RegEx added for topic "+e.toString())),h[e.toString()]={subscribeCallback:t,publishCallback:r,unsubscribeCallback:n},i=!0),i})(t,n.subscribeCallback,n.publishCallback,n.unsubscribeCallback)?(r=r||{},b[t.toString()]=l.clone(r),Q(new z(t.toString(),r,!1)),s="success"):(o="RouterClient.addPubSubResponder: Responder already locally defined for topic "+t,y.system.error(o))}i&&i(o,s)},this.removePubSubResponder=function(e){y.system.info("RouterClient.removePubSubResponder","TOPIC",e),c.default.args(e,"any");se(h,e)?(delete b[e.toString()],delete S[e.toString()],Q(new q(e))):y.system.warn("RouterClient.removePubSubResponder failed: Could not find responder for topic "+e)},this.subscribe=function(e,t){y.system.info("RouterClient.subscribe","TOPIC",e),c.default.args(e,"string",t,"function");const r=ne();return function(e,t,r,n){e[t]=r,E[t]=n}(_,r,t,e),Q(new V(r,e)),{subscribeID:r,topic:e}},this.publish=function(e,t){y.system.info("RouterClient.publish","TOPIC",e,"EVENT",t),c.default.args(e,"string",t,"any"),Q(new U(e,t))},this.unsubscribe=function(e){y.system.info("RouterClient.unsubscribe","SUBSCRIBE ID",e),c.default.args(e,"object")&&c.default.args2("subscribeIDStruct.subscribeID",e.subscribeID,"string");(function(e,t){let r=!1;return void 0!==e[t]&&(delete e[t],r=!0),r})(_,e.subscribeID)?Q(new W(e.subscribeID,e.topic)):y.system.warn("RouterClient.unsubscribe: Could not find subscribeID for topic "+e.topic)},this.trustedMessage=function(e){let t=!0;return y.system.debug("RouterClient.trustedMessage header",e.header),"SharedWorker"===e.header.originIncomingTransportInfo.transportID&&(t=!0),t},this.disconnectAll=function(){y.system.info("RouterClient.disconnectAll");for(const e in o)y.system.debug("RouterClient.disconnectAll is removing listener on "+e),Q(new k(e)),delete o[e];for(const e in s)y.system.debug("RouterClient.disconnectAll is removing responder on "+e),Q(new $(e)),delete s[e];for(const e in h)y.system.debug("RouterClient.disconnectAll is removing pubsub responder on "+e),Q(new q(e)),delete h[e.toString()],delete b[e.toString()],delete S[e.toString()];for(const e in _){const t=E[e];y.system.debug("RouterClient.disconnectAll is removing subscriber on "+t),Q(new W(e,t)),delete _[e],delete E[e]}},"loggerService"===d.System.Window.getCurrent().name&&(y=new p.LocalLogger),O=`${t}.${d.System.Window.getCurrent().name}`,O in g.FSBLData.RouterClients?(y.system.debug('"RouterClient Check: reusing existing client for '+O),console.debug('"RouterClient Check: reusing existing client for '+O,g)):(y.system.debug('"RouterClient Check: constructing new client for '+O),console.debug('"RouterClient Check: constructing new client for '+O,g),g.FSBLData.RouterClients[O]=this,function(e,t){y.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient Constructor:Name:",e);let i=0;function o(i){y.system.info("WINDOW LIFECYCLE:STARTUP:RouterClient:processManifest"),i&&"string"!=typeof i?function(e,t,i,o){y.system.verbose(`Client ${t} connecting to event router`),y.system.verbose("Name of transport to establish: "+i);const s=void 0===i;let l,c,d=!1,h=0;const p=e.finsemble,m={FinsembleUUID:p.FinsembleUUID,applicationRoot:p.applicationRoot,routerDomainRoot:p.moduleRoot,forceWindowTransport:u.ConfigUtilInstance.getDefault(p,"finConfig.router.forceWindowTransport",{}),sameDomainTransport:u.ConfigUtilInstance.getDefault(p,"finConfig.router.sameDomainTransport","SharedWorker"),crossDomainTransport:u.ConfigUtilInstance.getDefault(p,"finConfig.router.crossDomainTransport","IPCBus"),transportSettings:u.ConfigUtilInstance.getDefault(p,"finConfig.router.transportSettings",{}),IAC:u.ConfigUtilInstance.getDefault(p,"finConfig.IAC",{})};let g,b,S,w,_,E;g=e=>{c=0,y.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient:transport ready","TRANSPORT OBJECT",e),R=e,n=E,_(),l=setInterval(_,200)},b=e=>{y.system.error("RouterClientError",e)},S=()=>{y.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient:getClientTransport","ROUTER PARAMS:",m),R=s?a.default.getRecommendedTransport(m,re,O,"RouterService").then(g).catch(b):a.default.getTransport(m,r,re,O,"RouterService").then(g).catch(b)},w=()=>{if(clearInterval(l),h++,h<=3)y.system.error("WINDOW LIFECYCLE:STARTUP:RouterClient: failure to connect to router service. Retrying...",h,m),S();else{const e="A cross domain transport has failed to connect. Cross domain components may not work. Please contact your administrator.";y.system.error(e,m);const t=u.ConfigUtilInstance.getDefault(p,"finConfig.notificationURL",p.moduleRoot+"/components/system/notification/notification.html");f.default.alert("dev","ONCE-SINCE-STARTUP","FSBL-Internal-Transport-Failure",e,{url:t})}},_=()=>{y.system.debug("WINDOW LIFECYCLE:STARTUP:RouterClient: sendHandshake",c),Q(new j),c++>50&&w()},E=()=>{if(!d){if(y.system.debug(`WINDOW LIFECYCLE:STARTUP:RouterClient connected: Starting ${O} with transport ${R.identifier()}`),d=!0,clearInterval(l),v)for(let e=0;e<v.length;e++){y.system.debug("RouterClient: firing queued msg");const t=v[e];R.send(t)}o&&o()}},S()}(i,e,t,H):y.system.error("WINDOW LIFECYCLE:STARTUP:RouterClient:processManifest failed -- fatal error",i)}d.System.ready(()=>{const e=d.System.Window.getCurrent();y.system.debug("WINDOW LIFECYCLE:STARTUP: System.ready invoked in "+e.name),console.debug("WINDOW LIFECYCLE:STARTUP: System.ready invoked in "+e.name),I.startupTime=performance.now(),0==i++&&e.getOptions(e=>{e.customData&&e.customData.manifest?(y.system.debug("Router Init using custom data"),o(e.customData.manifest)):u.ConfigUtilInstance.getExpandedRawManifest(e=>{y.system.debug("Router Init using getExpandedRawManifest"),g.FinsembleUUID&&(e.finsemble.FinsembleUUID=g.FinsembleUUID),o(e)},e=>{y.system.error("WINDOW LIFECYCLE:STARTUP:RouterClient:manifest error",e)})},e=>{y.system.error("WINDOW LIFECYCLE:STARTUP:finWindow.getOptions error",e)})})}(O,r)),g.FSBLData.RouterClients[O]}}).call(this,r(3))},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function o(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,r,n,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new s(r,n||e,o),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,o=r.length,s=new Array(o);n<o;n++)s[n]=r[n].fn;return s},u.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,o,s){var a=i?i+e:e;if(!this._events[a])return!1;var l,u,c=this._events[a],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,n),!0;case 5:return c.fn.call(c.context,t,r,n,o),!0;case 6:return c.fn.call(c.context,t,r,n,o,s),!0}for(u=1,l=new Array(f-1);u<f;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),f){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,n);break;default:if(!l)for(d=1,l=new Array(f-1);d<f;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},u.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return l(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||n&&!s.once||r&&s.context!==r||l(this,o);else{for(var a=0,u=[],c=s.length;a<c;a++)(s[a].fn!==t||n&&!s[a].once||r&&s[a].context!==r)&&u.push(s[a]);u.length?this._events[o]=1===u.length?u[0]:u:l(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&l(this,t)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,e.exports=u},function(e,t,r){"use strict";const n=r(50);class i extends Error{constructor(e){super(e),this.name="TimeoutError"}}const o=(e,t,r)=>new Promise((o,s)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const a=setTimeout(()=>{if("function"==typeof r){try{o(r())}catch(e){s(e)}return}const n=r instanceof Error?r:new i("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),s(n)},t);n(e.then(o,s),()=>{clearTimeout(a)})});e.exports=o,e.exports.default=o,e.exports.TimeoutError=i},function(e,t,r){"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(52);t.default=class{constructor(){Object.defineProperty(this,"_queue",{enumerable:!0,configurable:!0,writable:!0,value:[]})}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const i=n.default(this._queue,r,(e,t)=>t.priority-e.priority);this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return e&&e.run}get size(){return this._queue.length}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let n=0,i=e.length;for(;i>0;){const o=i/2|0;let s=n+o;r(e[s],t)<=0?(n=++s,i-=o+1):i=o}return n}},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t,n="object"==typeof self&&self&&self.Object===Object&&self,i=r||n||Function("return this")();function o(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function s(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var a=Object.prototype,l=a.hasOwnProperty,u=a.toString,c=i.Symbol,f=a.propertyIsEnumerable,d=c?c.isConcatSpreadable:void 0,h=Math.max;function p(e){return v(e)||function(e){return function(e){return g(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?u.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(e)}(e)&&l.call(e,"callee")&&(!f.call(e,"callee")||"[object Arguments]"==u.call(e))}(e)||!!(d&&e&&e[d])}function m(e){if("string"==typeof e||function(e){return"symbol"==typeof e||g(e)&&"[object Symbol]"==u.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}var v=Array.isArray;function g(e){return!!e&&"object"==typeof e}var y,b,S=(y=function(e,t){return null==e?{}:function(e,t){return function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=e[s];r(a,s)&&(o[s]=a)}return o}(e=Object(e),t,(function(t,r){return r in e}))}(e,function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(function e(t,r,n,i,o){var a=-1,l=t.length;for(n||(n=p),o||(o=[]);++a<l;){var u=t[a];r>0&&n(u)?r>1?e(u,r-1,n,i,o):s(o,u):i||(o[o.length]=u)}return o}(t,1),m))},b=h(void 0===b?y.length-1:b,0),function(){for(var e=arguments,t=-1,r=h(e.length-b,0),n=Array(r);++t<r;)n[t]=e[b+t];t=-1;for(var i=Array(b+1);++t<b;)i[t]=e[t];return i[b]=n,o(y,this,i)});e.exports=S}).call(this,r(3))},function(e,t,r){(function(e,r){var n="[object Arguments]",i="[object Map]",o="[object Object]",s="[object Set]",a=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[n]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u[i]=u["[object Number]"]=u[o]=u["[object RegExp]"]=u[s]=u["[object String]"]=u["[object WeakMap]"]=!1;var c="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,d=c||f||Function("return this")(),h=t&&!t.nodeType&&t,p=h&&"object"==typeof r&&r&&!r.nodeType&&r,m=p&&p.exports===h&&c.process,v=function(){try{return m&&m.binding("util")}catch(e){}}(),g=v&&v.isTypedArray;function y(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function b(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function S(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function w(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var _,E,C,P=Array.prototype,O=Function.prototype,R=Object.prototype,A=d["__core-js_shared__"],T=(_=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",I=O.toString,j=R.hasOwnProperty,L=R.toString,D=RegExp("^"+I.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=d.Symbol,k=d.Uint8Array,N=R.propertyIsEnumerable,x=P.splice,M=(E=Object.keys,C=Object,function(e){return E(C(e))}),$=ce(d,"DataView"),V=ce(d,"Map"),W=ce(d,"Promise"),U=ce(d,"Set"),B=ce(d,"WeakMap"),z=ce(Object,"create"),q=he($),H=he(V),Q=he(W),G=he(U),Y=he(B),K=F?F.prototype:void 0,J=K?K.valueOf:void 0;function X(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Z(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ee(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function te(e){var t=-1,r=e?e.length:0;for(this.__data__=new ee;++t<r;)this.add(e[t])}function re(e){this.__data__=new Z(e)}function ne(e,t){var r=me(e)||function(e){return function(e){return Se(e)&&ve(e)}(e)&&j.call(e,"callee")&&(!N.call(e,"callee")||L.call(e)==n)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],i=r.length,o=!!i;for(var s in e)!t&&!j.call(e,s)||o&&("length"==s||de(s,i))||r.push(s);return r}function ie(e,t){for(var r=e.length;r--;)if(pe(e[r][0],t))return r;return-1}function oe(e,t,r,a,l){return e===t||(null==e||null==t||!be(e)&&!Se(t)?e!=e&&t!=t:function(e,t,r,a,l,u){var c=me(e),f=me(t),d="[object Array]",h="[object Array]";c||(d=(d=fe(e))==n?o:d);f||(h=(h=fe(t))==n?o:h);var p=d==o&&!b(e),m=h==o&&!b(t),v=d==h;if(v&&!p)return u||(u=new re),c||we(e)?le(e,t,r,a,l,u):function(e,t,r,n,o,a,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!n(new k(e),new k(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return pe(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case i:var u=S;case s:var c=2&a;if(u||(u=w),e.size!=t.size&&!c)return!1;var f=l.get(e);if(f)return f==t;a|=1,l.set(e,t);var d=le(u(e),u(t),n,o,a,l);return l.delete(e),d;case"[object Symbol]":if(J)return J.call(e)==J.call(t)}return!1}(e,t,d,r,a,l,u);if(!(2&l)){var g=p&&j.call(e,"__wrapped__"),y=m&&j.call(t,"__wrapped__");if(g||y){var _=g?e.value():e,E=y?t.value():t;return u||(u=new re),r(_,E,a,l,u)}}if(!v)return!1;return u||(u=new re),function(e,t,r,n,i,o){var s=2&i,a=_e(e),l=a.length,u=_e(t).length;if(l!=u&&!s)return!1;var c=l;for(;c--;){var f=a[c];if(!(s?f in t:j.call(t,f)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);var p=s;for(;++c<l;){f=a[c];var m=e[f],v=t[f];if(n)var g=s?n(v,m,f,t,e,o):n(m,v,f,e,t,o);if(!(void 0===g?m===v||r(m,v,n,i,o):g)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,r,a,l,u)}(e,t,oe,r,a,l))}function se(e){return!(!be(e)||function(e){return!!T&&T in e}(e))&&(ge(e)||b(e)?D:a).test(he(e))}function ae(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||R,t!==n)return M(e);var t,r,n,i=[];for(var o in Object(e))j.call(e,o)&&"constructor"!=o&&i.push(o);return i}function le(e,t,r,n,i,o){var s=2&i,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var c=-1,f=!0,d=1&i?new te:void 0;for(o.set(e,t),o.set(t,e);++c<a;){var h=e[c],p=t[c];if(n)var m=s?n(p,h,c,t,e,o):n(h,p,c,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(d){if(!y(t,(function(e,t){if(!d.has(t)&&(h===e||r(h,e,n,i,o)))return d.add(t)}))){f=!1;break}}else if(h!==p&&!r(h,p,n,i,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function ue(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ce(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return se(r)?r:void 0}X.prototype.clear=function(){this.__data__=z?z(null):{}},X.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},X.prototype.get=function(e){var t=this.__data__;if(z){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return j.call(t,e)?t[e]:void 0},X.prototype.has=function(e){var t=this.__data__;return z?void 0!==t[e]:j.call(t,e)},X.prototype.set=function(e,t){return this.__data__[e]=z&&void 0===t?"__lodash_hash_undefined__":t,this},Z.prototype.clear=function(){this.__data__=[]},Z.prototype.delete=function(e){var t=this.__data__,r=ie(t,e);return!(r<0)&&(r==t.length-1?t.pop():x.call(t,r,1),!0)},Z.prototype.get=function(e){var t=this.__data__,r=ie(t,e);return r<0?void 0:t[r][1]},Z.prototype.has=function(e){return ie(this.__data__,e)>-1},Z.prototype.set=function(e,t){var r=this.__data__,n=ie(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},ee.prototype.clear=function(){this.__data__={hash:new X,map:new(V||Z),string:new X}},ee.prototype.delete=function(e){return ue(this,e).delete(e)},ee.prototype.get=function(e){return ue(this,e).get(e)},ee.prototype.has=function(e){return ue(this,e).has(e)},ee.prototype.set=function(e,t){return ue(this,e).set(e,t),this},te.prototype.add=te.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},te.prototype.has=function(e){return this.__data__.has(e)},re.prototype.clear=function(){this.__data__=new Z},re.prototype.delete=function(e){return this.__data__.delete(e)},re.prototype.get=function(e){return this.__data__.get(e)},re.prototype.has=function(e){return this.__data__.has(e)},re.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Z){var n=r.__data__;if(!V||n.length<199)return n.push([e,t]),this;r=this.__data__=new ee(n)}return r.set(e,t),this};var fe=function(e){return L.call(e)};function de(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function he(e){if(null!=e){try{return I.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function pe(e,t){return e===t||e!=e&&t!=t}($&&"[object DataView]"!=fe(new $(new ArrayBuffer(1)))||V&&fe(new V)!=i||W&&"[object Promise]"!=fe(W.resolve())||U&&fe(new U)!=s||B&&"[object WeakMap]"!=fe(new B))&&(fe=function(e){var t=L.call(e),r=t==o?e.constructor:void 0,n=r?he(r):void 0;if(n)switch(n){case q:return"[object DataView]";case H:return i;case Q:return"[object Promise]";case G:return s;case Y:return"[object WeakMap]"}return t});var me=Array.isArray;function ve(e){return null!=e&&ye(e.length)&&!ge(e)}function ge(e){var t=be(e)?L.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function ye(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function be(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Se(e){return!!e&&"object"==typeof e}var we=g?function(e){return function(t){return e(t)}}(g):function(e){return Se(e)&&ye(e.length)&&!!u[L.call(e)]};function _e(e){return ve(e)?ne(e):ae(e)}r.exports=function(e,t,r){var n=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===n?oe(e,t,r):!!n}}).call(this,r(3),r(19)(e))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=new function(){let e=3;this.diagLevel=function(){return e},this.setDiagLevel=function(t){e=t},this.validationEnabled=function(){return e>=4}};t.default=n,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BootReadyItem=t.BootConfigElement=t.ALL_BOOT_STAGES=void 0,t.ALL_BOOT_STAGES=["microkernel","kernel","authentication","preuser","earlyuser","user"];t.BootConfigElement=class{};t.BootReadyItem=class{constructor(e,t,r){this.name=e,this.type=t,this.config=r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkpointChannel=t.statusChannel=t.killOldApplications=void 0;const n=r(5),i=r(34);t.killOldApplications=function(e){return new Promise(async t=>{n.System.getAllApplications(async r=>{if(r)for(let t=0;t<r.length;t++){const i=r[t];if(i.uuid.endsWith("-"+e)){const e=n.System.Application.wrap(i.uuid);await n.System.closeApplication(e)}}console.log("killOldApplications: finished closing old apps"),t()})})},t.statusChannel=function(e){return`${i.STATUS_CHANNEL_BASE}.${e}`},t.checkpointChannel=function(e,t){return`${i.CHECKPOINT_CHANNEL_BASE}.${e}.${t}`}},function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(6)),l=o(r(8));t.default=class{constructor(e,t){this.allowDelay=!1,this.delayed=!1,this.allowCancel=!1,this.canceled=!1,this.completed=!1,this.event=e.event,this.source=e.source,this.sourceType=e.sourceType,this.listenerGuid=e.listenerGuid,l[this.sourceType.toUpperCase()]&&l[this.sourceType.toUpperCase()].DELAYABLE_EVENTS.includes(this.event)&&(this.allowDelay=!0),l[this.sourceType.toUpperCase()]&&l[this.sourceType.toUpperCase()].CANCELABLE_EVENTS.includes(this.event)&&(this.allowCancel=!0),this.handler=e.handler,this.queryMessage=t,this.guid=t.data.guid,this.internalHandler()}async internalHandler(){this.data=this.queryMessage.data.data,this.handler&&await this.handler(this),this.delayed||this.canceled||this.completed||this.done()}cancel(){this.allowCancel&&(this.canceled=!0,this.done())}wait(){this.allowDelay?(this.delayed=!0,this.queryMessage.sendQueryResponse(null,{delayed:!0})):this.done()}done(e){this.completed=!0,this.delayed?a.default.transmit(`Finsemble.Listener.Done.${this.guid}.${this.listenerGuid}`,{canceled:this.canceled,data:e}):this.queryMessage.sendQueryResponse(null,{canceled:this.canceled,data:e})}}},function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseService=void 0;
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const a=r(13),l=r(28),u=s(r(6)),c=s(r(1)),f=s(r(12)),d=r(5),h=o(r(8)),{SERVICE_INITIALIZING_CHANNEL:p,SERVICE_READY_CHANNEL:m,SERVICE_QUERY_READY_CHANNEL:v,SERVICE_CLOSING_CHANNEL:g,SERVICE_CLOSED_CHANNEL:y,SERVICE_STOP_CHANNEL:b}=h,S={startupDependencies:{services:[],clients:[]},shutdownDependencies:{services:[]},addOFWrapper:!1,name:window.name},w=window;t.BaseService=class{constructor(e=S){!function(e){e.startupDependencies?(e.startupDependencies.services||(e.startupDependencies.services=S.startupDependencies.services),e.startupDependencies.clients||(e.startupDependencies.clients=S.startupDependencies.clients)):e.startupDependencies=S.startupDependencies,e.shutdownDependencies?e.shutdownDependencies.services||(e.shutdownDependencies.services=S.shutdownDependencies.services):e.shutdownDependencies=S.shutdownDependencies}(e),this.name=e.name?e.name:window.name,this.startupDependencies=e.startupDependencies,this.shutdownDependencies=e.shutdownDependencies,this.Logger=c.default,this.RouterClient=u.default,this.onBaseServiceReadyCB=null,this.setOnConnectionCompleteCB=null,this.listeners={},this.start=this.waitForDependencies,this.started=!1,this.status="initializing",this.setOnline=this.setOnline.bind(this),this.onBaseServiceReady=this.onBaseServiceReady.bind(this),this.handleShutdown=this.handleShutdown.bind(this),this.waitForDependencies(),w.finsembleServices?w.finsembleServices.push(this):w.finsembleServices=[this]}waitForDependencies(){const e=this;if(this.started)return;this.started=!0;const t=this;function r(e){c.default.system.debug("BaseService.start.setParentUUID"),d.System.Window.getCurrent().getOptions(r=>{t.customData=r.customData,t.parentUuid=r.customData.parentUuid,e()})}function n(r){u.default.onReady(()=>{u.default.addResponder(v(e.name),(t,r)=>{(e.status="ready")?r.sendQueryResponse(null):r.sendQueryResponse("service not ready")}),u.default.transmit(p,{name:t.name}),window.addEventListener("beforeunload",t.RouterClient.disconnectAll),c.default.system.debug("APPLICATION LIFECYCLE:STARTUP:SERVICE:BaseService.start.onRouterReady"),r()})}function i(e){const r=t.customData.debugServiceDelay||0;if(c.default.system.debug(`Custom Data: ${t.name} custom data`,t.customData),Number.isInteger(r))r>0&&c.default.system.debug(`APPLICATION LIFECYCLE:STARTUP:SERVICE:BaseService.start.debugDelay: ${t.name} startup will delayed by ${r} milliseconds for debugging`);else{const e=`debugDelay has an illegal value ("${r}") for ${t.name}. Value must be an integer.`;c.default.system.error("APPLICATION LIFECYCLE:STARTUP:SERVICE:BaseService.start: "+e),f.default.systemLog({error:!0},e)}setTimeout(e,r)}function o(e){c.default.system.debug("APPLICATION LIFECYCLE:STARTUP:SERVICE:BaseService.start.readyToGo "+t.name),console.log("Startup Dependencies for",t.name,t.startupDependencies),console.log("Shutdown Dependencies for",t.name,t.shutdownDependencies),l.FSBLDependencyManagerSingleton.shutdown.waitFor(t.shutdownDependencies,t.handleShutdown),c.default.system.debug("APPLICATION LIFECYCLE:STARTUP:SERVICE:BaseService.start.readyToGo after wait "+t.name),u.default.transmit(d.System.Window.getCurrent().name+".onSpawned",{name:d.System.Window.getCurrent().name},{suppressWarnings:!0});l.FSBLDependencyManagerSingleton.startup.waitFor(t.startupDependencies,e).on("err",e=>{c.default.system.error(e)})}function s(e){const r=d.System.Window.getCurrent();r.isShowing(n=>{n&&!1!==t.customData.showDevConsoleOnVisible?d.System.showDeveloperTools(r.uuid,r.name,null,e):(c.default.system.debug("APPLICATION LIFECYCLE:STARTUP:SERVICE:BaseService.start.delayStartup done"),e())})}return c.default.system.debug(this.name+" starting"),new Promise(e=>{a.series([n,r,s,i,o],()=>{e(),this.onDependenciesReady()})})}setOnline(){"ready"!==this.status&&(console.log("Setting service online",this.name),this.RouterClient.addListener(`${b}.${this.name}`,()=>{l.FSBLDependencyManagerSingleton.shutdown.checkDependencies()}),this.status="ready",u.default.transmit(m,{serviceName:this.name},{suppressWarnings:!0}),c.default.system.log("APPLICATION LIFECYCLE:STARTUP:SERVICE ONLINE",this.name),f.default.publishBootStatus(this.name,"services","completed"))}onDependenciesReady(){c.default.system.debug("APPLICATION LIFECYCLE:STARTUP:BaseService onDependenciesReady",this.name),this.status="initializing",u.default.onReady(()=>{this.onBaseServiceReadyCB?this.onBaseServiceReadyCB(this.setOnline):this.initialize?this.initialize(this.setOnline):setTimeout(()=>{"ready"!==this.status&&"routerService"!==this.name&&(console.error("No onBaseServiceReadyCB on initialize function defined on your service. Ensure that service.setOnline is called"),c.default.system.error("No onBaseServiceReadyCB on initialize function defined on your service. Ensure that service.setOnline is called"))},3e3)})}onBaseServiceReady(e){"initializing"===this.status?this.onBaseServiceReadyCB=()=>{e(this.setOnline)}:e(this.setOnline)}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}onShutdown(e){this.addEventListener("onShutdown",e)}handleShutdown(){c.default.system.debug("BaseService.handleShutdown");const e=this;this.listeners.onShutdown?(u.default.transmit(g,{waitForMe:!0,name:this.name}),a.each(this.listeners.onShutdown,(function(e,t){a.asyncify(e)(null,t)}),(function(t){t&&c.default.system.error(t),e.shutdownComplete()}))):(u.default.transmit(g,{waitForMe:!1,name:this.name}),e.shutdownComplete())}shutdownComplete(){c.default.system.info('"APPLICATION LIFECYCLE:SHUTDOWN:SERVICE SHUTDOWN: '+this.name),u.default.transmit(y,{name:this.name,uuid:d.System.Application.getCurrent().uuid})}},window.addEventListener("error",e=>{const t=e.error?e.error.stack.substring(e.error.stack.search("at ")):"";return c.default.error(e.message,"File: "+e.filename,"Line: "+e.lineno,"Column: "+e.colno,"Error Stack: \n    "+t),!1}),window.addEventListener("unhandledrejection",e=>{"Cannot Wrap Service Manager or Services"==e.reason?c.default.warn("A service tried To wrap itself. This is a side effect of using Clients in services."):c.default.error("Unhandled rejection","reason",e.reason)})},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */
const i=r(18),o=n(r(65));let s;const a=window;let l;const u={};function c(e,t){return l.routerClient.query("storeService.getStore",e,(function(e,r){return e?t(e):t(e,new s(r.data,l.routerClient))}))}function f(e,t){l.routerClient.query("storeService.removeStore",e,(e,r)=>t(e,!e&&r.data))}class d extends i._BaseClient{constructor(e){super(e),this.load=function(e){e()},l=this,this.ls=u}getStore(e,t){return e.global?c(e,t):u[e.store]?t(null,u[e.store]):c(e,t)}createStore(e,t=Function.prototype){return new Promise((r,n)=>{if(e.global)return this.routerClient.query("storeService.createStore",e,(e,i)=>{if(e)return n(e),t(e);const o=new s(i.data,l.routerClient);return r({err:e,data:o}),t(e,o)});if(u[e.store])return r({err:null,data:u[e.store]}),t(null,u[e.store]);const i=new s(e,l.routerClient);return u[i.name]=i,r({err:null,data:i}),t(null,i)})}removeStore(e,t){return e.global?f(e,t):u[e.store]?(delete u[e.store],t(null,!0)):void f(e,t)}}var h=new d({startupDependencies:{},onReady(e){s=o.default,h.load(e)},name:"distributedStoreClient"});a.distributedStoreClient=h,t.default=h},,function(e,t,r){"use strict";const n=r(63);e.exports=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=[];let r=0;const i=async(e,i,...o)=>{r++;const s=n(e,...o);i(s);try{await s}catch{}r--,t.length>0&&t.shift()()},o=(n,...o)=>new Promise(s=>((n,o,...s)=>{t.push(i.bind(null,n,o,...s)),(async()=>{await Promise.resolve(),r<e&&t.length>0&&t.shift()()})()})(n,s,...o));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>t.length},clearQueue:{value:()=>{t.length=0}}}),o}},function(e,t,r){"use strict";const n=(e,...t)=>new Promise(r=>{r(e(...t))});e.exports=n,e.exports.default=n},function(e,t,r){"use strict";function i(e,t){const r=(t=t.replace(/^\./,"")).split(/\.(?![^[]*])/g);for(let t=0;t<r.length;++t){const n=r[t].replace(/[["\]]/g,"");if(!e)return null;if("string"==typeof e)return null;if(!(n in e))return null;e=e[n]}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.byString=i,t.initObject=function e(t,r,i){let o;r||(r=null);if("object"!=typeof t)return o=r?`${r}.${n}`:n,void(i[o]=r);for(const n in t)"object"==typeof t[n]&&"undefined"!==t[n]?(o=r?`${r}.${n}`:n,i[o]=r,e(t[n],o,i)):(o=r?`${r}.${n}`:n,i[o]=r)},t.mapField=function e(t,r,n){if(n[r])return;const o=(r=(r=r.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),s=r;if(!n.hasOwnProperty(s)){let e=null;o.length>1&&(o.pop(),e=o.join(".")),n[s]=e}const a=i(t,s);if("undefined"===a)return;if("object"==typeof a)for(const r in a)e(t,`${s}.${r}`,n)},t.checkForObjectChange=function(e,t,r){const n=i(e,t);if(null===n)return!1;if("object"==typeof n)return o(r,t);if("object"!=typeof n&&"object"==typeof t)return o(r,t);return null},t.setPath=void 0;function o(e,t){const r=[];for(const n in e){const i=t+".";n.includes(i)&&(r.push(n),delete e[n])}return r}t.setPath=(e,t,r)=>t.split(".").reduce((e,n)=>e[n]=t.split(".").pop()===n?r:e[n]||{},e)},function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(13),l=o(r(64)),u=s(r(1)),c=window;t.default=class{constructor(e,t){this.values={},this.listeners=[],this.registeredDispatchListeners=[],this.mapping={},this.Dispatcher={register:e=>{this.registeredDispatchListeners.push(e)},dispatch:e=>{this.isGlobal?this.routerClient.transmit("storeService.dispatch."+this.name,e):this.handleDispatchedMessages(null,{data:e})}},this.handleChanges=(e,t)=>{if(e&&u.default.system.error("DistributedStoreClient",e),!t.data.store)return;t.data.field||(t.data.field=null);const r=this.name+(t.data.field?"."+t.data.field:""),n=t.data.storeData?t.data.storeData:t.data.value;this.triggerListeners(r,n)},this.routerClient=t,this.isGlobal=e.global,this.name=e.store?e.store:"finsemble",e.values&&(this.values=e.values),this.lst=this.listeners,l.initObject(this.values,null,this.mapping),this.isGlobal&&this.routerClient.addListener("storeService.dispatch."+this.name,this.handleDispatchedMessages.bind(this))}handleDispatchedMessages(e,t){for(let e=0;e<this.registeredDispatchListeners.length;e++)this.registeredDispatchListeners[e](t.data)}setValue(e,t){if(e.field||u.default.system.error("DistributedStore.setValue:no field provided",e),e.hasOwnProperty("value")||u.default.system.error("DistributedStore.setValue:no value provided",e),this.isGlobal){const r={store:this.name,field:e.field,value:e.value};return c.distributedStoreClient.routerClient.query("storeService.setValue",r,e=>{if(t)return t(e)})}const r=l.checkForObjectChange(this.values,e.field,this.mapping);return l.setPath(this.values,e.field,e.value),l.mapField(this.values,e.field,this.mapping),r&&this.sendRemovals(r),this.triggerListeners(this.name,this),this.publishObjectUpdates(e.field,this.mapping),t?t(null):null}publishObjectUpdates(e,t){const r=t;for(;e;)this.triggerListeners(`${this.name}.${e}`,l.byString(this.values,e)),e=r[e]}sendRemovals(e){for(let t=0;t<e.length;t++)this.triggerListeners(`${this.name}.${e[t]}`,l.byString(this.values,e[t]))}setValues(e,t){return e?Array.isArray(e)?void a.each(e,(e,t)=>{this.setValue(e,t)},e=>t?t(e):null):u.default.system.error("DistributedStore.setValues:params must be an array"):u.default.system.error("DistributedStore.setValues:no params given")}getValue(e,t){if("string"==typeof e&&(e={field:e}),!e.field)return t?t("no field provided"):"no field provided";if(this.isGlobal)return this.getGlobalValue(e,t);const r=l.byString(this.values,e.field);return void 0!==r?t?t(null,r):r:t?t("couldn't find a value"):null}getValues(e,t){if(null===e&&(e=t),"function"==typeof e)return t=e,this.isGlobal?this.getGlobalValues(null,t):t?t(null,this.values):this.values;if(!Array.isArray(e))return this.getValue(e,t);if(this.isGlobal)return this.getGlobalValues(e,t);const r={};for(let t=0;t<e.length;t++){const n=e[t],i="string"==typeof n?n:n.field,o=l.byString(this.values,i);r[i]=o}return t?t(null,r):r}getGlobalValue(e,t){c.distributedStoreClient.routerClient.query("storeService.getValue",{store:this.name,field:e.field},(e,r)=>e?t(e):t(e,r.data))}getGlobalValues(e,t){c.distributedStoreClient.routerClient.query("storeService.getValues",{store:this.name,fields:e},(e,r)=>e?t(e):t(e,r.data))}removeValue(e,t){if(!e.field){if(void 0===e)return t("no field provided");e={field:e}}return e.value=null,this.setValue(e,t)}removeValues(e,t){if(!Array.isArray(e))return t("The passed in parameter needs to be an array");a.map(e,this.removeValue,(e,r)=>t(e,r))}destroy(e){const t={store:this.name,global:this.isGlobal};c.distributedStoreClient.removeStore(t,t=>t?e(t):e(null,!0))}changeSub(e){this.subs||(this.subs=[]),this.subs[e]||(this.isGlobal&&c.distributedStoreClient.routerClient.subscribe("storeService"+e,this.handleChanges),this.subs[e]=!0)}addListener(e,t,r){"function"==typeof e&&(t=e,e={});let{field:n}=e;const i=this.name+(n?"."+n:"");return this.listeners[i]?this.listeners[i].push(t):this.listeners[i]=[t],this.changeSub(i),r?r():null}addListeners(e,t,r){if(!Array.isArray(e))return this.addListener(e,t,r);for(let r=0;r<e.length;r++){let i=null;const o=e[r];var n;"string"==typeof o?i=o:o.field&&(({field:i}=o),n=e[r].listener);const s=this.name+(i?"."+i:"");n||t&&"function"==typeof t&&(n=t),this.listeners[s]?this.listeners[s].push(n):this.listeners[s]=[n],this.changeSub(s)}return r?r():null}removeListener(e,t,r){"function"==typeof e&&(r=t,t=e,e={});let{field:n}=e;const i=this.name+(n?"."+n:"");if(this.listeners[i])for(let e=0;e<this.listeners[i].length;e++)if(this.listeners[i][e]===t)return this.listeners[i].splice(e,1),r?r(null,!0):null;return r?r(null,!1):null}removeListeners(e,t,r){if(!Array.isArray(e))return"function"==typeof e?this.removeListener({},e,r):e.field&&this.removeListener(e,t,r),r("missing fields");let n=0;for(let r=0;r<e.length;r++){let o=null;const s=e[r];var i;"string"==typeof s?o=s:s.field&&(({field:o}=s),i=e[r].listener);const a=this.name+(o?"."+o:"");if(!i){if(!t||"function"!=typeof t)continue;i=t}for(let e=0;e<this.listeners[a].length;e++)this.listeners[a][e]===i&&(this.listeners[a].splice(e,1),n++)}return n<e.length?r("All listeners could not be found",!1):r?r(null,!0):null}triggerListeners(e,t){if(this.listeners[e])for(let r=0;r<this.listeners[e].length;r++)"function"==typeof this.listeners[e][r]?(u.default.system.debug("DistributedStore.triggerListeners",e,t),this.listeners[e][r](null,{field:e,value:t})):u.default.system.warn("DistributedStoreClient:triggerListeners: listener is not a function",e,r,this.listeners[e][r])}}},,,,,,,,,,,,function(e,t,r){"use strict";function n(e,t,r){var n=r?" !== ":" === ",i=r?" || ":" && ",o=r?"!":"",s=r?"":"!";switch(e){case"null":return t+n+"null";case"array":return o+"Array.isArray("+t+")";case"object":return"("+o+t+i+"typeof "+t+n+'"object"'+i+s+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+n+'"number"'+i+s+"("+t+" % 1)"+i+t+n+t+")";default:return"typeof "+t+n+'"'+e+'"'}}e.exports={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:n,checkDataTypes:function(e,t){switch(e.length){case 1:return n(e[0],t,!0);default:var r="",i=o(e);for(var s in i.array&&i.object&&(r=i.null?"(":"(!"+t+" || ",r+="typeof "+t+' !== "object")',delete i.null,delete i.array,delete i.object),i.number&&delete i.integer,i)r+=(r?" && ":"")+n(s,t,!0);return r}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],n=0;n<t.length;n++){var o=t[n];(i[o]||"array"===e&&"array"===o)&&(r[r.length]=o)}if(r.length)return r}else{if(i[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:o,getProperty:l,escapeQuotes:u,equal:r(89),ucs2length:r(142),varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},cleanUpCode:function(e){return e.replace(c,"").replace(f,"").replace(d,"if (!($1))")},finalCleanUpCode:function(e,t){var r=e.match(h);r&&2==r.length&&(e=t?e.replace(m,"").replace(v,"return data;"):e.replace(p,"").replace("return errors === 0;","validate.errors = null; return true;"));return(r=e.match(g))&&3===r.length?e.replace(y,""):e},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var n in e)if(n!=r&&t[n])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var r in e)if(!t[r])return r},toQuotedString:b,getPathExpr:function(e,t,r,n){return _(e,r?"'/' + "+t+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){var n=b(r?"/"+E(t):l(t));return _(e,n)},getData:function(e,t,r){var n,i,o,s;if(""===e)return"rootData";if("/"==e[0]){if(!S.test(e))throw new Error("Invalid JSON-pointer: "+e);i=e,o="rootData"}else{if(!(s=e.match(w)))throw new Error("Invalid JSON-pointer: "+e);if(n=+s[1],"#"==(i=s[2])){if(n>=t)throw new Error("Cannot access property/index "+n+" levels up, current level is "+t);return r[t-n]}if(n>t)throw new Error("Cannot access data "+n+" levels up, current level is "+t);if(o="data"+(t-n||""),!i)return o}for(var a=o,u=i.split("/"),c=0;c<u.length;c++){var f=u[c];f&&(o+=l(C(f)),a+=" && "+o)}return a},unescapeFragment:function(e){return C(decodeURIComponent(e))},unescapeJsonPointer:C,escapeFragment:function(e){return encodeURIComponent(E(e))},escapeJsonPointer:E};var i=o(["string","number","integer","boolean","null"]);function o(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var s=/^[a-z$_][a-z$_0-9]*$/i,a=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":s.test(e)?"."+e:"['"+u(e)+"']"}function u(e){return e.replace(a,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var c=/else\s*{\s*}/g,f=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,d=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g;var h=/[^v.]errors/g,p=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,m=/var errors = 0;|var vErrors = null;/g,v=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,g=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,y=/if \(rootData === undefined\) rootData = data;/;function b(e){return"'"+u(e)+"'"}var S=/^\/(?:[^~]|~0|~1)*$/,w=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function _(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function E(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function C(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},,,,function(e,t,r){(function(t){var r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,u=a||l||Function("return this")(),c=Object.prototype.toString,f=Math.max,d=Math.min,h=function(){return u.Date.now()};function p(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(p(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=p(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var a=i.test(e);return a||o.test(e)?s(e.slice(2),a?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,r){var n,i,o,s,a,l,u=0,c=!1,v=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var r=n,o=i;return n=i=void 0,u=t,s=e.apply(o,r)}function b(e){return u=e,a=setTimeout(w,t),c?y(e):s}function S(e){var r=e-l;return void 0===l||r>=t||r<0||v&&e-u>=o}function w(){var e=h();if(S(e))return _(e);a=setTimeout(w,function(e){var r=t-(e-l);return v?d(r,o-(e-u)):r}(e))}function _(e){return a=void 0,g&&n?y(e):(n=i=void 0,s)}function E(){var e=h(),r=S(e);if(n=arguments,i=this,l=e,r){if(void 0===a)return b(l);if(v)return a=setTimeout(w,t),y(l)}return void 0===a&&(a=setTimeout(w,t)),s}return t=m(t)||0,p(r)&&(c=!!r.leading,o=(v="maxWait"in r)?f(m(r.maxWait)||0,t):o,g="trailing"in r?!!r.trailing:g),E.cancel=function(){void 0!==a&&clearTimeout(a),u=0,n=l=i=a=void 0},E.flush=function(){return void 0===a?s:_(h())},E}}).call(this,r(3))},,,,,,,function(e,t,r){"use strict";var n=r(141),i=r(89),o=r(77),s=r(101),a=r(143);function l(e,t,r){var n=this._refs[r];if("string"==typeof n){if(!this._refs[n])return l.call(this,e,t,n);n=this._refs[n]}if((n=n||this._schemas[r])instanceof s)return p(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var i,o,a,c=u.call(this,t,r);return c&&(i=c.schema,t=c.root,a=c.baseId),i instanceof s?o=i.validate||e.call(this,i.schema,t,void 0,a):void 0!==i&&(o=p(i,this._opts.inlineRefs)?i:e.call(this,i,t,void 0,a)),o}function u(e,t){var r=n.parse(t),i=v(r),o=m(this._getId(e.schema));if(0===Object.keys(e.schema).length||i!==o){var a=y(i),l=this._refs[a];if("string"==typeof l)return c.call(this,e,l,r);if(l instanceof s)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[a])instanceof s))return;if(l.validate||this._compile(l),a==y(t))return{schema:l,root:e,baseId:o};e=l}if(!e.schema)return;o=m(this._getId(e.schema))}return d.call(this,r,o,e.schema,e)}function c(e,t,r){var n=u.call(this,e,t);if(n){var i=n.schema,o=n.baseId;e=n.root;var s=this._getId(i);return s&&(o=b(o,s)),d.call(this,r,o,i,e)}}e.exports=l,l.normalizeId=y,l.fullPath=m,l.url=b,l.ids=function(e){var t=y(this._getId(e)),r={"":t},s={"":m(t,!1)},l={},u=this;return a(e,{allKeys:!0},(function(e,t,a,c,f,d,h){if(""!==t){var p=u._getId(e),m=r[c],v=s[c]+"/"+f;if(void 0!==h&&(v+="/"+("number"==typeof h?h:o.escapeFragment(h))),"string"==typeof p){p=m=y(m?n.resolve(m,p):p);var g=u._refs[p];if("string"==typeof g&&(g=u._refs[g]),g&&g.schema){if(!i(e,g.schema))throw new Error('id "'+p+'" resolves to more than one schema')}else if(p!=y(v))if("#"==p[0]){if(l[p]&&!i(e,l[p]))throw new Error('id "'+p+'" resolves to more than one schema');l[p]=e}else u._refs[p]=v}r[t]=m,s[t]=v}})),l},l.inlineRef=p,l.schema=u;var f=o.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function d(e,t,r,n){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var i=e.fragment.split("/"),s=1;s<i.length;s++){var a=i[s];if(a){if(void 0===(r=r[a=o.unescapeFragment(a)]))break;var l;if(!f[a]&&((l=this._getId(r))&&(t=b(t,l)),r.$ref)){var c=b(t,r.$ref),d=u.call(this,n,c);d&&(r=d.schema,n=d.root,t=d.baseId)}}}return void 0!==r&&r!==n.schema?{schema:r,root:n,baseId:t}:void 0}}var h=o.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function p(e,t){return!1!==t&&(void 0===t||!0===t?function e(t){var r;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if("object"==typeof(r=t[n])&&!e(r))return!1}else for(var i in t){if("$ref"==i)return!1;if("object"==typeof(r=t[i])&&!e(r))return!1}return!0}(e):t?function e(t){var r,n=0;if(Array.isArray(t)){for(var i=0;i<t.length;i++)if("object"==typeof(r=t[i])&&(n+=e(r)),n==1/0)return 1/0}else for(var o in t){if("$ref"==o)return 1/0;if(h[o])n++;else if("object"==typeof(r=t[o])&&(n+=e(r)+1),n==1/0)return 1/0}return n}(e)<=t:void 0)}function m(e,t){return!1!==t&&(e=y(e)),v(n.parse(e))}function v(e){return n.serialize(e).split("#")[0]+"#"}var g=/#\/?$/;function y(e){return e?e.replace(g,""):""}function b(e,t){return t=y(t),n.resolve(e,t)}},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";var n=r(88);function i(e,t,r){this.message=r||i.message(e,t),this.missingRef=n.url(e,t),this.missingSchema=n.normalizeId(n.fullPath(this.missingRef))}function o(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:o((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:o(i)},i.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(13),o=r(59),s=n(r(38)),a=n(r(6)),l=n(r(1)),u=n(r(22)),c=n(r(12));s.default.initialize(),u.default.initialize();class f extends o.BaseService{constructor(e){e&&void 0!==e||(e={}),e.hasOwnProperty("startupDependencies")||(e.startupDependencies={clients:["storageClient","configClient"]}),e.hasOwnProperty("shutdownDependencies")||(e.shutdownDependencies={services:["windowService"]}),super(e),this.name="preferencesService",this.userPreferences={},this.bindCorrectContext(),this.onBaseServiceReady(this.doInit),this.start()}createRouterEndpoints(){const e=this;a.default.addResponder("PreferencesService.getPreferences",(t,r)=>{this.serviceReady||l.default.system.error("PreferencesService invoked before ready",r),r.sendQueryResponse(t,e.userPreferences)}),a.default.addResponder("PreferencesService.setPreference",(e,t)=>{this.serviceReady||l.default.system.error("PreferencesService invoked before ready",t);const r=t.data;this.setPreference(r,e=>{t.sendQueryResponse(e,e?null:"success")})})}bindCorrectContext(){this.createRouterEndpoints=this.createRouterEndpoints.bind(this),this.doInit=this.doInit.bind(this),this.getPreferences=this.getPreferences.bind(this),this.initiateRetrievingPreferences=this.initiateRetrievingPreferences.bind(this),this.setPreference=this.setPreference.bind(this),this.setPreferencesOnConfigStore=this.setPreferencesOnConfigStore.bind(this)}doInit(e){const t=this;c.default.waitForBootStage("authentication","stageCompleted",()=>{(0,i.series)([function(e){t.createRouterEndpoints(),e()},function(e){t.initiateRetrievingPreferences(e)},function(e){t.setPreferencesOnConfigStore(e)}],()=>{t.serviceReady=!0,e()})})}getPreferences(e){e(null,this.userPreferences)}async initiateRetrievingPreferences(e){l.default.system.debug("initiateRetrievingPreferences"),c.default.waitForStartup("storageService",()=>{s.default.get({topic:"finsemble",key:"userPreferences"},(t,r)=>{if(l.default.system.debug("initiateRetrievingPreferences",r),t&&l.default.system.error(t),r){try{delete r["finsemble.components.Toolbar.window.dockable"],delete r["finsemble.components.Toolbar.window.options.resizable"],delete r["finsemble.components.Toolbar.window.monitor"]}catch(e){}this.userPreferences=r,l.default.system.log("APPLICATION LIFECYCLE:User Preferences Retrieved",r)}else l.default.system.log("APPLICATION LIFECYCLE:No user preferences found");e()})})}setPreference(e,t){const r=this;(0,i.parallel)([function(t){u.default.setValue(e,t)},function(t){r.userPreferences[e.field]=e.value,s.default.save({topic:"finsemble",key:"userPreferences",value:r.userPreferences},e=>{e&&l.default.system.error(e),t()})}],t)}setPreferencesOnConfigStore(e){const t=this;l.default.system.debug("PreferenceService: setPreferencesOnConfigStore");const r=Object.keys(t.userPreferences);r.length?(0,i.each)(r,(function(e,r){const n={field:e,value:t.userPreferences[e]};u.default.setValue(n,r)}),e):e()}}var d=new f({name:"preferencesService"});t.default=d,e.exports=t.default},,,,,,,,,,function(e,t,r){"use strict";var n=r(77);e.exports=function(e){n.copy(e,this)}},function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,n="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(r=t.cmp,function(e){return function(t,n){var i={key:t,value:e[t]},o={key:n,value:e[n]};return r(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,s;if(Array.isArray(t)){for(s="[",r=0;r<t.length;r++)r&&(s+=","),s+=e(t[r])||"null";return s+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=o.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(s="",r=0;r<l.length;r++){var u=l[r],c=e(t[u]);c&&(s&&(s+=","),s+=JSON.stringify(u)+":"+c)}return o.splice(a,1),"{"+s+"}"}}(e)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n="",i=!0===e.schema.$async,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),s=e.self._getId(e.schema);if(e.opts.strictKeywords){var a=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(a){var l="unknown keyword: "+a;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(n+=" var validate = ",i&&(e.async=!0,n+="async "),n+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",s&&(e.opts.sourceCode||e.opts.processCode)&&(n+=" /*# sourceURL="+s+" */ ")),"boolean"==typeof e.schema||!o&&!e.schema.$ref){var u=e.level,c=e.dataLevel,f=e.schema["false schema"],d=e.schemaPath+e.util.getProperty("false schema"),h=e.errSchemaPath+"/false schema",p=!e.opts.allErrors,m="data"+(c||""),v="valid"+u;if(!1===e.schema){e.isTop?p=!0:n+=" var "+v+" = false; ",(J=J||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'boolean schema is false' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";var g=n;n=J.pop(),!e.compositeRule&&p?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n+=i?" return data; ":" validate.errors = null; return true; ":n+=" var "+v+" = true; ";return e.isTop&&(n+=" }; return validate; "),n}if(e.isTop){var y=e.isTop;u=e.level=0,c=e.dataLevel=0,m="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}n+=" var vErrors = null; ",n+=" var errors = 0;     ",n+=" if (rootData === undefined) rootData = data; "}else{u=e.level,m="data"+((c=e.dataLevel)||"");if(s&&(e.baseId=e.resolve.url(e.baseId,s)),i&&!e.async)throw new Error("async schema in sync schema");n+=" var errs_"+u+" = errors;"}v="valid"+u,p=!e.opts.allErrors;var S="",w="",_=e.schema.type,E=Array.isArray(_);if(_&&e.opts.nullable&&!0===e.schema.nullable&&(E?-1==_.indexOf("null")&&(_=_.concat("null")):"null"!=_&&(_=[_,"null"],E=!0)),E&&1==_.length&&(_=_[0],E=!1),e.schema.$ref&&o){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(n+=" "+e.RULES.all.$comment.code(e,"$comment")),_){if(e.opts.coerceTypes)var C=e.util.coerceToTypes(e.opts.coerceTypes,_);var P=e.RULES.types[_];if(C||E||!0===P||P&&!X(P)){d=e.schemaPath+".type",h=e.errSchemaPath+"/type",d=e.schemaPath+".type",h=e.errSchemaPath+"/type";var O=E?"checkDataTypes":"checkDataType";if(n+=" if ("+e.util[O](_,m,!0)+") { ",C){var R="dataType"+u,A="coerced"+u;n+=" var "+R+" = typeof "+m+"; ","array"==e.opts.coerceTypes&&(n+=" if ("+R+" == 'object' && Array.isArray("+m+")) "+R+" = 'array'; "),n+=" var "+A+" = undefined; ";var T="",I=C;if(I)for(var j,L=-1,D=I.length-1;L<D;)j=I[L+=1],L&&(n+=" if ("+A+" === undefined) { ",T+="}"),"array"==e.opts.coerceTypes&&"array"!=j&&(n+=" if ("+R+" == 'array' && "+m+".length == 1) { "+A+" = "+m+" = "+m+"[0]; "+R+" = typeof "+m+";  } "),"string"==j?n+=" if ("+R+" == 'number' || "+R+" == 'boolean') "+A+" = '' + "+m+"; else if ("+m+" === null) "+A+" = ''; ":"number"==j||"integer"==j?(n+=" if ("+R+" == 'boolean' || "+m+" === null || ("+R+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==j&&(n+=" && !("+m+" % 1)"),n+=")) "+A+" = +"+m+"; "):"boolean"==j?n+=" if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+A+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+A+" = true; ":"null"==j?n+=" if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+A+" = null; ":"array"==e.opts.coerceTypes&&"array"==j&&(n+=" if ("+R+" == 'string' || "+R+" == 'number' || "+R+" == 'boolean' || "+m+" == null) "+A+" = ["+m+"]; ");n+=" "+T+" if ("+A+" === undefined) {   ",(J=J||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",n+=E?""+_.join(","):""+_,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=E?""+_.join(","):""+_,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";g=n;n=J.pop(),!e.compositeRule&&p?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  ";var F=c?"data"+(c-1||""):"parentData";n+=" "+m+" = "+A+"; ",c||(n+="if ("+F+" !== undefined)"),n+=" "+F+"["+(c?e.dataPathArr[c]:"parentDataProperty")+"] = "+A+"; } "}else{(J=J||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",n+=E?""+_.join(","):""+_,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=E?""+_.join(","):""+_,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";g=n;n=J.pop(),!e.compositeRule&&p?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}n+=" } "}}if(e.schema.$ref&&!o)n+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",p&&(n+=" } if (errors === ",n+=y?"0":"errs_"+u,n+=") { ",w+="}");else{var k=e.RULES;if(k)for(var N=-1,x=k.length-1;N<x;)if(X(P=k[N+=1])){if(P.type&&(n+=" if ("+e.util.checkDataType(P.type,m)+") { "),e.opts.useDefaults)if("object"==P.type&&e.schema.properties){f=e.schema.properties;var M=Object.keys(f);if(M)for(var $,V=-1,W=M.length-1;V<W;){if(void 0!==(z=f[$=M[V+=1]]).default){var U=m+e.util.getProperty($);if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+U;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else n+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(n+=" || "+U+" === null || "+U+" === '' "),n+=" ) "+U+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(z.default)+" ":n+=" "+JSON.stringify(z.default)+" ",n+="; "}}}else if("array"==P.type&&Array.isArray(e.schema.items)){var B=e.schema.items;if(B){L=-1;for(var z,q=B.length-1;L<q;)if(void 0!==(z=B[L+=1]).default){U=m+"["+L+"]";if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+U;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else n+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(n+=" || "+U+" === null || "+U+" === '' "),n+=" ) "+U+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(z.default)+" ":n+=" "+JSON.stringify(z.default)+" ",n+="; "}}}var H=P.rules;if(H)for(var Q,G=-1,Y=H.length-1;G<Y;)if(Z(Q=H[G+=1])){var K=Q.code(e,Q.keyword,P.type);K&&(n+=" "+K+" ",p&&(S+="}"))}if(p&&(n+=" "+S+" ",S=""),P.type&&(n+=" } ",_&&_===P.type&&!C)){n+=" else { ";var J;d=e.schemaPath+".type",h=e.errSchemaPath+"/type";(J=J||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",n+=E?""+_.join(","):""+_,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=E?""+_.join(","):""+_,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";g=n;n=J.pop(),!e.compositeRule&&p?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } "}p&&(n+=" if (errors === ",n+=y?"0":"errs_"+u,n+=") { ",w+="}")}}function X(e){for(var t=e.rules,r=0;r<t.length;r++)if(Z(t[r]))return!0}function Z(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,n=0;n<r.length;n++)if(void 0!==e.schema[r[n]])return!0}(t)}return p&&(n+=" "+w+" "),y?(i?(n+=" if (errors === 0) return data;           ",n+=" else throw new ValidationError(vErrors); "):(n+=" validate.errors = vErrors; ",n+=" return errors === 0;       "),n+=" }; return validate;"):n+=" var "+v+" = errors === errs_"+u+";",n=e.util.cleanUpCode(n),y&&(n=e.util.finalCleanUpCode(n,i)),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a;var h="maximum"==t,p=h?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[p],v=e.opts.$data&&m&&m.$data,g=h?"<":">",y=h?">":"<",b=void 0;if(v){var S=e.util.getData(m.$data,s,e.dataPathArr),w="exclusive"+o,_="exclType"+o,E="exclIsNumber"+o,C="' + "+(R="op"+o)+" + '";i+=" var schemaExcl"+o+" = "+S+"; ",i+=" var "+w+"; var "+_+" = typeof "+(S="schemaExcl"+o)+"; if ("+_+" != 'boolean' && "+_+" != 'undefined' && "+_+" != 'number') { ";var P;b=p;(P=P||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: '"+p+" should be boolean' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var O=i;i=P.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+O+"]); ":i+=" validate.errors = ["+O+"]; return false; ":i+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+_+" == 'number' ? ( ("+w+" = "+n+" === undefined || "+S+" "+g+"= "+n+") ? "+f+" "+y+"= "+S+" : "+f+" "+y+" "+n+" ) : ( ("+w+" = "+S+" === true) ? "+f+" "+y+"= "+n+" : "+f+" "+y+" "+n+" ) || "+f+" !== "+f+") { var op"+o+" = "+w+" ? '"+g+"' : '"+g+"='; ",void 0===a&&(b=p,u=e.errSchemaPath+"/"+p,n=S,d=v)}else{C=g;if((E="number"==typeof m)&&d){var R="'"+C+"'";i+=" if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" ( "+n+" === undefined || "+m+" "+g+"= "+n+" ? "+f+" "+y+"= "+m+" : "+f+" "+y+" "+n+" ) || "+f+" !== "+f+") { "}else{E&&void 0===a?(w=!0,b=p,u=e.errSchemaPath+"/"+p,n=m,y+="="):(E&&(n=Math[h?"min":"max"](m,a)),m===(!E||n)?(w=!0,b=p,u=e.errSchemaPath+"/"+p,y+="="):(w=!1,C+="="));R="'"+C+"'";i+=" if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+f+" "+y+" "+n+" || "+f+" !== "+f+") { "}}b=b||t,(P=P||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+R+", limit: "+n+", exclusive: "+w+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be "+C+" ",i+=d?"' + "+n:n+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";O=i;return i=P.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+O+"]); ":i+=" validate.errors = ["+O+"]; return false; ":i+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a,i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+f+".length "+("maxItems"==t?">":"<")+" "+n+") { ";var h=t,p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(h||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxItems"==t?"more":"fewer",i+=" than ",i+=d?"' + "+n+" + '":""+a,i+=" items' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var m=i;return i=p.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a;var h="maxLength"==t?">":"<";i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===e.opts.unicode?i+=" "+f+".length ":i+=" ucs2length("+f+") ",i+=" "+h+" "+n+") { ";var p=t,m=m||[];m.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be ",i+="maxLength"==t?"longer":"shorter",i+=" than ",i+=d?"' + "+n+" + '":""+a,i+=" characters' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var v=i;return i=m.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+v+"]); ":i+=" validate.errors = ["+v+"]; return false; ":i+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a,i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" Object.keys("+f+").length "+("maxProperties"==t?">":"<")+" "+n+") { ";var h=t,p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(h||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxProperties"==t?"more":"fewer",i+=" than ",i+=d?"' + "+n+" + '":""+a,i+=" properties' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var m=i;return i=p.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){e.exports=r(136)},function(e,t,r){"use strict";var n=r(7);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(59),o=n(r(6)),s=n(r(60)),a=r(9),l=r(137),u=r(138),c=n(r(1));r(91);var f=n(r(39)),d=r(13),h=n(r(12)),p=n(r(81));s.default.initialize(),c.default.start(),c.default.system.log("Starting Config Service");class m extends i.BaseService{constructor(e){super(e),this.configStore={},this.manifest={},this.listeners={},this.bindCorrectContext(),this.onBaseServiceReady(this.doInit),this.start()}createRouterEndpoints(){const e=this;o.default.addResponder("config.get",this.get),o.default.addResponder("config.set",this.set),o.default.addResponder("config.processAndSet",this.processAndSet),o.default.addPubSubResponder("Config.changeNotification",{newConfig:null,finsemble:this.manifest.finsemble}),o.default.addPubSubResponder(/configService*/,{}),o.default.addResponder("configService.getValue",(t,r)=>(e.serviceReady||c.default.system.error("configService invoked before ready",r),t?c.default.system.error(t):e.getValue(r.data,(e,t)=>{r.sendQueryResponse(e,t)}))),o.default.addResponder("configService.getValues",(t,r)=>(e.serviceReady||c.default.system.error("configService invoked before ready",r),t?c.default.system.error(t):e.getValues(r.data.fields,(e,t)=>{r.sendQueryResponse(e,t)}))),o.default.addResponder("configService.setValue",(t,r)=>{e.serviceReady||c.default.system.error("configService invoked before ready",r),e.setValue(r,e=>{r.sendQueryResponse(e,r.data)})}),o.default.addResponder("configService.setValues",(t,r)=>{e.serviceReady||c.default.system.error("configService invoked before ready",r),e.setValues(r,e=>{r.sendQueryResponse(e,r.data)})}),o.default.addResponder("configService.addListener",(t,r)=>{e.serviceReady||c.default.system.error("configService invoked before ready",r),e.addListener(r.data),r.sendQueryResponse(t,r.data)})}bindCorrectContext(){this.processFinsembleConfig=this.processFinsembleConfig.bind(this),this.processManifest=this.processManifest.bind(this),this.initializeDataStore=this.initializeDataStore.bind(this),this.doInit=this.doInit.bind(this),this.get=this.get.bind(this),this.set=this.set.bind(this),this.processAndSet=this.processAndSet.bind(this),this.getValue=this.getValue.bind(this),this.getValues=this.getValues.bind(this),this._setValue=this._setValue.bind(this),this.setValue=this.setValue.bind(this),this.setValues=this.setValues.bind(this),this.addListener=this.addListener.bind(this),this.handleListeners=this.handleListeners.bind(this),this.debounceValidateConfig=(0,p.default)(u.SchemaUtilInstance.validateConfig.bind(u.SchemaUtilInstance),6e3,{trailing:!1,leading:!0,maxWait:12e3})}doInit(e){const t=this;(0,d.series)([function(e){a.ConfigUtilInstance.getInitialManifest(r=>{t.processManifest(r,r=>{t.manifest=r,e()})})},async function(e){try{await l.DeprecatedConfigUtilInstance.modifyConfigBasedOnDeprecatedDefinitions("mainConfig",t.manifest),c.default.system.log("modifyConfigBasedOnDeprecatedDefinitions done")}catch(e){c.default.system.error("modifyConfigBasedOnDeprecatedDefinitions failed.  Error caught",e)}e()},async function(e){try{await u.SchemaUtilInstance.walkSchemaAndSetConfigDefaults(t.manifest)}catch(e){c.default.system.error("walkSchemaForDefaults failed.  Error caught",e)}e()},async function(e){c.default.system.debug("JSON Schema: initial validation");let r=await t.debounceValidateConfig(t.manifest,"#/definitions/ManifestSubschema");r&&c.default.system.error("Manifest Error: "+r),c.default.system.log("forceObjectsToLogger","APPLICATION LIFECYCLE:STARTUP: ************* FULL PROCESSED MANIFEST *************",t.manifest),console.log("APPLICATION LIFECYCLE:STARTUP: ************* FULL PROCESSED MANIFEST *************",t.manifest),o.default.transmit("ServiceManager.InitialManifestReceived",t.manifest),e()},function(e){s.default.onReady(e)},function(e){t.initializeDataStore(t.manifest,()=>{c.default.system.log("initializeDataStore complete"),t.createRouterEndpoints(),e()})},function(e){t.configStore.addListener({field:"finsemble"},async(e,r)=>{t.manifest.finsemble=r.value,c.default.system.log("forceObjectsToLogger","JSON Schema: store changed",t.manifest,r),await l.DeprecatedConfigUtilInstance.modifyConfigBasedOnDeprecatedDefinitions("dynamicConfig",t.manifest),await u.SchemaUtilInstance.walkSchemaAndSetConfigDefaults(t.manifest),t.debounceValidateConfig(t.manifest,"#/definitions/ManifestSubschema")}),e()}],()=>{t.serviceReady=!0,e()})}processFinsembleConfig(e,t){let{manifest:r,allowOverwrites:n,recursionLevel:i,finsembleConfigObject:o,replaceComponents:s,replaceServices:l,updateStore:u}=e;const p=this;let m=i;c.default.system.debug("forceObjectsToLogger","*** entering processFinsembleConfig ***",o,"recursionLevel",i);const v=/comment.*/;function g(e){let t=!1;for(const r in e)e[r].component&&e[r].component.category&&"system"===e[r].component.category||(c.default.system.debug("filterNonSystemComponents deleting",r),delete e[r],t=!0);return c.default.system.debug("filterNonSystemComponents after",e,t),t}function y(e){let t=!1;for(const r in e)e[r].category&&"system"===e[r].category||(c.default.system.debug("filterNonSystemServices deleting",r),delete e.key,t=!0);return c.default.system.debug("filterNonSystemServices after",e,t),t}function b(e,t,r){e&&p.configStore.setValue({field:t,value:r})}function S(e,t,n){m++,e=e||[],c.default.system.debug("forceObjectsToLogger","* processImportConfig *",e,"allowOverwrites",t),function o(f,d){if(c.default.system.debug("forceObjectsToLogger","processURL",f,"importCount",d),f>=d)c.default.system.debug("forceObjectsToLogger","---\x3e importing all URLs complete",i),n&&n(r);else{const n=e[f];a.ConfigUtilInstance.getFile(n,(e,a)=>{if(e){const t='"failed importing into finsemble config because of bad URL or illegal JSON. URL='+n;h.default.systemLog({error:!0},t),c.default.error("forceObjectsToLogger",t,e),o(++f,d)}else{c.default.system.debug("forceObjectsToLogger","---\x3e importing into finsemble config",n,"recursionLevel",i);const e={manifest:r,allowOverwrites:t,recursionLevel:m,finsembleConfigObject:a,replaceComponents:s,replaceServices:l,updateStore:u};p.processFinsembleConfig(e,e=>{c.default.system.debug("forceObjectsToLogger","updated manifest with configObject",n,e),o(++f,d)})}})}}(0,e.length)}if(a.ConfigUtilInstance.resolveConfigVariables(r.finsemble,o),(0,d.series)([function(e){S(o.importConfig,!0,e)},function(e){S(o.importThirdPartyConfig,!1,e)}],()=>{console.debug("preprocessing import config files done"),a.ConfigUtilInstance.resolveConfigVariables(r.finsemble,o);for(const e in o)if(v.test(e))c.default.system.debug("ignoring comment",e),delete o.key;else if("components"===e){if(n&&s){g(r.finsemble.components)&&u&&p.configStore.setValue({field:"finsemble.components",value:r.finsemble.components}),s=!1}else r.finsemble.components=r.finsemble.components||{};for(const e in o.components)c.default.system.debug("adding component",e),!n&&r.finsemble.components.hasOwnProperty(e)?console.warn("finsemble component config",e,"cannot be overwritten by third-party component config",o.components[e]):i>0&&r.finsemble.components.hasOwnProperty(e)?(c.default.system.info("finsemble component config",e,"is being overwritten by component config",o.components[e]),r.finsemble.components[e]=o.components[e],b(u,"finsemble.components."+e,o.components[e])):(r.finsemble.components[e]=o.components[e],b(u,"finsemble.components."+e,o.components[e]))}else if("services"===e){if(n&&l){y(r.finsemble.services)&&u&&p.configStore.setValue({field:"finsemble.services",value:r.finsemble.services}),l=!1}else r.finsemble.services=r.finsemble.services||{};for(const e in o.services)c.default.system.debug("adding service",e),!n&&r.finsemble.services.hasOwnProperty(e)?console.warn("finsemble service config",e,"cannot be overwritten by third-party service config",o.services[e]):i>0&&r.finsemble.services.hasOwnProperty(e)?(c.default.system.info("finsemble service config",e,"is being overwritten by service config",o.services[e]),r.finsemble.services[e]=o.services[e],b(u,"finsemble.services."+e,o.services[e])):(r.finsemble.services[e]=o.services[e],b(u,"finsemble.services."+e,o.services[e]))}else if("workspaceTemplates"===e){r.finsemble.workspaceTemplates=r.finsemble.workspaceTemplates||{};for(const e in o.workspaceTemplates)c.default.system.debug("adding template",e),!n&&r.finsemble.workspaceTemplates.hasOwnProperty(e)?console.warn("finsemble template config",e,"cannot be overwritten by third-party template config",o.workspaceTemplates[e]):i>0&&r.finsemble.workspaceTemplates.hasOwnProperty(e)?(c.default.system.info("finsemble template config",e,"is being overwritten by template config",o.workspaceTemplates[e]),r.finsemble.workspaceTemplates[e]=o.workspaceTemplates[e],b(u,"finsemble.workspaceTemplates."+e,o.workspaceTemplates[e])):(r.finsemble.workspaceTemplates[e]=o.workspaceTemplates[e],b(u,"finsemble.workspaceTemplates."+e,o.workspaceTemplates[e]))}else"importConfig"===e||"importThirdPartyConfig"===e||(c.default.system.debug("adding key",e),!n&&r.finsemble.hasOwnProperty(e)?console.warn("finsemble config property",e,"cannot be overwritten by third-party config"):i>0&&r.finsemble.hasOwnProperty(e)?(c.default.system.info("finsemble config property",e,"is being overwritten"),r.finsemble[e]=o[e],b(u,"finsemble."+e,o[e])):(r.finsemble[e]=o[e],b(u,"finsemble."+e,o[e])))}),i>50){const e="Configuration Error: importConfig may have a loop (recursion depth exceeded).";h.default.systemLog({error:!0},e),c.default.error(e);const t=a.ConfigUtilInstance.getDefault(r,"manifest.finsemble.notificationURL",r.finsemble.moduleRoot+"/components/system/notification/notification.html");f.default.alert("dev","ONCE-SINCE-STARTUP","FSBL-Internal-Config-Error",e,{url:t})}else(0,d.series)([function(e){S(o.importConfig,!0,e)},function(e){S(o.importThirdPartyConfig,!1,e)}],()=>{t(r)})}processManifest(e,t){if(void 0!==e.finsemble){const r={manifest:e,allowOverwrites:!0,recursionLevel:0,finsembleConfigObject:e.finsemble,replaceComponents:!1,replaceServices:!1,updateStore:!1};this.processFinsembleConfig(r,e=>{t(e)})}else{const e="'finsemble' property not found in manifest";h.default.systemLog({error:!0},e),c.default.error(e)}}initializeDataStore(e,t){const r=this;c.default.system.debug("initializeDataStore"),s.default.createStore({store:"Finsemble-Configuration-Store",global:!1,values:e},(e,n)=>{e?c.default.error("CreateStore Error",e):(r.configStore=n,console.log("initializeDataStore complete",r.configStore),c.default.system.log("initializeDataStore complete"),t())})}get(e,t){let r,n=null;function i(e,i){e?(n=`field ${r} error: ${e}`,c.default.system.warn(n),t.sendQueryResponse(n,null)):(c.default.system.log("get responseData",i),t.sendQueryResponse(n,i))}t.data&&t.data.hasOwnProperty("field")?(({field:r}=t.data),this.configStore.getValues({field:r},i)):this.configStore.getValues(i)}set(e,t){const r=this;t.data&&t.data.hasOwnProperty("field")?t.data.field.startsWith("finsemble.")?(r.configStore.setValues({field:t.data.field,value:t.data.value}),r.configStore.getValues({field:"field"},(function(e,r){if(e){var n=`field ${r} error: ${e}`;c.default.system.warn(n),t.sendQueryResponse(n,null)}else c.default.system.log("get responseData",r),t.sendQueryResponse(n,r)}))):t.sendQueryResponse("You cannot modify this part of the config",null):t.sendQueryResponse("Invalid Request",null)}processAndSet(e,t){const r=this,n=o.default.trustedMessage(t),{newConfig:i}=t.data,s=!!t.data.overwrite,a=!!t.data.replace;if(c.default.system.debug("forceObjectsToLogger","Config.processAndSet",n,i),s&&!n)t.sendQueryResponse("Config.processAndSet Rejected: only same domain components using default SharedWorker transport can overwrite config",null);else{const e={manifest:r.manifest,allowOverwrites:s,recursionLevel:0,finsembleConfigObject:i,replaceComponents:a,replaceServices:a,updateStore:!0};r.processFinsembleConfig(e,e=>{c.default.system.log("forceObjectsToLogger","Config.processAndSet revised manifest",e),r.configStore.setValue({field:"finsemble.configSetDone",value:!0},()=>{t.sendQueryResponse(null,e.finsemble)}),o.default.publish("Config.changeNotification",{newConfig:i,finsemble:e.finsemble})})}}getValue(e,t){this.configStore.getValue(e,t)}getValues(e,t){if(!e)return this.configStore.getValues(t);this.configStore.getValues(e,t)}_setValue(e,t){this.configStore.setValue(e,t)}setValue(e,t){o.default.trustedMessage(e)?this._setValue(e.data,t):t("setValue failed. Only trusted (root domain) sources can set config.")}setValues(e,t){o.default.trustedMessage(e)?(0,d.each)(e.data,(e,t)=>{this._setValue(e,t)},e=>{t(e)}):t("setValues failed. Only trusted (root domain) sources can set config.")}addListener(e){this.listeners[e]||(this.listeners[e]=!0,this.configStore.addListener("configService"==e?null:{field:e.replace("configService.","")},this.handleListeners))}handleListeners(e,t){t.field=t.field.replace("Finsemble-Configuration-Store","configService"),o.default.publish(t.field,t)}}var v=new m({name:"configService"});t.default=v,e.exports=t.default},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DeprecatedConfigUtilInstance=t.SINGLE_PATH_OPERATIONS=void 0;const a=s(r(1)),l=o(r(11));t.SINGLE_PATH_OPERATIONS=["setValue","removeProperty","logMessage"];t.DeprecatedConfigUtilInstance=new class{getChildPropertyValue(e,t,r){let n;if(t.includes("[")){let i=(t=t.replace("]","[")).split("[");if(3!==i.length)throw new Error(`"illegal array syntax ${t} within ${r} so skipping`);{let t=i[0],o=i[1];if(n=e[t][o],void 0===n)throw new Error(`"undefined array element ${t}[${o}] within ${r} so skipping`)}}else n=e[t];return n}setChildPropertyValue(e,t,r,n,i){let o;if(o="object"==typeof r&&n?l.clone(r):r,t.includes("[")){let r=(t=t.replace("]","[")).split("[");if(3!==r.length)throw new Error(`"illegal array syntax ${t} within ${i} so skipping`);{let t=r[0],n=r[1];if(void 0===e[t][n])throw new Error(`"undefined array element ${t}[${n}] within ${i} so skipping`);e[t][n]=o}}else e[t]=o}findConfigPropertyValue(e,t){let r,n,i;if(t)for(r=e,i=t.split("."),n=0;n<i.length&&(r=this.getChildPropertyValue(r,i[n],t),"object"==typeof r);n++);return n<i.length-1&&(r=void 0),a.default.system.debug("DeprecatedConfigUtil.findConfigParent",t,r),r}findConfigParent(e,t){let r=t.split("."),n=e;for(let e=0;e<r.length-1;e++)r[e].includes("[")||n[r[e]]||(n[r[e]]={}),n=this.getChildPropertyValue(n,r[e],t);return a.default.system.debug("DeprecatedConfigUtil.findConfigParent",t,n),n}getLastPathProperty(e){let t=e.split(".").pop();return a.default.system.debug("DeprecatedConfigUtil.getLastPathProperty",e,t),t}copyObjectProperties(e,t,r){let n;n="object"==typeof t&&r?l.clone(t):t,Object.assign(e,n)}systemLog(e){let t=a.default.system.warn;return"error"===e&&(t=a.default.system.error),t}moveConfigProperty(e,t){let r=this.findConfigPropertyValue(e,t.oldProperty);if(void 0!==r){let n=this.findConfigParent(e,t.newProperty),i=this.getLastPathProperty(t.newProperty);if(t.addToExistingObject&&"object"==typeof n[i]&&!Array.isArray(n[i])?this.copyObjectProperties(n[i],r,t.clone):this.setChildPropertyValue(n,i,r,t.clone,t.newProperty),this.systemLog(t.userMessageType)(`${t.versionDeprecated} deprecated config ${t.oldProperty} was found and updated to ${t.newProperty}`),t.removeOld){delete this.findConfigParent(e,t.oldProperty)[this.getLastPathProperty(t.oldProperty)],a.default.system.log(`"DeprecatedConfig: ${t.oldProperty} removed`)}}else a.default.system.warn(`"DeprecatedConfig: ${t.oldProperty} not found so skipped`,t)}setPropertyValue(e,t){let r=this.findConfigPropertyValue(e,t.property);if(!t.ifOldValue||t.ifOldValue===r){this.findConfigParent(e,t.property)[this.getLastPathProperty(t.property)]=t.newValue,this.systemLog(t.userMessageType)(`${t.versionDeprecated} deprecated config value for ${t.property} set to ${t.newValue}`)}}removeProperty(e,t){let r=this.findConfigParent(e,t.property),n=this.getLastPathProperty(t.property);void 0!==r[n]&&(delete r[n],this.systemLog(t.userMessageType)(`${t.versionDeprecated} deprecated config property ${t.property} removed`))}getWildCardListItems(e,t){let r=[],n=e;if(t.includes("*")){let e=t.split(".");for(let t=0;t<e.length;t++){if("*"===e[t]){"object"==typeof n&&(r=Object.keys(n));break}if(n=n[e[t]],"object"!=typeof n)break}}return r}wildCardMismatch(e,t){let r,n=e.indexOf("*"),i=e.indexOf("*");if(-1===n)r=!1;else{r=e.substring(0,n)!==t.substring(0,i)}return r}displayDeprecationMessage(e,t){null!=this.findConfigPropertyValue(e,t.property)&&this.systemLog(t.userMessageType)(`${t.versionDeprecated} deprecated config found for ${t.property}. ${t.userMessage}`)}processDeprecatedProperty(e,r,n){try{let i;if(void 0===n.when||n.when[e])if(n.set)if(Array.isArray(n.set)){let t=n.set;delete n.set;for(let i=0;i<t.length;i++){let o=Object.keys(t[i]);for(let e=0;e<o.length;e++)n[o[e]]=t[i][o[e]];this.processDeprecatedProperty(e,r,n)}}else a.default.system.log("DeprecatedConfigUtil.processDeprecatedProperty skipping illegal set operation",n);else if(t.SINGLE_PATH_OPERATIONS.includes(n.operation))if(i=this.getWildCardListItems(r,n.property),0===i.length)switch(n.operation){case"setValue":a.default.system.debug("DeprecatedConfigUtil.setValue for property "+n.property,n),this.setPropertyValue(r,n);break;case"removeProperty":a.default.system.debug("DeprecatedConfigUtil.removeProperty for "+n.property,n),this.removeProperty(r,n);break;case"logMessage":a.default.system.debug("DeprecatedConfigUtil.logMessageOnly for "+n.property,n),this.displayDeprecationMessage(r,n)}else{let t,o=n.property.slice();for(;t=i.pop();)n.property=o.replace(".*.",`.${t}.`),this.processDeprecatedProperty(e,r,n)}else if("moveProperty"===n.operation)if(this.wildCardMismatch(n.oldProperty,n.newProperty))a.default.system.warn(`DeprecatedConfig: wildCards are mismatched for ${n.oldProperty} and ${n.newProperty} so ignoring`,n);else if(i=this.getWildCardListItems(r,n.newProperty),0===i.length)a.default.system.debug(`DeprecatedConfigUtil.moveProperty from ${n.oldProperty} to ${n.newProperty}`,n),this.moveConfigProperty(r,n);else{let t,o=n.oldProperty.slice(),s=n.newProperty.slice();for(;t=i.pop();)n.oldProperty=o.replace(".*.",`.${t}.`),n.newProperty=s.replace(".*.",`.${t}.`),this.processDeprecatedProperty(e,r,n)}else a.default.system.warn("DeprecatedConfigUtil.processDeprecatedProperty skipping unknown operation",n);else a.default.system.log("DeprecatedConfigUtil.processDeprecatedProperty skipping item because wrong context",n)}catch(e){a.default.system.error("DeprecatedConfig: error caught: "+e,n)}}modifyConfigBasedOnDeprecatedDefinitions(e,t){if(Array.isArray(t.finsemble.deprecatedConfig)){let r=t.finsemble.deprecatedConfig;for(let n=0;n<r.length;n++)a.default.system.debug("DeprecatedConfigUtil.modifyConfigBasedOnDeprecatedDefinitions processing",e,r[n]),this.processDeprecatedProperty(e,t,r[n])}return!0}}},function(e,t,r){"use strict";
/*!
 * Copyright 2017 - 2020 by ChartIQ, Inc.
 * All rights reserved.
 */var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaUtilInstance=void 0;const i=n(r(1)),o=r(9),s=n(r(139));t.SchemaUtilInstance=new class{constructor(){this.generatedDocLines=[],this.knownPropertiesMap={},this.previousLevel=0}formatValidationErrors(e){let t={errorList:[],errorListWithMoreDetails:e};for(let r=0;r<e.length;r++){let n={configPathOfError:e[r].dataPath,errorMessage:e[r].message,errorData:JSON.stringify(e[r].params)};t.errorList.push(n)}return t}schemaValidate(e,t,r,n){let o=!1;try{var s=e.getSchema(r);s(n)?(console.log("JSON Schema Validation: No Errors"),i.default.system.log("JSON Schema Validation: Done With No Errors"),o=!0):i.default.system.error("forceObjectsToLogger","JSON Schema Validation Errors",this.formatValidationErrors(s.errors),"manifest",n,"schema",t)}catch(e){console.log("schemaValidate catch: ",e,t,n),i.default.system.error("forceObjectsToLogger","schemaValidate catch",e,t,n)}return o}async validateConfig(e,t){console.log("JSON Schema Validation: validateConfig",t,e),i.default.system.debug("forceObjectsToLogger","JSON Schema Validation: validateConfig",t,e);let r=null,n=!1,a={allErrors:!0,verbose:!0,useDefaults:"empty"};if(this.finsembleSchema&&this.ajv)n=!0;else try{this.finsembleSchema=await o.ConfigUtilInstance.getFile(e.finsemble.configSchemaURL,e=>{e&&console.error("getFile error: "+e)}),this.ajv=new s.default(a),this.ajv.addSchema(this.finsembleSchema,"Finsemble"),n=!0}catch(e){i.default.system.error("validateConfig: Error thrown reading or adding schema: "+e)}return n?(i.default.system.debug("ConfigService: schema read",this.finsembleSchema),this.schemaValidate(this.ajv,this.finsembleSchema,t,e)||(r="Failure validating config against schema")):(i.default.system.error("Failure reading config schema. Confirm the schema URL configured in finsemble.configSchemaURL is correct and the file contains a valid JSON schema."),r="Failure reading config schema"),r}setDefaultForForOneProperty(e,t,r){i.default.system.debug(`setDefaultForForOneProperty: ${t}=${r}`);let n=null,o=e,s=t.split("%%");for(let e=1;e<s.length-1;e++){let t=s[e];if(t.includes("%&%")){let e=t.split("%&%"),r=e[0],n=e[1];o=o[r][n]}else o[t]||(o[t]={}),o=o[t]}let a=s[s.length-1];n=o[a],void 0===n&&(o[a]=r,i.default.system.debug(`config-default-set property: path=${t}, originalPropertyValue=${n} defaultValue=${r},`))}getAdditionalProperties(e,t){i.default.system.debug("getAdditionalProperties for "+t);let r=e,n=t.split("%%");for(let e=1;e<n.length;e++){let t=n[e];r[t]||(r[t]={}),r=r[t]}let o=Object.keys(r),s=[];for(let e of o){let r=`${t}%%${e}`;this.knownPropertiesMap[r]||s.push(e)}return i.default.system.debug("getAdditionalProperties-additionalProperties for "+t,s,o),s}getLengthOfArrayInConfig(e,t){i.default.system.debug("getLengthOfArrayInConfig for "+t);let r=0,n=e,o=t.split("%%");for(let e=1;e<o.length;e++){let t=o[e];if(t.includes("%&%")){let e=t.split("%&%"),r=e[0],i=e[1];n=n[r][i]}else n=n[t];if(!n)break}return n&&Array.isArray(n)&&(r=n.length,i.default.system.debug(`getLengthOfArrayInConfig value is ${r} for path=${t}`,n)),r}recursiveWalkerForDefaults(e,t,r,n,o,s){if(i.default.system.verbose(`recursiveWalkerForDefaults: level ${s} path=${o} default=${r}`),r instanceof Object&&"forceDefaults"in r&&(t=r.forceDefaults),r.default&&t&&this.setDefaultForForOneProperty(e,o,r.default),++s>=50)i.default.system.warn(`recursiveWalkerForDefaults stopped due to excessive schema depth although could be a valid circular dependency: level ${s} path=${o} default=${r}`);else{if(r.$ref){let i=r.$ref.replace("#/definitions/","");this.recursiveWalkerForDefaults(e,t,this.finsembleSchema.definitions[i],n,""+o,--s)}if(r.items){"array"===r.type||Array.isArray(r.type)||i.default.system.error("recursiveWalkerForDefaults expected items of type array for "+o,r);let a=this.getLengthOfArrayInConfig(e,o);for(let l=0;l<a;l++){let a=`${o}%&%${l}`;i.default.system.debug("processing items for "+a,r.items),this.recursiveWalkerForDefaults(e,t,r.items,n,""+a,s)}}if(r.properties){let i=Object.keys(r.properties);for(let a of i){let i=`${o}%%${a}`;a!=n&&"object"==typeof r.properties[a]&&(this.knownPropertiesMap[i]=!0,this.recursiveWalkerForDefaults(e,t,r.properties[a],a,""+i,s))}}if(r.additionalProperties){let a=this.getAdditionalProperties(e,o);for(let l=0;l<a.length;l++){let u=`${o}%%${a[l]}`;i.default.system.debug("processing additionalProperties for "+u,r.additionalProperties),this.recursiveWalkerForDefaults(e,t,r.additionalProperties,n,""+u,s)}}}--s}async initializeSchema(e){let t=!0;return this.finsembleSchema||(this.finsembleSchema=await o.ConfigUtilInstance.getFile(e)),this.finsembleSchema||(i.default.system.error("Failure reading config schema. Confirm the schema URL configured in finsemble.configSchemaURL is correct and the file contains a valid JSON schema."),t=!1),t}async walkSchemaAndSetConfigDefaults(e){i.default.system.debug("walkSchemaAndSetConfigDefaults Starting"),console.log("walkSchemaAndSetConfigDefaults",e);await this.initializeSchema(e.finsemble.configSchemaURL)?this.recursiveWalkerForDefaults(e,!0,this.finsembleSchema.definitions.ManifestSubschema,"ManifestSubschema","",0):i.default.system.error("Failure to initialize schema so config defaults not initialized."),i.default.system.debug("walkSchemaAndSetConfigDefaults Done")}}},function(e,t,r){"use strict";var n=r(140),i=r(88),o=r(144),s=r(101),a=r(102),l=r(145),u=r(146),c=r(167),f=r(77);e.exports=g,g.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var n=this._addSchema(e);r=n.validate||this._compile(n)}var i=r(t);!0!==r.$async&&(this.errors=r.errors);return i},g.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},g.prototype.addSchema=function(e,t,r,n){if(Array.isArray(e)){for(var o=0;o<e.length;o++)this.addSchema(e[o],void 0,r,n);return this}var s=this._getId(e);if(void 0!==s&&"string"!=typeof s)throw new Error("schema id must be string");return E(this,t=i.normalizeId(t||s)),this._schemas[t]=this._addSchema(e,r,n,!0),this},g.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},g.prototype.validateSchema=function(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(p)?p:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,e);if(!n&&t){var i="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(i);this.logger.error(i)}return n},g.prototype.getSchema=function(e){var t=y(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=i.schema.call(e,{schema:{}},t);if(r){var o=r.schema,a=r.root,l=r.baseId,u=n.call(e,o,a,void 0,l);return e._fragments[t]=new s({ref:t,fragment:!0,schema:o,root:a,baseId:l,validate:u}),u}}(this,e)}},g.prototype.removeSchema=function(e){if(e instanceof RegExp)return b(this,this._schemas,e),b(this,this._refs,e),this;switch(typeof e){case"undefined":return b(this,this._schemas),b(this,this._refs),this._cache.clear(),this;case"string":var t=y(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,n=r?r(e):e;this._cache.del(n);var o=this._getId(e);o&&(o=i.normalizeId(o),delete this._schemas[o],delete this._refs[o])}return this},g.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},g.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,n=void 0===t.dataVar?"data":t.dataVar,i="",o=0;o<e.length;o++){var s=e[o];s&&(i+=n+s.dataPath+" "+s.message+r)}return i.slice(0,-r.length)},g.prototype._addSchema=function(e,t,r,n){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var o=this._opts.serialize,a=o?o(e):e,l=this._cache.get(a);if(l)return l;n=n||!1!==this._opts.addUsedSchema;var u=i.normalizeId(this._getId(e));u&&n&&E(this,u);var c,f=!1!==this._opts.validateSchema&&!t;f&&!(c=u&&u==i.normalizeId(e.$schema))&&this.validateSchema(e,!0);var d=i.ids.call(this,e),h=new s({id:u,schema:e,localRefs:d,cacheKey:a,meta:r});"#"!=u[0]&&n&&(this._refs[u]=h);this._cache.put(a,h),f&&c&&this.validateSchema(e,!0);return h},g.prototype._compile=function(e,t){if(e.compiling)return e.validate=o,o.schema=e.schema,o.errors=null,o.root=t||o,!0===e.schema.$async&&(o.$async=!0),o;var r,i;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{i=n.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=i,e.refs=i.refs,e.refVal=i.refVal,e.root=i.root,i;function o(){var t=e.validate,r=t.apply(this,arguments);return o.errors=t.errors,r}},g.prototype.compileAsync=r(168);var d=r(169);g.prototype.addKeyword=d.add,g.prototype.getKeyword=d.get,g.prototype.removeKeyword=d.remove,g.prototype.validateKeyword=d.validate;var h=r(90);g.ValidationError=h.Validation,g.MissingRefError=h.MissingRef,g.$dataMetaSchema=c;var p="http://json-schema.org/draft-07/schema",m=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],v=["/properties"];function g(e){if(!(this instanceof g))return new g(e);e=this._opts=f.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:C,warn:C,error:C};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=l(e.format),this._cache=e.cache||new o,this._loadingSchemas={},this._compilations=[],this.RULES=u(),this._getId=function(e){switch(e.schemaId){case"auto":return _;case"id":return S;default:return w}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=a),this._metaOpts=function(e){for(var t=f.copy(e._opts),r=0;r<m.length;r++)delete t[m[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(e){var t;e._opts.$data&&(t=r(172),e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var n=r(108);e._opts.$data&&(n=c(n,v));e.addMetaSchema(n,p,!0),e._refs["http://json-schema.org/schema"]=p}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function y(e,t){return t=i.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function b(e,t,r){for(var n in t){var i=t[n];i.meta||r&&!r.test(n)||(e._cache.del(i.cacheKey),delete t[n])}}function S(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function w(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function _(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function E(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function C(){}},function(e,t,r){"use strict";var n=r(88),i=r(77),o=r(90),s=r(102),a=r(103),l=i.ucs2length,u=r(89),c=o.Validation;function f(e,t,r){var n=h.call(this,e,t,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:e,root:t,baseId:r},{index:n,compiling:!1})}function d(e,t,r){var n=h.call(this,e,t,r);n>=0&&this._compilations.splice(n,1)}function h(e,t,r){for(var n=0;n<this._compilations.length;n++){var i=this._compilations[n];if(i.schema==e&&i.root==t&&i.baseId==r)return n}return-1}function p(e,t){return"var pattern"+e+" = new RegExp("+i.toQuotedString(t[e])+");"}function m(e){return"var default"+e+" = defaults["+e+"];"}function v(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function g(e){return"var customRule"+e+" = customRules["+e+"];"}function y(e,t){if(!e.length)return"";for(var r="",n=0;n<e.length;n++)r+=t(n,e);return r}e.exports=function e(t,r,h,b){var S=this,w=this._opts,_=[void 0],E={},C=[],P={},O=[],R={},A=[];r=r||{schema:t,refVal:_,refs:E};var T=f.call(this,t,r,b),I=this._compilations[T.index];if(T.compiling)return I.callValidate=function e(){var t=I.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var j=this._formats,L=this.RULES;try{var D=k(t,r,h,b);I.validate=D;var F=I.callValidate;return F&&(F.schema=D.schema,F.errors=null,F.refs=D.refs,F.refVal=D.refVal,F.root=D.root,F.$async=D.$async,w.sourceCode&&(F.source=D.source)),D}finally{d.call(this,t,r,b)}function k(t,s,f,d){var h=!s||s&&s.schema==t;if(s.schema!=r.schema)return e.call(S,t,s,f,d);var b,P=!0===t.$async,R=a({isTop:!0,schema:t,isRoot:h,baseId:d,root:s,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:o.MissingRef,RULES:L,validate:a,util:i,resolve:n,resolveRef:N,usePattern:$,useDefault:V,useCustomRule:W,opts:w,formats:j,logger:S.logger,self:S});R=y(_,v)+y(C,p)+y(O,m)+y(A,g)+R,w.processCode&&(R=w.processCode(R));try{b=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",R)(S,L,j,r,_,O,A,u,l,c),_[0]=b}catch(e){throw S.logger.error("Error compiling schema, function code:",R),e}return b.schema=t,b.errors=null,b.refs=E,b.refVal=_,b.root=h?b:s,P&&(b.$async=!0),!0===w.sourceCode&&(b.source={code:R,patterns:C,defaults:O}),b}function N(t,i,o){i=n.url(t,i);var s,a,l=E[i];if(void 0!==l)return M(s=_[l],a="refVal["+l+"]");if(!o&&r.refs){var u=r.refs[i];if(void 0!==u)return M(s=r.refVal[u],a=x(i,s))}a=x(i);var c=n.call(S,k,r,i);if(void 0===c){var f=h&&h[i];f&&(c=n.inlineRef(f,w.inlineRefs)?f:e.call(S,f,r,h,t))}if(void 0!==c)return function(e,t){var r=E[e];_[r]=t}(i,c),M(c,a);!function(e){delete E[e]}(i)}function x(e,t){var r=_.length;return _[r]=t,E[e]=r,"refVal"+r}function M(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function $(e){var t=P[e];return void 0===t&&(t=P[e]=C.length,C[t]=e),"pattern"+t}function V(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return i.toQuotedString(e);case"object":if(null===e)return"null";var t=s(e),r=R[t];return void 0===r&&(r=R[t]=O.length,O[r]=e),"default"+r}}function W(e,t,r,n){if(!1!==S._opts.validateSchema){var i=e.definition.dependencies;if(i&&!i.every((function(e){return Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have all required keywords: "+i.join(","));var o=e.definition.validateSchema;if(o)if(!o(t)){var s="keyword schema is invalid: "+S.errorsText(o.errors);if("log"!=S._opts.validateSchema)throw new Error(s);S.logger.error(s)}}var a,l=e.definition.compile,u=e.definition.inline,c=e.definition.macro;if(l)a=l.call(S,t,r,n);else if(c)a=c.call(S,t,r,n),!1!==w.validateSchema&&S.validateSchema(a,!0);else if(u)a=u.call(S,n,e.keyword,t,r);else if(!(a=e.definition.validate))return;if(void 0===a)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var f=A.length;return A[f]=a,{code:"customRule"+f,validate:a}}}},function(e,t,r){
/** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function o(e){var n=t("[0-9]","[A-Fa-f]"),i=r(r("%[EFef]"+n+"%"+n+n+"%"+n+n)+"|"+r("%[89A-Fa-f]"+n+"%"+n+n)+"|"+r("%"+n+n)),o="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",s=t("[\\:\\/\\?\\#\\[\\]\\@]",o),a=e?"[\\uE000-\\uF8FF]":"[]",l=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),u=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),c=r(r(i+"|"+t(l,o,"[\\:]"))+"*"),f=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),d=r(f+"\\."+f+"\\."+f+"\\."+f),h=r(n+"{1,4}"),p=r(r(h+"\\:"+h)+"|"+d),m=r(r(h+"\\:")+"{6}"+p),v=r("\\:\\:"+r(h+"\\:")+"{5}"+p),g=r(r(h)+"?\\:\\:"+r(h+"\\:")+"{4}"+p),y=r(r(r(h+"\\:")+"{0,1}"+h)+"?\\:\\:"+r(h+"\\:")+"{3}"+p),b=r(r(r(h+"\\:")+"{0,2}"+h)+"?\\:\\:"+r(h+"\\:")+"{2}"+p),S=r(r(r(h+"\\:")+"{0,3}"+h)+"?\\:\\:"+h+"\\:"+p),w=r(r(r(h+"\\:")+"{0,4}"+h)+"?\\:\\:"+p),_=r(r(r(h+"\\:")+"{0,5}"+h)+"?\\:\\:"+h),E=r(r(r(h+"\\:")+"{0,6}"+h)+"?\\:\\:"),C=r([m,v,g,y,b,S,w,_,E].join("|")),P=r(r(l+"|"+i)+"+"),O=(r(C+"\\%25"+P),r(C+r("\\%25|\\%(?!"+n+"{2})")+P)),R=r("[vV]"+n+"+\\."+t(l,o,"[\\:]")+"+"),A=r("\\["+r(O+"|"+C+"|"+R)+"\\]"),T=r(r(i+"|"+t(l,o))+"*"),I=r(A+"|"+d+"(?!"+T+")|"+T),j=r("[0-9]*"),L=r(r(c+"@")+"?"+I+r("\\:"+j)+"?"),D=r(i+"|"+t(l,o,"[\\:\\@]")),F=r(D+"*"),k=r(D+"+"),N=r(r(i+"|"+t(l,o,"[\\@]"))+"+"),x=r(r("\\/"+F)+"*"),M=r("\\/"+r(k+x)+"?"),$=r(N+x),V=r(k+x),W="(?!"+D+")",U=(r(x+"|"+M+"|"+$+"|"+V+"|"+W),r(r(D+"|"+t("[\\/\\?]",a))+"*")),B=r(r(D+"|[\\/\\?]")+"*"),z=r(r("\\/\\/"+L+x)+"|"+M+"|"+V+"|"+W),q=r(u+"\\:"+z+r("\\?"+U)+"?"+r("\\#"+B)+"?"),H=r(r("\\/\\/"+L+x)+"|"+M+"|"+$+"|"+W),Q=r(H+r("\\?"+U)+"?"+r("\\#"+B)+"?");return r(q+"|"+Q),r(u+"\\:"+z+r("\\?"+U)+"?"),r(r("\\/\\/("+r("("+c+")@")+"?("+I+")"+r("\\:("+j+")")+"?)")+"?("+x+"|"+M+"|"+V+"|"+W+")"),r("\\?("+U+")"),r("\\#("+B+")"),r(r("\\/\\/("+r("("+c+")@")+"?("+I+")"+r("\\:("+j+")")+"?)")+"?("+x+"|"+M+"|"+$+"|"+W+")"),r("\\?("+U+")"),r("\\#("+B+")"),r(r("\\/\\/("+r("("+c+")@")+"?("+I+")"+r("\\:("+j+")")+"?)")+"?("+x+"|"+M+"|"+V+"|"+W+")"),r("\\?("+U+")"),r("\\#("+B+")"),r("("+c+")@"),r("\\:("+j+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,o),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,o),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,o),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,o),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,o,"[\\:\\@\\/\\?]",a),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,o,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,o),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,s),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+d+")$"),IPV6ADDRESS:new RegExp("^\\[?("+C+")"+r(r("\\%25|\\%(?!"+n+"{2})")+"("+P+")")+"?\\]?$")}}var s=o(!1),a=o(!0),l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=2147483647,c=/^xn--/,f=/[^\0-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function v(e){throw new RangeError(h[e])}function g(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}((e=e.replace(d,".")).split("."),t).join(".");return n+i}function y(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),r--)}else t.push(i)}return t}var b=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},S=function(e,t,r){var n=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;n+=36)e=p(e/35);return p(n+36*e/(e+38))},w=function(e){var t,r=[],n=e.length,i=0,o=128,s=72,a=e.lastIndexOf("-");a<0&&(a=0);for(var l=0;l<a;++l)e.charCodeAt(l)>=128&&v("not-basic"),r.push(e.charCodeAt(l));for(var c=a>0?a+1:0;c<n;){for(var f=i,d=1,h=36;;h+=36){c>=n&&v("invalid-input");var m=(t=e.charCodeAt(c++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>p((u-i)/d))&&v("overflow"),i+=m*d;var g=h<=s?1:h>=s+26?26:h-s;if(m<g)break;var y=36-g;d>p(u/y)&&v("overflow"),d*=y}var b=r.length+1;s=S(i-f,b,0==f),p(i/b)>u-o&&v("overflow"),o+=p(i/b),i%=b,r.splice(i++,0,o)}return String.fromCodePoint.apply(String,r)},_=function(e){var t=[],r=(e=y(e)).length,n=128,i=0,o=72,s=!0,a=!1,l=void 0;try{for(var c,f=e[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var d=c.value;d<128&&t.push(m(d))}}catch(e){a=!0,l=e}finally{try{!s&&f.return&&f.return()}finally{if(a)throw l}}var h=t.length,g=h;for(h&&t.push("-");g<r;){var w=u,_=!0,E=!1,C=void 0;try{for(var P,O=e[Symbol.iterator]();!(_=(P=O.next()).done);_=!0){var R=P.value;R>=n&&R<w&&(w=R)}}catch(e){E=!0,C=e}finally{try{!_&&O.return&&O.return()}finally{if(E)throw C}}var A=g+1;w-n>p((u-i)/A)&&v("overflow"),i+=(w-n)*A,n=w;var T=!0,I=!1,j=void 0;try{for(var L,D=e[Symbol.iterator]();!(T=(L=D.next()).done);T=!0){var F=L.value;if(F<n&&++i>u&&v("overflow"),F==n){for(var k=i,N=36;;N+=36){var x=N<=o?1:N>=o+26?26:N-o;if(k<x)break;var M=k-x,$=36-x;t.push(m(b(x+M%$,0))),k=p(M/$)}t.push(m(b(k,0))),o=S(i,A,g==h),i=0,++g}}}catch(e){I=!0,j=e}finally{try{!T&&D.return&&D.return()}finally{if(I)throw j}}++i,++n}return t.join("")},E=function(e){return g(e,(function(e){return f.test(e)?"xn--"+_(e):e}))},C=function(e){return g(e,(function(e){return c.test(e)?w(e.slice(4).toLowerCase()):e}))},P={};function O(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function R(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var s=parseInt(e.substr(r+4,2),16),a=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function A(e,t){function r(e){var r=R(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,O).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,O).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,O).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,O).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,O).replace(t.PCT_ENCODED,i)),e}function T(e){return e.replace(/^0*(.*)/,"$1")||"0"}function I(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=l(r,2)[1];return n?n.split(".").map(T).join("."):e}function j(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=l(r,3),i=n[1],o=n[2];if(i){for(var s=i.toLowerCase().split("::").reverse(),a=l(s,2),u=a[0],c=a[1],f=c?c.split(":").map(T):[],d=u.split(":").map(T),h=t.IPV4ADDRESS.test(d[d.length-1]),p=h?7:8,m=d.length-p,v=Array(p),g=0;g<p;++g)v[g]=f[g]||d[m+g]||"";h&&(v[p-1]=I(v[p-1],t));var y=v.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(y&&y.length>1){var S=v.slice(0,y.index),w=v.slice(y.index+y.length);b=S.join(":")+"::"+w.join(":")}else b=v.join(":");return o&&(b+="%"+o),b}return e}var L=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?a:s;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(L);if(i){D?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=j(I(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=P[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)A(r,n);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=E(r.host.replace(n.PCT_ENCODED,R).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}A(r,s)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function k(e,t){var r=!1!==t.iri?a:s,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(j(I(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"==typeof e.port&&(n.push(":"),n.push(e.port.toString(10))),n.length?n.join(""):void 0}var N=/^\.\.?\//,x=/^\/\.(\/|$)/,M=/^\/\.\.(\/|$)/,$=/^\/?(?:.|\n)*?(?=\/|$)/;function V(e){for(var t=[];e.length;)if(e.match(N))e=e.replace(N,"");else if(e.match(x))e=e.replace(x,"/");else if(e.match(M))e=e.replace(M,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match($);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?a:s,n=[],i=P[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?C(e.host):E(e.host.replace(r.PCT_ENCODED,R).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}A(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var o=k(e,t);if(void 0!==o&&("suffix"!==t.reference&&n.push("//"),n.push(o),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var l=e.path;t.absolutePath||i&&i.absolutePath||(l=V(l)),void 0===o&&(l=l.replace(/^\/\//,"/%2F")),n.push(l)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function U(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],i={};return n||(e=F(W(e,r),r),t=F(W(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=V(t.path||""),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=V(t.path||""),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=V(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=V(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function B(e,t){return e&&e.toString().replace(t&&t.iri?a.PCT_ENCODED:s.PCT_ENCODED,R)}var z={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},q={scheme:"https",domainHost:z.domainHost,parse:z.parse,serialize:z.serialize},H={},Q="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",G="[0-9A-Fa-f]",Y=r(r("%[EFef]"+G+"%"+G+G+"%"+G+G)+"|"+r("%[89A-Fa-f]"+G+"%"+G+G)+"|"+r("%"+G+G)),K=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),J=new RegExp(Q,"g"),X=new RegExp(Y,"g"),Z=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',K),"g"),ee=new RegExp(t("[^]",Q,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),te=ee;function re(e){var t=R(e);return t.match(J)?t:e}var ne={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,o={},s=r.query.split("&"),a=0,l=s.length;a<l;++a){var u=s[a].split("=");switch(u[0]){case"to":for(var c=u[1].split(","),f=0,d=c.length;f<d;++f)n.push(c[f]);break;case"subject":r.subject=B(u[1],t);break;case"body":r.body=B(u[1],t);break;default:i=!0,o[B(u[0],t)]=B(u[1],t)}}i&&(r.headers=o)}r.query=void 0;for(var h=0,p=n.length;h<p;++h){var m=n[h].split("@");if(m[0]=B(m[0]),t.unicodeSupport)m[1]=B(m[1],t).toLowerCase();else try{m[1]=E(B(m[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}n[h]=m.join("@")}return r},serialize:function(e,t){var r,n=e,o=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(o){for(var s=0,a=o.length;s<a;++s){var l=String(o[s]),u=l.lastIndexOf("@"),c=l.slice(0,u).replace(X,re).replace(X,i).replace(Z,O),f=l.slice(u+1);try{f=t.iri?C(f):E(B(f,t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}o[s]=c+"@"+f}n.path=o.join(",")}var d=e.headers=e.headers||{};e.subject&&(d.subject=e.subject),e.body&&(d.body=e.body);var h=[];for(var p in d)d[p]!==H[p]&&h.push(p.replace(X,re).replace(X,i).replace(ee,O)+"="+d[p].replace(X,re).replace(X,i).replace(te,O));return h.length&&(n.query=h.join("&")),n}},ie=/^([^\:]+)\:(.*)/,oe={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(ie),n=e;if(r){var i=t.scheme||n.scheme||"urn",o=r[1].toLowerCase(),s=r[2],a=i+":"+(t.nid||o),l=P[a];n.nid=o,n.nss=s,n.path=void 0,l&&(n=l.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),o=P[i];o&&(e=o.serialize(e,t));var s=e,a=e.nss;return s.path=(n||t.nid)+":"+a,s}},se=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ae={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(se)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};P[z.scheme]=z,P[q.scheme]=q,P[ne.scheme]=ne,P[oe.scheme]=oe,P[ae.scheme]=ae,e.SCHEMES=P,e.pctEncChar=O,e.pctDecChars=R,e.parse=F,e.removeDotSegments=V,e.serialize=W,e.resolveComponents=U,e.resolve=function(e,t,r){var n=function(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}({scheme:"null"},r);return W(U(F(e,n),F(t,n),n,!0),n)},e.normalize=function(e,t){return"string"==typeof e?e=W(F(e,t),t):"object"===n(e)&&(e=F(W(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=W(F(e,r),r):"object"===n(e)&&(e=W(e,r)),"string"==typeof t?t=W(F(t,r),r):"object"===n(t)&&(t=W(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?a.ESCAPE:s.ESCAPE,O)},e.unescapeComponent=B,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=0,n=e.length,i=0;i<n;)r++,(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<n&&56320==(64512&(t=e.charCodeAt(i)))&&i++;return r}},function(e,t,r){"use strict";var n=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,i,o,s,a,l,u,c,f){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var d in r(o,s,a,l,u,c,f),o){var h=o[d];if(Array.isArray(h)){if(d in n.arrayKeywords)for(var p=0;p<h.length;p++)e(t,r,i,h[p],s+"/"+d+"/"+p,a,s,d,o,p)}else if(d in n.propsKeywords){if(h&&"object"==typeof h)for(var m in h)e(t,r,i,h[m],s+"/"+d+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),a,s,d,o,m)}else(d in n.keywords||t.allKeys&&!(d in n.skipKeywords))&&e(t,r,i,h,s+"/"+d,a,s,d,o)}i(o,s,a,l,u,c,f)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};n.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},n.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},n.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},n.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,r){"use strict";var n=e.exports=function(){this._cache={}};n.prototype.put=function(e,t){this._cache[e]=t},n.prototype.get=function(e){return this._cache[e]},n.prototype.del=function(e){delete this._cache[e]},n.prototype.clear=function(){this._cache={}}},function(e,t,r){"use strict";var n=r(77),i=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31],s=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,a=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,u=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,c=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,f=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,d=/^(?:\/(?:[^~/]|~0|~1)*)*$/,h=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,p=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function m(e){return e="full"==e?"full":"fast",n.copy(m[e])}function v(e){var t=e.match(i);if(!t)return!1;var r=+t[1],n=+t[2],s=+t[3];return n>=1&&n<=12&&s>=1&&s<=(2==n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:o[n])}function g(e,t){var r=e.match(s);if(!r)return!1;var n=r[1],i=r[2],o=r[3],a=r[5];return(n<=23&&i<=59&&o<=59||23==n&&59==i&&60==o)&&(!t||a)}e.exports=m,m.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":u,url:c,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:a,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:w,uuid:f,"json-pointer":d,"json-pointer-uri-fragment":h,"relative-json-pointer":p},m.full={date:v,time:g,"date-time":function(e){var t=e.split(y);return 2==t.length&&v(t[0])&&g(t[1],!0)},uri:function(e){return b.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":u,url:c,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:a,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:w,uuid:f,"json-pointer":d,"json-pointer-uri-fragment":h,"relative-json-pointer":p};var y=/t|\s/i;var b=/\/|:/;var S=/[^\\]\\Z/;function w(e){if(S.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},function(e,t,r){"use strict";var n=r(147),i=r(77).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=i(t),e.types=i(["number","integer","string","array","object","boolean","null"]),e.forEach((function(r){r.rules=r.rules.map((function(r){var i;if("object"==typeof r){var o=Object.keys(r)[0];i=r[o],r=o,i.forEach((function(r){t.push(r),e.all[r]=!0}))}return t.push(r),e.all[r]={keyword:r,code:n[r],implements:i}})),e.all.$comment={keyword:"$comment",code:n.$comment},r.type&&(e.types[r.type]=r)})),e.keywords=i(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},function(e,t,r){"use strict";e.exports={$ref:r(148),allOf:r(149),anyOf:r(150),$comment:r(151),const:r(152),contains:r(153),dependencies:r(154),enum:r(155),format:r(156),if:r(157),items:r(158),maximum:r(104),minimum:r(104),maxItems:r(105),minItems:r(105),maxLength:r(106),minLength:r(106),maxProperties:r(107),minProperties:r(107),multipleOf:r(159),not:r(160),oneOf:r(161),pattern:r(162),properties:r(163),propertyNames:r(164),required:r(165),uniqueItems:r(166),validate:r(103)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i,o=" ",s=e.level,a=e.dataLevel,l=e.schema[t],u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(a||""),d="valid"+s;if("#"==l||"#/"==l)e.isRoot?(n=e.async,i="validate"):(n=!0===e.root.schema.$async,i="root.refVal[0]");else{var h=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===h){var p=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(p),(y=y||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(o+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(o+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),o+=" } "):o+=" {} ";var m=o;o=y.pop(),!e.compositeRule&&c?e.async?o+=" throw new ValidationError(["+m+"]); ":o+=" validate.errors = ["+m+"]; return false; ":o+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(o+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,p);e.logger.warn(p),c&&(o+=" if (true) { ")}}else if(h.inline){var v=e.util.copy(e);v.level++;var g="valid"+v.level;v.schema=h.schema,v.schemaPath="",v.errSchemaPath=l,o+=" "+e.validate(v).replace(/validate\.schema/g,h.code)+" ",c&&(o+=" if ("+g+") { ")}else n=!0===h.$async||e.async&&!1!==h.$async,i=h.code}if(i){var y;(y=y||[]).push(o),o="",e.opts.passContext?o+=" "+i+".call(this, ":o+=" "+i+"( ",o+=" "+f+", (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var b=o+=" , "+(a?"data"+(a-1||""):"parentData")+" , "+(a?e.dataPathArr[a]:"parentDataProperty")+", rootData)  ";if(o=y.pop(),n){if(!e.async)throw new Error("async schema referenced by sync schema");c&&(o+=" var "+d+"; "),o+=" try { await "+b+"; ",c&&(o+=" "+d+" = true; "),o+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(o+=" "+d+" = false; "),o+=" } ",c&&(o+=" if ("+d+") { ")}else o+=" if (!"+b+") { if (vErrors === null) vErrors = "+i+".errors; else vErrors = vErrors.concat("+i+".errors); errors = vErrors.length; } ",c&&(o+=" else { ")}return o}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),s=e.errSchemaPath+"/"+t,a=!e.opts.allErrors,l=e.util.copy(e),u="";l.level++;var c="valid"+l.level,f=l.baseId,d=!0,h=i;if(h)for(var p,m=-1,v=h.length-1;m<v;)p=h[m+=1],(e.opts.strictKeywords?"object"==typeof p&&Object.keys(p).length>0:e.util.schemaHasRules(p,e.RULES.all))&&(d=!1,l.schema=p,l.schemaPath=o+"["+m+"]",l.errSchemaPath=s+"/"+m,n+="  "+e.validate(l)+" ",l.baseId=f,a&&(n+=" if ("+c+") { ",u+="}"));return a&&(n+=d?" if (true) { ":" "+u.slice(0,-1)+" "),n=e.util.cleanUpCode(n)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d="errs__"+i,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level;if(s.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0:e.util.schemaHasRules(t,e.RULES.all)}))){var v=h.baseId;n+=" var "+d+" = errors; var "+f+" = false;  ";var g=e.compositeRule;e.compositeRule=h.compositeRule=!0;var y=s;if(y)for(var b,S=-1,w=y.length-1;S<w;)b=y[S+=1],h.schema=b,h.schemaPath=a+"["+S+"]",h.errSchemaPath=l+"/"+S,n+="  "+e.validate(h)+" ",h.baseId=v,n+=" "+f+" = "+f+" || "+m+"; if (!"+f+") { ",p+="}";e.compositeRule=h.compositeRule=g,n+=" "+p+" if (!"+f+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } "),n=e.util.cleanUpCode(n)}else u&&(n+=" if (true) { ");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.schema[t],o=e.errSchemaPath+"/"+t,s=(e.opts.allErrors,e.util.toQuotedString(i));return!0===e.opts.$comment?n+=" console.log("+s+");":"function"==typeof e.opts.$comment&&(n+=" self._opts.$comment("+s+", "+e.util.toQuotedString(o)+", validate.root.schema);"),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d=e.opts.$data&&s&&s.$data;d&&(n+=" var schema"+i+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; "),d||(n+=" var schema"+i+" = validate.schema"+a+";"),n+="var "+f+" = equal("+c+", schema"+i+"); if (!"+f+") {   ";var h=h||[];h.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to constant' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var p=n;return n=h.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d="errs__"+i,h=e.util.copy(e);h.level++;var p="valid"+h.level,m="i"+i,v=h.dataLevel=e.dataLevel+1,g="data"+v,y=e.baseId,b=e.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:e.util.schemaHasRules(s,e.RULES.all);if(n+="var "+d+" = errors;var "+f+";",b){var S=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=s,h.schemaPath=a,h.errSchemaPath=l,n+=" var "+p+" = false; for (var "+m+" = 0; "+m+" < "+c+".length; "+m+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var w=c+"["+m+"]";h.dataPathArr[v]=m;var _=e.validate(h);h.baseId=y,e.util.varOccurences(_,g)<2?n+=" "+e.util.varReplace(_,g,w)+" ":n+=" var "+g+" = "+w+"; "+_+" ",n+=" if ("+p+") break; }  ",e.compositeRule=h.compositeRule=S,n+="  if (!"+p+") {"}else n+=" if ("+c+".length == 0) {";var E=E||[];E.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should contain a valid item' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var C=n;return n=E.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+C+"]); ":n+=" validate.errors = ["+C+"]; return false; ":n+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { ",b&&(n+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(n+=" } "),n=e.util.cleanUpCode(n)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="errs__"+i,d=e.util.copy(e),h="";d.level++;var p="valid"+d.level,m={},v={},g=e.opts.ownProperties;for(w in s){var y=s[w],b=Array.isArray(y)?v:m;b[w]=y}n+="var "+f+" = errors;";var S=e.errorPath;for(var w in n+="var missing"+i+";",v)if((b=v[w]).length){if(n+=" if ( "+c+e.util.getProperty(w)+" !== undefined ",g&&(n+=" && Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(w)+"') "),u){n+=" && ( ";var _=b;if(_)for(var E=-1,C=_.length-1;E<C;){I=_[E+=1],E&&(n+=" || "),n+=" ( ( "+(F=c+(D=e.util.getProperty(I)))+" === undefined ",g&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(I)+"') "),n+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?I:D)+") ) "}n+=")) {  ";var P="missing"+i,O="' + "+P+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(S,P,!0):S+" + "+P);var R=R||[];R.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+O+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==b.length?n+="property "+e.util.escapeQuotes(b[0]):n+="properties "+e.util.escapeQuotes(b.join(", ")),n+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var A=n;n=R.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+A+"]); ":n+=" validate.errors = ["+A+"]; return false; ":n+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{n+=" ) { ";var T=b;if(T)for(var I,j=-1,L=T.length-1;j<L;){I=T[j+=1];var D=e.util.getProperty(I),F=(O=e.util.escapeQuotes(I),c+D);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(S,I,e.opts.jsonPointers)),n+=" if ( "+F+" === undefined ",g&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(I)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+O+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==b.length?n+="property "+e.util.escapeQuotes(b[0]):n+="properties "+e.util.escapeQuotes(b.join(", ")),n+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}n+=" }   ",u&&(h+="}",n+=" else { ")}e.errorPath=S;var k=d.baseId;for(var w in m){y=m[w];(e.opts.strictKeywords?"object"==typeof y&&Object.keys(y).length>0:e.util.schemaHasRules(y,e.RULES.all))&&(n+=" "+p+" = true; if ( "+c+e.util.getProperty(w)+" !== undefined ",g&&(n+=" && Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(w)+"') "),n+=") { ",d.schema=y,d.schemaPath=a+e.util.getProperty(w),d.errSchemaPath=l+"/"+e.util.escapeFragment(w),n+="  "+e.validate(d)+" ",d.baseId=k,n+=" }  ",u&&(n+=" if ("+p+") { ",h+="}"))}return u&&(n+="   "+h+" if ("+f+" == errors) {"),n=e.util.cleanUpCode(n)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d=e.opts.$data&&s&&s.$data;d&&(n+=" var schema"+i+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; ");var h="i"+i,p="schema"+i;d||(n+=" var "+p+" = validate.schema"+a+";"),n+="var "+f+";",d&&(n+=" if (schema"+i+" === undefined) "+f+" = true; else if (!Array.isArray(schema"+i+")) "+f+" = false; else {"),n+=f+" = false;for (var "+h+"=0; "+h+"<"+p+".length; "+h+"++) if (equal("+c+", "+p+"["+h+"])) { "+f+" = true; break; }",d&&(n+="  }  "),n+=" if (!"+f+") {   ";var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var v=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||"");if(!1===e.opts.format)return u&&(n+=" if (true) { "),n;var f,d=e.opts.$data&&s&&s.$data;d?(n+=" var schema"+i+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; ",f="schema"+i):f=s;var h=e.opts.unknownFormats,p=Array.isArray(h);if(d){n+=" var "+(m="format"+i)+" = formats["+f+"]; var "+(v="isObject"+i)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(g="formatType"+i)+" = "+v+" && "+m+".type || 'string'; if ("+v+") { ",e.async&&(n+=" var async"+i+" = "+m+".async; "),n+=" "+m+" = "+m+".validate; } if (  ",d&&(n+=" ("+f+" !== undefined && typeof "+f+" != 'string') || "),n+=" (","ignore"!=h&&(n+=" ("+f+" && !"+m+" ",p&&(n+=" && self._opts.unknownFormats.indexOf("+f+") == -1 "),n+=") || "),n+=" ("+m+" && "+g+" == '"+r+"' && !(typeof "+m+" == 'function' ? ",e.async?n+=" (async"+i+" ? await "+m+"("+c+") : "+m+"("+c+")) ":n+=" "+m+"("+c+") ",n+=" : "+m+".test("+c+"))))) {"}else{var m;if(!(m=e.formats[s])){if("ignore"==h)return e.logger.warn('unknown format "'+s+'" ignored in schema at path "'+e.errSchemaPath+'"'),u&&(n+=" if (true) { "),n;if(p&&h.indexOf(s)>=0)return u&&(n+=" if (true) { "),n;throw new Error('unknown format "'+s+'" is used in schema at path "'+e.errSchemaPath+'"')}var v,g=(v="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(v){var y=!0===m.async;m=m.validate}if(g!=r)return u&&(n+=" if (true) { "),n;if(y){if(!e.async)throw new Error("async format in sync schema");n+=" if (!(await "+(b="formats"+e.util.getProperty(s)+".validate")+"("+c+"))) { "}else{n+=" if (! ";var b="formats"+e.util.getProperty(s);v&&(b+=".validate"),n+="function"==typeof m?" "+b+"("+c+") ":" "+b+".test("+c+") ",n+=") { "}}var S=S||[];S.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",n+=d?""+f:""+e.util.toQuotedString(s),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match format \"",n+=d?"' + "+f+" + '":""+e.util.escapeQuotes(s),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=d?"validate.schema"+a:""+e.util.toQuotedString(s),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var w=n;return n=S.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+w+"]); ":n+=" validate.errors = ["+w+"]; return false; ":n+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d="errs__"+i,h=e.util.copy(e);h.level++;var p="valid"+h.level,m=e.schema.then,v=e.schema.else,g=void 0!==m&&(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0:e.util.schemaHasRules(m,e.RULES.all)),y=void 0!==v&&(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0:e.util.schemaHasRules(v,e.RULES.all)),b=h.baseId;if(g||y){var S;h.createErrors=!1,h.schema=s,h.schemaPath=a,h.errSchemaPath=l,n+=" var "+d+" = errors; var "+f+" = true;  ";var w=e.compositeRule;e.compositeRule=h.compositeRule=!0,n+="  "+e.validate(h)+" ",h.baseId=b,h.createErrors=!0,n+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=h.compositeRule=w,g?(n+=" if ("+p+") {  ",h.schema=e.schema.then,h.schemaPath=e.schemaPath+".then",h.errSchemaPath=e.errSchemaPath+"/then",n+="  "+e.validate(h)+" ",h.baseId=b,n+=" "+f+" = "+p+"; ",g&&y?n+=" var "+(S="ifClause"+i)+" = 'then'; ":S="'then'",n+=" } ",y&&(n+=" else { ")):n+=" if (!"+p+") { ",y&&(h.schema=e.schema.else,h.schemaPath=e.schemaPath+".else",h.errSchemaPath=e.errSchemaPath+"/else",n+="  "+e.validate(h)+" ",h.baseId=b,n+=" "+f+" = "+p+"; ",g&&y?n+=" var "+(S="ifClause"+i)+" = 'else'; ":S="'else'",n+=" } "),n+=" if (!"+f+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+S+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match \"' + "+S+" + '\" schema' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" }   ",u&&(n+=" else { "),n=e.util.cleanUpCode(n)}else u&&(n+=" if (true) { ");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d="errs__"+i,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level,v="i"+i,g=h.dataLevel=e.dataLevel+1,y="data"+g,b=e.baseId;if(n+="var "+d+" = errors;var "+f+";",Array.isArray(s)){var S=e.schema.additionalItems;if(!1===S){n+=" "+f+" = "+c+".length <= "+s.length+"; ";var w=l;l=e.errSchemaPath+"/additionalItems",n+="  if (!"+f+") {   ";var _=_||[];_.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+s.length+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have more than "+s.length+" items' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var E=n;n=_.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+E+"]); ":n+=" validate.errors = ["+E+"]; return false; ":n+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l=w,u&&(p+="}",n+=" else { ")}var C=s;if(C)for(var P,O=-1,R=C.length-1;O<R;)if(P=C[O+=1],e.opts.strictKeywords?"object"==typeof P&&Object.keys(P).length>0:e.util.schemaHasRules(P,e.RULES.all)){n+=" "+m+" = true; if ("+c+".length > "+O+") { ";var A=c+"["+O+"]";h.schema=P,h.schemaPath=a+"["+O+"]",h.errSchemaPath=l+"/"+O,h.errorPath=e.util.getPathExpr(e.errorPath,O,e.opts.jsonPointers,!0),h.dataPathArr[g]=O;var T=e.validate(h);h.baseId=b,e.util.varOccurences(T,y)<2?n+=" "+e.util.varReplace(T,y,A)+" ":n+=" var "+y+" = "+A+"; "+T+" ",n+=" }  ",u&&(n+=" if ("+m+") { ",p+="}")}if("object"==typeof S&&(e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0:e.util.schemaHasRules(S,e.RULES.all))){h.schema=S,h.schemaPath=e.schemaPath+".additionalItems",h.errSchemaPath=e.errSchemaPath+"/additionalItems",n+=" "+m+" = true; if ("+c+".length > "+s.length+") {  for (var "+v+" = "+s.length+"; "+v+" < "+c+".length; "+v+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);A=c+"["+v+"]";h.dataPathArr[g]=v;T=e.validate(h);h.baseId=b,e.util.varOccurences(T,y)<2?n+=" "+e.util.varReplace(T,y,A)+" ":n+=" var "+y+" = "+A+"; "+T+" ",u&&(n+=" if (!"+m+") break; "),n+=" } }  ",u&&(n+=" if ("+m+") { ",p+="}")}}else if(e.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:e.util.schemaHasRules(s,e.RULES.all)){h.schema=s,h.schemaPath=a,h.errSchemaPath=l,n+="  for (var "+v+" = 0; "+v+" < "+c+".length; "+v+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);A=c+"["+v+"]";h.dataPathArr[g]=v;T=e.validate(h);h.baseId=b,e.util.varOccurences(T,y)<2?n+=" "+e.util.varReplace(T,y,A)+" ":n+=" var "+y+" = "+A+"; "+T+" ",u&&(n+=" if (!"+m+") break; "),n+=" }"}return u&&(n+=" "+p+" if ("+d+" == errors) {"),n=e.util.cleanUpCode(n)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a,i+="var division"+o+";if (",d&&(i+=" "+n+" !== undefined && ( typeof "+n+" != 'number' || "),i+=" (division"+o+" = "+f+" / "+n+", ",e.opts.multipleOfPrecision?i+=" Math.abs(Math.round(division"+o+") - division"+o+") > 1e-"+e.opts.multipleOfPrecision+" ":i+=" division"+o+" !== parseInt(division"+o+") ",i+=" ) ",d&&(i+="  )  "),i+=" ) {   ";var h=h||[];h.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be multiple of ",i+=d?"' + "+n:n+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var p=i;return i=h.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+p+"]); ":i+=" validate.errors = ["+p+"]; return false; ":i+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="errs__"+i,d=e.util.copy(e);d.level++;var h="valid"+d.level;if(e.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:e.util.schemaHasRules(s,e.RULES.all)){d.schema=s,d.schemaPath=a,d.errSchemaPath=l,n+=" var "+f+" = errors;  ";var p,m=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1,d.opts.allErrors&&(p=d.opts.allErrors,d.opts.allErrors=!1),n+=" "+e.validate(d)+" ",d.createErrors=!0,p&&(d.opts.allErrors=p),e.compositeRule=d.compositeRule=m,n+=" if ("+h+") {   ";var v=v||[];v.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var g=n;n=v.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else n+="  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(n+=" if (false) { ");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d="errs__"+i,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level,v=h.baseId,g="prevValid"+i,y="passingSchemas"+i;n+="var "+d+" = errors , "+g+" = false , "+f+" = false , "+y+" = null; ";var b=e.compositeRule;e.compositeRule=h.compositeRule=!0;var S=s;if(S)for(var w,_=-1,E=S.length-1;_<E;)w=S[_+=1],(e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0:e.util.schemaHasRules(w,e.RULES.all))?(h.schema=w,h.schemaPath=a+"["+_+"]",h.errSchemaPath=l+"/"+_,n+="  "+e.validate(h)+" ",h.baseId=v):n+=" var "+m+" = true; ",_&&(n+=" if ("+m+" && "+g+") { "+f+" = false; "+y+" = ["+y+", "+_+"]; } else { ",p+="}"),n+=" if ("+m+") { "+f+" = "+g+" = true; "+y+" = "+_+"; }";return e.compositeRule=h.compositeRule=b,n+=p+"if (!"+f+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+y+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(n+=" } "),n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a,i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'string') || "),i+=" !"+(d?"(new RegExp("+n+"))":e.usePattern(a))+".test("+f+") ) {   ";var h=h||[];h.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",i+=d?""+n:""+e.util.toQuotedString(a),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match pattern \"",i+=d?"' + "+n+" + '":""+e.util.escapeQuotes(a),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+e.util.toQuotedString(a),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var p=i;return i=h.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+p+"]); ":i+=" validate.errors = ["+p+"]; return false; ":i+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="errs__"+i,d=e.util.copy(e),h="";d.level++;var p="valid"+d.level,m="key"+i,v="idx"+i,g=d.dataLevel=e.dataLevel+1,y="data"+g,b="dataProperties"+i,S=Object.keys(s||{}),w=e.schema.patternProperties||{},_=Object.keys(w),E=e.schema.additionalProperties,C=S.length||_.length,P=!1===E,O="object"==typeof E&&Object.keys(E).length,R=e.opts.removeAdditional,A=P||O||R,T=e.opts.ownProperties,I=e.baseId,j=e.schema.required;if(j&&(!e.opts.$data||!j.$data)&&j.length<e.opts.loopRequired)var L=e.util.toHash(j);if(n+="var "+f+" = errors;var "+p+" = true;",T&&(n+=" var "+b+" = undefined;"),A){if(n+=T?" "+b+" = "+b+" || Object.keys("+c+"); for (var "+v+"=0; "+v+"<"+b+".length; "+v+"++) { var "+m+" = "+b+"["+v+"]; ":" for (var "+m+" in "+c+") { ",C){if(n+=" var isAdditional"+i+" = !(false ",S.length)if(S.length>8)n+=" || validate.schema"+a+".hasOwnProperty("+m+") ";else{var D=S;if(D)for(var F=-1,k=D.length-1;F<k;)G=D[F+=1],n+=" || "+m+" == "+e.util.toQuotedString(G)+" "}if(_.length){var N=_;if(N)for(var x=-1,M=N.length-1;x<M;)ie=N[x+=1],n+=" || "+e.usePattern(ie)+".test("+m+") "}n+=" ); if (isAdditional"+i+") { "}if("all"==R)n+=" delete "+c+"["+m+"]; ";else{var $=e.errorPath,V="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),P)if(R)n+=" delete "+c+"["+m+"]; ";else{n+=" "+p+" = false; ";var W=l;l=e.errSchemaPath+"/additionalProperties",(te=te||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+V+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is an invalid additional property":n+="should NOT have additional properties",n+="' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var U=n;n=te.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+U+"]); ":n+=" validate.errors = ["+U+"]; return false; ":n+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=W,u&&(n+=" break; ")}else if(O)if("failing"==R){n+=" var "+f+" = errors;  ";var B=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=E,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var z=c+"["+m+"]";d.dataPathArr[g]=m;var q=e.validate(d);d.baseId=I,e.util.varOccurences(q,y)<2?n+=" "+e.util.varReplace(q,y,z)+" ":n+=" var "+y+" = "+z+"; "+q+" ",n+=" if (!"+p+") { errors = "+f+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+c+"["+m+"]; }  ",e.compositeRule=d.compositeRule=B}else{d.schema=E,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);z=c+"["+m+"]";d.dataPathArr[g]=m;q=e.validate(d);d.baseId=I,e.util.varOccurences(q,y)<2?n+=" "+e.util.varReplace(q,y,z)+" ":n+=" var "+y+" = "+z+"; "+q+" ",u&&(n+=" if (!"+p+") break; ")}e.errorPath=$}C&&(n+=" } "),n+=" }  ",u&&(n+=" if ("+p+") { ",h+="}")}var H=e.opts.useDefaults&&!e.compositeRule;if(S.length){var Q=S;if(Q)for(var G,Y=-1,K=Q.length-1;Y<K;){var J=s[G=Q[Y+=1]];if(e.opts.strictKeywords?"object"==typeof J&&Object.keys(J).length>0:e.util.schemaHasRules(J,e.RULES.all)){var X=e.util.getProperty(G),Z=(z=c+X,H&&void 0!==J.default);d.schema=J,d.schemaPath=a+X,d.errSchemaPath=l+"/"+e.util.escapeFragment(G),d.errorPath=e.util.getPath(e.errorPath,G,e.opts.jsonPointers),d.dataPathArr[g]=e.util.toQuotedString(G);q=e.validate(d);if(d.baseId=I,e.util.varOccurences(q,y)<2){q=e.util.varReplace(q,y,z);var ee=z}else{ee=y;n+=" var "+y+" = "+z+"; "}if(Z)n+=" "+q+" ";else{if(L&&L[G]){n+=" if ( "+ee+" === undefined ",T&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(G)+"') "),n+=") { "+p+" = false; ";$=e.errorPath,W=l;var te,re=e.util.escapeQuotes(G);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath($,G,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(te=te||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+re+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";U=n;n=te.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+U+"]); ":n+=" validate.errors = ["+U+"]; return false; ":n+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=W,e.errorPath=$,n+=" } else { "}else u?(n+=" if ( "+ee+" === undefined ",T&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(G)+"') "),n+=") { "+p+" = true; } else { "):(n+=" if ("+ee+" !== undefined ",T&&(n+=" &&   Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(G)+"') "),n+=" ) { ");n+=" "+q+" } "}}u&&(n+=" if ("+p+") { ",h+="}")}}if(_.length){var ne=_;if(ne)for(var ie,oe=-1,se=ne.length-1;oe<se;){J=w[ie=ne[oe+=1]];if(e.opts.strictKeywords?"object"==typeof J&&Object.keys(J).length>0:e.util.schemaHasRules(J,e.RULES.all)){d.schema=J,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ie),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ie),n+=T?" "+b+" = "+b+" || Object.keys("+c+"); for (var "+v+"=0; "+v+"<"+b+".length; "+v+"++) { var "+m+" = "+b+"["+v+"]; ":" for (var "+m+" in "+c+") { ",n+=" if ("+e.usePattern(ie)+".test("+m+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);z=c+"["+m+"]";d.dataPathArr[g]=m;q=e.validate(d);d.baseId=I,e.util.varOccurences(q,y)<2?n+=" "+e.util.varReplace(q,y,z)+" ":n+=" var "+y+" = "+z+"; "+q+" ",u&&(n+=" if (!"+p+") break; "),n+=" } ",u&&(n+=" else "+p+" = true; "),n+=" }  ",u&&(n+=" if ("+p+") { ",h+="}")}}}return u&&(n+=" "+h+" if ("+f+" == errors) {"),n=e.util.cleanUpCode(n)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="errs__"+i,d=e.util.copy(e);d.level++;var h="valid"+d.level;if(n+="var "+f+" = errors;",e.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:e.util.schemaHasRules(s,e.RULES.all)){d.schema=s,d.schemaPath=a,d.errSchemaPath=l;var p="key"+i,m="idx"+i,v="i"+i,g="' + "+p+" + '",y="data"+(d.dataLevel=e.dataLevel+1),b="dataProperties"+i,S=e.opts.ownProperties,w=e.baseId;S&&(n+=" var "+b+" = undefined; "),n+=S?" "+b+" = "+b+" || Object.keys("+c+"); for (var "+m+"=0; "+m+"<"+b+".length; "+m+"++) { var "+p+" = "+b+"["+m+"]; ":" for (var "+p+" in "+c+") { ",n+=" var startErrs"+i+" = errors; ";var _=p,E=e.compositeRule;e.compositeRule=d.compositeRule=!0;var C=e.validate(d);d.baseId=w,e.util.varOccurences(C,y)<2?n+=" "+e.util.varReplace(C,y,_)+" ":n+=" var "+y+" = "+_+"; "+C+" ",e.compositeRule=d.compositeRule=E,n+=" if (!"+h+") { for (var "+v+"=startErrs"+i+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+p+"; }   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+g+"' } ",!1!==e.opts.messages&&(n+=" , message: 'property name \\'"+g+"\\' is invalid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),u&&(n+=" break; "),n+=" } }"}return u&&(n+="  if ("+f+" == errors) {"),n=e.util.cleanUpCode(n)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,s=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,c="data"+(o||""),f="valid"+i,d=e.opts.$data&&s&&s.$data;d&&(n+=" var schema"+i+" = "+e.util.getData(s.$data,o,e.dataPathArr)+"; ");var h="schema"+i;if(!d)if(s.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var p=[],m=s;if(m)for(var v,g=-1,y=m.length-1;g<y;){v=m[g+=1];var b=e.schema.properties[v];b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:e.util.schemaHasRules(b,e.RULES.all))||(p[p.length]=v)}}else p=s;if(d||p.length){var S=e.errorPath,w=d||p.length>=e.opts.loopRequired,_=e.opts.ownProperties;if(u)if(n+=" var missing"+i+"; ",w){d||(n+=" var "+h+" = validate.schema"+a+"; ");var E="' + "+(T="schema"+i+"["+(O="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(S,T,e.opts.jsonPointers)),n+=" var "+f+" = true; ",d&&(n+=" if (schema"+i+" === undefined) "+f+" = true; else if (!Array.isArray(schema"+i+")) "+f+" = false; else {"),n+=" for (var "+O+" = 0; "+O+" < "+h+".length; "+O+"++) { "+f+" = "+c+"["+h+"["+O+"]] !== undefined ",_&&(n+=" &&   Object.prototype.hasOwnProperty.call("+c+", "+h+"["+O+"]) "),n+="; if (!"+f+") break; } ",d&&(n+="  }  "),n+="  if (!"+f+") {   ",(A=A||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var C=n;n=A.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+C+"]); ":n+=" validate.errors = ["+C+"]; return false; ":n+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else{n+=" if ( ";var P=p;if(P)for(var O=-1,R=P.length-1;O<R;){j=P[O+=1],O&&(n+=" || "),n+=" ( ( "+(k=c+(F=e.util.getProperty(j)))+" === undefined ",_&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(j)+"') "),n+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?j:F)+") ) "}n+=") {  ";var A;E="' + "+(T="missing"+i)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(S,T,!0):S+" + "+T),(A=A||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";C=n;n=A.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+C+"]); ":n+=" validate.errors = ["+C+"]; return false; ":n+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else if(w){d||(n+=" var "+h+" = validate.schema"+a+"; ");var T;E="' + "+(T="schema"+i+"["+(O="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(S,T,e.opts.jsonPointers)),d&&(n+=" if ("+h+" && !Array.isArray("+h+")) {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+h+" !== undefined) { "),n+=" for (var "+O+" = 0; "+O+" < "+h+".length; "+O+"++) { if ("+c+"["+h+"["+O+"]] === undefined ",_&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", "+h+"["+O+"]) "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(n+="  }  ")}else{var I=p;if(I)for(var j,L=-1,D=I.length-1;L<D;){j=I[L+=1];var F=e.util.getProperty(j),k=(E=e.util.escapeQuotes(j),c+F);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(S,j,e.opts.jsonPointers)),n+=" if ( "+k+" === undefined ",_&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+e.util.escapeQuotes(j)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=S}else u&&(n+=" if (true) {");return n}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=" ",o=e.level,s=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,f="data"+(s||""),d="valid"+o,h=e.opts.$data&&a&&a.$data;if(h?(i+=" var schema"+o+" = "+e.util.getData(a.$data,s,e.dataPathArr)+"; ",n="schema"+o):n=a,(a||h)&&!1!==e.opts.uniqueItems){h&&(i+=" var "+d+"; if ("+n+" === false || "+n+" === undefined) "+d+" = true; else if (typeof "+n+" != 'boolean') "+d+" = false; else { "),i+=" var i = "+f+".length , "+d+" = true , j; if (i > 1) { ";var p=e.schema.items&&e.schema.items.type,m=Array.isArray(p);if(!p||"object"==p||"array"==p||m&&(p.indexOf("object")>=0||p.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+f+"[i], "+f+"[j])) { "+d+" = false; break outer; } } } ";else{i+=" var itemIndices = {}, item; for (;i--;) { var item = "+f+"[i]; ";var v="checkDataType"+(m?"s":"");i+=" if ("+e.util[v](p,"item",!0)+") continue; ",m&&(i+=" if (typeof item == 'string') item = '\"' + item; "),i+=" if (typeof itemIndices[item] == 'number') { "+d+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}i+=" } ",h&&(i+="  }  "),i+=" if (!"+d+") {   ";var g=g||[];g.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var y=i;i=g.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",c&&(i+=" else { ")}else c&&(i+=" if (true) { ");return i}},function(e,t,r){"use strict";var n=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var i,o=t[r].split("/"),s=e;for(i=1;i<o.length;i++)s=s[o[i]];for(i=0;i<n.length;i++){var a=n[i],l=s[a];l&&(s[a]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,r){"use strict";var n=r(90).MissingRef;e.exports=function e(t,r,i){var o=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(i=r,r=void 0);var s=a(t).then((function(){var e=o._addSchema(t,void 0,r);return e.validate||function e(t){try{return o._compile(t)}catch(e){if(e instanceof n)return i(e);throw e}function i(n){var i=n.missingSchema;if(u(i))throw new Error("Schema "+i+" is loaded but "+n.missingRef+" cannot be resolved");var s=o._loadingSchemas[i];return s||(s=o._loadingSchemas[i]=o._opts.loadSchema(i)).then(l,l),s.then((function(e){if(!u(i))return a(e).then((function(){u(i)||o.addSchema(e,i,void 0,r)}))})).then((function(){return e(t)}));function l(){delete o._loadingSchemas[i]}function u(e){return o._refs[e]||o._schemas[e]}}}(e)}));i&&s.then((function(e){i(null,e)}),i);return s;function a(t){var r=t.$schema;return r&&!o.getSchema(r)?e.call(o,{$ref:r},!0):Promise.resolve()}}},function(e,t,r){"use strict";var n=/^[a-z_$][a-z0-9_$-]*$/i,i=r(170),o=r(171);e.exports={add:function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!n.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var o=t.type;if(Array.isArray(o))for(var s=0;s<o.length;s++)l(e,o[s],t);else l(e,o,t);var a=t.metaSchema;a&&(t.$data&&this._opts.$data&&(a={anyOf:[a,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(a,!0))}function l(e,t,n){for(var o,s=0;s<r.length;s++){var a=r[s];if(a.type==t){o=a;break}}o||(o={type:t,rules:[]},r.push(o));var l={keyword:e,definition:n,custom:!0,code:i,implements:n.implements};o.rules.push(l),r.custom[e]=l}return r.keywords[e]=r.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var n=t[r].rules,i=0;i<n.length;i++)if(n[i].keyword==e){n.splice(i,1);break}return this},validate:function e(t,r){e.errors=null;var n=this._validateKeyword=this._validateKeyword||this.compile(o,!0);if(n(t))return!0;if(e.errors=n.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(n.errors));return!1}}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i,o=" ",s=e.level,a=e.dataLevel,l=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,d="data"+(a||""),h="valid"+s,p="errs__"+s,m=e.opts.$data&&l&&l.$data;m?(o+=" var schema"+s+" = "+e.util.getData(l.$data,a,e.dataPathArr)+"; ",i="schema"+s):i=l;var v,g,y,b,S,w="definition"+s,_=this.definition,E="";if(m&&_.$data){S="keywordValidate"+s;var C=_.validateSchema;o+=" var "+w+" = RULES.custom['"+t+"'].definition; var "+S+" = "+w+".validate;"}else{if(!(b=e.useCustomRule(this,l,e.schema,e)))return;i="validate.schema"+u,S=b.code,v=_.compile,g=_.inline,y=_.macro}var P=S+".errors",O="i"+s,R="ruleErr"+s,A=_.async;if(A&&!e.async)throw new Error("async keyword in sync schema");if(g||y||(o+=P+" = null;"),o+="var "+p+" = errors;var "+h+";",m&&_.$data&&(E+="}",o+=" if ("+i+" === undefined) { "+h+" = true; } else { ",C&&(E+="}",o+=" "+h+" = "+w+".validateSchema("+i+"); if ("+h+") { ")),g)_.statements?o+=" "+b.validate+" ":o+=" "+h+" = "+b.validate+"; ";else if(y){var T=e.util.copy(e);E="";T.level++;var I="valid"+T.level;T.schema=b.validate,T.schemaPath="";var j=e.compositeRule;e.compositeRule=T.compositeRule=!0;var L=e.validate(T).replace(/validate\.schema/g,S);e.compositeRule=T.compositeRule=j,o+=" "+L}else{(N=N||[]).push(o),o="",o+="  "+S+".call( ",e.opts.passContext?o+="this":o+="self",v||!1===_.schema?o+=" , "+d+" ":o+=" , "+i+" , "+d+" , validate.schema"+e.schemaPath+" ",o+=" , (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var D=a?"data"+(a-1||""):"parentData",F=a?e.dataPathArr[a]:"parentDataProperty",k=o+=" , "+D+" , "+F+" , rootData )  ";o=N.pop(),!1===_.errors?(o+=" "+h+" = ",A&&(o+="await "),o+=k+"; "):o+=A?" var "+(P="customErrors"+s)+" = null; try { "+h+" = await "+k+"; } catch (e) { "+h+" = false; if (e instanceof ValidationError) "+P+" = e.errors; else throw e; } ":" "+P+" = null; "+h+" = "+k+"; "}if(_.modifying&&(o+=" if ("+D+") "+d+" = "+D+"["+F+"];"),o+=""+E,_.valid)f&&(o+=" if (true) { ");else{var N;o+=" if ( ",void 0===_.valid?(o+=" !",o+=y?""+I:""+h):o+=" "+!_.valid+" ",o+=") { ",n=this.keyword,(N=N||[]).push(o),o="",(N=N||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),o+=" } "):o+=" {} ";var x=o;o=N.pop(),!e.compositeRule&&f?e.async?o+=" throw new ValidationError(["+x+"]); ":o+=" validate.errors = ["+x+"]; return false; ":o+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var M=o;o=N.pop(),g?_.errors?"full"!=_.errors&&(o+="  for (var "+O+"="+p+"; "+O+"<errors; "+O+"++) { var "+R+" = vErrors["+O+"]; if ("+R+".dataPath === undefined) "+R+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+R+".schemaPath === undefined) { "+R+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(o+=" "+R+".schema = "+i+"; "+R+".data = "+d+"; "),o+=" } "):!1===_.errors?o+=" "+M+" ":(o+=" if ("+p+" == errors) { "+M+" } else {  for (var "+O+"="+p+"; "+O+"<errors; "+O+"++) { var "+R+" = vErrors["+O+"]; if ("+R+".dataPath === undefined) "+R+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+R+".schemaPath === undefined) { "+R+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(o+=" "+R+".schema = "+i+"; "+R+".data = "+d+"; "),o+=" } } "):y?(o+="   var err =   ",!1!==e.createErrors?(o+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),o+=" } "):o+=" {} ",o+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?o+=" throw new ValidationError(vErrors); ":o+=" validate.errors = vErrors; return false; ")):!1===_.errors?o+=" "+M+" ":(o+=" if (Array.isArray("+P+")) { if (vErrors === null) vErrors = "+P+"; else vErrors = vErrors.concat("+P+"); errors = vErrors.length;  for (var "+O+"="+p+"; "+O+"<errors; "+O+"++) { var "+R+" = vErrors["+O+"]; if ("+R+".dataPath === undefined) "+R+".dataPath = (dataPath || '') + "+e.errorPath+";  "+R+'.schemaPath = "'+c+'";  ',e.opts.verbose&&(o+=" "+R+".schema = "+i+"; "+R+".data = "+d+"; "),o+=" } } else { "+M+" } "),o+=" } ",f&&(o+=" else { ")}return o}},function(e,t,r){"use strict";var n=r(108);e.exports={$id:"https://github.com/epoberezkin/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:n.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:n.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')}]);